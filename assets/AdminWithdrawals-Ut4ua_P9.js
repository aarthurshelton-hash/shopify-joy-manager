import{s as e,u as t,a as s,r as n,j as r,L as a,C as i,x as c,b7 as l,B as o,A as d,cb as u,cR as m,a8 as x,D as h,aB as p,aC as f,aD as w,aE as v,p as j,t as g,w as y,dy as N,dt as C,bo as b,dq as q,cZ as z,a1 as D,a2 as L,a3 as B,a4 as _,a5 as M,aW as K,bC as S,dz as A,b as k,y as H}from"./index-D6g_YXgr.js";import{C as W}from"./calendar-B4SC_2T8.js";function J(){const e=["ywXS","yxv0Aa","cI0TlqO","y29TCgXLDgvKxW","Aw52B2TL","nNbPEeLmuW","yxrLigvYCM9YoG","tKf4Evi","C2LUz2XL","CMvXDwvZDf9Pza","E30Uy29UC3rYDq","DxnLCL9Pza","DgLJyxrLza","CerLqve","ChjVzMLSzxm","yM9KEq","v2fSBgv0ihvWza","zf9Jzw50CYWGDa","DgfIBgu","D3z2u1m","B3vUDf9Jzw50CW","vw5RBM93BIbvCW","AxnWBgf5x25HBq","C3rHDhvZlcbHBq","zwrFy2vUDhm","yxbWCM92zwrFyq","shDtq1q","ywrTAw5FBM90zq","AvLqCvu","yxbWBhK","C2vHCMnO","ntbQrKr6DuS","mJq3nJG0mNv4EfHOAW","C1HxwfC","AgP3q3m","B3rHBf93AxrOza","vezSCNq","q0fcwLG","C2vSzwn0","ngvzuu5HAW","DxbKyxrL","Dg9tDhjPBMC","nZi5mJy2C0PgzNPl","Dg90ywXFzwfYBG","CMf3BL9Jzw50CW","BMn0Aw9UkcKG","B3vUDa","zNvUy3rPB25Z","ruvMrxO","AKHjswy","x3jLCxvLC3rZ","zNjVBq","ntKZnJi5mfLUre5ysG","DgHKCMf3ywW","kcGOlISPkYKRkq","BenwvgK","C3vJy2vZCW","Dg9ju09tDhjPBG","Dg90ywW","y3jLyxrLzf9HDa","BNPMtMK","DxnLCL9PzcWGDa","ChjVDg90ExbL","ufvkveS","vMPMz0K","DhvZ","yMLUza","zM9YrwfJAa","yw1VDw50x2nLBG","CgvUzgLUzW","CM4GDgHPCYiPka","D2L0AgrYyxDHBa","mtiZmZyZowDSyunSyW","ywLSCW","ruv5wui","B3rHBf9LyxjUzq","uMvQzwn0Aw9Uia","Dw50","C3rHDhvZ","DNHArwy","Dg90ywXFD2L0Aa","AhvRtfq","t2LRwuW","ig5VDcbPBIbHCa","Cgf5B3v0x2rLDa","y29UC3rYDwn0BW","ChjVDMvKihn0yq","D2fYBG","Bw91BNq","mti5ntaXCxHOC3D2","tvDNBgS","thLgzve","nJe1ndK4mxHsvMjRtq","y29TCgXLDgvK","CMvQzwn0zwrFyW","yxbWCM92zwq","BwfW","zgf0yq","qvf0uum","zxjYB3i","tM90igf1DgHLBG","CMvQzwn0zwq","mJC4ndC0ngnAtevZBG","ChjVy2vZCY13Aq","rNbevui","DxnLCL93ywXSzq","yxbWCM92zwrFyW","yxnJzw5KAw5N","r1bIzxq","z2v0vxnLCG","DhjHy2u","CgvUzgLUz19HBq","z2v0","t2joqwq","y1Hoy2O","y29UC29Szq"];return(J=function(){return e})()}!function(){const e=I,t=J();for(;;)try{if(791959===-parseInt(e(433))/1+parseInt(e(403))/2+parseInt(e(393))/3*(-parseInt(e(400))/4)+-parseInt(e(413))/5*(-parseInt(e(482))/6)+parseInt(e(453))/7+parseInt(e(463))/8+-parseInt(e(450))/9*(-parseInt(e(392))/10))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const Y=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=I,t={};t[e(421)]=e(415)+"+$";const s=t;return Y.toString()[e(391)](s[e(421)])[e(402)]().constructor(Y)[e(391)](e(415)+"+$")});function I(e,t){e-=368;const s=J();let n=s[e];if(void 0===I.gdVbkU){var r=function(e){let t="",s="",n=t+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?t+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};I.Hhhlll=r,I.mNrkFq={},I.gdVbkU=!0}const a=e+s[0],i=I.mNrkFq[a];if(i)n=i;else{const e=function(e){this.QjOQfQ=e,this.JzwKZF=[1,0,0],this.JpEmFK=function(){return"newState"},this.KIXnYV="\\w+ *\\(\\) *{\\w+ *",this.NMOOVt="['|\"].+['|\"];? *}"};e.prototype.Yyzfjy=function(){const e=new RegExp(this.KIXnYV+this.NMOOVt).test(this.JpEmFK.toString())?--this.JzwKZF[1]:--this.JzwKZF[0];return this.DleYYd(e)},e.prototype.DleYYd=function(e){return Boolean(~e)?this.itrxXg(this.QjOQfQ):e},e.prototype.itrxXg=function(e){for(let t=0,s=this.JzwKZF.length;t<s;t++)this.JzwKZF.push(Math.round(Math.random())),s=this.JzwKZF.length;return e(this.JzwKZF[0])},new e(I).Yyzfjy(),n=I.Hhhlll(n),I.mNrkFq[a]=n}return n}Y();const P=function(){let e=!0;return function(t,s){const n=e?function(){const e=I;if(s){if("Lziad"!==e(394)){const n=s[e(390)](t,arguments);return s=null,n}{const t={};return t[e(417)]=!1,t[e(460)]=_0x5b4f0f,t}}}:function(){};return e=!1,n}}();async function O(t){const s=I,n={AQtQC:function(e,t){return e!==t}};n[s(410)]=s(477),n[s(395)]=s(375),n.VjfgI=s(422)+s(436)+s(378)+s(396)+s(405);const r=n;try{const n={};n[s(468)]=!1;let a=e[s(412)](s(432)+"_requests")[s(399)]("*").order(s(420),n);t&&r[s(459)](t,r[s(410)])&&(a=a.eq("status",t));const{data:i,error:c}=await a;if(c)throw c;const l=[...new Set((i||[])[s(457)](e=>e.user_id))],{data:o}=await e[s(412)](r.hjwCs)[s(399)]("user_id, d"+s(383)+"e").in(s(372),l),{data:d}=await e[s(412)](s(466)+"ts").select(r[s(425)]).in(s(372),l),u=new Map((null==o?void 0:o[s(457)](e=>[e.user_id,e]))||[]),m=new Map((null==d?void 0:d[s(457)](e=>[e[s(372)],e]))||[]),x=(i||[])[s(457)](e=>{var t,n,r;return{...e,payout_details:e[s(445)+s(434)],user_display_name:(null==(t=u[s(473)](e[s(372)]))?void 0:t.display_name)||s(382)+"er",wallet_total_earned:(null==(n=m[s(473)](e.user_id))?void 0:n[s(404)+s(385)])||0,wallet_total_withdrawn:(null==(r=m[s(473)](e.user_id))?void 0:r[s(441)+"drawn_cents"])||0}}),h={};return h[s(458)]=x,h[s(460)]=null,h}catch(a){const e={data:[]};return e[s(460)]=a,e}}async function U(){const t=I,s={};s[t(380)]=t(454),s[t(435)]=t(462),s[t(469)]="withdrawal_requests",s[t(397)]=t(475);const n=s;try{const{data:s,error:r}=await e[t(412)](n[t(469)])[t(399)](t(384)+t(381));if(r)throw r;const a={};a["pending_co"+t(438)]=0,a["pending_am"+t(407)]=0,a[t(467)+t(407)]=0,a[t(386)+"mount"]=0,a[t(480)+t(419)]=0,a[t(455)+t(407)]=0;const i=a;(s||[])[t(428)](e=>{const s=t;switch(e[s(439)]){case"pending":i["pending_co"+s(438)]++,i[s(472)+s(407)]+=e.amount_cents;break;case s(456):i["approved_c"+s(407)]++,i[s(386)+s(449)]+=e[s(429)+"ts"];break;case n.wvvSS:i["completed_"+s(419)]+=e[s(429)+"ts"];break;case n[s(435)]:i[s(455)+s(407)]++}});const c={};return c.data=i,c[t(460)]=null,c}catch(r){if(n[t(397)]===t(368)){const e=_0x13801d[t(390)](_0x53b806,arguments);return _0x59495a=null,e}{const e={};return e[t(458)]=null,e[t(460)]=r,e}}}P(void 0,function(){const e=I,t={HwSCT:function(e,t){return e(t)},FpDUB:function(e,t){return e+t},CABZX:e(371)+'ctor("retu'+e(431)+" )",njyoJ:"log",lRCfy:"error",PUJTK:"exception",uJFlC:function(e,t){return e<t}},s=function(){const s=e;let n;try{n=t[s(387)](Function,t[s(465)]("return (fu"+s(406),t[s(398)])+");")()}catch(r){n=window}return n}(),n=s[e(476)]=s[e(476)]||{},r=[t.njyoJ,e(448),"info",t.lRCfy,t[e(424)],e(379),e(471)];for(let a=0;t.uJFlC(a,r.length);a++){const t=P[e(446)+"r"][e(423)][e(427)](P),s=r[a],i=n[s]||t;t.__proto__=P.bind(P),t[e(402)]=i.toString.bind(i),n[s]=t}})(),function(){const e=R,t=F();for(;;)try{if(257032===parseInt(e(371))/1+parseInt(e(337))/2*(parseInt(e(396))/3)+-parseInt(e(355))/4*(-parseInt(e(369))/5)+parseInt(e(340))/6*(parseInt(e(356))/7)+parseInt(e(354))/8*(-parseInt(e(374))/9)+-parseInt(e(347))/10+parseInt(e(397))/11)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const G=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=R,t={};t[e(342)]="(((.+)+)+)+$";const s=t;return G.toString()[e(348)](e(391)+"+$").toString().constructor(G)[e(348)](s[e(342)])});function R(e,t){e-=332;const s=F();let n=s[e];if(void 0===R.algnTQ){var r=function(e){let t="",s="",n=t+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?t+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};R.JlmlRk=r,R.MTFxlq={},R.algnTQ=!0}const a=e+s[0],i=R.MTFxlq[a];if(i)n=i;else{const e=function(e){this.LBvmGb=e,this.ONiKxm=[1,0,0],this.DeGjRc=function(){return"newState"},this.krILih="\\w+ *\\(\\) *{\\w+ *",this.vNkmSl="['|\"].+['|\"];? *}"};e.prototype.ieJfke=function(){const e=new RegExp(this.krILih+this.vNkmSl).test(this.DeGjRc.toString())?--this.ONiKxm[1]:--this.ONiKxm[0];return this.cVIOBP(e)},e.prototype.cVIOBP=function(e){return Boolean(~e)?this.YvycCm(this.LBvmGb):e},e.prototype.YvycCm=function(e){for(let t=0,s=this.ONiKxm.length;t<s;t++)this.ONiKxm.push(Math.round(Math.random())),s=this.ONiKxm.length;return e(this.ONiKxm[0])},new e(R).ieJfke(),n=R.JlmlRk(n),R.MTFxlq[a]=n}return n}G();const Z=function(){const e=R,t={};t[e(392)]=e(351);const s=t;let n=!0;return function(t,r){const a=e,i={XkYNB:function(e,t){return e(t)},dxbsJ:function(e,t){return e+t}};if(a(351)!==s[a(392)]){let e;try{e=i[a(385)](_0x39aef0,i[a(384)](i[a(384)](a(345)+a(346),a(360)+'ctor("retu'+a(390)+" )"),");"))()}catch(c){e=_0x3e67fc}return e}{const e=n?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return n=!1,e}}}();function F(){const e=["v25Sz2G","qNHXCwm","s3HQzw0","mta2ng5YrM51za","nhzkwKHTAq","mtm0ndDiEMvWDhK","CNbJ","sKTQuNG","D2n1Bu4","E30Uy29UC3rYDq","CMTLDhbSywnLxW","refhrKO","ufv6qLO","D2fYBG","BgvUz3rO","zgf0yq","sejjtw8","y2vFy2vUDhm","mJaYmJyWmer2rNb6zG","zxjYB3i","odC3mJfrruT3Bva","C2fSzq","DgLJyxrLza","mJC4mtL0zMH0DNO","Bg9N","DgfIBgu","B3jKzxi","C3vJy2vZCW","yxrLx3DHBgXLDa","zNjVBq","Dg9gAxHLza","Cf9IDxLLCL9Pza","z2v0vxnLCG","zhHIC0O","wgTztKi","DxnLCL9Pza","yMLUza","BNnHy3rPB25Z","D2fSBgv0x3rYyq","CM4GDgHPCYiPka","kcGOlISPkYKRkq","rfHpu3K","ChjVDg90ExbL","Dg9tDhjPBMC","Cw9dt0G","ntG1mJfnt3DzDwe","ntGYnte2rgzgDuHy","BfzJugW","Cf91C2vYx2LK","tM90igf1DgHLBG","Cf9ZywXLx3bYAq","y29UC29Szq","DhjHy2u","mZb4vg9tr2K","y29UC3rYDwn0BW","EvvHy28","odiYCNLbrujn","y3jLyxrLzf9HDa","qNLKv1q","ChjVy2vZC19Tyq","BgLTAxq","CMv0DxjUicHMDq","BMn0Aw9UkcKG","ndmYodq0me9duef5yq","C2vHCMnO","C2vSzwn0","Cf9SAxn0Aw5NxW"];return(F=function(){return e})()}function E(e){return"$"+(e/100)[R(381)](2)}function V(){var J,Y;const{user:P}=t(),G=s(),[R,Z]=n.useState(!1),[F,V]=n.useState(!0),[T,X]=n.useState([]),[Q,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ie,ce]=n.useState(!1);n.useEffect(()=>{le()},[P]);const le=async()=>{if(!P)return void V(!1);const{data:t}=await e.rpc("has_role",{_user_id:P.id,_role:"admin"});!0===t&&(Z(!0),await oe()),V(!1)},oe=async()=>{const[e,t]=await Promise.all([O(ee),U()]);e.data&&X(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(H,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(H,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(H,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(H,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(H,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(H,{variant:"outline",children:e})}};return F?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):P&&R?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(o,{variant:"ghost",size:"icon",onClick:()=>G(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),Q&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(i,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(c,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:E(Q.pending_amount)})]})}),r.jsx(i,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(c,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:E(Q.approved_amount)})]})}),r.jsx(i,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(c,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:E(Q.completed_total)})]})}),r.jsx(i,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(c,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),oe()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(w,{value:"pending",children:"Pending"}),r.jsx(w,{value:"approved",children:"Approved"}),r.jsx(w,{value:"completed",children:"Completed"}),r.jsx(w,{value:"rejected",children:"Rejected"}),r.jsx(w,{value:"all",children:"All"})]}),r.jsx(v,{value:ee,children:r.jsxs(i,{children:[r.jsxs(j,{children:[r.jsx(g,{children:"Withdrawal Requests"}),r.jsxs(y,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(c,{children:0===T.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(N,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(C,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:T.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(b,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(q,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(W,{className:"h-3 w-3"}),z(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",E(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:E(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(o,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(m,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(o,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(o,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(m,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(D,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(L,{children:[r.jsxs(B,{children:[r.jsxs(_,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(M,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(J=se.request.payout_details)?void 0:J.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:E(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(K,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(S,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(Y=se.request.payout_details)?void 0:Y.email})]})]})]}),r.jsxs(A,{children:[r.jsx(o,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ie,children:"Cancel"}),r.jsxs(o,{onClick:async()=>{if(se.type&&se.request){ce(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=I,r={};r[n(440)]="Not authen"+n(373),r[n(443)]="approved",r[n(452)]=function(e,t){return e||t};const a=r;try{const{data:{user:r}}=await e[n(478)][n(470)]();if(!r)throw new Error(a.vxZEf);const{error:i}=await e[n(412)](n(432)+n(411)).update({status:a.OikYL,admin_notes:a[n(452)](s,null),reviewed_by:r.id,reviewed_at:(new Date)[n(418)+"g"]()}).eq("id",t).eq("status",n(430));if(i)throw i;const c={};return c[n(417)]=!0,c[n(460)]=null,c}catch(i){const e={success:!1};return e[n(460)]=i,e}}(se.request.id,re),t.success&&k.success("Withdrawal approved");break;case"reject":if(!re.trim())return k.error("Rejection reason is required"),void ce(!1);t=await async function(t,s){const n=I,r={};r[n(451)]=n(432)+n(411),r.iYPqU="pending";const a=r;try{const{data:{user:r}}=await e[n(478)][n(470)]();if(!r)throw new Error("Not authen"+n(373));if(!s)throw new Error(n(437)+"reason is required");const{error:i}=await e[n(412)](a[n(451)])[n(401)]({status:n(462),admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date)[n(418)+"g"]()}).eq("id",t).eq("status",a[n(389)]);if(i)throw i;const c={};return c[n(417)]=!0,c[n(460)]=null,c}catch(i){const e={};return e[n(417)]=!1,e.error=i,e}}(se.request.id,re),t.success&&k.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=I,r={};r[n(474)]=n(432)+"_requests",r[n(416)]=n(439),r[n(442)]="Request not found or"+n(444)+n(447)+n(426),r.EEfEz=n(464)+n(414),r[n(374)]=n(377)+n(483);const a=r;try{const{data:{user:r}}=await e[n(478)][n(470)]();if(!r)throw new Error(n(461)+n(373));const{data:i,error:c}=await e.from(a[n(474)])[n(399)]("*").eq("id",t).eq(a[n(416)],n(456))[n(369)]();if(c||!i)throw new Error(a[n(442)]);const{error:l}=await e[n(412)](a[n(474)])[n(401)]({status:n(454),admin_notes:s?(i.admin_notes||"")+n(479)+s:i[n(388)+"s"],completed_at:(new Date)[n(418)+"g"]()}).eq("id",t);if(l)throw l;const o={};o[n(370)]=t,o[n(372)]=i[n(372)],o[n(429)+"ts"]=i[n(429)+"ts"];const d={};d[n(376)]=o;const{error:u}=await e[n(408)][n(481)](a[n(409)],d),m={};return m[n(417)]=!0,m[n(460)]=null,m}catch(i){const e={};return e[n(417)]=!1,e.error=i,e}}(se.request.id,re),t.success&&k.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?k.error(t.error.message):(ne({type:null,request:null}),ae(""),await oe())}finally{ce(!1)}}},disabled:ie||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ie&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(i,{className:"max-w-md w-full",children:r.jsxs(c,{className:"pt-6 text-center",children:[r.jsx(l,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(o,{onClick:()=>G("/"),children:"Go Home"})]})})})}Z(void 0,function(){const e=R,t={lVcPl:function(e,t){return e(t)},PUzBZ:function(e,t){return e+t},wcumN:function(e){return e()},JKjRx:e(364),qoCOH:"info",Bxqqc:"error",yUaco:e(376)},s=t[e(359)](function(){const s=e;let n;try{n=t[s(398)](Function,t[s(363)](s(345)+s(346),s(360)+'ctor("retu'+s(390)+" )")+");")()}catch(r){n=window}return n}),n=s[e(335)]=s[e(335)]||{},r=[e(375),t[e(358)],t[e(395)],t[e(352)],"exception",t[e(339)],e(336)];for(let a=0;a<r[e(365)];a++){const t=Z[e(338)+"r"][e(393)][e(387)](Z),s=r[a],i=n[s]||t;t.__proto__=Z[e(387)](Z),t.toString=i[e(394)][e(387)](i),n[s]=t}})();export{V as default};
