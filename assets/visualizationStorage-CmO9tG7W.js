import{s as n,ca as r,dG as t,dH as e}from"./index-D6g_YXgr.js";import{v as o,a as i,b as a}from"./visualizationSchemas-_U_9EAz7.js";import"./flagContent-BiRdmn0V.js";function s(n,r){n-=352;const t=l();let e=t[n];if(void 0===s.LMmeqb){var o=function(n){let r="",t="",e=r+o;for(let o,i,a=0,s=0;i=n.charAt(s++);~i&&(o=a%4?64*o+i:i,a++%4)?r+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=r.length;o<i;o++)t+="%"+("00"+r.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(t)};s.pHCXQx=o,s.eYYNuL={},s.LMmeqb=!0}const i=n+t[0],a=s.eYYNuL[i];if(a)e=a;else{const n=function(n){this.OptHoD=n,this.EvOeHy=[1,0,0],this.VHPqkq=function(){return"newState"},this.XZjtOr="\\w+ *\\(\\) *{\\w+ *",this.lRXQlz="['|\"].+['|\"];? *}"};n.prototype.CbYgVP=function(){const n=new RegExp(this.XZjtOr+this.lRXQlz).test(this.VHPqkq.toString())?--this.EvOeHy[1]:--this.EvOeHy[0];return this.apLKLD(n)},n.prototype.apLKLD=function(n){return Boolean(~n)?this.Wzvsse(this.OptHoD):n},n.prototype.Wzvsse=function(n){for(let r=0,t=this.EvOeHy.length;r<t;r++)this.EvOeHy.push(Math.round(Math.random())),t=this.EvOeHy.length;return n(this.EvOeHy[0])},new n(s).CbYgVP(),e=s.pHCXQx(e),s.eYYNuL[i]=e}return e}!function(){const n=s,r=l();for(;;)try{if(172555===-parseInt(n(464))/1*(-parseInt(n(402))/2)+parseInt(n(455))/3*(parseInt(n(370))/4)+parseInt(n(490))/5*(-parseInt(n(453))/6)+-parseInt(n(373))/7+-parseInt(n(511))/8*(-parseInt(n(383))/9)+parseInt(n(534))/10+-parseInt(n(505))/11)break;r.push(r.shift())}catch(t){r.push(r.shift())}}();const u=function(){let n=!0;return function(r,t){const e=n?function(){if(t){const n=t[s(446)](r,arguments);return t=null,n}}:function(){};return n=!1,e}}()(void 0,function(){const n=s;return u[n(524)]().search(n(494)+"+$")[n(524)]()[n(501)+"r"](u)[n(400)](n(494)+"+$")});u();const c=function(){let n=!0;return function(r,t){const e=n?function(){if(t){const n=t.apply(r,arguments);return t=null,n}}:function(){};return n=!1,e}}();function l(){const n=["zgfYA01Vzgu","r1ziAfq","yM9HCMq","zNjVBq","Dg90ywXnB3zLCW","vxLoEuy","C2fMzq","CK5HEwG","yKvlt04","DxbSAwnHDguGyW","BfvNAw4","zxr0zvnPBwLSyq","CM91BMq","Aw4GEw91CIbNyq","mZbVvvjqBuW","Aw1Hz2uVCg5N","DhrLswq","ywXPEMf0Aw9UoG","kcGOlISPkYKRkq","DhLXCeS","B3DUzwrcEun1CG","vgHPCYbPCYa","Bw9KzxjU","zcWGCgDUlcbNyq","AxnjBNrYAw5ZAq","y29UC3rYDwn0BW","BgXLy3rVCG","BMn0Aw9UkcKG","C2f2zwrFDMLZDq","ntG4ndGYngLHDerJsa","C3vHBgL6yxrPBW","rxHHy3qGzhvWBa","vhnbww8","z2TMBMe","Bw92zxm","mJq5mJK2CMPiBK5T","C2LUz2XL","rxjYB3iGAw4Gza","rxjYB3iGy2HLyW","tIbKyxrH","BgL6yxrPB246ia","zgvSzxrL","zxr0zuLK","ywLUCYbPBMfWCa","zxHJzxb0Aw9U","AwnHDguGzxHPCW","A2LUzYbKDxbSAq","CMvHC29U","Dg9tDhjPBMC","y3vZDg9Tq29SBW","Ew9kzw4","CgfSzxr0zuLK","y29UC29Szq","CMvZDwX0","ChjVDg90ExbL","u2vhBvG","BwvFzgf0yq","y3vYCMvUDe1VDG","otG0mdGWq1DfveLL","AxPHDgLVBIaTia","sfH4DKC","y3rVCIGICMv0Dq","CfnouLC","C3vJy2vZCW","BgXLCNK","y0DHBwu","Bwf0y2HLzeDHBq","zxHPC3rPBMDdBW","yxnJzw5KAw5N","DxnLCL9Pza","BgfYihzPC3vHBa","B3jKzxi","DxbZzxj0","DhjHy2u","BgL6yxrPB24GAq","C2f2zsb2Axn1yq","z2fTzv9KyxrH","DgXL","Cgf0Ag5HBwu","odG3nZu2uKDUBwLq","ruDdz2m","Aw9Uig5VDcbMBW","ndqWmdiWBhnnsNrJ","yvLIEvm","y29SB3jtAw1PBa","yMr0yLm","ueDsu1qXmty","CMvWBgfJzq","ihzLCNKGC2LTAq","y1bHBgv0Dgu","Aw9UCW","wKPKCMS","nJneuKjhwfu","CgLLy2vdB2XVCG","uePOEgq","BKLK","zMLUza","BgvUz3rO","zgf0yq","y29Kzq","Dhj5ignOyw5NAq","BM93","vgHPCYb2Axn1yq","tfb6t0K","C2vSzwn0","CvresLe","vK1zCuW","v21Sv3m","Dw5K","C2vHCMnO","ChjVzMLSzxm","nJzrseH5tKS","Bwf0y2HLzfbHBa","rKHZv2C","AvnJA2G","AM9PBG","CM9WCMLHDguGyW","zgf0zq","zxHPC3rPBMDwAq","ww91igHHDMuGyq","yMXHy2S","tvzMD1O","zxjYB3i","yxjPDhK","z2fTzurHDge","ChvIBgLJvxjS","BwvZC2fNzq","z2u6ia","vMLZDwfSAxPHDa","B2Dsqxi","yxjL","Aw9Uu3rHDgu","DwfSAxPHDgLVBG","zw5LC3m","qw9wu04","Dwn6Dui","DMLZDwfSAxPHDa","Bg9JywXLq29TCa","yK55y0K","B3DUzxjeAxnWBa","y3jLyxrLzf9HDa","AgnprLy","y29UDgvUDfr5Ca","zunHCMq","s0Tvsue","AxneDxbSAwnHDa","CML0Eq","zxzLBNq","wgTRD1y","BMCGyxqGBgvHCW","Bg9JA2vKugLLyW","t0vovNm","AunizNC","C3rVCMfNzq","yw5VDgHLCIbJBW","yxbWBhK","Dg9mB3DLCKnHCW","z2v0uhvIBgLJvq","y3vZDg9T","rMfPBgvKihrVia","AxnuB29tAw1PBa","CM4GDgHPCYiPka","mti0odbyyxHssxq","Dg8Gysb2AxnPBW","m2r1BgvAzG","D2HPDgu","E30Uy29UC3rYDq","zgvSzxrLihzPCW","zxHPC3rPBMDjza","CgLLy2vuExbL","yMLUza","C3rYAw5NAwz5","ywXPEMf0Aw9UCW","nZqWnNfyqxPWuq","CgDU","BNrluKm","igzVCIb1BMLXDq","BgLUA2vKugfSzq","yxLoyw1L","zMv0y2GGDMLZDq","Bg9YCW","AgvJAZO","CMvUDfvZzxi","CMvTB3zL","BIbIEsa"];return(l=function(){return n})()}function f(n,r,t){const e=s,o={};o[e(385)]="all";const i=o;return(n||r.pgn||"").trim()[e(378)](/\s+/g," ")+"::"+(t?JSON[e(462)]({palette:t[e(527)]||e(498),darkMode:t[e(476)]||!1,currentMove:t[e(533)+"e"]===1/0?i[e(385)]:t[e(533)+"e"],lockedPieces:(t[e(441)+"es"]||[]).sort((n,r)=>(n.pieceColor+"-"+n[e(460)])[e(428)+e(421)](r[e(384)]+"-"+r[e(460)]))}):"{}")}async function w(o,i,a,u){const c=s,l={ntKRC:function(n,r){return n===r},LPzOI:c(484),NbMlc:function(n,r,t,e){return n(r,t,e)},uczuB:function(n,r,t,e){return n(r,t,e)},TsAYo:c(360),iCHfw:c(507)+c(521)+"ts",AoVSN:"modern",ZJdrk:c(397),TUzvv:function(n,r){return n===r},MVfwZ:function(n,r,t,e,o,i){return n(r,t,e,o,i)},lUgin:function(n,r){return n(r)},yoJen:c(513)+c(485)+c(472)};try{if(l.ntKRC(l[c(394)],"bEKON")){const s=l.NbMlc(f,i,a,u),{data:w,error:y}=await n[c(479)](c(504)+"alizations")[c(395)]("id, user_i"+c(499)+c(532));if(y){const n={};return n[c(436)+"e"]=!1,n.isTooSimilar=!1,n}for(const r of w||[]){const t=r[c(367)];if(s===l[c(426)](f,r[c(465)]||void 0,t,t["visualizat"+c(422)])){const t=l[c(466)](r.user_id,o);let e;if(!t){const{data:t}=await n[c(479)](c(401))[c(395)]("display_name").eq(l[c(508)],r.user_id).single();e=(null==t?void 0:t.display_name)||"Another co"+c(502)}const i={isDuplicate:!0,isTooSimilar:!0};return i[c(459)]=r.id,i.ownedByCurrentUser=t,i[c(430)+c(469)]=e,i["colorSimil"+c(414)]=100,i.reason=l[c(443)],i}}const C=(null==u?void 0:u.paletteId)||l[c(425)];let z;if(null==u?void 0:u[c(525)+"rs"]){if(l[c(382)]!=l[c(382)]){const n={};return n[c(413)]=_0x54ea6c,n}z=u[c(525)+"rs"]}else if(l.TUzvv(C,c(449))){if("MYbmM"===c(376)){const n=_0x5dcaf1[c(496)+c(473)]?c(393)+"lization is already in your gallery":c(393)+c(365)+"s owned by "+(_0x120336.ownerDisplayName||c(445)+"llector");return{data:null,error:new _0x345982(n),isDuplicate:!0,ownedByCurrentUser:_0x521109[c(496)+"rentUser"],ownerDisplayName:_0x242753[c(430)+c(469)],colorSimilarity:100}}{const n=r[c(387)](n=>n.id===c(449));if(n){const r={};r.white=n[c(456)],r.black=n[c(411)],z=r}}}const v=await l[c(412)](t,o,i,a,C,z);if(v[c(451)+"ar"]){const n={};return n[c(436)+"e"]=!1,n[c(451)+"ar"]=!0,n[c(459)]=v[c(409)+c(506)+c(386)],n[c(496)+c(473)]=v["ownedByCur"+c(473)],n["ownerDispl"+c(469)]=v[c(430)+c(469)],n[c(375)+"arity"]=v[c(375)+c(414)],n[c(523)]=v[c(523)],n[c(358)+c(471)]=v[c(358)+"lors"],n["isIntrinsi"+c(380)]=v[c(500)+c(380)],n.isIntrinsicGame=v[c(500)+c(356)],n.matchedGameCard=v["matchedGam"+c(434)],n[c(403)+c(518)]=v["matchedPal"+c(518)],n["matchedPal"+c(487)+c(437)]=v[c(403)+c(487)+"rity"],n}let D;z&&(D=l[c(486)](e,z)||void 0);const g={};return g[c(436)+"e"]=!1,g[c(451)+"ar"]=!1,g[c(468)+"tteId"]=D,g["colorSimil"+c(414)]=v[c(375)+c(414)],g["isIntrinsi"+c(380)]=v[c(500)+c(380)],g.isIntrinsicGame=v[c(500)+c(356)],g[c(357)+c(434)]=v[c(357)+c(434)],g[c(403)+c(518)]=v[c(403)+c(518)],g[c(403)+c(487)+c(437)]=v[c(403)+c(487)+c(437)],g}{_0x2086cc[c(413)](c(513)+c(485)+c(472),_0x47c61d);const n={};return n[c(436)+"e"]=!1,n.isTooSimilar=!1,n}}catch(w){const n={};return n[c(436)+"e"]=!1,n[c(451)+"ar"]=!1,n}}async function y(r,t,e,u,c,l){const f=s,y={zLxaO:function(n,r){return n(r)},FHsWg:"Invalid ti"+f(368),bNycI:function(n,r){return n!==r},iSckh:"ogRAr",TiiwZ:f(445)+"llector",GVHhT:f(427)+"ions",EGCgc:function(n,r){return n!==r},SeGmX:f(374)};try{const s=y.zLxaO(o,t);if(!s[f(354)]){if(f(481)!==f(442))return{data:null,error:new Error(s[f(413)]||y[f(404)])};{const n={};return n[f(389)]=[],n[f(413)]=_0x54db94,n}}const C=await i(t);if(!C[f(482)])return y[f(429)](y[f(405)],f(420))?_0x132a81[f(524)]()[f(400)]("(((.+)+)+)+$").toString()[f(501)+"r"](_0x42ff67).search(f(494)+"+$"):{data:null,error:new Error(C.reason||"Title cont"+f(519)+f(407)+"ontent")};const z=a(c);if(!z.success)return{data:null,error:new Error(z[f(413)]||"Invalid PG"+f(515))};const v=await w(r,c,e[f(415)],l);if(v[f(436)+"e"]){const n=v[f(496)+f(473)]?f(393)+f(365)+"s already "+f(489)+f(355):"This visua"+f(365)+"s owned by "+(v["ownerDispl"+f(469)]||y.TiiwZ);return{data:null,error:new Error(n),isDuplicate:!0,ownedByCurrentUser:v[f(496)+f(473)],ownerDisplayName:v.ownerDisplayName,colorSimilarity:100}}if(v[f(451)+"ar"]){const n=v["ownedByCur"+f(473)]?f(410)+f(379)+f(361)+f(535)+f(391)+f(440)+"t 8 colors"+f(467)+f(424):f(497)+Math[f(488)](v[f(375)+f(414)]||30)+"% similar "+f(454)+f(475)+(v[f(430)+f(469)]||y.TiiwZ);return{data:null,error:new Error(n),isTooSimilar:!0,ownedByCurrentUser:v[f(496)+f(473)],ownerDisplayName:v[f(430)+f(469)],colorSimilarity:v["colorSimil"+f(414)],reason:v.reason}}const D={...l};D[f(468)+f(492)]=v[f(468)+"tteId"];const g=D,B=r+"/"+Date[f(392)]()+"-"+t[f(378)](/[^a-z0-9]/gi,"-")[f(447)+"e"]()+".png",d={};d[f(433)+"e"]=f(491),d[f(363)]=!1;const{error:L}=await n[f(444)][f(479)](y[f(477)]).upload(B,u,d);if(L)throw new Error(f(450)+"upload ima"+f(418)+L[f(417)]);const{data:x}=n[f(444)][f(479)](f(427)+f(381))[f(448)+"rl"](B),h={};h.white=e[f(415)].white,h[f(411)]=e[f(415)].black,h[f(438)]=e.gameData.event,h[f(408)]=e[f(415)].date,h[f(529)]=e[f(415)][f(529)],h[f(465)]=e[f(415)][f(465)],h.moves=e.gameData[f(510)],h.board=e[f(478)],h.totalMoves=e[f(480)],h[f(427)+f(422)]=g;const H=h,m={};m[f(360)]=r,m.title=t,m[f(465)]=c||null,m[f(367)]=H,m.image_path=x[f(416)];const{data:q,error:M}=await n[f(479)](f(504)+"alizations").insert(m)[f(395)]()[f(512)]();if(M){if(y[f(371)](y.SeGmX,y[f(531)])){const n=_0x2aafc9[f(446)](_0x8f1084,arguments);return _0x6e6510=null,n}throw await n.storage[f(479)]("visualizat"+f(381))[f(474)]([B]),new Error("Failed to "+f(366)+f(516)+M[f(417)])}const p={};return p[f(389)]=q,p[f(413)]=null,p}catch(C){const n={};return n[f(389)]=null,n.error=C,n}}async function C(r){const t=s;try{const e={};e[t(359)]=!1;const{data:o,error:i}=await n[t(479)](t(504)+t(463))[t(395)]("*").eq("user_id",r)[t(362)](t(431),e);if(i)throw new Error(t(450)+t(470)+t(463)+": "+i[t(417)]);const a={};return a[t(389)]=o||[],a[t(413)]=null,a}catch(e){const n={};return n[t(389)]=[],n.error=e,n}}async function z(r,t){const e=s,o={};o[e(483)]=e(427)+e(381),o[e(435)]=e(504)+e(463);const i=o;try{const o=new URL(t)[e(369)].split("/"),a=o.findIndex(n=>n===e(427)+"ions"),s=o.slice(a+1)[e(406)]("/");s&&await n.storage[e(479)](i[e(483)])[e(474)]([s]);const{error:u}=await n.from(i[e(435)])[e(517)]().eq("id",r);if(u)throw new Error("Failed to delete vis"+e(423)+": "+u[e(417)]);const c={error:null};return c}catch(a){const n={};return n.error=a,n}}c(void 0,function(){const n=s,r={OYYDR:"return (fu"+n(503),pSNRW:n(457)+n(352)+n(452)+" )",WmlWs:function(n){return n()},hcOFV:"warn",qTDJQ:"table",XkkwV:function(n,r){return n<r}},t=r[n(398)](function(){const t=n;let e;try{e=Function(r.OYYDR+r[t(353)]+");")()}catch(o){e=window}return e}),e=t.console=t[n(528)]||{},o=["log",r[n(432)],"info",n(413),n(520),r[n(396)],n(364)];for(let i=0;r[n(439)](i,o[n(388)]);i++){const r=c[n(501)+"r"][n(530)].bind(c),t=o[i],a=e[t]||r;r.__proto__=c[n(461)](c),r[n(524)]=a[n(524)][n(461)](a),e[t]=r}})();export{w as checkDuplicateVisualization,z as deleteVisualization,C as getUserVisualizations,y as saveVisualization};
