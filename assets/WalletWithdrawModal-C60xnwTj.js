const n='import { useState, useEffect } from \'react\';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \'@/components/ui/dialog\';\nimport { Button } from \'@/components/ui/button\';\nimport { Input } from \'@/components/ui/input\';\nimport { Label } from \'@/components/ui/label\';\nimport { Textarea } from \'@/components/ui/textarea\';\nimport { Banknote, Shield, AlertTriangle, CheckCircle2, Info } from \'lucide-react\';\nimport { getWithdrawableBalance, validateWithdrawal, createWithdrawalRequest } from \'@/lib/marketplace/withdrawalApi\';\nimport { formatBalance } from \'@/lib/marketplace/walletApi\';\nimport { toast } from \'sonner\';\n\ninterface WalletWithdrawModalProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onSuccess?: () => void;\n}\n\nexport function WalletWithdrawModal({ open, onOpenChange, onSuccess }: WalletWithdrawModalProps) {\n  const [amount, setAmount] = useState(\'\');\n  const [paypalEmail, setPaypalEmail] = useState(\'\');\n  const [notes, setNotes] = useState(\'\');\n  const [loading, setLoading] = useState(false);\n  const [withdrawableBalance, setWithdrawableBalance] = useState(0);\n  const [validationError, setValidationError] = useState<string | null>(null);\n\n  const amountCents = Math.round(parseFloat(amount || \'0\') * 100);\n  const isValidAmount = amountCents >= 1000 && amountCents <= withdrawableBalance;\n\n  useEffect(() => {\n    if (open) {\n      loadWithdrawableBalance();\n    }\n  }, [open]);\n\n  const loadWithdrawableBalance = async () => {\n    const { data } = await getWithdrawableBalance();\n    setWithdrawableBalance(data);\n  };\n\n  const handleAmountChange = async (value: string) => {\n    setAmount(value);\n    setValidationError(null);\n    \n    const cents = Math.round(parseFloat(value || \'0\') * 100);\n    if (cents >= 1000) {\n      const { data } = await validateWithdrawal(cents);\n      if (data && !data.is_valid) {\n        setValidationError(data.error_message);\n      }\n    }\n  };\n\n  const handleWithdraw = async () => {\n    if (!isValidAmount || !paypalEmail) return;\n\n    setLoading(true);\n    try {\n      const { data: requestId, error } = await createWithdrawalRequest(amountCents, {\n        method: \'paypal\',\n        email: paypalEmail,\n        notes\n      });\n\n      if (error) {\n        toast.error(error.message);\n        return;\n      }\n\n      toast.success(\'Withdrawal request submitted! We\\\'ll process it within 3-5 business days.\');\n      onOpenChange(false);\n      onSuccess?.();\n    } catch (err) {\n      toast.error(\'Failed to submit withdrawal request\');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className="sm:max-w-md">\n        <DialogHeader>\n          <DialogTitle className="flex items-center gap-2">\n            <Banknote className="h-5 w-5 text-green-600" />\n            Withdraw Earnings\n          </DialogTitle>\n          <DialogDescription>\n            Request a payout of your marketplace earnings\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className="space-y-6 py-4">\n          {/* Available balance */}\n          <div className="p-4 rounded-lg bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/20">\n            <p className="text-sm text-muted-foreground">Available to Withdraw</p>\n            <p className="text-2xl font-bold text-green-600">\n              {formatBalance(withdrawableBalance)}\n            </p>\n            <p className="text-xs text-muted-foreground mt-1">\n              From marketplace sales only\n            </p>\n          </div>\n\n          {/* Amount */}\n          <div className="space-y-2">\n            <Label htmlFor="withdraw-amount">Withdrawal Amount (USD)</Label>\n            <div className="relative">\n              <span className="absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground">$</span>\n              <Input\n                id="withdraw-amount"\n                type="number"\n                min="10"\n                step="0.01"\n                placeholder="0.00"\n                value={amount}\n                onChange={(e) => handleAmountChange(e.target.value)}\n                className="pl-7"\n              />\n            </div>\n            <p className="text-xs text-muted-foreground">\n              Minimum: $10.00\n            </p>\n            {validationError && (\n              <p className="text-xs text-destructive flex items-center gap-1">\n                <AlertTriangle className="h-3 w-3" />\n                {validationError}\n              </p>\n            )}\n          </div>\n\n          {/* PayPal email */}\n          <div className="space-y-2">\n            <Label htmlFor="paypal-email">PayPal Email</Label>\n            <Input\n              id="paypal-email"\n              type="email"\n              placeholder="your@email.com"\n              value={paypalEmail}\n              onChange={(e) => setPaypalEmail(e.target.value)}\n            />\n            <p className="text-xs text-muted-foreground">\n              Funds will be sent to this PayPal account\n            </p>\n          </div>\n\n          {/* Optional notes */}\n          <div className="space-y-2">\n            <Label htmlFor="notes">Notes (Optional)</Label>\n            <Textarea\n              id="notes"\n              placeholder="Any special instructions..."\n              value={notes}\n              onChange={(e) => setNotes(e.target.value)}\n              rows={2}\n            />\n          </div>\n\n          {/* Anti-fraud info */}\n          <div className="space-y-3">\n            <div className="flex items-start gap-3 p-3 rounded-lg bg-muted/50">\n              <Shield className="h-5 w-5 text-primary shrink-0 mt-0.5" />\n              <div className="text-sm">\n                <p className="font-medium text-foreground">Fraud Protection</p>\n                <ul className="text-muted-foreground mt-1 space-y-1">\n                  <li className="flex items-center gap-1">\n                    <CheckCircle2 className="h-3 w-3 text-green-600" />\n                    Only earned funds (from sales) can be withdrawn\n                  </li>\n                  <li className="flex items-center gap-1">\n                    <CheckCircle2 className="h-3 w-3 text-green-600" />\n                    7-day wallet maturity requirement\n                  </li>\n                  <li className="flex items-center gap-1">\n                    <CheckCircle2 className="h-3 w-3 text-green-600" />\n                    Manual review within 3-5 business days\n                  </li>\n                </ul>\n              </div>\n            </div>\n\n            <div className="flex items-start gap-3 p-3 rounded-lg bg-blue-500/10 border border-blue-500/20">\n              <Info className="h-5 w-5 text-blue-600 shrink-0 mt-0.5" />\n              <p className="text-sm text-blue-700">\n                Withdrawals are reviewed manually to ensure security. \n                You\'ll receive an email when your payout is processed.\n              </p>\n            </div>\n          </div>\n\n          <Button \n            onClick={handleWithdraw} \n            disabled={!isValidAmount || !paypalEmail || loading || !!validationError}\n            className="w-full"\n          >\n            {loading ? \'Submitting...\' : `Request Withdrawal of ${formatBalance(amountCents)}`}\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n';export{n as default};
