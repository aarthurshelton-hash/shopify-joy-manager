const e="/**\n * Rate Limiting Hook v2 - Uses unified core\n * \n * Simplified API with sliding window accuracy\n */\n\nimport { useCallback, useState, useRef, useEffect } from 'react';\nimport { toast } from 'sonner';\nimport { \n  checkRateLimit, \n  getBrowserIdentifier,\n  RateLimitProfile,\n  RateLimitResult,\n  RATE_LIMIT_PROFILES \n} from '@/lib/rateLimitCore';\n\ninterface UseRateLimitOptions {\n  profile: RateLimitProfile;\n  showToast?: boolean;\n  onLimited?: (result: RateLimitResult) => void;\n}\n\ninterface UseRateLimitReturn {\n  check: () => RateLimitResult;\n  isLimited: boolean;\n  remaining: number | null;\n  resetInMs: number | null;\n  reset: () => void;\n}\n\nexport function useRateLimitV2({\n  profile,\n  showToast = true,\n  onLimited,\n}: UseRateLimitOptions): UseRateLimitReturn {\n  const [state, setState] = useState({\n    isLimited: false,\n    remaining: null as number | null,\n    resetInMs: null as number | null,\n  });\n  \n  const resetTimerRef = useRef<ReturnType<typeof setTimeout>>();\n  const identifierRef = useRef<string>();\n\n  // Memoize identifier\n  useEffect(() => {\n    identifierRef.current = getBrowserIdentifier();\n    return () => {\n      if (resetTimerRef.current) clearTimeout(resetTimerRef.current);\n    };\n  }, []);\n\n  const check = useCallback((): RateLimitResult => {\n    const identifier = identifierRef.current || getBrowserIdentifier();\n    const result = checkRateLimit(identifier, profile);\n\n    setState({\n      isLimited: !result.allowed,\n      remaining: result.remaining,\n      resetInMs: result.resetInMs,\n    });\n\n    if (!result.allowed) {\n      if (showToast && result.retryAfter) {\n        toast.error(`Rate limited. Try again in ${result.retryAfter}s`);\n      }\n      onLimited?.(result);\n\n      // Auto-reset state when limit expires\n      if (resetTimerRef.current) clearTimeout(resetTimerRef.current);\n      resetTimerRef.current = setTimeout(() => {\n        setState(s => ({ ...s, isLimited: false }));\n      }, result.resetInMs);\n    }\n\n    return result;\n  }, [profile, showToast, onLimited]);\n\n  const reset = useCallback(() => {\n    setState({ isLimited: false, remaining: null, resetInMs: null });\n    if (resetTimerRef.current) clearTimeout(resetTimerRef.current);\n  }, []);\n\n  return {\n    check,\n    isLimited: state.isLimited,\n    remaining: state.remaining,\n    resetInMs: state.resetInMs,\n    reset,\n  };\n}\n\n// ============================================\n// Pre-configured hooks for common use cases\n// ============================================\n\nexport function useAuthRateLimit() {\n  return useRateLimitV2({ profile: 'auth' });\n}\n\nexport function usePaymentRateLimit() {\n  return useRateLimitV2({ profile: 'payment' });\n}\n\nexport function useSearchRateLimit() {\n  return useRateLimitV2({ profile: 'search', showToast: false });\n}\n\nexport function useDownloadRateLimit() {\n  return useRateLimitV2({ profile: 'download' });\n}\n\nexport function useUploadRateLimit() {\n  return useRateLimitV2({ profile: 'upload' });\n}\n\nexport function useBenchmarkRateLimit() {\n  return useRateLimitV2({ profile: 'benchmark' });\n}\n\nexport function useScanRateLimit() {\n  return useRateLimitV2({ profile: 'scan' });\n}\n\n// Export profiles for reference\nexport { RATE_LIMIT_PROFILES };\n";export{e as default};
