import{s as e}from"./index-1k5cZzy0.js";async function t(t,n,r,s){try{const{error:o}=await e.from("flagged_content").insert({content_type:t,content_id:(null==s?void 0:s.contentId)||null,content_text:(null==s?void 0:s.contentText)||null,content_image_url:(null==s?void 0:s.contentImageUrl)||null,user_id:n,reason:r,severity:(null==s?void 0:s.severity)||"medium",status:"pending"});if(o)throw o;return{success:!0}}catch(o){return{success:!1,error:o.message}}}async function n(t){try{const{count:n,error:r}=await e.from("user_offenses").select("*",{count:"exact",head:!0}).eq("user_id",t);if(r)throw r;return n||0}catch(n){return 0}}async function r(){try{const{data:t,error:n}=await e.from("flagged_content").select("*").eq("status","pending").order("created_at",{ascending:!1});if(n)throw n;return t||[]}catch(t){return[]}}async function s(t,n,r,s){try{const{error:o}=await e.from("flagged_content").update({status:n,reviewed_by:r,reviewed_at:(new Date).toISOString(),review_notes:s||null}).eq("id",t);if(o)throw o;return{success:!0}}catch(o){return{success:!1,error:o.message}}}async function o(t,n,r,s){var o,a;try{const{data:c}=await e.from("banned_users").select("id, offense_count").eq("user_id",t).maybeSingle();if(c){const{error:t}=await e.from("banned_users").update({reason:n,banned_by:r,banned_at:(new Date).toISOString(),expires_at:(null==(o=null==s?void 0:s.expiresAt)?void 0:o.toISOString())||null,offense_count:(c.offense_count||1)+1}).eq("id",c.id);if(t)throw t}else{const{error:o}=await e.from("banned_users").insert({user_id:t,reason:n,banned_by:r,expires_at:(null==(a=null==s?void 0:s.expiresAt)?void 0:a.toISOString())||null,offense_count:(null==s?void 0:s.offenseCount)||1});if(o)throw o}return await e.from("user_offenses").insert({user_id:t,offense_type:(null==s?void 0:s.expiresAt)?"temp_ban":"permanent_ban",notes:n,created_by:r}),{success:!0}}catch(c){return{success:!1,error:c.message}}}async function a(t){try{const{error:n}=await e.from("banned_users").delete().eq("user_id",t);if(n)throw n;return{success:!0}}catch(n){return{success:!1,error:n.message}}}async function c(){try{const{data:t,error:n}=await e.from("banned_users").select("*").order("banned_at",{ascending:!1});if(n)throw n;return t||[]}catch(t){return[]}}async function i(t,n,r,s){try{const{error:o}=await e.from("user_offenses").insert({user_id:t,flagged_content_id:n,offense_type:"warning",notes:r,created_by:s});if(o)throw o;return{success:!0}}catch(o){return{success:!1,error:o.message}}}export{c as a,n as b,o as c,t as f,r as g,i,s as r,a as u};
