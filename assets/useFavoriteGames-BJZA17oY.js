const e="import { useState, useEffect, useCallback } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useAuth } from './useAuth';\n\nexport function useFavoriteGames() {\n  const { user } = useAuth();\n  const [favoriteIds, setFavoriteIds] = useState<Set<string>>(new Set());\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Fetch user's favorite games\n  const fetchFavorites = useCallback(async () => {\n    if (!user) {\n      setFavoriteIds(new Set());\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const { data, error } = await supabase\n        .from('favorite_games')\n        .select('game_id')\n        .eq('user_id', user.id);\n\n      if (error) {\n        console.error('Error fetching favorites:', error);\n        return;\n      }\n\n      setFavoriteIds(new Set(data?.map(f => f.game_id) || []));\n    } catch (err) {\n      console.error('Error fetching favorites:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user]);\n\n  // Initial fetch\n  useEffect(() => {\n    fetchFavorites();\n  }, [fetchFavorites]);\n\n  // Check if a game is favorited\n  const isFavorite = useCallback((gameId: string) => {\n    return favoriteIds.has(gameId);\n  }, [favoriteIds]);\n\n  // Toggle favorite status\n  const toggleFavorite = useCallback(async (gameId: string): Promise<boolean> => {\n    if (!user) {\n      return false;\n    }\n\n    const isCurrentlyFavorite = favoriteIds.has(gameId);\n\n    // Optimistic update\n    setFavoriteIds(prev => {\n      const next = new Set(prev);\n      if (isCurrentlyFavorite) {\n        next.delete(gameId);\n      } else {\n        next.add(gameId);\n      }\n      return next;\n    });\n\n    try {\n      if (isCurrentlyFavorite) {\n        // Remove favorite\n        const { error } = await supabase\n          .from('favorite_games')\n          .delete()\n          .eq('user_id', user.id)\n          .eq('game_id', gameId);\n\n        if (error) {\n          // Revert on error\n          setFavoriteIds(prev => {\n            const next = new Set(prev);\n            next.add(gameId);\n            return next;\n          });\n          console.error('Error removing favorite:', error);\n          return false;\n        }\n      } else {\n        // Add favorite\n        const { error } = await supabase\n          .from('favorite_games')\n          .insert({ user_id: user.id, game_id: gameId });\n\n        if (error) {\n          // Revert on error\n          setFavoriteIds(prev => {\n            const next = new Set(prev);\n            next.delete(gameId);\n            return next;\n          });\n          console.error('Error adding favorite:', error);\n          return false;\n        }\n      }\n      return true;\n    } catch (err) {\n      console.error('Error toggling favorite:', err);\n      return false;\n    }\n  }, [user, favoriteIds]);\n\n  return {\n    favoriteIds,\n    isFavorite,\n    toggleFavorite,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n";export{e as default};
