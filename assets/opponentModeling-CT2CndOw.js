const n="/**\n * Opponent Modeling - v7.53-ACCURACY\n * \n * Weights predictions based on player tendencies and style DNA.\n * Different players respond to the same position differently.\n */\n\nexport type PlayStyle = \n  | 'tactical'      // Calculates deeply, seeks complications\n  | 'positional'    // Slow maneuvering, structure focus\n  | 'aggressive'    // Always attacks, sacrifices\n  | 'solid'         // Avoids risk, draws acceptable\n  | 'universal'     // Adapts to opponent\n  | 'unknown';\n\nexport interface PlayerProfile {\n  id: string;\n  name?: string;\n  elo: number;\n  style: PlayStyle;\n  \n  // Statistical tendencies\n  winRateWhite: number;\n  winRateBlack: number;\n  drawRate: number;\n  \n  // Behavioral patterns\n  timeManagement: 'fast' | 'normal' | 'slow';\n  riskTolerance: number;  // 0-1, higher = more risk-seeking\n  \n  // Opening preferences\n  preferredOpenings: string[];\n  avoidedOpenings: string[];\n}\n\n/**\n * Style matchup matrix - how styles interact\n * Positive = first style has advantage\n */\nexport const STYLE_MATCHUPS: Record<PlayStyle, Record<PlayStyle, number>> = {\n  tactical: {\n    tactical: 0,\n    positional: -0.05,\n    aggressive: 0.1,\n    solid: -0.1,\n    universal: 0,\n    unknown: 0,\n  },\n  positional: {\n    tactical: 0.05,\n    positional: 0,\n    aggressive: 0.15,\n    solid: -0.05,\n    universal: 0,\n    unknown: 0,\n  },\n  aggressive: {\n    tactical: -0.1,\n    positional: -0.15,\n    aggressive: 0,\n    solid: -0.2,\n    universal: -0.05,\n    unknown: 0,\n  },\n  solid: {\n    tactical: 0.1,\n    positional: 0.05,\n    aggressive: 0.2,\n    solid: 0,\n    universal: 0.05,\n    unknown: 0,\n  },\n  universal: {\n    tactical: 0,\n    positional: 0,\n    aggressive: 0.05,\n    solid: -0.05,\n    universal: 0,\n    unknown: 0,\n  },\n  unknown: {\n    tactical: 0,\n    positional: 0,\n    aggressive: 0,\n    solid: 0,\n    universal: 0,\n    unknown: 0,\n  },\n};\n\n/**\n * Infer playing style from ELO and limited data\n */\nexport function inferPlayStyle(\n  elo: number,\n  winRate: number,\n  drawRate: number\n): PlayStyle {\n  // High draw rate suggests solid/positional\n  if (drawRate > 0.35) {\n    return winRate > 0.4 ? 'positional' : 'solid';\n  }\n  \n  // Very high win rate at high ELO = universal\n  if (elo > 2600 && winRate > 0.55) {\n    return 'universal';\n  }\n  \n  // High win rate, low draws = aggressive/tactical\n  if (winRate > 0.5 && drawRate < 0.2) {\n    return 'aggressive';\n  }\n  \n  // Moderate stats = tactical\n  if (winRate > 0.4) {\n    return 'tactical';\n  }\n  \n  return 'unknown';\n}\n\n/**\n * Create player profile from basic data\n */\nexport function createPlayerProfile(\n  id: string,\n  elo: number,\n  name?: string,\n  stats?: { wins: number; losses: number; draws: number }\n): PlayerProfile {\n  const total = stats ? stats.wins + stats.losses + stats.draws : 0;\n  const winRateWhite = stats && total > 0 ? stats.wins / total : 0.45;\n  const drawRate = stats && total > 0 ? stats.draws / total : 0.25;\n  \n  return {\n    id,\n    name,\n    elo,\n    style: inferPlayStyle(elo, winRateWhite, drawRate),\n    winRateWhite,\n    winRateBlack: winRateWhite * 0.9, // Black typically lower\n    drawRate,\n    timeManagement: elo > 2400 ? 'normal' : 'fast',\n    riskTolerance: elo > 2500 ? 0.4 : 0.6,\n    preferredOpenings: [],\n    avoidedOpenings: [],\n  };\n}\n\n/**\n * Calculate style matchup adjustment\n */\nexport function getStyleMatchupAdjustment(\n  whiteProfile: PlayerProfile,\n  blackProfile: PlayerProfile\n): number {\n  const baseMatchup = STYLE_MATCHUPS[whiteProfile.style][blackProfile.style];\n  \n  // ELO difference adjustment\n  const eloDiff = whiteProfile.elo - blackProfile.elo;\n  const eloAdjustment = Math.tanh(eloDiff / 400) * 0.1;\n  \n  return baseMatchup + eloAdjustment;\n}\n\n/**\n * Adjust win probabilities based on player profiles\n */\nexport function adjustProbabilitiesForProfiles(\n  baseWhiteWin: number,\n  baseBlackWin: number,\n  baseDraw: number,\n  whiteProfile: PlayerProfile,\n  blackProfile: PlayerProfile\n): { whiteWin: number; blackWin: number; draw: number } {\n  const matchupAdj = getStyleMatchupAdjustment(whiteProfile, blackProfile);\n  \n  // Adjust based on matchup\n  let whiteWin = baseWhiteWin + matchupAdj;\n  let blackWin = baseBlackWin - matchupAdj;\n  let draw = baseDraw;\n  \n  // Style-specific draw rate adjustments\n  if (whiteProfile.style === 'solid' || blackProfile.style === 'solid') {\n    draw += 0.05;\n    whiteWin -= 0.025;\n    blackWin -= 0.025;\n  }\n  \n  if (whiteProfile.style === 'aggressive' && blackProfile.style === 'aggressive') {\n    draw -= 0.1;\n    // Split the removed draw probability\n    whiteWin += 0.05;\n    blackWin += 0.05;\n  }\n  \n  // Normalize to ensure sum = 1\n  const total = whiteWin + blackWin + draw;\n  return {\n    whiteWin: Math.max(0, Math.min(1, whiteWin / total)),\n    blackWin: Math.max(0, Math.min(1, blackWin / total)),\n    draw: Math.max(0, Math.min(1, draw / total)),\n  };\n}\n\n/**\n * Predict which player is more likely to blunder under pressure\n */\nexport function predictBlunderProbability(\n  profile: PlayerProfile,\n  timeRemaining: number,\n  positionComplexity: number\n): number {\n  // Base blunder rate inversely related to ELO\n  const baseRate = Math.max(0.01, 0.15 - (profile.elo / 20000));\n  \n  // Time pressure multiplier\n  const timePressure = timeRemaining < 60 ? 2.0 : \n                       timeRemaining < 180 ? 1.5 : 1.0;\n  \n  // Complexity multiplier\n  const complexityMultiplier = 1 + (positionComplexity * 0.5);\n  \n  // Style adjustment\n  const styleMultiplier = profile.style === 'tactical' ? 0.8 :\n                          profile.style === 'aggressive' ? 1.2 :\n                          profile.style === 'solid' ? 0.7 : 1.0;\n  \n  return Math.min(0.5, baseRate * timePressure * complexityMultiplier * styleMultiplier);\n}\n";export{n as default};
