import{s as t,ca as n,dG as r,dH as e}from"./index-DBmMOexX.js";import{v as o,a,b as i}from"./visualizationSchemas-DPlUPo3l.js";import"./flagContent-CYjYu1sZ.js";!function(){const t=x,n=w();for(;;)try{if(604336===-parseInt(t(314))/1*(parseInt(t(358))/2)+parseInt(t(221))/3*(parseInt(t(284))/4)+parseInt(t(170))/5*(parseInt(t(360))/6)+-parseInt(t(341))/7+-parseInt(t(207))/8+-parseInt(t(212))/9*(parseInt(t(167))/10)+parseInt(t(327))/11)break;n.push(n.shift())}catch(r){n.push(n.shift())}}();const u=function(){let t=!0;return function(n,r){const e=t?function(){if(r){const t=r[x(260)](n,arguments);return r=null,t}}:function(){};return t=!1,e}}()(void 0,function(){const t=x;return u[t(307)]()[t(204)]("(((.+)+)+)+$").toString()[t(199)+"r"](u)[t(204)](t(331)+"+$")});u();const c=function(){let t=!0;return function(n,r){const e=t?function(){if(r){const t=r[x(260)](n,arguments);return r=null,t}}:function(){};return t=!1,e}}();function s(t,n,r){const e=x,o={};o[e(185)]=e(254),o[e(243)]=function(t,n){return t===n};const a=o;return(t||n[e(253)]||"").trim().replace(/\s+/g," ")+"::"+(r?JSON[e(209)]({palette:r[e(300)]||a[e(185)],darkMode:r[e(246)]||!1,currentMove:a[e(243)](r[e(205)+"e"],1/0)?e(237):r[e(205)+"e"],lockedPieces:(r.lockedPieces||[])[e(276)]((t,n)=>(t[e(274)]+"-"+t[e(229)])["localeComp"+e(153)](n.pieceColor+"-"+n.pieceType))}):"{}")}async function f(o,a,i,u){const c=x,f={vbNYZ:"Title contains inapp"+c(332)+c(161),ruFmP:function(t,n,r,e){return t(n,r,e)},QbaNO:c(197)+c(301)+c(328),Prwld:c(230)+c(349)+c(241),hfqIg:function(t,n){return t!==n},yYKnB:c(244),iyPKO:function(t,n){return t===n},gTqNj:"MDvPB",xlEqn:c(257),SpQOU:c(235)+c(189)+"ts",WSRAq:c(254),lPVZS:function(t,n,r,e,o,a){return t(n,r,e,o,a)},BeKRb:function(t,n){return t!==n},IJFzv:c(357),erZXQ:function(t,n){return t(n)},doOiU:c(330)+c(271)+c(286)};try{const w=f[c(313)](s,a,i,u),{data:l,error:x}=await t[c(315)](c(336)+c(178))[c(353)](f[c(329)]);if(x){const t={};return t[c(216)+"e"]=!1,t[c(169)+"ar"]=!1,t}for(const n of l||[]){if(!f[c(283)](f[c(151)],"dBDxf"))return{data:null,error:new _0x55c232(_0x89c066.reason||f.vbNYZ)};{const r=n[c(181)];if(w===s(n.pgn||void 0,r,r[c(317)+c(351)])){const r=f[c(158)](n.user_id,o);let e;if(!r){if(c(236)===f[c(227)]){const t={};return t[c(269)]=_0x38ad8c,t}{const{data:r}=await t.from(c(343)).select(c(163)+"me").eq(f.xlEqn,n.user_id)[c(293)]();e=(null==r?void 0:r[c(163)+"me"])||c(149)+"llector"}}const a={};return a[c(216)+"e"]=!0,a[c(169)+"ar"]=!0,a[c(280)]=n.id,a["ownedByCur"+c(206)]=r,a[c(195)+c(338)]=e,a[c(296)+c(324)]=100,a[c(210)]=f[c(298)],a}}}const C=(null==u?void 0:u[c(300)])||f[c(247)];let y;if(null==u?void 0:u.customColors)y=u[c(184)+"rs"];else if(C===c(202)){const t=n[c(292)](t=>t.id===c(202));if(t){const n={};n[c(303)]=t.white,n[c(335)]=t.black,y=n}}const d=await f[c(174)](r,o,a,i,C,y);if(d[c(169)+"ar"]){const t={};return t[c(216)+"e"]=!1,t.isTooSimilar=!0,t[c(280)]=d[c(272)+c(323)+"nId"],t[c(245)+"rentUser"]=d[c(245)+c(206)],t["ownerDispl"+c(338)]=d[c(195)+c(338)],t[c(296)+c(324)]=d["colorSimil"+c(324)],t[c(210)]=d[c(210)],t[c(183)+"lors"]=d[c(183)+c(287)],t[c(355)+c(240)]=d[c(355)+c(240)],t[c(355)+c(275)]=d[c(355)+c(275)],t[c(255)+"eCard"]=d[c(255)+c(251)],t[c(218)+"etteId"]=d[c(218)+c(196)],t["matchedPal"+c(319)+c(270)]=d[c(218)+c(319)+"rity"],t}let B;if(y){if(f[c(175)](c(357),f[c(309)]))return{data:null,error:new _0x4cfec9(_0x4a7f11[c(269)]||c(239)+"tle")};B=f[c(262)](e,y)||void 0}const g={isDuplicate:!1};return g[c(169)+"ar"]=!1,g[c(226)+"tteId"]=B,g[c(296)+"arity"]=d[c(296)+"arity"],g["isIntrinsi"+c(240)]=d[c(355)+"cPalette"],g["isIntrinsi"+c(275)]=d[c(355)+c(275)],g[c(255)+c(251)]=d.matchedGameCard,g["matchedPal"+c(196)]=d[c(218)+c(196)],g[c(218)+c(319)+c(270)]=d[c(218)+c(319)+c(270)],g}catch(w){const t={};return t[c(216)+"e"]=!1,t.isTooSimilar=!1,t}}function w(){const t=["wNfTv2S","y29UC29Szq","vgjpqwK","Dhj5ignOyw5NAq","AwnHDguGzxHPCW","y29Kzq","BgfYihzPC3vHBa","CfPXs1O","DgXL","CYbVD25LzcbIEq","B3DUzxjeAxnWBa","zxr0zuLK","AwqSihvZzxjFAq","B2zYwK4","y29UC3rYDwn0BW","uhj3Bgq","ruDxwK8","y3vZDg9T","DwfSAxPHDgLVBG","C2vHCMnO","y3vYCMvUDe1VDG","CMvUDfvZzxi","mJu1otyYne1mqvvSra","BgvUz3rO","C3rYAw5NAwz5","CMvHC29U","q2Txr1a","nJK0mZC3s29Jt2fP","vgHPCYb2Axn1yq","Bg9JA2vKugLLyW","BMn0Aw9UkcKG","AxneDxbSAwnHDa","BgXLy3rVCG","Bwf0y2HLzfbHBa","DhrLswq","y29UDgvUDfr5Ca","odKZmtyWv0v5DLvj","tKPvzum","Aw1Hz2vFCgf0Aa","Du9zwK4","ruzMCui","BgLUA2vKugfSzq","z1rXtMO","C1DnyuC","CgLLy2vuExbL","rxjYB3iGy2HLyW","DgL0Bgu","EM1hy3u","C2XPy2u","ihzLCNKGC2LTAq","rxHHy3qGzhvWBa","rM5tu1i","ywXS","BvzeDLy","sw52ywXPzcb0Aq","y1bHBgv0Dgu","y2f0zxm6","AwrYAe8","EKjICKC","zwHXt0u","B3DUzwrcEun1CG","zgfYA01Vzgu","v1nsqxe","yxnVt1u","zg9pAvu","zg9su1e","zunHCMq","CMvWBgfJzq","CgDU","Bw9KzxjU","Bwf0y2HLzeDHBq","AhvWs2m","DxnLCL9Pza","AKrtqKe","tIbKyxrH","yxbWBhK","CM4GDgHPCYiPka","zxjAwfe","ChjVDg90ExbL","ywnvDw0","zu1VANu","DuL5rNC","vMLZDwfSAxPHDa","Dg8Gysb2AxnPBW","zxjYB3i","CML0Eq","DxbSAwnHDguGyW","zxHPC3rPBMDwAq","BgL6yxrPB246ia","CgLLy2vdB2XVCG","y0DHBwu","C29YDa","CMvNAwO","Aw9Uig5VDcbMBW","DgfIBgu","zxHPC3rPBMDjza","z2v0uhvIBgLJvq","z2u6ia","AgzXswC","oengB3j5va","BKLK","AgvJAZO","Bg9YCW","Dg9mB3DLCKnHCW","z2fTzurHDge","rMfPBgvKihrVia","C3rVCMfNzq","zMLUza","C2LUz2XL","CgjVEei","D2fYBG","y29SB3jtAw1PBa","A2fLB1q","u3brt1u","ywLUCYbPBMfWCa","CgfSzxr0zuLK","zcWGCgDUlcbNyq","yxnJzw5KAw5N","D2HPDgu","zgvSzxrL","CwPLB3y","E30Uy29UC3rYDq","Dg9tDhjPBMC","BIbIEsa","suPgENy","vgL0BguGy29UDa","CMvTB3zL","sw52ywXPzcbqrW","CNvgBva","mZi5C0TUzhPS","zNjVBq","ywXPEMf0Aw9UoG","DMLZDwfSAxPHDa","wxflvLC","zxr0zvnPBwLSyq","BMCGyxqGBgvHCW","tgfxquC","Aw5MBW","C3vHBgL6yxrPBW","yxjPDhK","BgL6yxrPB24GAq","q21dEui","mtq2mJiYmJnoDLnlAve","BwvFzgf0yq","uwjHtK8","rxjYB3iGAw4Gza","kcGOlISPkYKRkq","CM9WCMLHDguGyW","zMv0y2GGDMLZDq","Dg90ywXnB3zLCW","yMXHy2S","C2f2zwrFDMLZDq","Dw5K","yxLoyw1L","yw5VDgHLCIbJBW","C3vJy2vZCW","nZy2nJCZnKLgCw9Mva","y3rVCIGICMv0Dq","ChjVzMLSzxm","CM91BMq","x19WCM90B19F","AuDSDLO","zgf0yq","yuDYq0C","A2LUzYbKDxbSAq","DhjPBq","Aw9Uu3rHDgu","Aw9UCW","C2vSzwn0","AM9PBG","AxnjBNrYAw5ZAq","BM93","yw1brw0","mJq5nhznBuHnvq","Aw1Hz2uVCg5N","mZe1nJu0yMH0EffU","CuPVChu","ChPeBxa","CMvZDwX0","rLbxu1K","Dca4ignVBg9YCW","qw5VDgHLCIbJBW","jsbZAw1PBgfYia","EvLlBKi","CYbHBhjLywr5ia","yxjL","Aw5Zzxj0","ueDsu1qXmty","vwT3vhm","yMLUza","AxLqs08","Bw92zxm","C3bSAxq","B250zw50","BwvZC2fNzq","zgLZCgXHEv9Uyq","zxzLBNq","uhHAuwy","yM9HCMq","mZbXB1PvCva","Cgf0Ag5HBwu","AxnuB29tAw1PBa","nZbpAMXcELm","zMLUzeLUzgv4","DLnnzwS","Bg9N","BfbwwLm","qMvluMi","DxbSB2fKigLTyq","DxbZzxj0","ywXPEMf0Aw9UCW","AxPHDgLVBIaTia","DhjHy2u","z2fTzv9KyxrH","B2HbEvu","zxHPC3rPBMDdBW","y3vZDg9Tq29SBW"];return(w=function(){return t})()}async function l(n,r,e,u,c,s){const w=x,l={NJUeC:function(t,n){return t(n)},kaeoT:function(t,n){return t(n)},vSMek:w(248),ofrZN:w(213)+w(325)+w(152)+"in your gallery",hupKc:w(266),pzDmp:"another co"+w(217),gKAwd:w(317)+w(352),yrpvg:function(t,n){return t!==n},doRSQ:"eMoju"};try{if("pBBUs"!==w(147)){const x=l[w(222)](o,r);if(!x[w(340)])return{data:null,error:new Error(x.error||w(239)+w(193))};const C=await l.NJUeC(a,r);if(!C.safe)return{data:null,error:new Error(C[w(210)]||w(310)+w(299)+w(332)+w(161))};const y=l[w(297)](i,c);if(!y[w(340)]){if(l[w(172)]===w(277))throw new _0x4aec99(w(290)+"upload ima"+w(282)+_0x1f72d7[w(162)]);return{data:null,error:new Error(y[w(269)]||w(312)+w(259))}}const d=await f(n,c,e[w(289)],s);if(d[w(216)+"e"]){const t=d["ownedByCur"+w(206)]?l[w(198)]:w(213)+"lization i"+w(194)+" "+(d.ownerDisplayName||w(339)+"llector");return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:d["ownedByCur"+w(206)],ownerDisplayName:d[w(195)+"ayName"],colorSimilarity:100}}if(d.isTooSimilar){if(l[w(256)]!==l.hupKc){const t=_0x144b6b.apply(_0x2ecc19,arguments);return _0xfafa85=null,t}{const t=d[w(245)+w(206)]?"You have a"+w(234)+w(191)+w(179)+w(188)+w(320)+w(148)+" for uniqueness":"This is "+Math[w(344)](d[w(296)+w(324)]||30)+(w(150)+w(268)+w(308))+(d[w(195)+"ayName"]||l[w(145)]);return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:d["ownedByCur"+w(206)],ownerDisplayName:d[w(195)+"ayName"],colorSimilarity:d[w(296)+w(324)],reason:d.reason}}}const B={...s};B[w(226)+w(219)]=d[w(226)+w(219)];const g=B,v=n+"/"+Date[w(356)]()+"-"+r[w(252)](/[^a-z0-9]/gi,"-")[w(288)+"e"]()+".png",z={};z[w(220)+"e"]=w(359),z[w(177)]=!1;const{error:D}=await t[w(291)].from(l.gKAwd).upload(v,u,z);if(D)throw new Error(w(290)+w(176)+w(282)+D[w(162)]);const{data:h}=t.storage[w(315)](w(317)+w(352))[w(281)+"rl"](v),A={};A[w(303)]=e.gameData[w(303)],A.black=e[w(289)][w(335)],A[w(164)]=e[w(289)][w(164)],A.date=e.gameData.date,A[w(146)]=e.gameData[w(146)],A.pgn=e[w(289)][w(253)],A.moves=e[w(289)][w(159)],A[w(166)]=e[w(166)],A[w(334)]=e.totalMoves,A[w(317)+w(351)]=g;const L=A,m={};m[w(257)]=n,m[w(231)]=r,m.pgn=c||null,m[w(181)]=L,m[w(223)]=h.publicUrl;const{data:q,error:p}=await t[w(315)](w(336)+"alizations")[w(154)](m)[w(353)]().single();if(p)throw await t[w(291)][w(315)]("visualizat"+w(352)).remove([v]),new Error(w(290)+"save visua"+w(273)+p[w(162)]);const b={};return b[w(347)]=q,b[w(269)]=null,b}throw new _0x5e714e(w(290)+"delete vis"+w(203)+": "+_0x1ea137[w(162)])}catch(C){if(l.yrpvg(l[w(250)],w(265))){const t={};return t[w(216)+"e"]=!1,t[w(169)+"ar"]=!0,t[w(280)]=_0x5acb18[w(272)+w(323)+w(285)],t[w(245)+w(206)]=_0x31ed71["ownedByCur"+w(206)],t[w(195)+w(338)]=_0x3d3ad9[w(195)+"ayName"],t[w(296)+"arity"]=_0x263c95[w(296)+w(324)],t[w(210)]=_0xe85bc1[w(210)],t[w(183)+w(287)]=_0xaf84cb["existingCo"+w(287)],t[w(355)+w(240)]=_0x406d6a[w(355)+w(240)],t[w(355)+w(275)]=_0x162bcd[w(355)+w(275)],t[w(255)+w(251)]=_0x320696[w(255)+w(251)],t[w(218)+"etteId"]=_0x5b31a5[w(218)+"etteId"],t[w(218)+w(319)+w(270)]=_0x1a1174[w(218)+w(319)+"rity"],t}{const t={};return t[w(347)]=null,t[w(269)]=C,t}}}function x(t,n){t-=145;const r=w();let e=r[t];if(void 0===x.MdwGds){var o=function(t){let n="",r="",e=n+o;for(let o,a,i=0,u=0;a=t.charAt(u++);~a&&(o=i%4?64*o+a:a,i++%4)?n+=e.charCodeAt(u+10)-10!=0?String.fromCharCode(255&o>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let o=0,a=n.length;o<a;o++)r+="%"+("00"+n.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(r)};x.TUNZPd=o,x.vtfUat={},x.MdwGds=!0}const a=t+r[0],i=x.vtfUat[a];if(i)e=i;else{const t=function(t){this.AFzXTb=t,this.uQENKa=[1,0,0],this.KsvBNF=function(){return"newState"},this.EoGXmW="\\w+ *\\(\\) *{\\w+ *",this.APtrJY="['|\"].+['|\"];? *}"};t.prototype.RntAWx=function(){const t=new RegExp(this.EoGXmW+this.APtrJY).test(this.KsvBNF.toString())?--this.uQENKa[1]:--this.uQENKa[0];return this.WcFXmI(t)},t.prototype.WcFXmI=function(t){return Boolean(~t)?this.QqfZjC(this.AFzXTb):t},t.prototype.QqfZjC=function(t){for(let n=0,r=this.uQENKa.length;n<r;n++)this.uQENKa.push(Math.round(Math.random())),r=this.uQENKa.length;return t(this.uQENKa[0])},new t(x).RntAWx(),e=x.TUNZPd(e),x.vtfUat[a]=e}return e}async function C(n){const r=x,e={};e[r(305)]=function(t,n){return t!==n},e[r(326)]=r(348),e.dIEzx=r(336)+r(178),e[r(242)]=r(257);const o=e;try{if(!o[r(305)](o[r(326)],r(348))){const e={};e[r(302)]=!1;const{data:a,error:i}=await t.from(o.dIEzx)[r(353)]("*").eq(o[r(242)],n).order("created_at",e);if(i)throw new Error("Failed to "+r(333)+"alizations: "+i[r(162)]);const u={};return u.data=a||[],u[r(269)]=null,u}{const t=_0x15fb0d.constructor[r(263)][r(157)](_0x4bac2c),n=_0x30057a[_0xd35d6c],e=_0x5485d8[n]||t;t[r(345)]=_0x3e08b5[r(157)](_0x548b79),t[r(307)]=e[r(307)][r(157)](e),_0x39ecb6[n]=t}}catch(a){const t={};return t[r(347)]=[],t.error=a,t}}async function y(n,r){const e=x,o={};o.TbOAi=e(165);const a=o;try{const o=new URL(r)[e(168)][e(160)]("/"),i=o[e(171)](t=>"visualizations"===t),u=o[e(233)](i+1)[e(354)]("/");u&&await t.storage[e(315)](e(317)+e(352))[e(311)]([u]);const{error:c}=await t[e(315)]("saved_visu"+e(178))[e(304)]().eq("id",n);if(c){if(a.TbOAi===a[e(187)])throw new Error("Failed to delete vis"+e(203)+": "+c[e(162)]);if(_0x3632ea){const t=_0x10ecd0[e(260)](_0x1f7e9e,arguments);return _0x201ee8=null,t}}const s={};return s[e(269)]=null,s}catch(i){if(e(225)==e(225)){const t={};return t[e(269)]=i,t}if(_0x3d9d67){const t=_0x5780e8[e(260)](_0x58ab98,arguments);return _0x2dbb06=null,t}}}c(void 0,function(){const t=x,n={};n[t(346)]="modern",n[t(192)]=t(237),n.pboxB="return (fu"+t(215),n[t(182)]=t(156),n[t(228)]=t(295),n[t(361)]=t(322),n.VSOSt=t(269),n.uOYZN=t(279),n[t(232)]=t(180);const r=n,e=function(){const n=t,e={};e[n(264)]=r[n(346)],e[n(258)]=r[n(192)];const o=e;let a;try{a=Function(r[n(294)]+(n(306)+n(342)+n(261)+" ));"))()}catch(i){if(r[n(182)]===n(318)){return(_0x44ebc6||_0x3de023[n(253)]||"")[n(350)]()[n(252)](/\s+/g," ")+"::"+(_0x3f7887?_0x3c9668[n(209)]({palette:_0x389464.paletteId||o[n(264)],darkMode:_0x5de615[n(246)]||!1,currentMove:_0x4a02a7[n(205)+"e"]===_0x32a497?o[n(258)]:_0x25ec5c[n(205)+"e"],lockedPieces:(_0x1d92a0[n(214)+"es"]||[])[n(276)]((t,r)=>(t[n(274)]+"-"+t[n(229)])["localeComp"+n(153)](r.pieceColor+"-"+r.pieceType))}):"{}")}a=window}return a}(),o=e[t(186)]=e.console||{},a=[t(173),r[t(228)],r[t(361)],r.VSOSt,"exception",r[t(224)],r.zmGcu];for(let i=0;i<a[t(208)];i++){const n=c[t(199)+"r"][t(263)][t(157)](c),r=a[i],e=o[r]||n;n.__proto__=c.bind(c),n[t(307)]=e.toString.bind(e),o[r]=n}})();export{f as checkDuplicateVisualization,y as deleteVisualization,C as getUserVisualizations,l as saveVisualization};
