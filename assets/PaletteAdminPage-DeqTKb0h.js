import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as m,P as h,w as f,B as p,bM as v,cj as j,a9 as w,am as g,a1 as y,a2 as N,a3 as b,a4 as z,bC as C,a5 as B,cu as q,b as k}from"./index-C3fhkH_G.js";!function(){const e=M,s=D();for(;;)try{if(979443===-parseInt(e(120))/1+-parseInt(e(192))/2+parseInt(e(135))/3+parseInt(e(202))/4*(-parseInt(e(176))/5)+parseInt(e(155))/6*(parseInt(e(187))/7)+-parseInt(e(195))/8*(-parseInt(e(146))/9)+-parseInt(e(140))/10*(parseInt(e(199))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const S=function(){const e=M,s={};s[e(165)]="UwrnH";const t=s;let n=!0;return function(s,a){const r=e;if(r(183)===t[r(165)]){const e=n?function(){if(a){const e=a[r(190)](s,arguments);return a=null,e}}:function(){};return n=!1,e}{const e=_0x4ec57e[r(153)]["visualizat"+r(156)];((null==e?void 0:e[r(186)])===_0x3e660a||(null==e?void 0:e["linkedPale"+r(150)])===_0x4d2e69)&&_0x89abac++}}}()(void 0,function(){const e=M,s={};s[e(129)]="(((.+)+)+)+$";const t=s;return S[e(130)]().search(e(189)+"+$")[e(130)]()[e(145)+"r"](S)[e(175)](t[e(129)])});S();const P=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[M(190)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();function D(){const e=["mteWCLDbv3bb","Aw5MBW","wxngCMq","A2LUzYbHzg1PBG","wMzUzNq","y29UC3rYDwn0BW","ouXls01gAa","ywrTAw4","Aw5Zzxj0","CNbJ","DhrLswq","zxHJzxb0Aw9U","E30Uy29UC3rYDq","z2fTzv9KyxrH","rxjYB3iGy291BG","mZeYnZaYBuLztKfh","Aw9Uu3rHDgu","su93BfG","D2HPDgvFy29SBW","B29VEKK","ywnXB2i","EefcBLy","ihjVBgu6","zgvSzxrL","y29Kzq","y1LUvha","rvfos1q","Ae5hq2q","txHMuKC","y29UC29Szq","we9ZuKS","DgfIBgu","x19WCM90B19F","tKfysvu","rxjYB3iGy2HLyW","C2vHCMnO","mZeWExfSBxPt","ALHUEMe","zg1PBIbJAgvJAW","yMrjAKG","AwqSigDHBwvFza","CM4GDgHPCYiPka","CgfSzxr0zv9Pza","vxDYBKG","zxjYAwrLCW","CNjUvLq","CgfSzxr0zuLK","mJfvvMnhCwu","Bw9KAwzPzwrFyG","kcGOlISPkYKRkq","yxbWBhK","vuPJDee","ntyZmtqYyNfIru1g","DMvYC2LVBG","yMLUza","mti4nJuXmtjUsvnSuMC","zMLUza","C2vSzwn0","DxbKyxrL","mtqYodeZweTMrKPj","EurRzem","BMn0Aw9UkcKG","nJCXntzXwKPgtMG","v3v3qwK","x3vZzxjFAwq","wgzREK8","BgLUA2vKugfSzq","y3rVCIGICMv0Dq","zgf0yq","zcb2Axn1ywXPEG","wKXYA3u","BgvUz3rO","Bvburgu","mte4ndG0ohr4DevSzq","ueDsu1qXmty","shzqqNC","yxrPB25ZoG","Cxr2sLK","yMXHy2TFy29SBW","C2LUz2XL","D2HPDgu","x3jVBgu","uePrEe0","Dg9tDhjPBMC","D2fYBG","zNjVBq","zxjYB3i","CgfSzxr0zv9VDG","ntu5ntmWoxPXELf1zq","CMv0DxjUicHMDq","ChjVDg90ExbL","DhjHy2u","yMXHy2S"];return(D=function(){return e})()}async function L(s){const t=M,n={};n[t(200)]=t(182),n.jXnza=function(e,s){return e!==s};const a=n;try{const{data:n,error:r}=await e[t(132)](t(134)+"errides")[t(197)]("*").eq(a[t(200)],s)[t(126)]();if(r&&a[t(177)](r[t(164)],t(121)))throw r;const i={};return i.data=n,i[t(133)]=null,i}catch(r){if("ydoRn"===t(191)){const e={};return e[t(133)]=_0x396598,e[t(193)]=0,e}{const e={};return e[t(115)]=null,e[t(133)]=r,e}}}function M(e,s){e-=113;const t=D();let n=t[e];if(void 0===M.HpqAVM){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};M.YTmotL=a,M.BqUETH={},M.HpqAVM=!0}const r=e+t[0],i=M.BqUETH[r];if(i)n=i;else{const e=function(e){this.hVLLVi=e,this.obGpdV=[1,0,0],this.tUFHjN=function(){return"newState"},this.PtnJpT="\\w+ *\\(\\) *{\\w+ *",this.ngTJly="['|\"].+['|\"];? *}"};e.prototype.WRaUQj=function(){const e=new RegExp(this.PtnJpT+this.ngTJly).test(this.tUFHjN.toString())?--this.obGpdV[1]:--this.obGpdV[0];return this.zSMqrd(e)},e.prototype.zSMqrd=function(e){return Boolean(~e)?this.ZfZevS(this.hVLLVi):e},e.prototype.ZfZevS=function(e){for(let s=0,t=this.obGpdV.length;s<t;s++)this.obGpdV.push(Math.round(Math.random())),t=this.obGpdV.length;return e(this.obGpdV[0])},new e(M).WRaUQj(),n=M.YTmotL(n),M.BqUETH[r]=n}return n}async function U(s){const t=M,n={};n.HvPBw=t(136)+t(201),n[t(161)]=t(152)+t(114)+t(181)+" )",n.ooslm="saved_visualizations",n[t(203)]=function(e,s){return e===s},n[t(157)]=t(185),n[t(173)]=t(154)+"ting linke"+t(116)+t(123);const a=n;try{const{data:n,error:r}=await e[t(132)](a.ooslm)[t(197)](t(180)+"ata");if(r)throw r;let i=0;for(const e of n||[]){const n=e[t(153)]["visualizat"+t(156)];((null==n?void 0:n.paletteId)===s||(null==n?void 0:n[t(113)+t(150)])===s)&&i++}return i}catch(r){if(a[t(203)](a[t(157)],"rrnVT"))return 0;_0x2a457c=_0x2e0f7f(fLIKYS[t(122)]+fLIKYS.xABnV+");")()}}P(void 0,function(){const e=M,s={mPTDe:function(e,s){return e(s)},ZLrku:function(e,s){return e+s},YBOmc:e(152)+e(114)+e(181)+" )",DyRWB:"log",disDF:e(131),qtvJY:e(141),YsFrd:e(138),ooozI:function(e,s){return e<s}},t=function(){const t=e;let n;try{n=s[t(119)](Function,s[t(117)](t(136)+t(201),s.YBOmc)+");")()}catch(a){n=window}return n}(),n=t[e(169)]=t.console||{},a=[s.DyRWB,s.disDF,s[e(124)],e(133),e(151),e(171),s[e(142)]];for(let r=0;s[e(159)](r,a[e(118)]);r++){const s=P[e(145)+"r"][e(137)][e(194)](P),t=a[r],i=n[t]||s;s[e(172)]=P[e(194)](P),s[e(130)]=i[e(130)].bind(i),n[t]=s}})();const A=["k","q","r","b","n","p"],H={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},K=()=>{var S,P,D,K;const{user:G}=s(),Y=t(),[V,I]=n.useState(!1),[_,T]=n.useState(!0),[E,W]=n.useState([]),[X,Z]=n.useState(null),[F,J]=n.useState(null),[R,O]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!G)return void Y("/");if(!(await async function(s){const t=M,n={};n[t(205)]=t(147),n[t(166)]=t(174)+t(143)+t(162),n[t(160)]="Error in a"+t(178)+":";const a=n;try{const n={};n[t(204)]=s,n[t(128)]=a.XfkzO;const{data:r,error:i}=await e[t(149)]("has_role",n);return!i&&!0===r}catch(r){return!1}}(G.id)))return k.error("Access denied",{description:"Admin privileges required"}),void Y("/");I(!0),await te(),T(!1)})()},[G,Y]);const te=async()=>{const{data:s}=await async function(){const s=M,t={};t[s(168)]=function(e,s){return e!==s},t[s(144)]="palette_overrides";const n=t;try{if(n[s(168)]("bdIjH",s(179))){const e=_0xa0487f?function(){if(_0x5c11e9){const e=_0x52c859[s(190)](_0xef93fe,arguments);return _0x1b9b98=null,e}}:function(){};return _0x46d590=!1,e}{const{data:t,error:a}=await e[s(132)](n[s(144)]).select("*").order(s(182));if(a)throw a;const r={};return r[s(115)]=t||[],r.error=null,r}}catch(a){const e={};return e[s(115)]=[],e[s(133)]=a,e}}();W(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await U(e.id);O(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=E.find(s=>s.palette_id===e);Z(e),J({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{F&&J({...F,[e]:{...F[e],[s]:t}})},re=async()=>{if(!X||!F||!G)return;Q(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,a){const r=M,i={THXpf:function(e,s){return e(s)},hNGCd:"palette_id"};try{const{data:c}=await i.THXpf(L,s);if(c){const o={};o[r(158)+"rs"]=t,o[r(125)+"rs"]=n,o[r(188)+"y"]=a,o[r(193)]=c.version+1;const{error:l}=await e[r(132)](r(134)+r(184))[r(198)](o).eq(i[r(167)],s);if(l)throw l;const d={};return d[r(133)]=null,d[r(193)]=c.version+1,d}{const i={};i[r(182)]=s,i[r(158)+"rs"]=t,i[r(125)+"rs"]=n,i.modified_by=a,i[r(193)]=1;const{error:c}=await e[r(132)](r(134)+r(184))[r(148)](i);if(c)throw c;const o={};return o[r(133)]=null,o[r(193)]=1,o}}catch(c){const e={};return e[r(133)]=c,e.version=0,e}}(X,F.white,F.black,G.id);s?k.error("Failed to save",{description:s.message}):(k.success("Palette updated!",{description:`Version ${t} saved. ${R[X]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>E.some(s=>s.palette_id===e);return _?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):V?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(X===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(l,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),R[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),R[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[A.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),A.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:X&&F?a.jsxs(o,{children:[a.jsx(x,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(m,{className:"flex items-center gap-2",children:[a.jsx(h,{className:"h-5 w-5"}),null==(S=ie(X))?void 0:S.name]}),a.jsx(f,{children:null==(P=ie(X))?void 0:P.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(X)&&a.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!X)return;Q(!0);const{error:s}=await async function(s){const t=M,n={};n[t(170)]=t(134)+t(184),n.ZuqJm=t(182);const a=n;try{const{error:n}=await e[t(132)](a.XOsRK)[t(163)]().eq(a.ZuqJm,s);if(n)throw n;const r={};return r[t(133)]=null,r}catch(r){const e={};return e.error=r,e}}(X);s?k.error("Failed to revert",{description:s.message}):(k.success("Reverted to defaults"),ne(X),await te()),Q(!1)},disabled:$,children:[a.jsx(v,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(p,{size:"sm",onClick:async()=>{if(!X||!F||!G)return;(R[X]||0)>0?se(!0):await re()},disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(j,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(l,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(D=ie(X))?void 0:D.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:A.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:H[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(w,{type:"color",value:F.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(w,{type:"text",value:F.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(K=ie(X))?void 0:K.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:A.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:H[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(w,{type:"color",value:F.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(w,{type:"text",value:F.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:A.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:F.white[e]},title:H[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:A.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:F.black[e]},title:H[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(o,{className:"h-full flex items-center justify-center",children:a.jsxs(l,{className:"text-center py-12",children:[a.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(b,{children:[a.jsxs(z,{className:"flex items-center gap-2",children:[a.jsx(C,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(B,{children:["This palette is linked to ",a.jsx("strong",{children:R[X||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(p,{onClick:re,disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(q,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{K as default};
