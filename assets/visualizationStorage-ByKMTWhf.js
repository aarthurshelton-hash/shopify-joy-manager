import{s as t,ca as n,dG as r,dH as e}from"./index-Hr12Z3Gc.js";import{v as o,a as i,b as a}from"./visualizationSchemas-Duuxjig0.js";import"./flagContent-gAerRtHQ.js";function s(){const t=["Bw92zxm","rxHHy3qGzhvWBa","zvrMs28","vefntey","zgf0yq","C2vHCMnO","vMDMzuq","sw52ywXPzcb0Aq","zgLZCgXHEv9Uyq","y1bHBgv0Dgu","ELHlDMO","BMn0Aw9UkcKG","Dg90ywXnB3zLCW","CMvTB3zL","Aw4GEw91CIbNyq","vgL0BguGy29UDa","BgLUA2vKugfSzq","y1LsDfK","yM9HCMq","qw5VDgHLCIbJBW","Eenswfi","C2f2zwrFDMLZDq","EKL1s28","y3vZDg9Tq29SBW","AxnjBNrYAw5ZAq","Bwf0y2HLzfbHBa","ENLOr3G","DwfSAxPHDgLVBG","C3rYAw5NAwz5","uLnRA00","zxHJzxb0Aw9U","CgLLy2vuExbL","zK9bDwu","tKPKugG","Dca4ignVBg9YCW","C2LUz2XL","DwTQB3y","Dw5K","Aw1Hz2vFCgf0Aa","yxbWBhK","mJbJuKzdEK0","u0nbCfy","DhrLswq","C3rVCMfNzq","y29Kzq","ru9iCMq","CgDU","sw52ywXPzcbqrW","zNjVBq","B3jKzxi","vurQv2K","CM4GDgHPCYiPka","wLDHu1C","Bg9N","rfDcBgO","ntu4nJCXm2Xctu9HzW","sLjhCeS","D2HPDgu","zMv0y2GGDMLZDq","yMLUza","C2f2zsb2Axn1yq","DxbZzxj0","vgHPCYbPCYa","mtuXmJa4ohHtEgvkuG","AM9PBG","y0DHBwu","ywLUCYbPBMfWCa","z3vwsM4","mtyYuvLjueTi","yxLoyw1L","BgvUz3rO","ChjVzMLSzxm","zxzLBNq","C2vSzwn0","z2u6ia","zxHPC3rPBMDjza","yxjPDhK","AMjJsKS","rhfTD2G","Aw1Hz2uVCg5N","BgfYihzPC3vHBa","vMLZDwfSAxPHDa","DxnLCL9Pza","mZr5qMLiwhi","vwnRDfC","yxnJzw5KAw5N","ChvIBgLJvxjS","CgLlvMG","tffswhu","sunwDg8","C2HHCum","C3vJy2vZCW","Bg9YCW","C3vHBgL6yxrPBW","kcGOlISPkYKRkq","rNvUtwy","ywXPEMf0Aw9UCW","y3rVCIGICMv0Dq","Aw9UCW","zgfYA01Vzgu","DhjPBq","yxjL","BgL6yxrPB246ia","vgHPCYb2Axn1yq","tev4Afy","igzVCIb1BMLXDq","DufKt1i","y2f0zxm6","ihzLCNKGC2LTAq","Aerwzgi","CMvZDwX0","y29UC3rYDwn0BW","yM15AeK","Cgf0Ag5HBwu","vK1bwfC","oda3mZHiCe9bC1C","ntC4mdaXnMDUy0XYuW","rxjYB3iGAw4Gza","zgf0zq","t0nvEhG","z2v0uhvIBgLJvq","CM91BMq","zunHCMq","B1fczvi","Dg9tDhjPBMC","CgfSzxr0zuLK","zxjYB3i","y3jLyxrLzf9HDa","AxPHDgLVBIaTia","ywXPEMf0Aw9UoG","CvbrChi","C29YDa","A2LUzYbKDxbSAq","BgXLy3rVCG","A2fdyuG","ELr4rg0","D2fYBG","CMv0DxjUicHMDq","BwvFzgf0yq","rxjYB3iGy2HLyW","CMvUDfvZzxi","uxLsBuy","lNbUzW","BwvZC2fNzq","vvjYwfC","E30Uy29UC3rYDq","DxbSAwnHDguGyW","zxr0zuLK","Bwf0y2HLzeDHBq","AxneDxbSAwnHDa","tencq24","mZKZnJu2ugTqug92","z014B3m","Aw5MBW","CM9WCMLHDguGyW","y29UC29Szq","CML0Eq","AwqSihvZzxjFAq","qwztsK8","y3vZDg9T","B3DUzwrcEun1CG","DhjHy2u","CgLLy2vdB2XVCG","zxHPC3rPBMDwAq","nKLqve9kwq","CMvHC29U","zxr0zvnPBwLSyq","nJm1nJv2vKPJCKS","AxnuB29tAw1PBa","BeT1yxi","Dhj5ignOyw5NAq","B3DUzxjeAxnWBa","yw5VDgHLCIbJBW","thbhAuW","BgL6yxrPB24GAq","zgvSzxrLihzPCW","DxbSB2fKigLTyq","z2fTzv9KyxrH","mte1mdqZnJrZAxneA3G","sej1B3u","DMLZDwfSAxPHDa","y3vYCMvUDe1VDG","mZvdt1Djtvi","u1njufa","CYbHBhjLywr5ia","AgTuAMe","DgL0Bgu","Bg9JywXLq29TCa","ww91igHHDMuGyq","C2fMzq","zgvSzxrL","BM93","BNfiBuC","y3zrD3a","Aw9Uig5VDcbMBW","yMXHy2S","z2fTzurHDge","EMjlEK4","zMLUza","zxHPC3rPBMDdBW","teTUCKm","B250zw50","rMfPBgvKihrVia","CMvWBgfJzq","ChjVDg90ExbL","Aw9Uu3rHDgu","rLnvtM8","AgvJAZO","DgfIBgu","y29SB3jtAw1PBa","sKHKEvu"];return(s=function(){return t})()}!function(){const t=f,n=s();for(;;)try{if(699135===parseInt(t(341))/1*(parseInt(t(373))/2)+-parseInt(t(422))/3*(-parseInt(t(532))/4)+-parseInt(t(425))/5*(parseInt(t(537))/6)+parseInt(t(440))/7*(parseInt(t(409))/8)+parseInt(t(374))/9+parseInt(t(509))/10*(-parseInt(t(524))/11)+-parseInt(t(436))/12)break;n.push(n.shift())}catch(r){n.push(n.shift())}}();const u=function(){const t=f,n={};n[t(431)]=t(521);const r=n;let e=!0;return function(n,o){const i=t,a={guVJn:function(t,n){return t!==n}};a[i(388)]=r[i(431)];const s=a,u=e?function(){const t=i;if(o){if(!s[t(536)](s[t(388)],s.qPQpr)){const t=o.apply(n,arguments);return o=null,t}{const n={};n.white=_0x1658b2[t(526)],n[t(453)]=_0x124260.black,_0x31c7a6=n}}}:function(){};return e=!1,u}}()(void 0,function(){const t=f,n={};n[t(392)]=t(352)+"+$";const r=n;return u[t(382)]().search(r[t(392)])[t(382)]()[t(369)+"r"](u).search(t(352)+"+$")});u();const c=function(){let t=!0;return function(n,r){const e=t?function(){if(r){const t=r[f(508)](n,arguments);return r=null,t}}:function(){};return t=!1,e}}();function f(t,n){t-=327;const r=s();let e=r[t];if(void 0===f.UFEvEg){var o=function(t){let n="",r="",e=n+o;for(let o,i,a=0,s=0;i=t.charAt(s++);~i&&(o=a%4?64*o+i:i,a++%4)?n+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=n.length;o<i;o++)r+="%"+("00"+n.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(r)};f.hhbBsu=o,f.csZsSH={},f.UFEvEg=!0}const i=t+r[0],a=f.csZsSH[i];if(a)e=a;else{const t=function(t){this.hZayUv=t,this.okaeGS=[1,0,0],this.mARZVc=function(){return"newState"},this.EtsGqT="\\w+ *\\(\\) *{\\w+ *",this.JMaWJa="['|\"].+['|\"];? *}"};t.prototype.sgUfkd=function(){const t=new RegExp(this.EtsGqT+this.JMaWJa).test(this.mARZVc.toString())?--this.okaeGS[1]:--this.okaeGS[0];return this.SXNNpT(t)},t.prototype.SXNNpT=function(t){return Boolean(~t)?this.BtZlez(this.hZayUv):t},t.prototype.BtZlez=function(t){for(let n=0,r=this.okaeGS.length;n<r;n++)this.okaeGS.push(Math.round(Math.random())),r=this.okaeGS.length;return t(this.okaeGS[0])},new t(f).sgUfkd(),e=f.hhbBsu(e),f.csZsSH[i]=e}return e}function w(t,n,r){const e=f,o={uAdOR:"modern"};o[e(491)]="all";const i=o;return(t||n[e(515)]||"")[e(358)]()[e(461)](/\s+/g," ")+"::"+(r?JSON[e(497)]({palette:r[e(383)]||i[e(364)],darkMode:r[e(357)]||!1,currentMove:r.currentMove===1/0?i[e(491)]:r[e(439)+"e"],lockedPieces:(r.lockedPieces||[])[e(389)]((t,n)=>(t[e(420)]+"-"+t[e(500)])[e(445)+e(359)](n.pieceColor+"-"+n[e(500)]))}):"{}")}async function l(o,i,a,s){const u=f,c={FunMf:function(t,n){return t(n)},AfSJO:function(t,n){return t+n},zgtko:function(t,n,r,e){return t(n,r,e)},shaqC:u(415)+"d, pgn, ga"+u(396),zyhGx:u(397)+u(390)+u(365),Dqmwh:function(t,n){return t===n},LExhV:u(519),jbcJK:function(t,n){return t===n},UcktW:u(329),SOoxC:u(488)+"llector",OCUxx:u(470)+"icate exists",zTxDm:function(t,n,r,e,o,i){return t(n,r,e,o,i)},JHdyU:u(375)+u(404)+u(465)};try{{const f=c.zgtko(w,i,a,s),{data:l,error:C}=await t[u(517)](u(490)+"alizations").select(c[u(348)]);if(C){const t={};return t[u(407)+"e"]=!1,t.isTooSimilar=!1,t}for(const n of l||[]){if(!c[u(336)](c[u(362)],c[u(362)]))throw new _0x4acd97(u(460)+u(527)+u(354)+": "+_0xaab672[u(401)]);{const r=n.game_data;if(f===w(n[u(515)]||void 0,r,r.visualizationState)){const r=c[u(336)](n[u(340)],o);let e;if(!r){if(c[u(335)](u(464),u(451)))throw new _0x46fac4(u(460)+u(433)+u(496)+": "+_0x30c651[u(401)]);{const{data:r}=await t[u(517)](c[u(342)]).select("display_name").eq("user_id",n[u(340)])[u(504)]();e=(null==r?void 0:r[u(477)+"me"])||c.SOoxC}}const i={isDuplicate:!0};return i[u(426)+"ar"]=!0,i[u(333)]=n.id,i[u(418)+"rentUser"]=r,i[u(429)+u(327)]=e,i[u(467)+u(334)]=100,i[u(423)]=c[u(377)],i}}}const y=(null==s?void 0:s[u(383)])||"modern";let z;if(null==s?void 0:s[u(492)+"rs"])z=s[u(492)+"rs"];else if(y===u(417)){const t=n[u(456)](t=>t.id===u(417));if(t){const n={};n.white=t[u(526)],n[u(453)]=t[u(453)],z=n}}const h=await c[u(393)](r,o,i,a,y,z);if(h[u(426)+"ar"]){const t={};return t[u(407)+"e"]=!1,t[u(426)+"ar"]=!0,t.existingId=h[u(421)+u(351)+"nId"],t[u(418)+u(398)]=h[u(418)+u(398)],t[u(429)+"ayName"]=h["ownerDispl"+u(327)],t[u(467)+"arity"]=h["colorSimil"+u(334)],t[u(423)]=h[u(423)],t[u(457)+u(350)]=h[u(457)+u(350)],t[u(493)+u(478)]=h[u(493)+u(478)],t["isIntrinsi"+u(534)]=h[u(493)+u(534)],t[u(406)+"eCard"]=h[u(406)+u(380)],t["matchedPal"+u(405)]=h[u(494)+u(405)],t[u(494)+u(424)+u(414)]=h["matchedPal"+u(424)+u(414)],t}let g;z&&(g=c[u(353)](e,z)||void 0);const D={isDuplicate:!1,isTooSimilar:!1};return D[u(485)+u(511)]=g,D[u(467)+u(334)]=h["colorSimil"+u(334)],D.isIntrinsicPalette=h[u(493)+"cPalette"],D[u(493)+"cGame"]=h[u(493)+"cGame"],D[u(406)+u(380)]=h["matchedGam"+u(380)],D[u(494)+u(405)]=h[u(494)+u(405)],D["matchedPal"+u(424)+u(414)]=h[u(494)+u(424)+"rity"],D}}catch(l){const t={};return t[u(407)+"e"]=!1,t[u(426)+"ar"]=!1,t}}async function C(n,r,e,s,u,c){const w=f,C={LQRXu:function(t,n){return t(n)},hDVdb:function(t,n){return t+n},jqJOo:w(395)+"nction() ",eTfKo:w(403)+'ctor("retu'+w(520)+" )",TAMLF:function(t,n){return t===n},fOAue:"PGRST116",VgfeD:w(339)+w(452)+w(506),xCRXR:w(514),zbKzN:function(t,n,r,e,o){return t(n,r,e,o)},RSkkM:w(438)+w(356),JRGpK:w(490)+"alizations"};try{if(C[w(472)](w(514),C[w(489)])){const f=o(r);if(!f[w(349)])return{data:null,error:new Error(f[w(384)]||w(476)+"tle")};const y=await C[w(346)](i,r);if(!y[w(447)])return{data:null,error:new Error(y[w(423)]||w(484)+w(535)+w(412)+w(459))};const z=a(u);if(!z[w(349)])return{data:null,error:new Error(z[w(384)]||w(516)+"N data")};const h=await C[w(455)](l,n,u,e[w(454)],c);if(h[w(407)+"e"]){const t=h.ownedByCurrentUser?w(361)+w(432)+w(442)+w(483)+"llery":"This visua"+w(432)+"s owned by "+(h[w(429)+w(327)]||w(430)+w(391));return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:h[w(418)+"rentUser"],ownerDisplayName:h[w(429)+w(327)],colorSimilarity:100}}if(h[w(426)+"ar"]){if(w(443)!==w(441)){const t=h[w(418)+w(398)]?w(446)+w(366)+w(338)+w(386)+w(428)+"ng at leas"+w(503)+w(363)+"eness":w(531)+Math[w(379)](h[w(467)+"arity"]||30)+"% similar to a vision by "+(h["ownerDispl"+w(327)]||w(430)+w(391));return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:h[w(418)+w(398)],ownerDisplayName:h[w(429)+w(327)],colorSimilarity:h[w(467)+"arity"],reason:h.reason}}_0x598feb=xhTKwh.LQRXu(_0x2fde84,xhTKwh[w(367)](xhTKwh.jqJOo+xhTKwh[w(471)],");"))()}const g={...c};g["linkedPale"+w(511)]=h[w(485)+w(511)];const D=g,v=n+"/"+Date[w(449)]()+"-"+r[w(461)](/[^a-z0-9]/gi,"-").toLowerCase()+w(400),B={};B.contentType=w(337),B[w(530)]=!1;const{error:x}=await t[w(512)][w(517)]("visualizat"+w(356)).upload(v,s,B);if(x)throw new Error("Failed to "+w(434)+w(332)+x.message);const{data:d}=t[w(512)][w(517)](C[w(498)])[w(378)+"rl"](v),L={};L[w(526)]=e[w(454)][w(526)],L.black=e[w(454)][w(453)],L.event=e[w(454)][w(330)],L[w(376)]=e[w(454)][w(376)],L.result=e.gameData[w(368)],L[w(515)]=e.gameData.pgn,L[w(469)]=e[w(454)][w(469)],L[w(487)]=e[w(487)],L[w(481)]=e[w(481)],L["visualizat"+w(463)]=D;const M=L,A={};A[w(340)]=n,A[w(444)]=r,A[w(515)]=u||null,A[w(435)]=M,A[w(507)]=d[w(344)];const{data:q,error:m}=await t.from(C[w(525)]).insert(A).select()[w(504)]();if(m)throw await t.storage[w(517)](C[w(498)])[w(482)]([v]),new Error("Failed to "+w(529)+w(360)+m[w(401)]);const H={};return H[w(473)]=q,H.error=null,H}if(C[w(472)](_0x401f37.code,C[w(501)]))return{data:null,error:new _0x438ac8(C[w(475)])};throw new _0x1d7213(w(460)+w(527)+"alization: "+_0x29773b[w(401)])}catch(y){const t={data:null};return t[w(384)]=y,t}}async function y(n){const r=f,e={};e[r(450)]=function(t,n){return t===n},e[r(408)]="QcFSG",e[r(486)]=r(385);const o=e;try{if(o[r(450)](o[r(408)],r(372))){const t={};return t[r(473)]=null,t[r(384)]=_0x529dec,t}{const e={};e[r(343)]=!1;const{data:i,error:a}=await t[r(517)](r(490)+r(354))[r(331)]("*").eq(r(340),n)[r(518)](o[r(486)],e);if(a)throw new Error(r(460)+r(527)+r(354)+": "+a.message);const s={};return s.data=i||[],s[r(384)]=null,s}}catch(i){const t={};return t[r(473)]=[],t[r(384)]=i,t}}async function z(n,r){const e=f,o={};o[e(381)]="visualizat"+e(356),o[e(345)]=e(490)+e(354);const i=o;try{const o=new URL(r)[e(371)].split("/"),a=o.findIndex(t=>t==="visualizat"+e(356)),s=o.slice(a+1)[e(533)]("/");s&&await t[e(512)][e(517)](i[e(381)])[e(482)]([s]);const{error:u}=await t[e(517)](i[e(345)])[e(448)]().eq("id",n);if(u)throw new Error("Failed to delete vis"+e(496)+": "+u.message);const c={};return c[e(384)]=null,c}catch(a){const t={};return t.error=a,t}}c(void 0,function(){const t=f,n={lKuar:"bmyhI",QyRmF:function(t,n){return t(n)},FOJYl:function(t,n){return t+n},DWBlj:"(((.+)+)+)+$",ukjov:function(t){return t()},HBuou:t(522),URrXW:t(411),SCApV:t(384),LKnrC:t(499),ZwUXh:t(466),hDKYR:t(419),ICVto:function(t,n){return t<n},zXKvj:function(t,n){return t!==n}},r=n[t(505)](function(){const r=t;let e;try{if(n[r(427)]!==r(370)){_0x49d9f0[r(384)]("Error chec"+r(390)+r(365),_0x3e141d);const t={};return t[r(407)+"e"]=!1,t[r(426)+"ar"]=!1,t}e=n[r(399)](Function,n.FOJYl(r(395)+r(480)+(r(403)+r(355)+r(520)+" )"),");"))()}catch(o){e=window}return e}),e=r[t(413)]=r.console||{},o=[n[t(437)],t(394),n[t(402)],n[t(510)],n[t(458)],n.ZwUXh,n.hDKYR];for(let i=0;n[t(347)](i,o[t(328)]);i++){if(n[t(479)](t(502),t(502)))return _0x4ed8a2[t(382)]()[t(474)](n[t(523)])[t(382)]()[t(369)+"r"](_0x2e6730).search(t(352)+"+$");{const n=c[t(369)+"r"][t(462)][t(528)](c),r=o[i],a=e[r]||n;n.__proto__=c[t(528)](c),n[t(382)]=a[t(382)][t(528)](a),e[r]=n}}})();export{l as checkDuplicateVisualization,z as deleteVisualization,y as getUserVisualizations,C as saveVisualization};
