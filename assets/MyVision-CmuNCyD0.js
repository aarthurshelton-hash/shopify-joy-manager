const n='import React, { useEffect, useState, useCallback } from \'react\';\nimport { useNavigate } from \'react-router-dom\';\nimport { useAuth } from \'@/hooks/useAuth\';\nimport { getUserVisualizations, deleteVisualization, SavedVisualization } from \'@/lib/visualizations/visualizationStorage\';\nimport { migrateUserVisualizations } from \'@/lib/visualizations/migrateVisualization\';\nimport { batchCheckVisualizationsListed } from \'@/lib/marketplace/marketplaceApi\';\nimport { validatePremiumDownload } from \'@/lib/premium/validatePremiumDownload\';\nimport { useMyVisionRealtime } from \'@/hooks/useMarketplaceRealtime\';\nimport { Button } from \'@/components/ui/button\';\nimport { Card, CardContent } from \'@/components/ui/card\';\nimport { \n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \'@/components/ui/alert-dialog\';\nimport { Skeleton } from \'@/components/ui/skeleton\';\nimport { Badge } from \'@/components/ui/badge\';\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from \'@/components/ui/tabs\';\nimport { Crown, Trash2, Download, Image as ImageIcon, Loader2, Link2, ExternalLink, Sparkles, Printer, RefreshCw, ShoppingBag, Tag, Settings, Globe, Lock } from \'lucide-react\';\nimport { toast } from \'sonner\';\nimport { OrderPrintButton } from \'@/components/shop/OrderPrintButton\';\nimport { VisionaryMembershipCard, SubscriptionManagement } from \'@/components/premium\';\nimport AuthModal from \'@/components/auth/AuthModal\';\nimport ListForSaleModal from \'@/components/marketplace/ListForSaleModal\';\nimport { Header } from \'@/components/shop/Header\';\nimport { Footer } from \'@/components/shop/Footer\';\nimport { usePrintOrderStore } from \'@/stores/printOrderStore\';\nimport { useSessionStore } from \'@/stores/sessionStore\';\nimport { PortfolioRoyaltySummary } from \'@/components/vision/PortfolioRoyaltySummary\';\nimport HoldingsValueDashboard from \'@/components/vision/HoldingsValueDashboard\';\nimport { GracePeriodBanner } from \'@/components/notifications/GracePeriodBanner\';\nimport PrivacyToggle from \'@/components/vision/PrivacyToggle\';\nimport { generateGameHash, buildCanonicalShareUrl } from \'@/lib/visualizations/gameCanonical\';\nimport { VisionFloorPrice } from \'@/components/nfts/VisionFloorPrice\';\nimport { useVisionNFT } from \'@/hooks/useVisionNFT\';\nimport type { VisionNFT } from \'@/lib/nfts/visionNftApi\';\n\n// VisionCard component for gallery items - MOBILE OPTIMIZED with touch-friendly actions\ninterface VisionCardProps {\n  viz: SavedVisualization;\n  listedIds: Set<string>;\n  isDownloading: string | null;\n  onNavigate: () => void;\n  onDownload: () => void;\n  onPrint: () => void;\n  onSell: () => void;\n  onDelete: () => void;\n  onCopyLink: () => void;\n  onViewPublic: () => void;\n  isPrivate?: boolean;\n}\n\nconst VisionCard: React.FC<VisionCardProps> = ({\n  viz,\n  listedIds,\n  isDownloading,\n  onNavigate,\n  onDownload,\n  onPrint,\n  onSell,\n  onDelete,\n  onCopyLink,\n  onViewPublic,\n  isPrivate,\n}) => {\n  const [showActions, setShowActions] = useState(false);\n  const { visionNFT, isLoading: nftLoading } = useVisionNFT({ \n    visualizationId: viz.id,\n    enabled: true \n  });\n\n  return (\n    <Card \n      className="overflow-hidden group cursor-pointer transition-all hover:ring-2 hover:ring-primary/50 active:scale-[0.98]"\n      onClick={onNavigate}\n    >\n      <div className="relative aspect-square">\n        <img\n          src={viz.image_path}\n          alt={viz.title}\n          className="w-full h-full object-cover"\n          loading="lazy"\n        />\n        \n        {/* Mobile: Tap to show actions overlay / Desktop: Hover */}\n        <div \n          className={`absolute inset-0 bg-black/60 transition-opacity flex flex-col items-center justify-center gap-2 p-3\n            ${showActions ? \'opacity-100\' : \'opacity-0\'}\n            sm:group-hover:opacity-100 sm:opacity-0`}\n          onClick={(e) => {\n            e.stopPropagation();\n            if (window.innerWidth < 640) {\n              setShowActions(!showActions);\n            }\n          }}\n        >\n          {/* Action Buttons Grid - Mobile Optimized */}\n          <div className="grid grid-cols-2 gap-2 w-full max-w-[200px]">\n            <Button\n              size="sm"\n              variant="secondary"\n              onClick={(e) => {\n                e.stopPropagation();\n                onNavigate();\n              }}\n              className="gap-1 text-xs sm:text-sm"\n            >\n              <ExternalLink className="h-3 w-3 sm:h-4 sm:w-4" />\n              <span className="hidden sm:inline">Open</span>\n              <span className="sm:hidden">View</span>\n            </Button>\n            <Button\n              size="sm"\n              variant="secondary"\n              onClick={(e) => {\n                e.stopPropagation();\n                onDownload();\n              }}\n              className="gap-1 text-xs sm:text-sm"\n              disabled={isDownloading === viz.id}\n            >\n              {isDownloading === viz.id ? (\n                <Loader2 className="h-3 w-3 sm:h-4 sm:w-4 animate-spin" />\n              ) : (\n                <Download className="h-3 w-3 sm:h-4 sm:w-4" />\n              )}\n              <span>DL</span>\n            </Button>\n            <Button\n              size="sm"\n              onClick={(e) => {\n                e.stopPropagation();\n                onPrint();\n              }}\n              className="gap-1 bg-gradient-to-r from-amber-500/80 to-amber-600/80 hover:from-amber-500 hover:to-amber-600 text-stone-900 text-xs sm:text-sm"\n            >\n              <Printer className="h-3 w-3 sm:h-4 sm:w-4" />\n              <span>Print</span>\n            </Button>\n            {!listedIds.has(viz.id) && !isPrivate && (\n              <Button\n                size="sm"\n                variant="secondary"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onSell();\n                }}\n                className="gap-1 text-xs sm:text-sm"\n              >\n                <Tag className="h-3 w-3 sm:h-4 sm:w-4" />\n                <span>Sell</span>\n              </Button>\n            )}\n          </div>\n          \n          {/* Delete button - full width on mobile */}\n          <Button\n            size="sm"\n            variant="destructive"\n            onClick={(e) => {\n              e.stopPropagation();\n              onDelete();\n            }}\n            className="gap-1 w-full max-w-[200px] text-xs sm:text-sm mt-2"\n          >\n            <Trash2 className="h-3 w-3 sm:h-4 sm:w-4" />\n            Delete\n          </Button>\n          \n          {/* Mobile hint */}\n          <span className="text-white/60 text-[10px] sm:hidden mt-1">\n            Tap image to close\n          </span>\n        </div>\n\n        {/* Mobile: Tap indicator / Desktop: Hover hint */}\n        <div \n          className={`absolute bottom-2 left-1/2 -translate-x-1/2 bg-black/60 text-white/80 text-[10px] px-2 py-1 rounded-full backdrop-blur-sm transition-opacity sm:hidden\n            ${showActions ? \'opacity-0\' : \'opacity-100\'}`}\n        >\n          Tap for actions\n        </div>\n\n        {listedIds.has(viz.id) && (\n          <Badge className="absolute top-2 left-2 bg-green-500/90 text-[10px] sm:text-xs">\n            <ShoppingBag className="h-2.5 w-2.5 sm:h-3 sm:w-3 mr-1" />\n            Listed\n          </Badge>\n        )}\n        {isPrivate && (\n          <Badge variant="secondary" className="absolute top-2 right-2 text-[10px] sm:text-xs">\n            <Lock className="h-2.5 w-2.5 sm:h-3 sm:w-3 mr-1" />\n            Private\n          </Badge>\n        )}\n      </div>\n      <CardContent className="p-3 sm:p-4 space-y-2">\n        <h3 className="font-medium truncate text-sm sm:text-base">{viz.title}</h3>\n        <p className="text-xs sm:text-sm text-muted-foreground truncate">\n          {viz.game_data.white} vs {viz.game_data.black}\n        </p>\n        {/* NFT Floor Price Display */}\n        {visionNFT && (\n          <div className="pt-1 border-t border-border/50">\n            <VisionFloorPrice visionNFT={visionNFT} showDetails={false} />\n          </div>\n        )}\n        <div className="flex items-center justify-between">\n          <p className="text-[10px] sm:text-xs text-muted-foreground">\n            {new Date(viz.created_at).toLocaleDateString()}\n          </p>\n          {viz.public_share_id && (\n            <div className="flex gap-1">\n              <Button\n                size="icon"\n                variant="ghost"\n                className="h-7 w-7 sm:h-6 sm:w-6"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onCopyLink();\n                }}\n                title="Copy share link"\n              >\n                <Link2 className="h-3.5 w-3.5 sm:h-3 sm:w-3" />\n              </Button>\n              <Button\n                size="icon"\n                variant="ghost"\n                className="h-7 w-7 sm:h-6 sm:w-6"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onViewPublic();\n                }}\n                title="View public page"\n              >\n                <ExternalLink className="h-3.5 w-3.5 sm:h-3 sm:w-3" />\n              </Button>\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nconst MyVision: React.FC = () => {\n  const navigate = useNavigate();\n  const { user, isPremium, isLoading: authLoading } = useAuth();\n  const { setOrderData } = usePrintOrderStore();\n  const { \n    setCurrentSimulation, \n    setSavedShareId, \n    setReturningFromOrder,\n    returningFromOrder,\n    capturedTimelineState,\n    setCapturedTimelineState,\n  } = useSessionStore();\n  const [visualizations, setVisualizations] = useState<SavedVisualization[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isMigrating, setIsMigrating] = useState(false);\n  const [deleteTarget, setDeleteTarget] = useState<SavedVisualization | null>(null);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [showAuthModal, setShowAuthModal] = useState(false);\n  const [listingTarget, setListingTarget] = useState<SavedVisualization | null>(null);\n  const [listedIds, setListedIds] = useState<Set<string>>(new Set());\n  const [showVisionaryModal, setShowVisionaryModal] = useState(false);\n  const [showSubscriptionPanel, setShowSubscriptionPanel] = useState(false);\n  const [isDownloading, setIsDownloading] = useState<string | null>(null);\n  const [activeSection, setActiveSection] = useState<\'public\' | \'private\'>(\'public\');\n\n  // Handle restoration toast when returning from order page\n  useEffect(() => {\n    if (returningFromOrder && capturedTimelineState) {\n      const { currentMove, totalMoves, title } = capturedTimelineState;\n      const titleText = title || \'Visualization\';\n      const moveInfo = currentMove !== undefined && totalMoves !== undefined\n        ? `Move ${currentMove} of ${totalMoves}`\n        : currentMove !== undefined\n        ? `Move ${currentMove}`\n        : \'Your gallery is ready\';\n      \n      toast.success(`${titleText} restored!`, {\n        description: moveInfo,\n        icon: <Sparkles className="w-4 h-4" />,\n      });\n      \n      // Clear the flags\n      setReturningFromOrder(false);\n      setCapturedTimelineState(null);\n    }\n  }, [returningFromOrder, capturedTimelineState, setReturningFromOrder, setCapturedTimelineState]);\n\n  // Batched loading function for better performance\n  const loadVisualizations = useCallback(async () => {\n    if (!user) return;\n    \n    setIsLoading(true);\n    const { data, error } = await getUserVisualizations(user.id);\n    \n    if (error) {\n      toast.error(\'Failed to load visualizations\', { description: error.message });\n    } else {\n      setVisualizations(data);\n      \n      // Batch check which visualizations are listed (single query instead of N queries)\n      if (data.length > 0) {\n        const vizIds = data.map(v => v.id);\n        const listedMap = await batchCheckVisualizationsListed(vizIds);\n        setListedIds(new Set(Object.entries(listedMap).filter(([_, isListed]) => isListed).map(([id]) => id)));\n      } else {\n        setListedIds(new Set());\n      }\n      \n      // Check if any visualizations need migration (missing board data)\n      const needsMigration = data.some(v => !v.game_data.board || !Array.isArray(v.game_data.board));\n      if (needsMigration && data.length > 0) {\n        // Auto-migrate in the background\n        handleMigration();\n      }\n    }\n    \n    setIsLoading(false);\n  }, [user]);\n\n  // Real-time updates for My Vision page\n  useMyVisionRealtime({\n    userId: user?.id,\n    onVisualizationChange: loadVisualizations,\n    onScoreChange: () => {\n      // Scores changed, could trigger a refresh of value displays\n      // The HoldingsValueDashboard handles its own updates\n    },\n    enabled: !!user && isPremium,\n  });\n\n  useEffect(() => {\n    if (user && isPremium) {\n      loadVisualizations();\n    } else {\n      setIsLoading(false);\n    }\n  }, [user, isPremium, loadVisualizations]);\n\n  const handleMigration = async () => {\n    if (!user || isMigrating) return;\n    \n    setIsMigrating(true);\n    try {\n      const result = await migrateUserVisualizations(user.id);\n      \n      if (result.migrated > 0) {\n        toast.success(`Updated ${result.migrated} visualization(s)`, {\n          description: \'Your saved games now support full interactivity\',\n        });\n        // Reload visualizations to get updated data\n        const { data } = await getUserVisualizations(user.id);\n        if (data) setVisualizations(data);\n      }\n      \n      if (result.failed > 0) {\n        console.warn(\'Migration failures:\', result.errors);\n      }\n    } catch (err) {\n      console.error(\'Migration error:\', err);\n    } finally {\n      setIsMigrating(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!deleteTarget) return;\n    \n    setIsDeleting(true);\n    const { error } = await deleteVisualization(deleteTarget.id, deleteTarget.image_path);\n    \n    if (error) {\n      toast.error(\'Failed to delete visualization\', { description: error.message });\n    } else {\n      setVisualizations(prev => prev.filter(v => v.id !== deleteTarget.id));\n      toast.success(\'Visualization deleted\');\n    }\n    \n    setIsDeleting(false);\n    setDeleteTarget(null);\n  };\n\n  const handleDownload = async (visualization: SavedVisualization) => {\n    setIsDownloading(visualization.id);\n    \n    try {\n      // Server-side premium validation before allowing HD download\n      const validation = await validatePremiumDownload();\n      \n      if (!validation.allowed) {\n        toast.error(\'Premium Required\', {\n          description: validation.message || \'Upgrade to Premium for HD downloads\',\n        });\n        setShowVisionaryModal(true);\n        return;\n      }\n\n      const response = await fetch(visualization.image_path);\n      const blob = await response.blob();\n      const url = URL.createObjectURL(blob);\n      \n      const link = document.createElement(\'a\');\n      link.href = url;\n      link.download = `${visualization.title.replace(/[^a-z0-9]/gi, \'-\')}.png`;\n      link.click();\n      \n      URL.revokeObjectURL(url);\n      toast.success(\'Image downloaded!\');\n    } catch (error) {\n      toast.error(\'Failed to download image\');\n    } finally {\n      setIsDownloading(null);\n    }\n  };\n\n  const handleCopyShareLink = async (viz: SavedVisualization) => {\n    // Get PGN from visualization to generate canonical URL\n    const pgn = viz.pgn || (viz.game_data as { pgn?: string }).pgn;\n    const paletteId = (viz.game_data as { visualizationState?: { paletteId?: string } }).visualizationState?.paletteId;\n    \n    if (!pgn) {\n      toast.error(\'Share link not available\');\n      return;\n    }\n    \n    const url = buildCanonicalShareUrl(pgn, paletteId);\n    try {\n      await navigator.clipboard.writeText(url);\n      toast.success(\'Share link copied!\', { description: \'Universal game link!\' });\n    } catch {\n      toast.error(\'Failed to copy link\');\n    }\n  };\n\n  const handleViewPublicPage = (viz: SavedVisualization) => {\n    // Get PGN from visualization to generate canonical URL\n    const pgn = viz.pgn || (viz.game_data as { pgn?: string }).pgn;\n    const paletteId = (viz.game_data as { visualizationState?: { paletteId?: string } }).visualizationState?.paletteId;\n    \n    if (!pgn) return;\n    \n    const gameHash = generateGameHash(pgn);\n    const params = new URLSearchParams();\n    if (paletteId) params.set(\'p\', paletteId);\n    const paramString = params.toString();\n    \n    window.open(`/g/${gameHash}${paramString ? `?${paramString}` : \'\'}`, \'_blank\');\n  };\n\n  const handleOrderPrint = (viz: SavedVisualization) => {\n    // Reconstruct simulation from saved visualization data\n    const storedData = viz.game_data;\n    const board = storedData.board || \n      Array(8).fill(null).map((_, rank) =>\n        Array(8).fill(null).map((_, file) => ({\n          file,\n          rank,\n          visits: [],\n          isLight: (file + rank) % 2 === 1,\n        }))\n      );\n    \n    const gameData = {\n      white: storedData.white || \'White\',\n      black: storedData.black || \'Black\',\n      event: storedData.event || \'\',\n      date: storedData.date || \'\',\n      result: storedData.result || \'\',\n      pgn: storedData.pgn || viz.pgn || \'\',\n      moves: storedData.moves || [],\n    };\n    \n    const simulation = {\n      board,\n      gameData,\n      totalMoves: storedData.totalMoves || storedData.moves?.length || 0,\n    };\n    \n    // Save to session store for restoration on return\n    setCurrentSimulation(simulation, viz.pgn || \'\', viz.title);\n    setSavedShareId(viz.public_share_id || null);\n    setReturningFromOrder(true);\n    \n    setOrderData({\n      visualizationId: viz.id,\n      imagePath: viz.image_path,\n      title: viz.title,\n      pgn: viz.pgn || undefined,\n      gameData: {\n        white: viz.game_data.white,\n        black: viz.game_data.black,\n        event: viz.game_data.event,\n        date: viz.game_data.date,\n        result: viz.game_data.result,\n      },\n      // Include reconstructed simulation for print rendering\n      simulation,\n      shareId: viz.public_share_id,\n      returnPath: \'/my-vision\',\n    });\n    navigate(\'/order-print\');\n  };\n\n  // Loading state\n  if (authLoading) {\n    return (\n      <div className="min-h-screen bg-background">\n        <Header />\n        <div className="container mx-auto px-4 py-8">\n          <div className="flex items-center justify-center h-64">\n            <Loader2 className="h-8 w-8 animate-spin text-primary" />\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  // Not logged in\n  if (!user) {\n    return (\n      <div className="min-h-screen bg-background">\n        <Header />\n        <div className="container mx-auto px-4 py-16">\n          <div className="max-w-md mx-auto text-center space-y-6">\n            <div className="flex justify-center">\n              <div className="h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center">\n                <Crown className="h-8 w-8 text-primary" />\n              </div>\n            </div>\n            <h1 className="text-2xl font-display font-bold">My Vision Gallery</h1>\n            <p className="text-muted-foreground">\n              Sign in to access your personal gallery of saved chess visualizations.\n            </p>\n            <Button onClick={() => setShowVisionaryModal(true)} className="btn-luxury">\n              Sign In to Continue\n            </Button>\n          </div>\n          \n          <VisionaryMembershipCard\n            isOpen={showVisionaryModal}\n            onClose={() => setShowVisionaryModal(false)}\n            onAuthRequired={() => {\n              setShowVisionaryModal(false);\n              setShowAuthModal(true);\n            }}\n            trigger="save"\n          />\n          <AuthModal isOpen={showAuthModal} onClose={() => setShowAuthModal(false)} />\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  // Not premium - show gallery preview with upgrade prompt\n  if (!isPremium) {\n    return (\n      <div className="min-h-screen bg-background">\n        <Header />\n        <div className="container mx-auto px-4 py-16">\n          <div className="max-w-2xl mx-auto text-center space-y-8">\n            <div className="flex justify-center">\n              <div className="h-20 w-20 rounded-full bg-primary/10 flex items-center justify-center">\n                <Sparkles className="h-10 w-10 text-primary" />\n              </div>\n            </div>\n            <div className="space-y-4">\n              <h1 className="text-3xl font-display font-bold">Unlock My Vision Gallery</h1>\n              <p className="text-lg text-muted-foreground leading-relaxed">\n                Save your chess visualizations to a personal gallery. Download them anytime, \n                share with unique QR codes, and build your collection of chess art.\n              </p>\n            </div>\n            \n            {/* Feature highlights */}\n            <div className="grid sm:grid-cols-3 gap-4 text-left">\n              <div className="p-4 rounded-lg bg-card border border-border/50">\n                <Download className="h-6 w-6 text-primary mb-2" />\n                <h3 className="font-medium text-sm">Unlimited Downloads</h3>\n                <p className="text-xs text-muted-foreground">HD images, no watermarks</p>\n              </div>\n              <div className="p-4 rounded-lg bg-card border border-border/50">\n                <Link2 className="h-6 w-6 text-primary mb-2" />\n                <h3 className="font-medium text-sm">Shareable Links</h3>\n                <p className="text-xs text-muted-foreground">Unique QR codes for prints</p>\n              </div>\n              <div className="p-4 rounded-lg bg-card border border-border/50">\n                <ImageIcon className="h-6 w-6 text-primary mb-2" />\n                <h3 className="font-medium text-sm">Personal Gallery</h3>\n                <p className="text-xs text-muted-foreground">All your art in one place</p>\n              </div>\n            </div>\n            \n            <Button \n              onClick={() => setShowVisionaryModal(true)}\n              className="btn-luxury gap-2"\n              size="lg"\n            >\n              <Crown className="h-5 w-5" />\n              Become a Visionary\n            </Button>\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  return (\n    <div className="min-h-screen bg-background">\n      <Header />\n      <div className="container mx-auto px-4 py-8">\n        {/* Grace Period Warning Banner */}\n        <GracePeriodBanner className="mb-6" />\n        <div className="mb-8">\n          <div className="flex items-center justify-between gap-3 mb-2">\n            <div className="flex items-center gap-3">\n              <Crown className="h-6 w-6 text-primary" />\n              <h1 className="text-3xl font-display font-bold">My Vision Gallery</h1>\n            </div>\n            <div className="flex items-center gap-2 overflow-x-auto scrollbar-hide shrink-0">\n              {isMigrating ? (\n                <div className="flex items-center gap-2 text-sm text-muted-foreground shrink-0">\n                  <RefreshCw className="h-4 w-4 animate-spin" />\n                  <span>Updating...</span>\n                </div>\n              ) : (\n                <>\n                  <Button\n                    variant="outline"\n                    size="sm"\n                    onClick={handleMigration}\n                    disabled={isMigrating || visualizations.length === 0}\n                    className="gap-2 shrink-0"\n                    title="Refresh and re-process any failed visualizations"\n                  >\n                    <RefreshCw className="h-4 w-4" />\n                    <span className="hidden sm:inline">Refresh</span>\n                  </Button>\n                  <Button\n                    variant="outline"\n                    size="sm"\n                    onClick={() => setShowSubscriptionPanel(!showSubscriptionPanel)}\n                    className="gap-2 shrink-0"\n                  >\n                    <Settings className="h-4 w-4" />\n                    <span className="hidden sm:inline">Subscription</span>\n                  </Button>\n                </>\n              )}\n            </div>\n          </div>\n          <p className="text-muted-foreground">\n            Your saved chess visualizations, ready to download anytime.\n          </p>\n        </div>\n\n        {/* Subscription Management Panel */}\n        {showSubscriptionPanel && (\n          <div className="mb-8 max-w-md">\n            <SubscriptionManagement />\n          </div>\n        )}\n\n        {/* Holdings Value Dashboard */}\n        <div className="mb-6 sm:mb-8">\n          <HoldingsValueDashboard />\n        </div>\n        \n        {isLoading ? (\n          <div className="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-6">\n            {[...Array(4)].map((_, i) => (\n              <Card key={i} className="overflow-hidden">\n                <Skeleton className="aspect-square w-full" />\n                <CardContent className="p-3 sm:p-4 space-y-2">\n                  <Skeleton className="h-4 sm:h-5 w-3/4" />\n                  <Skeleton className="h-3 sm:h-4 w-1/2" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : visualizations.length === 0 ? (\n          <div className="text-center py-16 space-y-4">\n            <div className="flex justify-center">\n              <div className="h-20 w-20 rounded-full bg-muted flex items-center justify-center">\n                <ImageIcon className="h-10 w-10 text-muted-foreground" />\n              </div>\n            </div>\n            <h2 className="text-xl font-medium">No visualizations yet</h2>\n            <p className="text-muted-foreground max-w-sm mx-auto">\n              Create a chess visualization and save it to your gallery to see it here.\n            </p>\n            <Button onClick={() => navigate(\'/\')} className="btn-luxury mt-4">\n              Create Your First Visualization\n            </Button>\n          </div>\n        ) : (\n          <Tabs value={activeSection} onValueChange={(v) => setActiveSection(v as \'public\' | \'private\')}>\n            <TabsList className="mb-6">\n              <TabsTrigger value="public" className="gap-2">\n                <Globe className="h-4 w-4" />\n                Public ({visualizations.filter(v => !(v.game_data as { is_private?: boolean }).is_private).length})\n              </TabsTrigger>\n              <TabsTrigger value="private" className="gap-2">\n                <Lock className="h-4 w-4" />\n                Private ({visualizations.filter(v => (v.game_data as { is_private?: boolean }).is_private).length})\n              </TabsTrigger>\n            </TabsList>\n            \n            <TabsContent value="public">\n              <div className="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-6">\n                {visualizations.filter(v => !(v.game_data as { is_private?: boolean }).is_private).map((viz) => (\n                  <VisionCard \n                    key={viz.id} \n                    viz={viz} \n                    listedIds={listedIds}\n                    isDownloading={isDownloading}\n                    onNavigate={() => navigate(`/my-vision/${viz.id}`)}\n                    onDownload={() => handleDownload(viz)}\n                    onPrint={() => handleOrderPrint(viz)}\n                    onSell={() => setListingTarget(viz)}\n                    onDelete={() => setDeleteTarget(viz)}\n                    onCopyLink={() => handleCopyShareLink(viz)}\n                    onViewPublic={() => handleViewPublicPage(viz)}\n                  />\n                ))}\n              </div>\n              {visualizations.filter(v => !(v.game_data as { is_private?: boolean }).is_private).length === 0 && (\n                <p className="text-center text-muted-foreground py-8">No public visions yet. Your visions will be visible to other collectors here.</p>\n              )}\n            </TabsContent>\n            \n            <TabsContent value="private">\n              <div className="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-6">\n                {visualizations.filter(v => (v.game_data as { is_private?: boolean }).is_private).map((viz) => (\n                  <VisionCard \n                    key={viz.id} \n                    viz={viz} \n                    listedIds={listedIds}\n                    isDownloading={isDownloading}\n                    onNavigate={() => navigate(`/my-vision/${viz.id}`)}\n                    onDownload={() => handleDownload(viz)}\n                    onPrint={() => handleOrderPrint(viz)}\n                    onSell={() => setListingTarget(viz)}\n                    onDelete={() => setDeleteTarget(viz)}\n                    onCopyLink={() => handleCopyShareLink(viz)}\n                    onViewPublic={() => handleViewPublicPage(viz)}\n                    isPrivate\n                  />\n                ))}\n              </div>\n              {visualizations.filter(v => (v.game_data as { is_private?: boolean }).is_private).length === 0 && (\n                <p className="text-center text-muted-foreground py-8">No private visions. Toggle any vision to private to hide it from other collectors.</p>\n              )}\n            </TabsContent>\n          </Tabs>\n        )}\n      </div>\n      \n      {/* Delete Confirmation Dialog */}\n      <AlertDialog open={!!deleteTarget} onOpenChange={() => setDeleteTarget(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Visualization?</AlertDialogTitle>\n            <AlertDialogDescription>\n              This will permanently delete "{deleteTarget?.title}" from your gallery. This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel disabled={isDeleting}>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleDelete}\n              disabled={isDeleting}\n              className="bg-destructive text-destructive-foreground hover:bg-destructive/90"\n            >\n              {isDeleting ? (\n                <Loader2 className="h-4 w-4 animate-spin mr-2" />\n              ) : (\n                <Trash2 className="h-4 w-4 mr-2" />\n              )}\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* List for Sale Modal */}\n      {listingTarget && (\n        <ListForSaleModal\n          isOpen={!!listingTarget}\n          onClose={() => setListingTarget(null)}\n          visualizationId={listingTarget.id}\n          visualizationTitle={listingTarget.title}\n          onSuccess={() => {\n            loadVisualizations();\n          }}\n        />\n      )}\n      \n      {/* Visionary Membership Modal */}\n      <VisionaryMembershipCard\n        isOpen={showVisionaryModal}\n        onClose={() => setShowVisionaryModal(false)}\n        onAuthRequired={() => {\n          setShowVisionaryModal(false);\n          setShowAuthModal(true);\n        }}\n        trigger="save"\n      />\n      \n      <Footer />\n    </div>\n  );\n};\n\nexport default MyVision;\n';export{n as default};
