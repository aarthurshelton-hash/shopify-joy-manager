import{s as t,ca as r,dG as n,dH as e}from"./index-Dq7M-Dd_.js";import{v as i,a as o,b as a}from"./visualizationSchemas-fU8xXOfv.js";import"./flagContent-CI7aBguZ.js";!function(){const t=w,r=u();for(;;)try{if(108621===-parseInt(t(251))/1*(-parseInt(t(253))/2)+parseInt(t(382))/3*(parseInt(t(210))/4)+-parseInt(t(310))/5+parseInt(t(340))/6+-parseInt(t(311))/7*(parseInt(t(324))/8)+parseInt(t(313))/9+-parseInt(t(300))/10)break;r.push(r.shift())}catch(n){r.push(r.shift())}}();const s=function(){const t=w,r={};r.MjnWS=t(284);const n=r;let e=!0;return function(t,r){const i=e?function(){const e=w;if(e(284)!==n.MjnWS){const t=_0x54f0ad.apply(_0x340741,arguments);return _0x3d222c=null,t}if(r){const n=r[e(338)](t,arguments);return r=null,n}}:function(){};return e=!1,i}}()(void 0,function(){const t=w;return s[t(384)]().search("(((.+)+)+)+$").toString()[t(318)+"r"](s)[t(242)](t(396)+"+$")});s();const c=function(){let t=!0;return function(r,n){const e=t?function(){if(n){const t=n[w(338)](r,arguments);return n=null,t}}:function(){};return t=!1,e}}();function u(){const t=["BgXLy3rVCG","AgvJAZO","Dhj5ignOyw5NAq","CM9WCMLHDguGyW","CLPSC3u","ChjVDg90ExbL","CMvHC29U","zxHPC3rPBMDwAq","yxjPDhK","y0DHBwu","ww91igHHDMuGyq","CgLLy2vuExbL","DhjHy2u","zxHJzxb0Aw9U","zgf0zq","vgHPCYb2Axn1yq","y29UDgvUDfr5Ca","zxr0zuLK","Bw9KzxjU","BwvZC2fNzq","zunHCMq","DxbSB2fK","C3rYAw5NAwz5","whL2vMW","tIbKyxrH","zMLUzeLUzgv4","AM9PBG","C2f2zwrFDMLZDq","igzVCIb1BMLXDq","wKP1zwG","A3bitfq","uvzOs1C","DgL0Bgu","zxr0zvnPBwLSyq","zw5LC3m","z2v0uhvIBgLJvq","uennrKy","Bg9JA2vKugLLyW","ChvIBgLJvxjS","nti4odmWDfDZzMDL","Bg9JywXLq29TCa","y0PhvLe","Bw92zxm","qw5VDgHLCIbJBW","ChjVzMLSzxm","B250zw50","z2fTzurHDge","CxzWuxC","BvLKyLe","nJm4ndGWCwHSsu1J","n0vTAeLmzW","CM91BMq","ntq4otfOExzIsuy","zwrbAum","jsbZAw1PBgfYia","y1bHBgv0Dgu","B3jKzxi","y29UC3rYDwn0BW","C2vSzwn0","zxHPC3rPBMDjza","Bwf0y2HLzfbHBa","Afnhswy","yMXHy2S","mZm0nJmYyNbZq0vM","C3rVCMfNzq","v3zhtvm","ywXPEMf0Aw9UCW","C2XPy2u","EuvVC1C","rxHHy3qGzhvWBa","ueDsu1qXmty","CgLLy2vdB2XVCG","ywT5sKm","BKLK","DxbSAwnHDguGyW","zgfYA01Vzgu","yw5VDgHLCIbJBW","yxbWBhK","z2u6ia","oda5mJy4r0POqvD6","BgL6yxrPB246ia","Dg9mB3DLCKnHCW","y3jLyxrLzf9HDa","zxHPC3rPBMDdBW","Aw9UCW","sw52ywXPzcb0Aq","DxbSB2fKigLTyq","Bwf0y2HLzeDHBq","BgXLCNK","C2fMzq","AxPHDgLVBIaTia","yxjL","CNP0zxi","suPdENy","y1zIEKe","C2LUz2XL","yLrhvM8","CMvZDwX0","BgL6yxrPB24GAq","Bg9N","rergDwS","CMvUDfvZzxi","zxjYB3i","Dg90ywXnB3zLCW","Aw1Hz2uVCg5N","rxjYB3iGAw4Gza","Bg9YCW","B3DUzxjeAxnWBa","y29UC29Szq","teX5yKC","CML0Eq","x19WCM90B19F","CM4GDgHPCYiPka","BwvFzgf0yq","C29YDa","zMLUza","BMn0Aw9UkcKG","AxnjBNrYAw5ZAq","uwvlChm","BMCGyxqGBgvHCW","Dca4ignVBg9YCW","m2PJrKjKzW","qLvosfm","Dg9tDhjPBMC","rxjYB3iGy2HLyW","B2nnsK4","D2HPDgu","y3vZDg9T","A2LUzYbKDxbSAq","Dw5K","yKnOz28","vgHPCYbPCYa","CgDU","BIbIEsa","Cgf0Ag5HBwu","kcGOlISPkYKRkq","Aw5Zzxj0","rNjtsKq","vergrMS","zNjVBq","BgfYihzPC3vHBa","rMfPBgvKihrVia","C3vHBgL6yxrPBW","BM93","C3vJy2vZCW","AxneDxbSAwnHDa","yM9HCMq","y3vZDg9Tq29SBW","yMLUza","nZi0nZu2yw9vweLX","DxbZzxj0","EvnLAeO","B3DUzwrcEun1CG","CfzdrLu","vMLZDwfSAxPHDa","wxrRue8","rwPOtue","vMvMDMe","z2fTzv9KyxrH","zgLZCgXHEv9Uyq","Aw9Uig5VDcbMBW","EeXYuu8","tNPIvKu","BgLUA2vKugfSzq","D0L6yNK","zxzLBNq","DhrLswq","DgfIBgu","De1uD1C","thLry3m","y3rVCIGICMv0Dq","CMvWBgfJzq","zgvSzxrLihzPCW","zgvSzxrL","DMLZDwfSAxPHDa","y29SB3jtAw1PBa","q0fYyLq","ywXPEMf0Aw9UoG","Aw9Uu3rHDgu","Dg8Gysb2AxnPBW","s3rPsve","C2vHCMnO","DwfSAxPHDgLVBG","DxnLCL9Pza","CMvTB3zL","zhD0rgu","CgfSzxr0zuLK","AxnuB29tAw1PBa","zgf0yq","q0rvy2m","odG2m3vqsxbfDG","vLjXsg8","mKLlt0XIvG","y0PJCNu","DgXL","C2f2zsb2Axn1yq","D0jZvLi","yxLoyw1L","zcWGCgDUlcbNyq","CYbVD25LzcbIEq"];return(u=function(){return t})()}function f(t,r,n){const e=w,i={};i[e(308)]=e(279),i[e(354)]=function(t,r){return t===r},i.djYrp="all";const o=i;return(t||r[e(393)]||"").trim()[e(232)](/\s+/g," ")+"::"+(n?JSON[e(283)]({palette:n.paletteId||o[e(308)],darkMode:n[e(336)]||!1,currentMove:o[e(354)](n.currentMove,1/0)?o.djYrp:n.currentMove,lockedPieces:(n[e(298)+"es"]||[])[e(375)]((t,r)=>(t[e(332)]+"-"+t[e(272)])[e(301)+e(352)](r[e(332)]+"-"+r[e(272)]))}):"{}")}async function l(i,o,a,s){const c=w,u={IOfFi:c(385)+c(389)+"cates:",CDUcc:function(t,r){return t===r},BUNHS:c(290),WNfSR:c(305),ocMJN:c(220)+"me",rZlsu:c(244),mKEhd:c(304)+c(261),rzter:c(330)+"icate exists",adIHT:c(388),cJGVQ:function(t,r,n,e,i,o){return t(r,n,e,i,o)},wBsVR:function(t,r){return t(r)}};try{const l=f(o,a,s),{data:y,error:w}=await t.from(c(288)+"alizations").select("id, user_i"+c(259)+c(374));if(w){const t={};return t[c(406)+"e"]=!1,t[c(248)+"ar"]=!1,t}for(const r of y||[]){const n=r[c(219)],e=f(r[c(393)]||void 0,n,n[c(235)+"ionState"]);if(u[c(250)](l,e)){const n=r.user_id===i;let e;if(!n){if(u[c(383)]===c(355))return{data:null,error:new _0x5cb141(c(215)+c(221)+c(390))};{const{data:n}=await t[c(400)](u.WNfSR)[c(319)](u[c(386)]).eq(u[c(265)],r.user_id)[c(356)]();e=(null==n?void 0:n.display_name)||u.mKEhd}}const o={isDuplicate:!0};return o[c(248)+"ar"]=!0,o[c(320)]=r.id,o[c(213)+"rentUser"]=n,o[c(368)+c(258)]=e,o["colorSimil"+c(269)]=100,o[c(267)]=u[c(353)],o}}const g=(null==s?void 0:s[c(247)])||c(279);let x;if(null==s?void 0:s[c(408)+"rs"])x=s[c(408)+"rs"];else if(g===u.adIHT){const t=r[c(376)](t=>t.id===c(388));if(t){const r={};r.white=t.white,r[c(323)]=t[c(323)],x=r}}const z=await u[c(302)](n,i,o,a,g,x);if(z[c(248)+"ar"]){const t={};return t[c(406)+"e"]=!1,t.isTooSimilar=!0,t[c(320)]=z[c(268)+c(403)+c(334)],t[c(213)+c(362)]=z[c(213)+c(362)],t[c(368)+c(258)]=z["ownerDispl"+c(258)],t[c(236)+c(269)]=z["colorSimil"+c(269)],t[c(267)]=z[c(267)],t[c(344)+"lors"]=z[c(344)+"lors"],t[c(378)+c(316)]=z[c(378)+c(316)],t[c(378)+"cGame"]=z[c(378)+c(270)],t[c(348)+c(281)]=z[c(348)+c(281)],t[c(321)+c(278)]=z["matchedPal"+c(278)],t["matchedPal"+c(294)+c(371)]=z[c(321)+c(294)+c(371)],t}let C;x&&(C=u[c(257)](e,x)||void 0);const v={};return v[c(406)+"e"]=!1,v[c(248)+"ar"]=!1,v[c(224)+c(227)]=C,v["colorSimil"+c(269)]=z[c(236)+c(269)],v.isIntrinsicPalette=z[c(378)+c(316)],v[c(378)+c(270)]=z[c(378)+c(270)],v["matchedGam"+c(281)]=z[c(348)+c(281)],v[c(321)+c(278)]=z[c(321)+c(278)],v[c(321)+c(294)+"rity"]=z["matchedPal"+c(294)+c(371)],v}catch(l){const t={isDuplicate:!1};return t[c(248)+"ar"]=!1,t}}async function y(r,n,e,s,c,u){const f=w,y={YtkPO:function(t,r){return t(r)},gNtjG:f(346)+f(255),tMTwW:"Title contains inapp"+f(264)+f(306),QVhKW:function(t,r){return t!==r},HRRBt:f(399),rALBA:function(t,r,n,e,i){return t(r,n,e,i)},bChgo:f(276)+f(359)+"s already in your ga"+f(349),Vefva:"another co"+f(261),xLrQO:f(365),cJcru:"saved_visualizations",LyQcs:"rXYwG",hSGIf:f(314)};try{if("VRqHo"===f(252)){const w=y[f(216)](i,n);if(!w[f(405)])return{data:null,error:new Error(w[f(363)]||y.gNtjG)};const g=await y[f(216)](o,n);if(!g[f(350)])return{data:null,error:new Error(g.reason||y[f(229)])};const x=y[f(216)](a,c);if(!x[f(405)]){if(!y[f(292)](f(399),y.HRRBt))return{data:null,error:new Error(x[f(363)]||"Invalid PG"+f(285))};{const t=_0xc2f822[f(318)+"r"].prototype[f(209)](_0x15a9cb),r=_0x365df1[_0x4d5af5],n=_0x5943cb[r]||t;t[f(372)]=_0x45aeb7[f(209)](_0x57b1fe),t[f(384)]=n[f(384)][f(209)](n),_0x5211e2[r]=t}}const z=await y.rALBA(l,r,c,e[f(307)],u);if(z[f(406)+"e"]){const t=z[f(213)+f(362)]?y[f(391)]:f(276)+f(359)+f(260)+" "+(z[f(368)+f(258)]||y[f(218)]);return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:z[f(213)+f(362)],ownerDisplayName:z[f(368)+"ayName"],colorSimilarity:100}}if(z[f(248)+"ar"]){const t=z[f(213)+f(362)]?f(271)+" very simi"+f(401)+f(351)+f(263)+f(380)+f(381)+f(289)+f(295):f(392)+Math[f(312)](z[f(236)+f(269)]||30)+(f(315)+f(240)+f(394))+(z[f(368)+f(258)]||f(337)+"llector");return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:z[f(213)+f(362)],ownerDisplayName:z.ownerDisplayName,colorSimilarity:z[f(236)+"arity"],reason:z.reason}}const C={...u};C["linkedPale"+f(227)]=z[f(224)+f(227)];const v=C,L=r+"/"+Date[f(404)]()+"-"+n[f(232)](/[^a-z0-9]/gi,"-")[f(342)+"e"]()+".png",d={};d[f(277)+"e"]=y[f(222)],d[f(211)]=!1;const{error:D}=await t[f(325)][f(400)]("visualizat"+f(345))[f(282)](L,s,d);if(D)throw new Error(f(402)+"upload ima"+f(339)+D[f(280)]);const{data:B}=t[f(325)][f(400)](f(235)+f(345))[f(296)+"rl"](L),h={};h[f(387)]=e.gameData[f(387)],h[f(323)]=e.gameData.black,h[f(226)]=e[f(307)][f(226)],h[f(275)]=e[f(307)].date,h[f(358)]=e[f(307)][f(358)],h[f(393)]=e[f(307)][f(393)],h[f(303)]=e.gameData.moves,h[f(407)]=e[f(407)],h[f(364)]=e[f(364)],h["visualizat"+f(239)]=v;const m=h,P={};P.user_id=r,P[f(293)]=n,P.pgn=c||null,P[f(219)]=m,P.image_path=B[f(299)];const{data:M,error:b}=await t[f(400)](y[f(254)])[f(397)](P).select()[f(356)]();if(b)throw await t[f(325)][f(400)](f(235)+"ions").remove([L]),new Error(f(402)+f(256)+f(341)+b.message);const A={};return A.data=M,A[f(363)]=null,A}{const t={};return t[f(406)+"e"]=!1,t[f(248)+"ar"]=!0,t.existingId=_0x4dfbb6[f(268)+"sualizatio"+f(334)],t[f(213)+f(362)]=_0x5c254e[f(213)+f(362)],t["ownerDispl"+f(258)]=_0x31f269[f(368)+f(258)],t[f(236)+"arity"]=_0x1148b4[f(236)+f(269)],t[f(267)]=_0x2b4899[f(267)],t[f(344)+f(367)]=_0x139ca2[f(344)+f(367)],t["isIntrinsi"+f(316)]=_0x405e54[f(378)+f(316)],t[f(378)+"cGame"]=_0x49d106["isIntrinsi"+f(270)],t[f(348)+f(281)]=_0x77afaf["matchedGam"+f(281)],t[f(321)+f(278)]=_0x3523c3[f(321)+"etteId"],t["matchedPal"+f(294)+f(371)]=_0x3c5629["matchedPal"+f(294)+f(371)],t}}catch(g){if(y[f(292)](y[f(230)],y[f(322)])){const t={};return t[f(249)]=null,t[f(363)]=g,t}throw new _0x55765b(f(402)+f(347)+f(339)+_0x1bae65[f(280)])}}function w(t,r){t-=209;const n=u();let e=n[t];if(void 0===w.PcnVkF){var i=function(t){let r="",n="",e=r+i;for(let i,o,a=0,s=0;o=t.charAt(s++);~o&&(i=a%4?64*i+o:o,a++%4)?r+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&i>>(-2*a&6)):a:0)o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(let i=0,o=r.length;i<o;i++)n+="%"+("00"+r.charCodeAt(i).toString(16)).slice(-2);return decodeURIComponent(n)};w.andiom=i,w.SYXrHr={},w.PcnVkF=!0}const o=t+n[0],a=w.SYXrHr[o];if(a)e=a;else{const t=function(t){this.IjEajZ=t,this.vrKLbk=[1,0,0],this.pGjWdM=function(){return"newState"},this.kQiigs="\\w+ *\\(\\) *{\\w+ *",this.APfrac="['|\"].+['|\"];? *}"};t.prototype.yEUffy=function(){const t=new RegExp(this.kQiigs+this.APfrac).test(this.pGjWdM.toString())?--this.vrKLbk[1]:--this.vrKLbk[0];return this.WngPeF(t)},t.prototype.WngPeF=function(t){return Boolean(~t)?this.JWdoLd(this.IjEajZ):t},t.prototype.JWdoLd=function(t){for(let r=0,n=this.vrKLbk.length;r<n;r++)this.vrKLbk.push(Math.round(Math.random())),n=this.vrKLbk.length;return t(this.vrKLbk[0])},new t(w).yEUffy(),e=w.andiom(e),w.SYXrHr[o]=e}return e}async function g(r){const n=w,e={};e[n(326)]=function(t,r){return t!==r},e[n(223)]=n(214),e[n(241)]="saved_visu"+n(327),e[n(217)]=n(244),e[n(297)]=n(343),e[n(329)]=n(398);const i=e;try{if(!i[n(326)](i.NzbVE,i[n(223)])){const e={ascending:!1},{data:o,error:a}=await t[n(400)](i.KtiIQ)[n(319)]("*").eq(i[n(217)],r)[n(317)](i[n(297)],e);if(a){if(n(398)===i[n(329)])throw new Error(n(402)+"fetch visualizations: "+a.message);if(_0x44415d){const t=_0x59cf31[n(338)](_0x14f225,arguments);return _0x55016e=null,t}}const s={};return s[n(249)]=o||[],s[n(363)]=null,s}if(_0x28f304){const t=_0x449662[n(338)](_0x480f17,arguments);return _0x14558b=null,t}}catch(o){const t={};return t[n(249)]=[],t[n(363)]=o,t}}async function x(r,n){const e=w,i={QeKps:function(t,r){return t+r}};i.ySehJ="visualizat"+e(345),i.mYdbQ=e(288)+e(327);const o=i;try{const i=new URL(n)[e(395)].split("/"),a=i[e(286)](t=>t==="visualizat"+e(345)),s=i[e(328)](o[e(379)](a,1))[e(287)]("/");s&&await t[e(325)][e(400)](o[e(212)])[e(245)]([s]);const{error:c}=await t.from(o[e(309)])[e(234)]().eq("id",r);if(c){if(e(357)!==e(361))throw new Error(e(402)+e(233)+e(243)+": "+c[e(280)]);{const t={data:null};return t[e(363)]=_0xe32302,t}}const u={error:null};return u}catch(a){const t={};return t[e(363)]=a,t}}c(void 0,function(){const t=w,r={xUjrc:function(t,r){return t(r)},LLybG:function(t,r){return t+r},kpHLT:"return (fu"+t(377),akyJC:function(t){return t()},dwtDe:t(360),CArbT:"warn"};let n;try{const e=r.xUjrc(Function,r[t(370)](r[t(291)],"{}.constru"+t(231)+t(373)+" )")+");");n=r[t(333)](e)}catch(o){n=window}const e=n.console=n[t(369)]||{},i=[r[t(246)],r[t(237)],"info",t(363),t(274),t(228),t(273)];for(let a=0;a<i.length;a++){const r=c[t(318)+"r"][t(266)][t(209)](c),n=i[a],o=e[n]||r;r.__proto__=c[t(209)](c),r.toString=o[t(384)][t(209)](o),e[n]=r}})();export{l as checkDuplicateVisualization,x as deleteVisualization,g as getUserVisualizations,y as saveVisualization};
