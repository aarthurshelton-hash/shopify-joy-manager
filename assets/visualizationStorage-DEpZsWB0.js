import{s as t,ca as r,dG as n,dH as e}from"./index-C_PxF1MG.js";import{v as o,a as i,b as a}from"./visualizationSchemas-DbRmHF-u.js";import"./flagContent-gDr604pv.js";!function(){const t=f,r=s();for(;;)try{if(277010===-parseInt(t(327))/1+parseInt(t(350))/2*(-parseInt(t(340))/3)+-parseInt(t(301))/4+-parseInt(t(240))/5*(-parseInt(t(173))/6)+parseInt(t(244))/7*(-parseInt(t(315))/8)+-parseInt(t(232))/9*(-parseInt(t(354))/10)+-parseInt(t(256))/11*(-parseInt(t(357))/12))break;r.push(r.shift())}catch(n){r.push(r.shift())}}();const u=function(){const t=f,r={};r[t(262)]=function(t,r){return t===r};const n=r;let e=!0;return function(r,o){const i=t,a={eVhnX:function(t,r){return n.TGzDd(t,r)},jiCoT:i(199)},u=e?function(){const t=i;if(o){if(a.eVhnX(a[t(253)],a[t(253)])){const t=o.apply(r,arguments);return o=null,t}{const r=_0x3f1f2b[t(286)+"r"][t(322)][t(214)](_0x2dfd17),n=_0x7a6037[_0x173ad4],e=_0x5b2806[n]||r;r.__proto__=_0x2d12cd[t(214)](_0x497030),r[t(325)]=e[t(325)].bind(e),_0x281b5a[n]=r}}}:function(){};return e=!1,u}}()(void 0,function(){const t=f;return u[t(325)]()[t(249)](t(234)+"+$").toString()[t(286)+"r"](u).search(t(234)+"+$")});u();const c=function(){let t=!0;return function(r,n){const e=t?function(){if(n){const t=n[f(280)](r,arguments);return n=null,t}}:function(){};return t=!1,e}}();function s(){const t=["qMnZBKC","Bg9JywXLq29TCa","Dg8Gysb2AxnPBW","BMCGyxqGBgvHCW","zgvSzxrLihzPCW","BwvFzgf0yq","BgL6yxrPB246ia","DxbSB2fKigLTyq","zgf0zq","EwX0rLi","Awj0uui","CMvZDwX0","BNLAAum","vgHPCYbPCYa","uKTICgq","C2XPy2u","DLvUrNy","nNDrC3fjBa","Aw9Uu3rHDgu","E30Uy29UC3rYDq","ChjVzMLSzxm","Aw9UCW","EgTLEwC","C2vSzwn0","B3jKzxi","B3DUzxjeAxnWBa","CYbHBhjLywr5ia","lNbUzW","z2fTzurHDge","x19WCM90B19F","BIbIEsa","CwvKCuO","DhrLswq","wxLuzuO","qu1wruG","C2fMzq","t3fTCMO","CMvUDfvZzxi","rxjYB3iGAw4Gza","AxneDxbSAwnHDa","C29YDa","BgL6yxrPB24GAq","yMXHy2S","zKTbwLm","Aw4GEw91CIbNyq","u3bPr0q","C2LUz2XL","sNHUCLG","BgXLCNK","ueDsu1qXmty","D2HPDgu","Ag5Kq2G","yw5VDgHLCIbJBW","ALjQwMW","C3rVCMfNzq","BgLUA2vKugfSzq","DfrMuNa","AxrQreW","yMLUza","ywLUCYbPBMfWCa","ywXPEMf0Aw9UCW","y0DHBwu","vMLZDwfSAxPHDa","Bw9KzxjU","CgLLy2vuExbL","zxHJzxb0Aw9U","v2rVufy","A2LUzYbKDxbSAq","q29XA1q","Aw5Zzxj0","y1bHBgv0Dgu","wKDNB3q","vgHPCYb2Axn1yq","Bwf0y2HLzeDHBq","AxnuB29tAw1PBa","Aw1Hz2uVCg5N","ntyZnJD1DMv4B2S","yxjPDhK","kcGOlISPkYKRkq","zxzLBNq","zunHCMq","Dw5K","Bg9N","igzVCIb1BMLXDq","odeXntvwu1HRtMm","C2f2zsb2Axn1yq","z2fTzv9KyxrH","wuDcwha","mta1mdCYogv1tK5VEa","z2u6ia","tuXVBha","DMLZDwfSAxPHDa","u0DptuC","C2vHCMnO","y3vZDg9Tq29SBW","thbLy3u","Aw5MBW","AMLdB1q","zxHPC3rPBMDdBW","zxr0zuLK","ntu4odiYqxDHqK9u","vgL0BguGy29UDa","CMv0DxjUicHMDq","BM93","t0PxDNC","y2f0zxm6","veD6rgq","CMvHC29U","zw5LC3m","zMv0y2GGDMLZDq","D251B0e","uLzmt1K","qw5VDgHLCIbJBW","zxr0zvnPBwLSyq","CgDU","zMLUza","Cw16Dwq","DxbSB2fK","ANvrs3u","DxnLCL9Pza","zxjYB3i","CYbVD25LzcbIEq","CvrkueS","rxHHy3qGzhvWBa","yxbWBhK","y29SB3jtAw1PBa","CM9WCMLHDguGyW","Dca4ignVBg9YCW","BwvZC2fNzq","AxLezMS","y29UC3rYDwn0BW","AM9PBG","AwqSihvZzxjFAq","Cgf0Ag5HBwu","CML0Eq","D2niq3e","DhjHy2u","CMTfuuK","BgfYihzPC3vHBa","C2f2zwrFDMLZDq","C3bSAxq","y3vZDg9T","zxHPC3rPBMDwAq","zcWGCgDUlcbNyq","rMfPBgvKihrVia","mJa5otm3nNrMqLfhEq","C3rYAw5NAwz5","tu1jDu4","zgf0yq","AgvJAZO","y3jLyxrLzf9HDa","Bg9YCW","yxLoyw1L","ihzLCNKGC2LTAq","Aw9Uig5VDcbMBW","Bwf0y2HLzfbHBa","Dhj5ignOyw5NAq","AwnHDguGzxHPCW","AgnzsvC","ohHjAKTYDW","zNjVBq","DgXL","yM9HCMq","CgfSzxr0zuLK","y29UC29Szq","DwfSAxPHDgLVBG","ChjVDg90ExbL","yxL2v0W","sw52ywXPzcb0Aq","Dg9tDhjPBMC","y3vYCMvUDe1VDG","ntq0nJGYB2XKuLzN","uujsDgW","BgXLy3rVCG","B3DUzwrcEun1CG","DvDMtKC","yxjL","Bg9JA2vKugLLyW","yK1jv1G","CM4GDgHPCYiPka","rxjYB3iGy2HLyW","yKDIs1y","jsbZAw1PBgfYia","zxHPC3rPBMDjza","mJmYntLyvMrIuhC","AxnjBNrYAw5ZAq","tIbKyxrH","zgLZCgXHEv9Uyq","BKLK","C3vHBgL6yxrPBW","DgfIBgu","qwnes1i","C3vJy2vZCW","v3z3vxu","mtm4r1ryDxDQ","D2fiChe","CgLLy2vdB2XVCG","zMLUzeLUzgv4","ndyWAgPVELLp","Dg90ywXnB3zLCW","CMvWBgfJzq","nda4CLrPA211","Bw92zxm","DxbSAwnHDguGyW","vLDNEKi"];return(s=function(){return t})()}function f(t,r){t-=162;const n=s();let e=n[t];if(void 0===f.YcgEIa){var o=function(t){let r="",n="",e=r+o;for(let o,i,a=0,u=0;i=t.charAt(u++);~i&&(o=a%4?64*o+i:i,a++%4)?r+=e.charCodeAt(u+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=r.length;o<i;o++)n+="%"+("00"+r.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(n)};f.vqiQwN=o,f.yItVAG={},f.YcgEIa=!0}const i=t+n[0],a=f.yItVAG[i];if(a)e=a;else{const t=function(t){this.ZlTWOU=t,this.HqMCLo=[1,0,0],this.rAutFn=function(){return"newState"},this.yjOfGr="\\w+ *\\(\\) *{\\w+ *",this.bYYHUB="['|\"].+['|\"];? *}"};t.prototype.MGwtqI=function(){const t=new RegExp(this.yjOfGr+this.bYYHUB).test(this.rAutFn.toString())?--this.HqMCLo[1]:--this.HqMCLo[0];return this.qOpwCF(t)},t.prototype.qOpwCF=function(t){return Boolean(~t)?this.qpKDNj(this.ZlTWOU):t},t.prototype.qpKDNj=function(t){for(let r=0,n=this.HqMCLo.length;r<n;r++)this.HqMCLo.push(Math.round(Math.random())),n=this.HqMCLo.length;return t(this.HqMCLo[0])},new t(f).MGwtqI(),e=f.vqiQwN(e),f.yItVAG[i]=e}return e}function C(t,r,n){const e=f,o={};o[e(347)]=function(t,r){return t===r},o.CoqkT="all";const i=o;return(t||r.pgn||"").trim().replace(/\s+/g," ")+"::"+(n?JSON[e(302)]({palette:n[e(319)]||e(219),darkMode:n.darkMode||!1,currentMove:i[e(347)](n.currentMove,1/0)?i[e(224)]:n[e(326)+"e"],lockedPieces:(n[e(333)+"es"]||[])[e(196)]((t,r)=>(t[e(352)]+"-"+t[e(220)])[e(362)+e(332)](r[e(352)]+"-"+r[e(220)]))}):"{}")}async function w(o,i,a,u){const c=f,s={iyDfk:c(288)+c(299)+c(366),MMIuN:function(t,r){return t===r},AMVEH:"RVLOY",Lpecu:c(176),Oqmrj:c(279)+c(313)+"ts",wnuoA:c(219),DQiKt:c(297),bGbKV:function(t,r,n,e,o,i){return t(r,n,e,o,i)},FnPkj:function(t,r){return t(r)},MLolp:c(194)+c(359)+c(305)};try{const f=C(i,a,u),{data:w,error:l}=await t[c(316)](c(295)+c(216))[c(179)](s[c(285)]);if(l){const t={};return t[c(195)+"e"]=!1,t.isTooSimilar=!1,t}for(const r of w||[]){const n=r[c(242)],e=C(r[c(270)]||void 0,n,n[c(247)+c(174)]);if(s[c(303)](f,e)){const n=r.user_id===o;let e;if(!n){if(c(267)!==s[c(190)])return{data:null,error:new _0x25486c(_0x355e17.error||c(324)+c(317))};{const{data:n}=await t[c(316)](s[c(251)])[c(179)](c(343)+"me").eq(c(275),r[c(275)])[c(202)]();e=(null==n?void 0:n[c(343)+"me"])||c(268)+"llector"}}const i={};return i[c(195)+"e"]=!0,i[c(230)+"ar"]=!0,i.existingId=r.id,i[c(330)+"rentUser"]=n,i[c(181)+c(308)]=e,i["colorSimil"+c(233)]=100,i[c(263)]=s[c(192)],i}}const y=(null==u?void 0:u[c(319)])||s[c(266)];let D;if(null==u?void 0:u[c(250)+"rs"])D=u[c(250)+"rs"];else if(s[c(303)](y,s.DQiKt)){const t=r[c(271)](t=>t.id===c(297));if(t){const r={};r.white=t.white,r.black=t.black,D=r}}const g=await s[c(337)](n,o,i,a,y,D);if(g[c(230)+"ar"]){const t={isDuplicate:!1};return t[c(230)+"ar"]=!0,t[c(339)]=g[c(298)+c(345)+c(344)],t[c(330)+c(193)]=g[c(330)+c(193)],t["ownerDispl"+c(308)]=g[c(181)+c(308)],t[c(281)+c(233)]=g[c(281)+"arity"],t[c(263)]=g.reason,t[c(254)+c(307)]=g["existingCo"+c(307)],t[c(341)+c(226)]=g[c(341)+c(226)],t[c(341)+c(217)]=g.isIntrinsicGame,t[c(229)+c(236)]=g[c(229)+"eCard"],t[c(311)+c(255)]=g[c(311)+"etteId"],t[c(311)+c(269)+c(290)]=g["matchedPal"+c(269)+c(290)],t}let x;D&&(x=s.FnPkj(e,D)||void 0);const B={isDuplicate:!1,isTooSimilar:!1};return B[c(211)+c(188)]=x,B.colorSimilarity=g[c(281)+c(233)],B["isIntrinsi"+c(226)]=g[c(341)+c(226)],B[c(341)+c(217)]=g[c(341)+c(217)],B[c(229)+c(236)]=g.matchedGameCard,B["matchedPal"+c(255)]=g[c(311)+c(255)],B[c(311)+"etteSimila"+c(290)]=g["matchedPal"+c(269)+c(290)],B}catch(w){const t={};return t[c(195)+"e"]=!1,t[c(230)+"ar"]=!1,t}}async function l(r,n,e,u,c,s){const C=f,l={qedqJ:"Invalid ti"+C(317),xkeyg:C(257)+C(215)+C(282)+"ontent",kVtZJ:function(t,r,n,e,o){return t(r,n,e,o)},wcHCq:"another co"+C(329),SpiGD:"You have a"+C(309)+C(294)+"ization - "+C(312)+C(364)+C(283)+C(239)+C(264),juQKu:function(t,r){return t===r},hcYIW:C(295)+C(216),nyZiC:function(t,r){return t||r},ayvWL:function(t,r){return t===r},YyTeJ:C(360),jRjZl:C(351)};try{const f=o(n);if(!f[C(348)])return{data:null,error:new Error(f.error||l[C(187)])};const y=await i(n);if(!y[C(191)])return{data:null,error:new Error(y[C(263)]||l[C(178)])};const D=a(c);if(!D.success)return{data:null,error:new Error(D[C(276)]||"Invalid PG"+C(342))};const g=await l.kVtZJ(w,r,c,e.gameData,s);if(g[C(195)+"e"]){const t=g[C(330)+C(193)]?C(228)+C(197)+C(182)+C(200)+C(204):C(228)+C(197)+C(277)+" "+(g[C(181)+C(308)]||l.wcHCq);return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:g[C(330)+C(193)],ownerDisplayName:g[C(181)+C(308)],colorSimilarity:100}}if(g.isTooSimilar){const t=g["ownedByCur"+C(193)]?l[C(201)]:C(169)+Math.round(g[C(281)+"arity"]||30)+(C(338)+C(363)+C(186))+(g[C(181)+C(308)]||l[C(291)]);return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:g[C(330)+C(193)],ownerDisplayName:g["ownerDispl"+C(308)],colorSimilarity:g[C(281)+C(233)],reason:g[C(263)]}}const x={...s};x["linkedPale"+C(188)]=g[C(211)+C(188)];const B=x,z=r+"/"+Date[C(259)]()+"-"+n[C(356)](/[^a-z0-9]/gi,"-").toLowerCase()+C(183),L={};L.contentType=C(231),L.upsert=!1;const{error:q}=await t[C(210)].from(C(247)+C(177))[C(273)](z,u,L);if(q){if(l[C(274)](C(334),"bMIWX"))throw new Error("Failed to "+C(163)+C(245)+q[C(284)]);_0x1e663f=_0x59607e[C(250)+"rs"]}const{data:d}=t[C(210)].from(C(247)+C(177)).getPublicUrl(z),h={};h[C(206)]=e[C(184)][C(206)],h.black=e.gameData.black,h.event=e[C(184)][C(235)],h.date=e.gameData[C(164)],h[C(167)]=e[C(184)][C(167)],h.pgn=e[C(184)][C(270)],h[C(358)]=e.gameData[C(358)],h[C(318)]=e[C(318)],h[C(355)]=e[C(355)],h[C(247)+C(174)]=B;const v=h,{data:M,error:A}=await t[C(316)](l[C(314)])[C(225)]({user_id:r,title:n,pgn:l[C(168)](c,null),game_data:v,image_path:d.publicUrl}).select()[C(202)]();if(A){if(!l[C(323)]("FqZkx",l[C(189)]))throw await t[C(210)][C(316)](C(247)+C(177)).remove([z]),new Error(C(300)+C(241)+C(162)+A[C(284)]);{const t={};t[C(206)]=_0x1a813a[C(206)],t[C(198)]=_0x20846f[C(198)],_0x5d7334=t}}const m={};return m[C(304)]=M,m.error=null,m}catch(y){if(l[C(209)]!==C(293)){const t={data:null};return t.error=y,t}{const t=_0x522633[C(271)](t=>t.id===C(297));if(t){const r={};r.white=t[C(206)],r.black=t[C(198)],_0x34ec61=r}}}}async function y(r){const n=f,e={};e[n(260)]=n(275),e.qmzud=n(306);const o=e;try{const e={ascending:!1},{data:i,error:a}=await t[n(316)](n(295)+n(216))[n(179)]("*").eq(o[n(260)],r)[n(180)](o[n(272)],e);if(a)throw new Error("Failed to "+n(265)+n(216)+": "+a[n(284)]);const u={};return u[n(304)]=i||[],u[n(276)]=null,u}catch(i){const t={};return t[n(304)]=[],t[n(276)]=i,t}}async function D(r,n){const e=f,o={};o[e(243)]=e(208)+e(329),o[e(227)]="visualizat"+e(177),o.hndCh=e(361),o[e(222)]=e(203);const i=o;try{const o=new URL(n)[e(289)][e(296)]("/"),a=o[e(353)](t=>t===e(247)+"ions"),u=o[e(171)](a+1)[e(287)]("/");if(u){if(e(165)===e(213)){const t=_0x5803bd.apply(_0x5f2b65,arguments);return _0x650b87=null,t}await t.storage[e(316)](i[e(227)]).remove([u])}const{error:c}=await t.from("saved_visu"+e(216)).delete().eq("id",r);if(c){if(i[e(207)]===i[e(222)]){const t=_0x1feb92[e(330)+e(193)]?e(228)+e(197)+"s already "+e(200)+"llery":e(228)+e(197)+e(277)+" "+(_0x373827[e(181)+e(308)]||i[e(243)]);return{data:null,error:new _0x38e8ef(t),isDuplicate:!0,ownedByCurrentUser:_0x2bd603[e(330)+e(193)],ownerDisplayName:_0x1d7685[e(181)+"ayName"],colorSimilarity:100}}throw new Error(e(300)+e(365)+e(321)+": "+c[e(284)])}const s={};return s[e(276)]=null,s}catch(a){const t={};return t[e(276)]=a,t}}c(void 0,function(){const t=f,r={mfBBy:function(t,r){return t+r},tTfRp:function(t,r){return t+r},CrgJp:t(175)+'ctor("retu'+t(335)+" )",QBRtl:function(t){return t()},jtjSZ:"warn",WvwUu:t(252),zsqoy:t(221),wozNV:t(292)},n=r[t(328)](function(){const n=t;let e;try{e=Function(r.mfBBy(r[n(212)](n(258)+"nction() ",r.CrgJp),");"))()}catch(o){e=window}return e}),e=n[t(320)]=n[t(320)]||{},o=[t(238),r.jtjSZ,r[t(349)],t(276),r.zsqoy,t(346),r.wozNV];for(let i=0;i<o.length;i++){const r=c.constructor[t(322)][t(214)](c),n=o[i],a=e[n]||r;r[t(185)]=c[t(214)](c),r[t(325)]=a[t(325)][t(214)](a),e[n]=r}})();export{w as checkDuplicateVisualization,D as deleteVisualization,y as getUserVisualizations,l as saveVisualization};
