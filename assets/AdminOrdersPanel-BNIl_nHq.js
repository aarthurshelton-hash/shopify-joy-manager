const e='import React, { useState } from \'react\';\nimport { useQuery } from \'@tanstack/react-query\';\nimport { \n  ShoppingBag,\n  Printer,\n  BookOpen,\n  ArrowRightLeft,\n  Crown,\n  Calendar,\n  DollarSign,\n  TrendingUp,\n  Filter,\n  Download,\n  Eye,\n} from \'lucide-react\';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \'@/components/ui/card\';\nimport { Badge } from \'@/components/ui/badge\';\nimport { ScrollArea } from \'@/components/ui/scroll-area\';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \'@/components/ui/select\';\nimport { supabase } from \'@/integrations/supabase/client\';\nimport { format, subDays, startOfDay } from \'date-fns\';\n\nexport const AdminOrdersPanel: React.FC = () => {\n  const [orderType, setOrderType] = useState<string>(\'all\');\n  const [dateRange, setDateRange] = useState<string>(\'30\');\n\n  // Fetch orders with filters\n  const { data: orders, isLoading } = useQuery({\n    queryKey: [\'admin-orders\', orderType, dateRange],\n    queryFn: async () => {\n      const startDate = startOfDay(subDays(new Date(), parseInt(dateRange)));\n      \n      let query = supabase\n        .from(\'order_financials\')\n        .select(\'*\')\n        .gte(\'created_at\', startDate.toISOString())\n        .order(\'created_at\', { ascending: false });\n\n      if (orderType !== \'all\') {\n        query = query.eq(\'order_type\', orderType);\n      }\n\n      const { data, error } = await query;\n      if (error) throw error;\n      return data || [];\n    },\n    staleTime: 30000,\n  });\n\n  // Calculate summary stats\n  const stats = {\n    totalOrders: orders?.length || 0,\n    totalRevenue: orders?.reduce((sum, o) => sum + (o.gross_revenue_cents || 0), 0) || 0,\n    netRevenue: orders?.reduce((sum, o) => sum + (o.net_revenue_cents || 0), 0) || 0,\n    totalRoyalties: orders?.reduce((sum, o) => sum + (o.creator_royalty_cents || 0), 0) || 0,\n    byType: {\n      print: orders?.filter(o => o.order_type === \'print\').length || 0,\n      book: orders?.filter(o => o.order_type === \'book\').length || 0,\n      subscription: orders?.filter(o => o.order_type === \'subscription\').length || 0,\n      marketplace: orders?.filter(o => o.order_type === \'marketplace\').length || 0,\n    },\n  };\n\n  const formatCents = (cents: number) => `$${(cents / 100).toFixed(2)}`;\n\n  const getOrderIcon = (type: string) => {\n    switch (type) {\n      case \'print\': return <Printer className="h-4 w-4" />;\n      case \'book\': return <BookOpen className="h-4 w-4" />;\n      case \'subscription\': return <Crown className="h-4 w-4" />;\n      case \'marketplace\': return <ArrowRightLeft className="h-4 w-4" />;\n      default: return <ShoppingBag className="h-4 w-4" />;\n    }\n  };\n\n  const getOrderColor = (type: string) => {\n    switch (type) {\n      case \'print\': return \'bg-blue-500/10 text-blue-600 border-blue-500/30\';\n      case \'book\': return \'bg-purple-500/10 text-purple-600 border-purple-500/30\';\n      case \'subscription\': return \'bg-primary/10 text-primary border-primary/30\';\n      case \'marketplace\': return \'bg-green-500/10 text-green-600 border-green-500/30\';\n      default: return \'bg-muted text-muted-foreground\';\n    }\n  };\n\n  return (\n    <div className="space-y-6">\n      {/* Stats Row */}\n      <div className="grid grid-cols-2 md:grid-cols-5 gap-4">\n        <Card>\n          <CardContent className="pt-4 pb-3">\n            <div className="flex items-center gap-2 text-muted-foreground mb-1">\n              <ShoppingBag className="h-3 w-3" />\n              <span className="text-xs">Total Orders</span>\n            </div>\n            <p className="text-xl font-bold">{stats.totalOrders}</p>\n          </CardContent>\n        </Card>\n\n        <Card className="border-green-500/30 bg-gradient-to-br from-green-500/5 to-green-500/10">\n          <CardContent className="pt-4 pb-3">\n            <div className="flex items-center gap-2 text-muted-foreground mb-1">\n              <DollarSign className="h-3 w-3" />\n              <span className="text-xs">Gross Revenue</span>\n            </div>\n            <p className="text-xl font-bold text-green-500">{formatCents(stats.totalRevenue)}</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className="pt-4 pb-3">\n            <div className="flex items-center gap-2 text-muted-foreground mb-1">\n              <TrendingUp className="h-3 w-3" />\n              <span className="text-xs">Net Revenue</span>\n            </div>\n            <p className="text-xl font-bold">{formatCents(stats.netRevenue)}</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className="pt-4 pb-3">\n            <div className="flex items-center gap-2 text-muted-foreground mb-1">\n              <Crown className="h-3 w-3" />\n              <span className="text-xs">Creator Royalties</span>\n            </div>\n            <p className="text-xl font-bold text-primary">{formatCents(stats.totalRoyalties)}</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className="pt-4 pb-3">\n            <div className="flex items-center gap-2 text-muted-foreground mb-1">\n              <Printer className="h-3 w-3" />\n              <span className="text-xs">Print Orders</span>\n            </div>\n            <p className="text-xl font-bold">{stats.byType.print}</p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Filters */}\n      <div className="flex gap-4">\n        <Select value={orderType} onValueChange={setOrderType}>\n          <SelectTrigger className="w-48">\n            <SelectValue placeholder="Order Type" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value="all">All Orders</SelectItem>\n            <SelectItem value="print">Print Orders</SelectItem>\n            <SelectItem value="book">Book Orders</SelectItem>\n            <SelectItem value="subscription">Subscriptions</SelectItem>\n            <SelectItem value="marketplace">Marketplace</SelectItem>\n          </SelectContent>\n        </Select>\n\n        <Select value={dateRange} onValueChange={setDateRange}>\n          <SelectTrigger className="w-48">\n            <SelectValue placeholder="Date Range" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value="7">Last 7 Days</SelectItem>\n            <SelectItem value="30">Last 30 Days</SelectItem>\n            <SelectItem value="90">Last 90 Days</SelectItem>\n            <SelectItem value="365">Last Year</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n\n      {/* Orders List */}\n      <Card>\n        <CardHeader>\n          <CardTitle className="flex items-center gap-2">\n            <ShoppingBag className="h-5 w-5" />\n            Order Log\n          </CardTitle>\n          <CardDescription>\n            Complete order history with financial breakdown\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className="flex items-center justify-center py-12">\n              <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary" />\n            </div>\n          ) : (\n            <ScrollArea className="h-[500px]">\n              <div className="space-y-2">\n                {orders?.map((order) => (\n                  <div\n                    key={order.id}\n                    className="flex items-center justify-between p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors"\n                  >\n                    <div className="flex items-center gap-4">\n                      <Badge variant="outline" className={getOrderColor(order.order_type)}>\n                        {getOrderIcon(order.order_type)}\n                        <span className="ml-1 capitalize">{order.order_type}</span>\n                      </Badge>\n\n                      <div>\n                        <p className="font-medium">\n                          {order.order_reference || `Order #${order.id.slice(0, 8)}`}\n                        </p>\n                        <p className="text-sm text-muted-foreground flex items-center gap-1">\n                          <Calendar className="h-3 w-3" />\n                          {format(new Date(order.created_at), \'MMM d, yyyy h:mm a\')}\n                        </p>\n                      </div>\n                    </div>\n\n                    <div className="flex items-center gap-6 text-right">\n                      <div>\n                        <p className="text-xs text-muted-foreground">Gross</p>\n                        <p className="font-medium text-green-500">{formatCents(order.gross_revenue_cents)}</p>\n                      </div>\n                      <div>\n                        <p className="text-xs text-muted-foreground">Fees</p>\n                        <p className="font-medium text-red-500">-{formatCents(order.platform_fees_cents)}</p>\n                      </div>\n                      <div>\n                        <p className="text-xs text-muted-foreground">Costs</p>\n                        <p className="font-medium text-red-500">-{formatCents(order.fulfillment_costs_cents)}</p>\n                      </div>\n                      <div>\n                        <p className="text-xs text-muted-foreground">Royalty</p>\n                        <p className="font-medium text-primary">{formatCents(order.creator_royalty_cents)}</p>\n                      </div>\n                      <div>\n                        <p className="text-xs text-muted-foreground">Net</p>\n                        <p className="font-bold">{formatCents(order.net_revenue_cents)}</p>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n\n                {orders?.length === 0 && (\n                  <div className="text-center py-12 text-muted-foreground">\n                    <ShoppingBag className="h-12 w-12 mx-auto mb-4 opacity-50" />\n                    <p>No orders found for the selected filters</p>\n                  </div>\n                )}\n              </div>\n            </ScrollArea>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n';export{e as default};
