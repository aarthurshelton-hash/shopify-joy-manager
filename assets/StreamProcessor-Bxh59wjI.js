const n="/**\n * En Pensent Core SDK - Stream Processor\n */\n\nimport { TemporalSignature, DomainAdapter } from '../types';\nimport { BatchInput, BatchResult } from './types';\nimport { BatchProcessor } from './BatchProcessor';\n\n/**\n * Stream processor for processing items as they arrive\n */\nexport class StreamProcessor<TInput, TState> {\n  private adapter: DomainAdapter<TInput, TState>;\n  private buffer: BatchInput<TInput>[] = [];\n  private bufferSize: number;\n  private flushInterval: number;\n  private flushTimer?: ReturnType<typeof setTimeout>;\n  private onFlush?: (results: BatchResult<TemporalSignature>[]) => void;\n\n  constructor(\n    adapter: DomainAdapter<TInput, TState>,\n    options: {\n      bufferSize?: number;\n      flushIntervalMs?: number;\n      onFlush?: (results: BatchResult<TemporalSignature>[]) => void;\n    } = {}\n  ) {\n    this.adapter = adapter;\n    this.bufferSize = options.bufferSize ?? 10;\n    this.flushInterval = options.flushIntervalMs ?? 1000;\n    this.onFlush = options.onFlush;\n  }\n\n  /**\n   * Add an item to the stream\n   */\n  push(input: BatchInput<TInput>): void {\n    this.buffer.push(input);\n\n    if (this.buffer.length >= this.bufferSize) {\n      this.flush();\n    } else {\n      this.scheduleFlush();\n    }\n  }\n\n  /**\n   * Schedule a flush after the interval\n   */\n  private scheduleFlush(): void {\n    if (this.flushTimer) return;\n    \n    this.flushTimer = setTimeout(() => {\n      this.flush();\n    }, this.flushInterval);\n  }\n\n  /**\n   * Flush the buffer\n   */\n  async flush(): Promise<BatchResult<TemporalSignature>[]> {\n    if (this.flushTimer) {\n      clearTimeout(this.flushTimer);\n      this.flushTimer = undefined;\n    }\n\n    if (this.buffer.length === 0) {\n      return [];\n    }\n\n    const items = [...this.buffer];\n    this.buffer = [];\n\n    const processor = new BatchProcessor(this.adapter, { concurrency: 3 });\n    const results = await processor.processBatch(items);\n\n    this.onFlush?.(results);\n    return results;\n  }\n\n  /**\n   * Close the stream and flush remaining items\n   */\n  async close(): Promise<BatchResult<TemporalSignature>[]> {\n    return this.flush();\n  }\n}\n";export{n as default};
