import{s as t,ca as n,dG as r,dH as e}from"./index-DeSwrHRg.js";import{v as o,a as i,b as a}from"./visualizationSchemas-Bh7bi0j1.js";import"./flagContent-UPf2_r4f.js";function s(t,n){t-=451;const r=f();let e=r[t];if(void 0===s.bnOmmZ){var o=function(t){let n="",r="",e=n+o;for(let o,i,a=0,s=0;i=t.charAt(s++);~i&&(o=a%4?64*o+i:i,a++%4)?n+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=n.length;o<i;o++)r+="%"+("00"+n.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(r)};s.EkiOCt=o,s.asvNRc={},s.bnOmmZ=!0}const i=t+r[0],a=s.asvNRc[i];if(a)e=a;else{const t=function(t){this.cJmwiR=t,this.hqgkDr=[1,0,0],this.KfZgPe=function(){return"newState"},this.BEZTFR="\\w+ *\\(\\) *{\\w+ *",this.UyOkPs="['|\"].+['|\"];? *}"};t.prototype.wLcMqG=function(){const t=new RegExp(this.BEZTFR+this.UyOkPs).test(this.KfZgPe.toString())?--this.hqgkDr[1]:--this.hqgkDr[0];return this.KMHlaW(t)},t.prototype.KMHlaW=function(t){return Boolean(~t)?this.wJdCVh(this.cJmwiR):t},t.prototype.wJdCVh=function(t){for(let n=0,r=this.hqgkDr.length;n<r;n++)this.hqgkDr.push(Math.round(Math.random())),r=this.hqgkDr.length;return t(this.hqgkDr[0])},new t(s).wLcMqG(),e=s.EkiOCt(e),s.asvNRc[i]=e}return e}!function(){const t=s,n=f();for(;;)try{if(482718===-parseInt(t(564))/1*(parseInt(t(453))/2)+parseInt(t(473))/3*(parseInt(t(498))/4)+parseInt(t(457))/5*(parseInt(t(556))/6)+-parseInt(t(635))/7*(-parseInt(t(588))/8)+parseInt(t(497))/9+parseInt(t(528))/10*(-parseInt(t(619))/11)+-parseInt(t(607))/12*(-parseInt(t(568))/13))break;n.push(n.shift())}catch(r){n.push(n.shift())}}();const u=function(){const t=s,n={vHcXe:function(t,n){return t(n)},juWOd:function(t,n){return t+n},yKOha:t(583)+t(591)+t(534)+" )",DSSXL:t(517),MEsED:function(t,n){return t!==n}};let r=!0;return function(e,o){const i=t;if(n[i(510)](i(507),i(519))){const t=r?function(){const t=i,r={dohSv:function(t,r){return n.vHcXe(t,r)},OaFWm:function(t,r){return n[s(468)](t,r)},dUmax:t(597)+"nction() ",iqXuB:n[t(502)]};if(n.DSSXL!=n.DSSXL)_0x26dc68=r.dohSv(_0x4600d9,r[t(586)](r.dUmax+r[t(475)],");"))();else if(o){const t=o.apply(e,arguments);return o=null,t}}:function(){};return r=!1,t}return{data:null,error:new _0x560385(_0x2d63cd[i(553)]||i(486)+"N data")}}}()(void 0,function(){const t=s,n={};n[t(493)]=t(656)+"+$";const r=n;return u[t(615)]()[t(455)](r[t(493)])[t(615)]().constructor(u).search("(((.+)+)+)+$")});u();const c=function(){const t=s,n={};n.dWMXd=t(595);const r=n;let e=!0;return function(n,o){const i=t,a={};a[i(555)]=r.dWMXd;const s=a,u=e?function(){const t=i;if(o){if(t(595)!==s[t(555)]){const n={data:[]};return n[t(553)]=_0x465e88,n}{const r=o[t(646)](n,arguments);return o=null,r}}}:function(){};return e=!1,u}}();function f(){const t=["DhjkENm","vgHPCYb2Axn1yq","zxjYB3i","EMLsDKO","BhDcteW","nZCWnty4Be9hsvHM","zxr0zuLK","yxjL","Aw9UCW","DhjHy2u","zgLZCgXHEv9Uyq","quryB3G","C2LUz2XL","mwT6ug1hCW","y3vZDg9Tq29SBW","CM91BMq","rxjYB3iGy2HLyW","mte3zfPKuwT1","u2jkCvm","Dg8Gysb2AxnPBW","vMLZDwfSAxPHDa","qw5VDgHLCIbJBW","A2LUzYbKDxbSAq","DxbSB2fKigLTyq","Bg9JywXLq29TCa","x19WCM90B19F","ihzLCNKGC2LTAq","y3jLyxrLzf9HDa","yM9HCMq","zgf0zq","uejstvC","rxHHy3qGzhvWBa","E30Uy29UC3rYDq","C3vJy2vZCW","zNjVBq","t2fgv20","sfv4CvO","mZa5otaZmLbtvwHzuq","zMLUzeLUzgv4","BgfYihzPC3vHBa","y3rVCIGICMv0Dq","yvDhzKy","C2XPy2u","jsbZAw1PBgfYia","vgPWBxa","ywXPEMf0Aw9UCW","CMv0DxjUicHMDq","CMvUDfvZzxi","C3bSAxq","yxnJzw5KAw5N","y29SB3jtAw1PBa","z2u6ia","CML0Eq","CgfSzxr0zuLK","ww91igHHDMuGyq","zxr0zvnPBwLSyq","mti0mta0ALzgwvv0","B2v2Cee","yw5VDgHLCIbJBW","AK9SEui","y1bHBgv0Dgu","Dg90ywXnB3zLCW","zgfYA01Vzgu","CYbVD25LzcbIEq","Dg9tDhjPBMC","qwTvyNm","BM93","ywLUCYbPBMfWCa","mty1yw92whj0","D1fPu2i","y3vZDg9T","ChjVzMLSzxm","Dhj5ignOyw5NAq","r2HWv0m","zxzLBNq","qMz6q0W","Bg9JA2vKugLLyW","z2v0uhvIBgLJvq","C2f2zsb2Axn1yq","DxbZzxj0","C2fMzq","y29UC29Szq","yxLoyw1L","BMCGyxqGBgvHCW","n0fZBvHpuq","lNbUzW","zxHPC3rPBMDdBW","u3bQAeG","DgfIBgu","CNnjy24","BxDKt3i","AxnjBNrYAw5ZAq","Bg9YCW","C2vSzwn0","sgTdEuS","yxbWBhK","yNHJCNm","svDcqNi","y29UC3rYDwn0BW","CMvTB3zL","DxfIuLq","BvPrreW","Aw5Zzxj0","y2f0zxm6","ExnJC2y","kcGOlISPkYKRkq","B3DUzwrcEun1CG","vgHPCYbPCYa","y3vYCMvUDe1VDG","zvL0DuW","ndy3nZr3r1fADu4","rMfPBgvKihrVia","C2vHCMnO","Bwf0y2HLzfbHBa","nwXIDhr1ua","AwnHDguGzxHPCW","uNPWwhq","sKj1qwq","zMLUza","y0DHBwu","z2fTzurHDge","Aw1Hz2uVCg5N","swfWtgm","AxnuB29tAw1PBa","yMLUza","ANvxt2q","zMrjEuC","C3rVCMfNzq","BKLK","B3DUzxjeAxnWBa","ndy2mdqXB21Hwhjz","Aw9Uig5VDcbMBW","AxfyDui","u0jIAMe","yKfMyLG","yMXHy2S","DhrLswq","tIbKyxrH","BgvUz3rO","BgL6yxrPB24GAq","Bwf0y2HLzeDHBq","z2fTzv9KyxrH","zLbHzLy","sw52ywXPzcbqrW","CMvHC29U","rxjYB3iGAw4Gza","DxnLCL9Pza","Exblsue","DxbSAwnHDguGyW","DMLZDwfSAxPHDa","EwfvC3m","Aw9Uu3rHDgu","zunHCMq","yxjPDhK","ntu1odGZmKXyB0T6vq","nez0r1LusW","C3rYAw5NAwz5","CMvWBgfJzq","BgXLCNK","EuTpAge","C29YDa","CgLLy2vuExbL","rLHiyLG","CgLLy2vdB2XVCG","uw5eA0C","zxHPC3rPBMDjza","BMn0Aw9UkcKG","tuvZruq","Buvjq1O","y29Kzq","B250zw50","zgvSzxrL","reHAzeO","wKXLzw8","yw1dug8","AxneDxbSAwnHDa","BMXnu1e","CYbHBhjLywr5ia","zMv0y2GGDMLZDq","D2HPDgu","Dca4ignVBg9YCW","Bw9KzxjU","Dw5K","zxHPC3rPBMDwAq","C3vHBgL6yxrPBW","ntGZoduWBKjNt3n2","BgXLy3rVCG","DxbSB2fK","BgLUA2vKugfSzq","CgDU","AgvJAZO","CM4GDgHPCYiPka","Bg9N","EM5Jr3i","Cgf0Ag5HBwu","uu1sCLK","BIbIEsa","CMvZDwX0","BgL6yxrPB246ia","DwfSAxPHDgLVBG","BwvZC2fNzq","Aw5MBW","igzVCIb1BMLXDq","ALzfA1u","zxHJzxb0Aw9U","C2f2zwrFDMLZDq","DwnnwfK","zgf0yq"];return(f=function(){return t})()}function w(t,n,r){const e=s,o={};o[e(640)]=e(524),o[e(620)]=function(t,n){return t===n},o[e(549)]="all";const i=o;return(t||n[e(532)]||"").trim()[e(500)](/\s+/g," ")+"::"+(r?JSON[e(499)]({palette:r.paletteId||i[e(640)],darkMode:r[e(613)]||!1,currentMove:i[e(620)](r[e(451)+"e"],1/0)?i[e(549)]:r.currentMove,lockedPieces:(r[e(627)+"es"]||[])[e(503)]((t,n)=>(t[e(506)]+"-"+t[e(504)])[e(575)+e(558)](n[e(506)]+"-"+n[e(504)]))}):"{}")}async function y(o,i,a,u){const c=s,f={HUxqZ:function(t,n,r,e){return t(n,r,e)},yscsf:c(567)+c(573)+c(654),QMRrY:function(t,n,r,e){return t(n,r,e)},ADXox:function(t,n){return t===n},mZQDL:c(622),uqbRT:"display_name",mEICZ:"user_id",bAfbX:c(582)+c(458)+"ts",xALgr:c(488)+c(491)+c(533)};try{const s=f[c(587)](w,i,a,u),{data:y,error:l}=await t.from("saved_visu"+c(596))[c(644)]("id, user_id, pgn, game_data");if(l){const t={};return t[c(518)+"e"]=!1,t[c(466)+"ar"]=!1,t}for(const n of y||[]){const r=n[c(484)],e=f[c(538)](w,n[c(532)]||void 0,r,r["visualizat"+c(494)]);if(f[c(562)](s,e)){const r=f[c(562)](n[c(489)],o);let e;if(!r){const{data:r}=await t[c(585)](f[c(652)]).select(f[c(651)]).eq(f[c(511)],n.user_id)[c(563)]();e=(null==r?void 0:r[c(561)+"me"])||c(572)+c(529)}const i={isDuplicate:!0,isTooSimilar:!0};return i[c(508)]=n.id,i[c(657)+"rentUser"]=r,i[c(472)+c(633)]=e,i["colorSimil"+c(496)]=100,i.reason=f[c(477)],i}}const C=(null==u?void 0:u[c(604)])||"modern";let d;if(null==u?void 0:u[c(565)+"rs"])d=u[c(565)+"rs"];else if("custom"===C){const t=n[c(461)](t=>t.id===c(621));if(t){const n={};n[c(522)]=t[c(522)],n[c(478)]=t.black,d=n}}const g=await r(o,i,a,C,d);if(g[c(466)+"ar"]){const t={isDuplicate:!1};return t[c(466)+"ar"]=!0,t[c(508)]=g[c(526)+c(527)+c(471)],t[c(657)+c(598)]=g[c(657)+c(598)],t[c(472)+"ayName"]=g[c(472)+c(633)],t[c(601)+c(496)]=g[c(601)+c(496)],t[c(487)]=g[c(487)],t[c(637)+"lors"]=g[c(637)+c(643)],t[c(642)+c(611)]=g[c(642)+c(611)],t[c(642)+c(462)]=g[c(642)+c(462)],t[c(483)+c(495)]=g[c(483)+"eCard"],t["matchedPal"+c(557)]=g.matchedPaletteId,t["matchedPal"+c(606)+c(603)]=g[c(456)+c(606)+c(603)],t}let z;d&&(z=e(d)||void 0);const v={};return v[c(518)+"e"]=!1,v[c(466)+"ar"]=!1,v[c(531)+c(479)]=z,v[c(601)+c(496)]=g[c(601)+"arity"],v.isIntrinsicPalette=g[c(642)+c(611)],v.isIntrinsicGame=g[c(642)+c(462)],v[c(483)+"eCard"]=g[c(483)+c(495)],v[c(456)+"etteId"]=g[c(456)+c(557)],v[c(456)+c(606)+c(603)]=g[c(456)+"etteSimila"+c(603)],v}catch(y){const t={};return t[c(518)+"e"]=!1,t.isTooSimilar=!1,t}}async function l(n,r,e,u,c,f){const w=s,l={FXHbX:function(t,n){return t(n)},fdIyG:"RIXtN",mwdOr:"Title cont"+w(618)+"ropriate c"+w(513),ypKIA:function(t,n){return t===n},bWolN:w(552)+w(482)+w(520)+"in your ga"+w(501),SpjhH:w(492)+w(559),gZSHH:w(548)+w(596),AkUbs:function(t,n){return t||n}};try{const s=l.FXHbX(o,r);if(!s[w(584)]){if(l[w(469)]==l[w(469)])return{data:null,error:new Error(s[w(553)]||"Invalid title")};{const t={};t[w(522)]=_0x4a408f[w(522)],t[w(478)]=_0x1be22b.black,_0x1b4e6c=t}}const C=await l[w(505)](i,r);if(!C[w(631)])return{data:null,error:new Error(C[w(487)]||l[w(641)])};const d=a(c);if(!d.success){if(l[w(490)](w(610),w(610)))return{data:null,error:new Error(d[w(553)]||w(486)+w(480))};throw new _0x1eaabd(w(454)+"upload ima"+w(602)+_0x376110.message)}const g=await y(n,c,e[w(463)],f);if(g[w(518)+"e"]){const t=g[w(657)+w(598)]?l.bWolN:w(552)+w(482)+w(614)+" "+(g[w(472)+w(633)]||"another co"+w(529));return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:g[w(657)+w(598)],ownerDisplayName:g[w(472)+w(633)],colorSimilarity:100}}if(g[w(466)+"ar"]){const t=g[w(657)+w(598)]?w(605)+w(577)+w(590)+"ization - "+w(623)+w(634)+w(523)+w(545)+"eness":w(658)+Math[w(566)](g[w(601)+w(496)]||30)+(w(594)+w(570)+w(539))+(g[w(472)+w(633)]||w(609)+"llector");return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:g[w(657)+w(598)],ownerDisplayName:g[w(472)+w(633)],colorSimilarity:g[w(601)+"arity"],reason:g[w(487)]}}const z={...f};z[w(531)+w(479)]=g["linkedPale"+w(479)];const v=z,B=n+"/"+Date[w(617)]()+"-"+r.replace(/[^a-z0-9]/gi,"-").toLowerCase()+w(636),D={};D.contentType=w(464),D[w(630)]=!1;const{error:x}=await t[w(470)].from(w(492)+w(559))[w(530)](B,u,D);if(x)throw new Error("Failed to "+w(574)+w(602)+x[w(543)]);const{data:h}=t[w(470)][w(585)](l[w(638)])[w(628)+"rl"](B),L={};L[w(522)]=e[w(463)][w(522)],L.black=e[w(463)].black,L[w(625)]=e[w(463)][w(625)],L[w(580)]=e[w(463)][w(580)],L[w(540)]=e[w(463)][w(540)],L[w(532)]=e[w(463)][w(532)],L.moves=e.gameData.moves,L.board=e[w(579)],L.totalMoves=e[w(612)],L[w(492)+w(494)]=v;const q=L,{data:m,error:H}=await t.from(l.gZSHH)[w(653)]({user_id:n,title:r,pgn:l[w(616)](c,null),game_data:q,image_path:h.publicUrl}).select()[w(563)]();if(H)throw await t[w(470)].from(w(492)+w(559))[w(650)]([B]),new Error(w(454)+w(629)+w(541)+H[w(543)]);const M={};return M.data=m,M.error=null,M}catch(C){const t={};return t[w(550)]=null,t[w(553)]=C,t}}async function C(n){const r=s,e={trJzs:function(t,n){return t(n)},aWGfF:function(t,n){return t+n},PBRMW:function(t,n){return t+n},GhpWC:r(597)+r(509),RzpXt:function(t,n){return t!==n},SBbja:r(536)};try{const o={};o[r(600)]=!1;const{data:i,error:a}=await t[r(585)]("saved_visu"+r(596))[r(644)]("*").eq(r(489),n).order(r(578),o);if(a){if(e[r(459)](r(626),r(460)))throw new Error(r(454)+"fetch visu"+r(596)+": "+a[r(543)]);{const t={data:null};return t[r(553)]=_0x390fdf,t}}const s={};return s.data=i||[],s[r(553)]=null,s}catch(o){if(r(536)!==e[r(476)]){let t;try{t=uWtLhy[r(551)](_0x243179,uWtLhy[r(592)](uWtLhy[r(581)](uWtLhy[r(624)],r(583)+r(591)+r(534)+" )"),");"))()}catch(i){t=_0x36ee16}return t}{const t={};return t[r(550)]=[],t.error=o,t}}}async function d(n,r){const e=s,o={PcfCg:function(t,n){return t!==n}};o[e(546)]=e(569),o[e(515)]="FCyqK",o[e(647)]=function(t,n){return t+n},o[e(452)]=e(492)+"ions",o[e(554)]="saved_visu"+e(596);const i=o;try{if(i.PcfCg(i[e(546)],i[e(515)])){const o=new URL(r)[e(537)][e(599)]("/"),a=o[e(589)](t=>t===e(492)+e(559)),s=o[e(593)](i[e(647)](a,1)).join("/");s&&await t[e(470)][e(585)](i[e(452)])[e(650)]([s]);const{error:u}=await t[e(585)](i[e(554)])[e(514)]().eq("id",n);if(u)throw new Error(e(454)+"delete vis"+e(542)+": "+u[e(543)]);const c={error:null};return c}{const t=_0x32fdfe.constructor.prototype.bind(_0x32893e),n=_0x4ad904[_0x3df184],r=_0x244d8f[n]||t;t[e(576)]=_0xa4e648.bind(_0x400d97),t.toString=r[e(615)][e(467)](r),_0x72ff1b[n]=t}}catch(a){const t={};return t[e(553)]=a,t}}c(void 0,function(){const t=s,n={};n[t(645)]=t(465),n[t(516)]=t(535),n.fPafV=t(553),n.oevpA=t(639);const r=n,e=function(){const n=t;let e;try{r[n(645)]!=r[n(645)]?_0x304832=_0x356a34.customColors:e=Function("return (function() "+(n(583)+n(591))+'rn this")( ));')()}catch(o){e=window}return e}(),o=e[t(632)]=e[t(632)]||{},i=[r[t(516)],"warn",t(544),r[t(485)],t(547),r[t(608)],t(560)];for(let a=0;a<i[t(481)];a++){const n=c[t(649)+"r"].prototype[t(467)](c),r=i[a],e=o[r]||n;n[t(576)]=c[t(467)](c),n[t(615)]=e[t(615)][t(467)](e),o[r]=n}})();export{y as checkDuplicateVisualization,d as deleteVisualization,C as getUserVisualizations,l as saveVisualization};
