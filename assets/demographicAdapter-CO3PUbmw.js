const n="/**\n * Demographic & Generational Cycles Adapter\n * \n * Population pyramids, generational theory, demographic transition,\n * birth/death cycles, migration flows, age structure economics.\n * \n * For Alec Arthur Shelton - The Artist\n * Civilizations breathe through their populations.\n */\n\nimport type { DomainAdapter, UniversalSignal, DomainSignature } from '../types';\n\n// GENERATIONAL THEORY (Strauss-Howe)\nconst GENERATIONAL_CYCLES = {\n  cycleLength: '80-90 years (human lifespan)',\n  seasons: {\n    high: {\n      description: 'Post-crisis, institutions strong, individualism weak',\n      generations: ['Prophet (Idealist)', 'Nomad (Reactive)'],\n      characteristics: ['Consensus', 'Institutionalization', 'Pluralism'],\n      economic: 'Stability, growth, low volatility',\n      marketAnalogy: 'Bull market, low VIX, institutional dominance'\n    },\n    awakening: {\n      description: 'Institutions attacked, personal/spiritual autonomy rises',\n      generations: ['Nomad (Reactive)', 'Hero (Civic)'],\n      characteristics: ['Consciousness revolution', 'Personal expression', 'Religious upheaval'],\n      economic: 'Productivity gains, inflation, social unrest',\n      marketAnalogy: 'Growth to value rotation, volatility increase'\n    },\n    unraveling: {\n      description: 'Institutions weak, individualism strong',\n      generations: ['Hero (Civic)', 'Artist (Adaptive)'],\n      characteristics: ['Fragmentation', 'Cynicism', 'Diversity'],\n      economic: 'Inequality, debt buildup, asset bubbles',\n      marketAnalogy: 'Bubble formation, speculative excess'\n    },\n    crisis: {\n      description: 'Institutions collapse, rebuild collective foundation',\n      generations: ['Artist (Adaptive)', 'Prophet (Idealist)'],\n      characteristics: ['Secular upheaval', 'Civic unity', 'Total war/restructuring'],\n      economic: 'Depression, war economy, reset',\n      marketAnalogy: 'Crash, capitulation, new paradigm'\n    }\n  },\n  \n  currentPosition: 'Crisis era (2008-2030?)',\n  upcoming: 'High era (2030s-2050s)'\n};\n\n// DEMOGRAPHIC TRANSITION MODEL\nconst DEMOGRAPHIC_TRANSITION = {\n  stage1: {\n    name: 'Pre-industrial',\n    birthRate: 'High',\n    deathRate: 'High',\n    population: 'Stable/low growth',\n    examples: ['Historical societies', 'Remote tribes']\n  },\n  stage2: {\n    name: 'Early industrial',\n    birthRate: 'High',\n    deathRate: 'Falling',\n    population: 'Rapid growth',\n    examples: ['Sub-Saharan Africa today']\n  },\n  stage3: {\n    name: 'Late industrial',\n    birthRate: 'Falling',\n    deathRate: 'Low',\n    population: 'Growth slowing',\n    examples: ['India, Mexico, Brazil']\n  },\n  stage4: {\n    name: 'Post-industrial',\n    birthRate: 'Low',\n    deathRate: 'Low',\n    population: 'Stable/declining',\n    examples: ['Japan, Germany, Italy', 'China (approaching)']\n  },\n  stage5: {\n    name: 'Post-transition',\n    birthRate: 'Very low',\n    deathRate: 'Rising (aging)',\n    population: 'Declining',\n    examples: ['Projected future for developed nations']\n  }\n};\n\n// POPULATION PYRAMID SHAPES\nconst PYRAMID_TYPES = {\n  expanding: {\n    shape: 'True pyramid (wide base)',\n    meaning: 'High birth rates, young population',\n    challenges: 'Education, employment, infrastructure',\n    opportunities: 'Demographic dividend',\n    examples: ['Nigeria', 'Uganda']\n  },\n  stationary: {\n    shape: 'Bell (uniform distribution)',\n    meaning: 'Stable population, balanced ages',\n    challenges: 'Replacing workforce',\n    opportunities: 'Stable consumption patterns',\n    examples: ['US', 'Australia']\n  },\n  contracting: {\n    shape: 'Urn (narrow base, bulging top)',\n    meaning: 'Low birth rates, aging population',\n    challenges: 'Pension systems, healthcare, labor shortage',\n    opportunities: 'Automation, silver economy',\n    examples: ['Japan', 'Italy', 'South Korea']\n  }\n};\n\n// DEPENDENCY RATIOS\nconst DEPENDENCY_RATIOS = {\n  youth: {\n    formula: 'Population 0-14 / Population 15-64',\n    high: 'Burden on working age (education costs)',\n    low: 'Demographic dividend opportunity'\n  },\n  oldAge: {\n    formula: 'Population 65+ / Population 15-64',\n    high: 'Pension/healthcare burden',\n    critical: 'Old-age support ratio < 4:1 unsustainable'\n  },\n  total: {\n    formula: '(0-14 + 65+) / 15-64',\n    optimal: 'Low total dependency = economic growth window'\n  }\n};\n\n// GENERATIONAL ARCHETYPES\nconst GENERATIONAL_ARCHETYPES = {\n  prophets: {\n    birthYears: '1943-1960 (Baby Boomers)',\n    character: 'Visionary, values-driven, narcissistic',\n    lifeCycle: 'Enter during High, rebel during Awakening',\n    economicRole: 'Consumption peak, asset accumulation'\n  },\n  nomads: {\n    birthYears: '1961-1981 (Gen X)',\n    character: 'Pragmatic, survivors, cynical',\n    lifeCycle: 'Enter during Awakening, come of age in Unraveling',\n    economicRole: 'Scarce generation = labor market power'\n  },\n  heroes: {\n    birthYears: '1982-2004 (Millennials)',\n    character: 'Civic, institutional builders, team-oriented',\n    lifeCycle: 'Enter during Unraveling, come of age in Crisis',\n    economicRole: 'Delayed adulthood, high debt, delayed consumption'\n  },\n  artists: {\n    birthYears: '2005-2027 (Gen Z/Gen Alpha)',\n    character: 'Adaptive, sensitive, indecisive',\n    lifeCycle: 'Enter during Crisis, protected childhood',\n    economicRole: 'Smaller cohort = scarcity value'\n  }\n};\n\n// MIGRATION PATTERNS\nconst MIGRATION_DYNAMICS = {\n  leeModel: {\n    factors: ['Origin push', 'Destination pull', 'Intervening obstacles'],\n    selectivity: 'Young adults most likely to migrate'\n  },\n  \n  gravityModel: {\n    formula: 'Migration ~ (Population1 Ã— Population2) / Distance',\n    meaning: 'Larger, closer places exchange more migrants'\n  },\n  \n  transitionMigration: {\n    stage: 'Stage 2-3 of demographic transition',\n    pattern: 'Rural to urban, international labor migration',\n    remittances: 'Significant source of income for developing nations'\n  }\n};\n\ninterface DemographicEvent {\n  timestamp: number;\n  totalPopulation: number;\n  birthRate: number; // Per 1000\n  deathRate: number; // Per 1000\n  medianAge: number;\n  fertilityRate: number; // Children per woman\n  lifeExpectancy: number;\n  migrationNet: number; // Positive = inflow\n  workingAgePercent: number; // 15-64\n  dependencyRatio: number;\n  generationalPosition: number; // 0-1 through 80-year cycle\n}\n\nclass DemographicAdapter implements DomainAdapter<DemographicEvent> {\n  domain = 'soul' as const;\n  name = 'Demographic & Generational Cycles';\n  isActive = false;\n  lastUpdate = 0;\n  \n  private signalBuffer: UniversalSignal[] = [];\n  private readonly BUFFER_SIZE = 2000;\n  \n  async initialize(): Promise<void> {\n    this.isActive = true;\n    this.lastUpdate = Date.now();\n    console.log('[DemographicAdapter] Initialized - Population cycles flowing');\n  }\n  \n  processRawData(event: DemographicEvent): UniversalSignal {\n    const { timestamp, fertilityRate, medianAge, workingAgePercent, dependencyRatio, generationalPosition } = event;\n    \n    // Frequency encodes birth rate vitality\n    const frequency = fertilityRate / 3; // Normalize (2.1 = replacement)\n    \n    // Intensity = demographic stress (aging + dependency)\n    const agingStress = medianAge / 100;\n    const dependencyStress = dependencyRatio / 100;\n    const intensity = (agingStress + dependencyStress) / 2;\n    \n    // Phase encodes position in generational cycle\n    const phase = generationalPosition * Math.PI * 2;\n    \n    const harmonics = [\n      fertilityRate / 3,\n      workingAgePercent,\n      1 - (medianAge / 100),\n      event.migrationNet / 100000,\n      1 - (dependencyRatio / 100),\n      event.lifeExpectancy / 100\n    ];\n    \n    const signal: UniversalSignal = {\n      domain: 'soul',\n      timestamp,\n      intensity,\n      frequency,\n      phase,\n      harmonics,\n      rawData: [fertilityRate, medianAge, workingAgePercent, dependencyRatio, generationalPosition]\n    };\n    \n    this.signalBuffer.push(signal);\n    if (this.signalBuffer.length > this.BUFFER_SIZE) {\n      this.signalBuffer.shift();\n    }\n    \n    this.lastUpdate = timestamp;\n    return signal;\n  }\n  \n  extractSignature(signals: UniversalSignal[]): DomainSignature {\n    if (signals.length === 0) {\n      return this.getDefaultSignature();\n    }\n    \n    const recent = signals.slice(-100);\n    \n    const avgFertility = recent.reduce((sum, s) => sum + s.rawData[0], 0) / recent.length;\n    const avgAge = recent.reduce((sum, s) => sum + s.rawData[1], 0) / recent.length;\n    const avgWorking = recent.reduce((sum, s) => sum + s.rawData[2], 0) / recent.length;\n    const avgDependency = recent.reduce((sum, s) => sum + s.rawData[3], 0) / recent.length;\n    const avgGenPos = recent.reduce((sum, s) => sum + s.rawData[4], 0) / recent.length;\n    \n    const quadrantProfile = {\n      aggressive: avgFertility > 2.5 ? 0.8 : 0.2, // High growth\n      defensive: avgDependency > 50 ? 0.8 : 0.2, // High burden\n      tactical: avgAge > 40 ? 0.6 : 0.3, // Aging\n      strategic: avgWorking > 65 ? 0.8 : 0.3 // Demographic dividend\n    };\n    \n    const temporalFlow = {\n      early: avgGenPos < 0.25 ? 0.8 : 0.2, // High/Post-Crisis\n      mid: avgGenPos >= 0.25 && avgGenPos < 0.75 ? 0.7 : 0.2, // Awakening/Unraveling\n      late: avgGenPos >= 0.75 ? 0.8 : 0.2 // Crisis\n    };\n    \n    return {\n      domain: 'soul',\n      quadrantProfile,\n      temporalFlow,\n      intensity: avgDependency / 100,\n      momentum: avgFertility > 2.1 ? 1 : -1,\n      volatility: avgAge / 100,\n      dominantFrequency: avgFertility / 3,\n      harmonicResonance: avgWorking / 100,\n      phaseAlignment: avgGenPos,\n      extractedAt: Date.now()\n    };\n  }\n  \n  private getDefaultSignature(): DomainSignature {\n    return {\n      domain: 'soul',\n      quadrantProfile: { aggressive: 0.3, defensive: 0.4, tactical: 0.2, strategic: 0.1 },\n      temporalFlow: { early: 0.2, mid: 0.5, late: 0.3 },\n      intensity: 0.5,\n      momentum: 0,\n      volatility: 0.4,\n      dominantFrequency: 0.7,\n      harmonicResonance: 0.6,\n      phaseAlignment: 0.8,\n      extractedAt: Date.now()\n    };\n  }\n  \n  // Calculate demographic dividend window\n  calculateDividendWindow(workingAgePercent: number, dependencyRatio: number): {\n    inWindow: boolean;\n    yearsRemaining: number;\n  } {\n    const inWindow = workingAgePercent > 65 && dependencyRatio < 50;\n    // Simplified: assume 30-year window when entering\n    const yearsRemaining = inWindow ? Math.floor((65 - (100 - workingAgePercent)) * 2) : 0;\n    return { inWindow, yearsRemaining: Math.max(0, yearsRemaining) };\n  }\n  \n  // Identify current turnings season\n  identifyTurning(generationalPosition: number): keyof typeof GENERATIONAL_CYCLES['seasons'] {\n    if (generationalPosition < 0.25) return 'high';\n    if (generationalPosition < 0.50) return 'awakening';\n    if (generationalPosition < 0.75) return 'unraveling';\n    return 'crisis';\n  }\n  \n  // Project population\n  projectPopulation(\n    currentPop: number,\n    fertilityRate: number,\n    generations: number\n  ): number[] {\n    const projections: number[] = [currentPop];\n    let pop = currentPop;\n    \n    for (let i = 0; i < generations; i++) {\n      // Simplified: growth rate from fertility - replacement\n      const growthRate = (fertilityRate - 2.1) * 0.3;\n      pop = pop * (1 + growthRate / 100);\n      projections.push(pop);\n    }\n    \n    return projections;\n  }\n}\n\nexport const demographicAdapter = new DemographicAdapter();\nexport { GENERATIONAL_CYCLES, DEMOGRAPHIC_TRANSITION, PYRAMID_TYPES, DEPENDENCY_RATIOS, GENERATIONAL_ARCHETYPES, MIGRATION_DYNAMICS };\nexport type { DemographicEvent };\n";export{n as default};
