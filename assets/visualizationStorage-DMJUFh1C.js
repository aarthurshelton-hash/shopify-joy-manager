import{s as t,ca as n,dG as r,dH as e}from"./index-0PGTc9H0.js";import{v as i,a as o,b as s}from"./visualizationSchemas-COgNeJFb.js";import"./flagContent-Bf-cWMmq.js";!function(){const t=c,n=f();for(;;)try{if(361467===parseInt(t(321))/1*(-parseInt(t(208))/2)+-parseInt(t(310))/3+-parseInt(t(247))/4+-parseInt(t(174))/5+-parseInt(t(216))/6+-parseInt(t(127))/7+parseInt(t(196))/8)break;n.push(n.shift())}catch(r){n.push(n.shift())}}();const a=function(){const t=c,n={};n[t(209)]=function(t,n){return t!==n},n.sGuMb=t(200);const r=n;let e=!0;return function(t,n){const i={NvJiR:function(t,n){return r[c(209)](t,n)},dHpcA:r.sGuMb},o=e?function(){const r=c;if(n){if(i[r(143)](i[r(245)],"YnyYq")){const r=n.apply(t,arguments);return n=null,r}if(_0x5add7a){const t=_0x5ea2dd.apply(_0x1323a8,arguments);return _0x6ce916=null,t}}}:function(){};return e=!1,o}}()(void 0,function(){const t=c,n={};n[t(322)]="(((.+)+)+)+$";const r=n;return a.toString().search("(((.+)+)+)+$")[t(164)]()[t(152)+"r"](a)[t(206)](r.yvoKz)});a();const u=function(){const t={};t[c(253)]="icvCr";const n=t;let r=!0;return function(t,e){const i=function(t,n){return t(n)},o=r?function(){const r=c;if("icvCr"===n[r(253)]){if(e){const n=e[r(227)](t,arguments);return e=null,n}}else _0x317c8f=i(_0x4cadd9,_0x303338)||void 0}:function(){};return r=!1,o}}();function c(t,n){t-=117;const r=f();let e=r[t];if(void 0===c.iiueHL){var i=function(t){let n="",r="",e=n+i;for(let i,o,s=0,a=0;o=t.charAt(a++);~o&&(i=s%4?64*i+o:o,s++%4)?n+=e.charCodeAt(a+10)-10!=0?String.fromCharCode(255&i>>(-2*s&6)):s:0)o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(let i=0,o=n.length;i<o;i++)r+="%"+("00"+n.charCodeAt(i).toString(16)).slice(-2);return decodeURIComponent(r)};c.AYyGfb=i,c.xIdssz={},c.iiueHL=!0}const o=t+r[0],s=c.xIdssz[o];if(s)e=s;else{const t=function(t){this.hDwUTM=t,this.Hglwth=[1,0,0],this.ELFmJA=function(){return"newState"},this.gxidvi="\\w+ *\\(\\) *{\\w+ *",this.jCxUXn="['|\"].+['|\"];? *}"};t.prototype.eXkaLf=function(){const t=new RegExp(this.gxidvi+this.jCxUXn).test(this.ELFmJA.toString())?--this.Hglwth[1]:--this.Hglwth[0];return this.fIGKVw(t)},t.prototype.fIGKVw=function(t){return Boolean(~t)?this.aXHGbZ(this.hDwUTM):t},t.prototype.aXHGbZ=function(t){for(let n=0,r=this.Hglwth.length;n<r;n++)this.Hglwth.push(Math.round(Math.random())),r=this.Hglwth.length;return t(this.Hglwth[0])},new t(c).eXkaLf(),e=c.AYyGfb(e),c.xIdssz[o]=e}return e}function f(){const t=["Dca4ignVBg9YCW","zxHPC3rPBMDdBW","CerrBMu","Dw5K","yNrvywG","yw5VDgHLCIbJBW","uKHuBwm","Aw5MBW","y3jLyxrLzf9HDa","DhjPBq","CMvZDwX0","mJe5ndiXmdrvyLLitgq","rxHHy3qGzhvWBa","CML0Eq","vgHPCYb2Axn1yq","DNb1rwO","Bwf0y2HLzeDHBq","B0jPreq","AwnHDguGzxHPCW","Dg9mB3DLCKnHCW","ywXS","C2vHCMnO","Aw9UCW","mtyWmtrntLvfqM0","s0POwum","zxr0zvnPBwLSyq","DgfIBgu","CgDU","Dg90ywXnB3zLCW","BgXLy3rVCG","CgLTtu8","mZq0ntuZmhzxs25Mua","EKXSt2m","zgf0yq","BM93","z2fTzv9KyxrH","sw52ywXPzcbqrW","CMvHC29U","D2fYBG","Dg8Gysb2AxnPBW","DwfSAxPHDgLVBG","ueDsu1qXmty","yxbWBhK","yM9HCMq","BgvUz3rO","DxbSB2fK","yvr0Bu8","CgLLy2vdB2XVCG","BgfYihzPC3vHBa","C3vHBgL6yxrPBW","u3bABeS","CgLLy2vuExbL","x19WCM90B19F","CM9WCMLHDguGyW","y3vZDg9T","y29Kzq","yMXHy2S","vgHPCYbPCYa","AxnuB29tAw1PBa","AM9PBG","zeHWy0e","Aw4GEw91CIbNyq","mJCZnJK0neTRC2zqyW","C3rVCMfNzq","zxHPC3rPBMDjza","Aw5Zzxj0","zxzLBNq","uxrhEMO","vMfMDwW","DxbSB2fKigLTyq","ww91igHHDMuGyq","A2LUzYbKDxbSAq","C2fMzq","CM91BMq","zMLUzeLUzgv4","C2vSzwn0","Bw92zxm","AgvJAZO","DhjHy2u","wxb1q1y","sNvRBfi","CMv0DxjUicHMDq","vufjCMq","uvzsEhC","C3vJy2vZCW","DgL0Bgu","Bw9KzxjU","B3DUzxjeAxnWBa","zxr0zuLK","lNbUzW","AxnjBNrYAw5ZAq","y3vYCMvUDe1VDG","Bg9YCW","CYbVD25LzcbIEq","AwqSihvZzxjFAq","zw5LC3m","y1bHBgv0Dgu","uhjbrvC","igzVCIb1BMLXDq","rMfPBgvKihrVia","twXnCKq","ChjVzMLSzxm","Bg9JA2vKugLLyW","D2HPDgu","Cw1uDxm","BwvZC2fNzq","y2f0zxm6","BKLK","rxjYB3iGy2HLyW","yxjPDhK","zgvSzxrLihzPCW","ywLUCYbPBMfWCa","zxHJzxb0Aw9U","CgfSzxr0zuLK","CK9pt1a","sunuC1C","CM4GDgHPCYiPka","sxPVy0C","uM9fB0S","y3vZDg9Tq29SBW","Dvntsfy","DxbSAwnHDguGyW","zgLZCgXHEv9Uyq","rfLjrMO","AxneDxbSAwnHDa","otG4ntqYvKTOA2rZ","zwL5yw0","tuDyEwq","y29UDgvUDfr5Ca","ihzLCNKGC2LTAq","y29UC29Szq","B250zw50","DxbZzxj0","C2XPy2u","AxPHDgLVBIaTia","u1Dvwve","nLbHBg1iBG","ExzVs3O","C29YDa","q1bsuMm","BwzdtLa","Ae5lChC","DxnLCL9Pza","vMLZDwfSAxPHDa","BMn0Aw9UkcKG","E30Uy29UC3rYDq","yMLUza","wu55BNm","CNvVAMK","mZq5otGXmvn1yNrAAq","u0Dbthq","y1nozMS","zNjVBq","y0DHBwu","ChDUzgW","zvPtBK8","zgvSzxrL","DMLZDwfSAxPHDa","CMvWBgfJzq","zgf0zq","vgL0BguGy29UDa","BMCGyxqGBgvHCW","t3HAve4","zgfYA01Vzgu","Aw1Hz2vFCgf0Aa","tNzkAvi","zunHCMq","z2u6ia","DhrLswq","z1DgyNO","AwHxvvq","jsbZAw1PBgfYia","C3bSAxq","y29SB3jtAw1PBa","y29UC3rYDwn0BW","C2LUz2XL","CMnMB3u","y3rVCIGICMv0Dq","BgLUA2vKugfSzq","C2f2zwrFDMLZDq","zxHPC3rPBMDwAq","BgXLCNK","ywXPEMf0Aw9UoG","uwD5u2q","ywXPEMf0Aw9UCW","Bwf0y2HLzfbHBa","Dg9tDhjPBMC","BMHMshe","CMvTB3zL","Aw9Uig5VDcbMBW","zxjYB3i","BuHgCNK","u3Lhs1y","CMvUDfvZzxi","yxjL","yxLoyw1L","mtiYnJm4mhvYDvLJzq","BgL6yxrPB24GAq","zMv0y2GGDMLZDq","rxjYB3iGAw4Gza","CM9fDfi","CYbHBhjLywr5ia","B3DUzwrcEun1CG","z2fTzurHDge","yur0t2i","tIbKyxrH","qK9QtNq"];return(f=function(){return t})()}function l(t,n,r){const e=c,i={};i[e(125)]="modern",i[e(308)]=function(t,n){return t===n},i.eZSnO=e(205);const o=i;return(t||n[e(212)]||"")[e(194)]()[e(136)](/\s+/g," ")+"::"+(r?JSON.stringify({palette:r[e(298)]||o[e(125)],darkMode:r[e(141)]||!1,currentMove:o[e(308)](r[e(276)+"e"],1/0)?o[e(133)]:r[e(276)+"e"],lockedPieces:(r[e(287)+"es"]||[])[e(323)]((t,n)=>(t[e(232)]+"-"+t[e(236)])["localeComp"+e(172)](n.pieceColor+"-"+n[e(236)]))}):"{}")}async function w(i,o,s,a){const u=c,f={ihWUT:"saved_visu"+u(162),pDNVk:u(279)+"d, pgn, game_data",qmTus:u(293)+u(256)+u(291),aDtOb:function(t,n,r,e){return t(n,r,e)},eiyam:"beKxO",SpZlK:u(305),RoEoK:u(307)+"me",zpYEb:u(120),zLlOc:"Another co"+u(214),SGALt:u(197)+u(203)+"ts",pimMO:function(t,n){return t===n},QVRxw:"MgVeJ",QtGzj:u(165),lbtAm:function(t,n,r,e,i,o){return t(n,r,e,i,o)},SsMxK:function(t,n){return t(n)},zXYPH:u(177)+u(306)+u(262)};try{const c=l(o,s,a),{data:w,error:C}=await t[u(130)](f[u(148)])[u(260)](f.pDNVk);if(C){const t={};return t[u(309)+"e"]=!1,t[u(243)+"ar"]=!1,t}for(const n of w||[]){const r=n[u(220)];if(c===f[u(182)](l,n[u(212)]||void 0,r,r[u(135)+"ionState"])){if(f[u(311)]===f[u(235)]){const t=_0x59283f?function(){if(_0x445e11){const t=_0x4f6b17[u(227)](_0x48a423,arguments);return _0x304f74=null,t}}:function(){};return _0x75ff51=!1,t}{const r=n.user_id===i;let e;if(!r){const{data:r}=await t.from(u(286))[u(260)](f[u(303)]).eq(f.zpYEb,n[u(120)]).single();e=(null==r?void 0:r[u(307)+"me"])||f[u(217)]}const o={};return o[u(309)+"e"]=!0,o[u(243)+"ar"]=!0,o.existingId=n.id,o[u(180)+"rentUser"]=r,o[u(272)+u(173)]=e,o[u(151)+u(294)]=100,o.reason=f[u(128)],o}}}const x=(null==a?void 0:a[u(298)])||u(271);let y;if(null==a?void 0:a[u(304)+"rs"])y=a.customColors;else if(f[u(215)](x,u(239))){const t=n.find(t=>"custom"===t.id);if(t)if(f[u(268)]!==f[u(252)]){const n={};n[u(288)]=t[u(288)],n[u(241)]=t[u(241)],y=n}else _0x3c87ef=_0x3dc6e3.customColors}const g=await f.lbtAm(r,i,o,s,x,y);if(g.isTooSimilar){const t={isDuplicate:!1,isTooSimilar:!0};return t[u(249)]=g[u(158)+"sualizatio"+u(292)],t[u(180)+u(171)]=g[u(180)+u(171)],t["ownerDispl"+u(173)]=g["ownerDispl"+u(173)],t[u(151)+u(294)]=g[u(151)+"arity"],t[u(222)]=g[u(222)],t[u(186)+u(277)]=g[u(186)+u(277)],t[u(275)+"cPalette"]=g["isIntrinsi"+u(281)],t.isIntrinsicGame=g.isIntrinsicGame,t[u(201)+u(144)]=g[u(201)+u(144)],t[u(163)+u(273)]=g[u(163)+"etteId"],t[u(163)+u(210)+u(198)]=g[u(163)+u(210)+u(198)],t}let z;y&&(z=f.SsMxK(e,y)||void 0);const D={};return D[u(309)+"e"]=!1,D.isTooSimilar=!1,D[u(156)+u(146)]=z,D[u(151)+u(294)]=g[u(151)+u(294)],D[u(275)+u(281)]=g["isIntrinsi"+u(281)],D[u(275)+u(131)]=g[u(275)+u(131)],D[u(201)+"eCard"]=g[u(201)+u(144)],D[u(163)+"etteId"]=g[u(163)+"etteId"],D["matchedPal"+u(210)+u(198)]=g[u(163)+u(210)+"rity"],D}catch(w){const t={isDuplicate:!1};return t[u(243)+"ar"]=!1,t}}async function C(n,r,e,a,u,f){const l=c,C={rcfou:l(123)+l(155)+l(301)+" )",YpuCV:function(t,n){return t===n},hlynx:"YFyYH",BOjNt:l(117),UAIrd:"dXgOk",hNKpw:function(t,n){return t(n)},roEtR:l(132),SWUYQ:l(221)+l(183),IzocG:function(t,n,r,e,i){return t(n,r,e,i)},JuklR:l(231),cCoUm:l(199)+"lization i"+l(179)+l(246)+l(159),MGXyd:l(190)+"llector",gokoM:"image/png",rOOOP:l(135)+"ions"};try{if(C[l(264)](C.hlynx,l(202))){const t={};return t[l(218)]=null,t[l(168)]=_0x3d4df7,t}{const c=i(r);if(!c[l(269)]){if(C[l(184)]!==C[l(267)])return{data:null,error:new Error(c[l(168)]||"Invalid title")};{const t=_0x2b32c3?function(){if(_0x5a7f39){const t=_0x5c6f47[l(227)](_0x3acdf1,arguments);return _0x4498d9=null,t}}:function(){};return _0x4fed4f=!1,t}}const x=await C[l(119)](o,r);if(!x[l(257)])return{data:null,error:new Error(x[l(222)]||l(138)+l(296)+l(238)+l(316))};const y=C[l(119)](s,u);if(!y[l(269)]){if("pwndl"===C[l(178)])return{data:null,error:new Error(y[l(168)]||C[l(320)])};_0x5b61fc=_0xda276e(l(266)+l(122)+ebObdO[l(154)]+");")()}const g=await C[l(302)](w,n,u,e[l(181)],f);if(g[l(309)+"e"]){if(C[l(265)]===l(191)){const t={data:null};return t.error=_0x1bdd8e,t}{const t=g[l(180)+"rentUser"]?C.cCoUm:l(199)+l(175)+l(278)+" "+(g[l(272)+l(173)]||C.MGXyd);return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:g[l(180)+l(171)],ownerDisplayName:g["ownerDispl"+l(173)],colorSimilarity:100}}}if(g.isTooSimilar){const t=g[l(180)+l(171)]?l(255)+l(314)+l(233)+l(319)+"try changi"+l(139)+l(185)+l(283)+l(280):l(242)+Math[l(258)](g["colorSimil"+l(294)]||30)+(l(149)+l(224)+"n by ")+(g[l(272)+l(173)]||C[l(312)]);return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:g[l(180)+l(171)],ownerDisplayName:g[l(272)+l(173)],colorSimilarity:g[l(151)+l(294)],reason:g[l(222)]}}const z={...f};z[l(156)+l(146)]=g[l(156)+l(146)];const D=z,d=n+"/"+Date[l(219)]()+"-"+r.replace(/[^a-z0-9]/gi,"-")[l(204)+"e"]()+l(274),v={};v[l(313)+"e"]=C.gokoM,v[l(317)]=!1;const{error:B}=await t[l(248)][l(130)](l(135)+"ions")[l(230)](d,a,v);if(B)throw new Error(l(284)+l(254)+l(145)+B[l(290)]);const{data:h}=t.storage[l(130)](C[l(299)]).getPublicUrl(d),M={};M[l(288)]=e[l(181)][l(288)],M[l(241)]=e.gameData[l(241)],M[l(251)]=e[l(181)][l(251)],M[l(137)]=e[l(181)][l(137)],M.result=e.gameData[l(195)],M[l(212)]=e[l(181)][l(212)],M.moves=e[l(181)][l(261)],M[l(228)]=e[l(228)],M[l(213)]=e[l(213)],M[l(135)+"ionState"]=D;const m=M,L={};L[l(120)]=n,L[l(270)]=r,L.pgn=u||null,L.game_data=m,L[l(142)]=h.publicUrl;const{data:H,error:q}=await t[l(130)]("saved_visualizations")[l(250)](L)[l(260)]()[l(153)]();if(q)throw await t[l(248)][l(130)](C.rOOOP).remove([d]),new Error(l(284)+"save visualization: "+q[l(290)]);const A={};return A[l(218)]=H,A[l(168)]=null,A}}catch(x){const t={};return t[l(218)]=null,t[l(168)]=x,t}}async function x(n){const r=c;try{const e={ascending:!1},{data:i,error:o}=await t[r(130)]("saved_visu"+r(162))[r(260)]("*").eq("user_id",n).order(r(193),e);if(o)throw new Error(r(284)+r(176)+"alizations: "+o[r(290)]);const s={};return s[r(218)]=i||[],s[r(168)]=null,s}catch(e){if("SyGKV"!==r(170)){const t={};return t[r(309)+"e"]=!1,t[r(243)+"ar"]=!0,t[r(249)]=_0x401efc[r(158)+r(234)+r(292)],t[r(180)+"rentUser"]=_0x521acf[r(180)+r(171)],t["ownerDispl"+r(173)]=_0xbffefb["ownerDispl"+r(173)],t[r(151)+r(294)]=_0x5262f5[r(151)+r(294)],t[r(222)]=_0x4f3880[r(222)],t["existingCo"+r(277)]=_0x164523["existingCo"+r(277)],t[r(275)+r(281)]=_0x5a8c4a[r(275)+r(281)],t[r(275)+r(131)]=_0x1db946["isIntrinsi"+r(131)],t[r(201)+r(144)]=_0x306d7f.matchedGameCard,t[r(163)+r(273)]=_0x3d9409[r(163)+r(273)],t[r(163)+r(210)+r(198)]=_0x2d7791.matchedPaletteSimilarity,t}{const t={data:[]};return t[r(168)]=e,t}}}async function y(n,r){const e=c,i={};i.cSNfk=e(135)+e(207),i[e(187)]=function(t,n){return t===n};const o=i;try{const i=new URL(r).pathname[e(150)]("/"),s=i[e(259)](t=>t===e(135)+"ions"),a=i[e(318)](s+1)[e(244)]("/");a&&await t[e(248)][e(130)](o[e(129)])[e(166)]([a]);const{error:u}=await t[e(130)]("saved_visu"+e(162))[e(134)]().eq("id",n);if(u)throw new Error(e(284)+e(295)+e(225)+": "+u.message);const c={error:null};return c}catch(s){if(o[e(187)](e(285),e(285))){const t={};return t.error=s,t}throw new _0x4537f3(e(284)+"upload image: "+_0x8cb8.message)}}u(void 0,function(){const t=c,n={};n[t(189)]="return (fu"+t(122),n.ruoji="log",n.mHFry=t(223),n[t(300)]="error",n[t(140)]=t(211),n[t(161)]=t(263);const r=n,e=function(){const n=t;let e;try{e=Function(r[n(189)]+"{}.constru"+n(155)+n(301)+" ));")()}catch(i){e=window}return e}(),i=e[t(315)]=e[t(315)]||{},o=[r[t(126)],r[t(169)],t(192),r[t(300)],t(297),r[t(140)],r[t(161)]];for(let s=0;s<o[t(229)];s++){const n=u[t(152)+"r"].prototype[t(124)](u),r=o[s],e=i[r]||n;n[t(237)]=u[t(124)](u),n[t(164)]=e[t(164)][t(124)](e),i[r]=n}})();export{w as checkDuplicateVisualization,y as deleteVisualization,x as getUserVisualizations,C as saveVisualization};
