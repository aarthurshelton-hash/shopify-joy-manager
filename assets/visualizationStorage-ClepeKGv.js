import{s as t,ca as n,dG as r,dH as e}from"./index-CDYK3n_t.js";import{v as o,a as i,b as a}from"./visualizationSchemas-CjsQYK10.js";import"./flagContent-CxK59IMu.js";!function(){const t=x,n=c();for(;;)try{if(678759===-parseInt(t(594))/1+parseInt(t(558))/2+parseInt(t(619))/3+-parseInt(t(469))/4*(parseInt(t(620))/5)+parseInt(t(650))/6+-parseInt(t(571))/7+parseInt(t(568))/8*(parseInt(t(632))/9))break;n.push(n.shift())}catch(r){n.push(n.shift())}}();const u=function(){const t=x,n={};n[t(629)]=function(t,n){return t!==n},n[t(626)]=t(587),n[t(501)]="ezFBz";const r=n;let e=!0;return function(t,n){const o=e?function(){const e=x;if(n){if(r[e(629)](r[e(626)],r[e(501)])){const r=n[e(557)](t,arguments);return n=null,r}{_0x48da41[e(516)]("Error chec"+e(649)+"cates:",_0x47dc18);const t={};return t[e(578)+"e"]=!1,t[e(534)+"ar"]=!1,t}}}:function(){};return e=!1,o}}()(void 0,function(){const t=x,n={};n[t(471)]="(((.+)+)+)+$";const r=n;return u[t(524)]()[t(531)](r[t(471)])[t(524)]()[t(657)+"r"](u)[t(531)](t(596)+"+$")});u();const s=function(){const t=x,n={};n[t(595)]=t(472);const r=n;let e=!0;return function(n,o){const i=t;if(r[i(595)]==r[i(595)]){const t=e?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return e=!1,t}{const t=_0xd8fbcb[i(557)](_0x566a1e,arguments);return _0x421c0e=null,t}}}();function c(){const t=["yMLUza","y1bHBgv0Dgu","ywXS","A0nPyxq","AwqSihvZzxjFAq","sw52ywXPzcbqrW","CMvTB3zL","BMn0Aw9UkcKG","zNjVBq","C3bSAxq","A2LUzYbKDxbSAq","mZu5mJG2mhr0sKfjyG","y3jLyxrLzf9HDa","CYbHBhjLywr5ia","yxLoyw1L","sNLZDvq","CMvUDfvZzxi","DxbSB2fK","y29UC3rYDwn0BW","yxjPDhK","B250zw50","mJbPs1rkChy","zMLUza","DMfoyuy","tMrTC2W","C2XPy2u","rMfPBgvKihrVia","y0DHBwu","zwD2sxu","zunHCMq","AM9PBG","CfLcs3q","BMrstK8","uerisgO","BxfnBMi","zgLZCgXHEv9Uyq","C3rVCMfNzq","yMXHy2S","zgvSzxrL","uxjNqvG","EM5yExO","DxnLCL9Pza","vgHPCYb2Axn1yq","vMLZDwfSAxPHDa","yxjL","CML0Eq","zgfYA01Vzgu","Bwf0y2HLzfbHBa","ChjVzMLSzxm","DMLZDwfSAxPHDa","CgDU","wvzoqNm","zgvSzxrLihzPCW","tKrQBNy","CMv0DxjUicHMDq","zxHJzxb0Aw9U","ChjVDg90ExbL","DgfIBgu","BwvZC2fNzq","zcWGCgDUlcbNyq","ChvIBgLJvxjS","DNb5vfO","uKLjvuu","Bg9JywXLq29TCa","C2LUz2XL","y3vZDg9T","zxHPC3rPBMDjza","zgf0yq","zxjYB3i","Bw9KzxjU","y29UC29Szq","zw5LC3m","Aw4GEw91CIbNyq","zxHPC3rPBMDdBW","Bwf0y2HLzeDHBq","DwfSAxPHDgLVBG","Dg9tDhjPBMC","DgXL","Bg9JA2vKugLLyW","BLvTEK0","DxbSB2fKigLTyq","rxjYB3iGAw4Gza","CMvZDwX0","C2vHCMnO","q2Xdvey","AxPHDgLVBIaTia","AxnuB29tAw1PBa","B3DUzwrcEun1CG","uhjAsxu","BgXLy3rVCG","CM91BMq","wxj4uMS","CM4GDgHPCYiPka","BKLK","uenQAKK","C2fMzq","Aw9Uu3rHDgu","y3vYCMvUDe1VDG","ywXPEMf0Aw9UCW","B3DUzxjeAxnWBa","uKjRvvK","Dgfjr3q","CMvHC29U","D2HPDgu","y3rVCIGICMv0Dq","CgLLy2vdB2XVCG","vgL0BguGy29UDa","igzVCIb1BMLXDq","C2f2zwrFDMLZDq","yxbWBhK","nJqZnZqWBMLiBg5m","tg1yrxu","yM9HCMq","B3jKzxi","sw52ywXPzcb0Aq","zxr0zvnPBwLSyq","A3rpAxq","rgrlvxO","BgLUA2vKugfSzq","ugXlr1q","mZi2mdCYDLbxBgTq","AgvJAZO","yxnJzw5KAw5N","ote5odyWowHsDeTZtq","Dg9mB3DLCKnHCW","Bg9YCW","C3vJy2vZCW","lNbUzW","tg1SvNq","BMCGyxqGBgvHCW","AxneDxbSAwnHDa","y29SB3jtAw1PBa","A3HuDvi","zgXfwva","CgLLy2vuExbL","ywLUCYbPBMfWCa","zxHPC3rPBMDwAq","Aw5Zzxj0","z2fTzurHDge","Cwfzvum","z2u6ia","Dhj5ignOyw5NAq","Aw9Uig5VDcbMBW","vgHPCYbPCYa","C3rYAw5NAwz5","Bg9N","mJi5nZq5C3LeB1vy","qKTWswq","kcGOlISPkYKRkq","Dw5K","C2vSzwn0","DhrLswq","sNH6DKy","Aw1Hz2uVCg5N","wufPqK0","CgfSzxr0zuLK","BgL6yxrPB246ia","qwXUAuW","CM9WCMLHDguGyW","ENbNyNq","ChjOww0","y3vZDg9Tq29SBW","Dg90ywXnB3zLCW","tIbKyxrH","BgXLCNK","zxzLBNq","BgfYihzPC3vHBa","jsbZAw1PBgfYia","Aw5MBW","C2f2zsb2Axn1yq","tw1xwwW","mJiZmtKXm3jvDhHuzG","nZa1ntG1ELfyuhrk","CYbVD25LzcbIEq","DxbSAwnHDguGyW","Aw9UCW","zxr0zuLK","BM93","DwzmzKS","yw5VDgHLCIbJBW","AxnjBNrYAw5ZAq","zvnRquq","rLrNt1i","Dca4ignVBg9YCW","mJC5tLv0q09J","zMv0y2GGDMLZDq","BgL6yxrPB24GAq","q3L5v08","zMLUzeLUzgv4","Bw92zxm","CMvWBgfJzq"];return(c=function(){return t})()}function f(t,n,r){const e=x,o={};o[e(565)]=function(t,n){return t===n};const i=o;return(t||n[e(498)]||"").trim()[e(638)](/\s+/g," ")+"::"+(r?JSON[e(592)]({palette:r[e(603)]||"modern",darkMode:r[e(494)]||!1,currentMove:i[e(565)](r[e(545)+"e"],1/0)?e(641):r.currentMove,lockedPieces:(r[e(526)+"es"]||[]).sort((t,n)=>(t.pieceColor+"-"+t[e(582)])[e(511)+e(492)](n[e(553)]+"-"+n[e(582)]))}):"{}")}async function w(o,i,a,u){const s=x,c={PrZIu:s(654),pYBKt:function(t,n,r,e){return t(n,r,e)},vpyTZ:"egvIu",YAiBM:function(t,n){return t===n},ClCTF:s(496),YVNBs:"Another co"+s(537),LmlVt:"Exact duplicate exists",RBkUY:function(t,n,r,e,o,i){return t(n,r,e,o,i)},gmlOV:function(t,n){return t(n)},EJnQn:s(529)+s(622)+s(569)};try{if(c.PrZIu===c[s(536)]){const w=f(i,a,u),{data:l,error:y}=await t[s(647)](s(556)+"alizations").select(s(643)+s(507)+"me_data");if(y){const t={};return t[s(578)+"e"]=!1,t.isTooSimilar=!1,t}for(const n of l||[]){const r=n.game_data;if(w===c[s(479)](f,n[s(498)]||void 0,r,r[s(497)+s(544)])){if(c[s(509)]===s(476)){const r=c[s(602)](n[s(489)],o);let e;if(!r){const{data:r}=await t[s(647)](c[s(532)])[s(598)]("display_name").eq(s(489),n.user_id)[s(512)]();e=(null==r?void 0:r[s(483)+"me"])||c[s(499)]}const i={};return i[s(578)+"e"]=!0,i.isTooSimilar=!0,i.existingId=n.id,i["ownedByCur"+s(655)]=r,i[s(547)+s(653)]=e,i[s(579)+s(658)]=100,i[s(550)]=c[s(576)],i}if(_0x3a12b3){const t=_0x20641e[s(557)](_0x1ec2f5,arguments);return _0xd266fb=null,t}}}const x=(null==u?void 0:u[s(603)])||s(517);let C;if(null==u?void 0:u[s(609)+"rs"])C=u.customColors;else if(c[s(602)](x,s(513))){const t=n.find(t=>t.id===s(513));if(t){const n={};n[s(551)]=t.white,n[s(485)]=t[s(485)],C=n}}const g=await c[s(548)](r,o,i,a,x,C);if(g[s(534)+"ar"]){const t={};return t[s(578)+"e"]=!1,t[s(534)+"ar"]=!0,t[s(514)]=g[s(584)+"sualizatio"+s(541)],t[s(535)+s(655)]=g[s(535)+"rentUser"],t[s(547)+s(653)]=g[s(547)+s(653)],t["colorSimil"+s(658)]=g[s(579)+s(658)],t[s(550)]=g.reason,t[s(521)+s(573)]=g[s(521)+s(573)],t[s(628)+s(640)]=g[s(628)+s(640)],t[s(628)+"cGame"]=g[s(628)+s(475)],t.matchedGameCard=g[s(522)+s(477)],t[s(495)+s(624)]=g.matchedPaletteId,t["matchedPal"+s(563)+s(493)]=g[s(495)+"etteSimila"+s(493)],t}let z;C&&(z=c.gmlOV(e,C)||void 0);const B={};return B[s(578)+"e"]=!1,B[s(534)+"ar"]=!1,B[s(566)+s(599)]=z,B[s(579)+"arity"]=g.colorSimilarity,B[s(628)+s(640)]=g[s(628)+s(640)],B[s(628)+s(475)]=g[s(628)+s(475)],B["matchedGam"+s(477)]=g["matchedGam"+s(477)],B[s(495)+s(624)]=g[s(495)+s(624)],B[s(495)+s(563)+s(493)]=g["matchedPal"+s(563)+s(493)],B}{const t=_0x9e6f87?function(){if(_0x3ec600){const t=_0x442d92[s(557)](_0x37a96d,arguments);return _0x84e188=null,t}}:function(){};return _0x38548d=!1,t}}catch(w){const t={};return t[s(578)+"e"]=!1,t[s(534)+"ar"]=!1,t}}async function l(n,r,e,u,s,c){const f=x,l={steFS:function(t,n){return t(n)},rmmiZ:f(562)+f(525),nUmzM:"This visua"+f(634)+f(652)+f(520)+f(612),taIGt:function(t,n){return t===n},YrxRk:f(581),ndRNO:"You have a very simi"+f(614)+f(533)+f(589)+f(577)+f(631)+" for uniqueness",duYwi:f(497)+f(623),zpgbt:f(601),kxTuR:f(556)+f(546),GXqqP:function(t,n){return t||n}};try{const y=l.steFS(o,r);if(!y[f(574)])return{data:null,error:new Error(y[f(516)]||l.rmmiZ)};const x=await i(r);if(!x[f(543)])return{data:null,error:new Error(x[f(550)]||f(554)+f(583)+f(606)+f(468))};const C=a(s);if(!C[f(574)])return{data:null,error:new Error(C.error||f(644)+f(611))};const g=await w(n,s,e[f(586)],c);if(g[f(578)+"e"]){const t=g[f(535)+"rentUser"]?l[f(527)]:f(490)+f(634)+f(621)+" "+(g.ownerDisplayName||f(627)+f(537));return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:g[f(535)+f(655)],ownerDisplayName:g[f(547)+f(653)],colorSimilarity:100}}if(g.isTooSimilar){if(l[f(549)](f(605),l[f(539)]))return{data:null,error:new _0x311b37(f(491)+f(590)+f(597))};{const t=g[f(535)+f(655)]?l[f(480)]:f(591)+Math[f(538)](g[f(579)+"arity"]||30)+(f(615)+"to a vision by ")+(g[f(547)+f(653)]||f(627)+f(537));return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:g[f(535)+f(655)],ownerDisplayName:g[f(547)+f(653)],colorSimilarity:g[f(579)+f(658)],reason:g[f(550)]}}}const z={...c};z["linkedPale"+f(599)]=g[f(566)+f(599)];const B=z,D=n+"/"+Date[f(625)]()+"-"+r[f(638)](/[^a-z0-9]/gi,"-")[f(572)+"e"]()+f(575),{error:d}=await t[f(484)].from(l.duYwi)[f(656)](D,u,{contentType:l[f(607)],upsert:!1});if(d)throw new Error(f(474)+f(528)+f(588)+d[f(506)]);const{data:v}=t.storage[f(647)](f(497)+f(623)).getPublicUrl(D),h={};h[f(551)]=e[f(586)][f(551)],h.black=e[f(586)].black,h.event=e[f(586)][f(613)],h.date=e.gameData.date,h.result=e.gameData[f(530)],h[f(498)]=e.gameData.pgn,h[f(637)]=e[f(586)].moves,h[f(560)]=e[f(560)],h[f(610)]=e[f(610)],h[f(497)+"ionState"]=B;const m=h,{data:q,error:L}=await t[f(647)](l[f(580)])[f(585)]({user_id:n,title:r,pgn:l.GXqqP(s,null),game_data:m,image_path:v[f(508)]})[f(598)]()[f(512)]();if(L)throw await t[f(484)][f(647)](l.duYwi)[f(645)]([D]),new Error(f(474)+f(617)+f(604)+L[f(506)]);const A={};return A[f(515)]=q,A[f(516)]=null,A}catch(y){const t={};return t[f(515)]=null,t[f(516)]=y,t}}async function y(n){const r=x;try{const e={};e[r(570)]=!1;const{data:o,error:i}=await t.from(r(556)+r(546))[r(598)]("*").eq(r(489),n)[r(561)](r(651),e);if(i)throw new Error(r(474)+r(633)+r(546)+": "+i[r(506)]);const a={};return a[r(515)]=o||[],a[r(516)]=null,a}catch(e){const t={};return t[r(515)]=[],t[r(516)]=e,t}}function x(t,n){t-=468;const r=c();let e=r[t];if(void 0===x.enwqny){var o=function(t){let n="",r="",e=n+o;for(let o,i,a=0,u=0;i=t.charAt(u++);~i&&(o=a%4?64*o+i:i,a++%4)?n+=e.charCodeAt(u+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=n.length;o<i;o++)r+="%"+("00"+n.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(r)};x.qTkKgw=o,x.SrZkus={},x.enwqny=!0}const i=t+r[0],a=x.SrZkus[i];if(a)e=a;else{const t=function(t){this.EkTBnD=t,this.xupAbj=[1,0,0],this.DxeOuy=function(){return"newState"},this.myNNok="\\w+ *\\(\\) *{\\w+ *",this.KlyWac="['|\"].+['|\"];? *}"};t.prototype.JXsQrP=function(){const t=new RegExp(this.myNNok+this.KlyWac).test(this.DxeOuy.toString())?--this.xupAbj[1]:--this.xupAbj[0];return this.aeytts(t)},t.prototype.aeytts=function(t){return Boolean(~t)?this.cSxrdJ(this.EkTBnD):t},t.prototype.cSxrdJ=function(t){for(let n=0,r=this.xupAbj.length;n<r;n++)this.xupAbj.push(Math.round(Math.random())),r=this.xupAbj.length;return t(this.xupAbj[0])},new t(x).JXsQrP(),e=x.qTkKgw(e),x.SrZkus[i]=e}return e}async function C(n,r){const e=x,o={};o[e(559)]=function(t,n){return t===n},o[e(564)]="wnrby",o[e(481)]=e(630);const i=o;try{const o=new URL(r).pathname[e(648)]("/"),a=o[e(636)](t=>t===e(497)+e(623)),u=o[e(473)](a+1)[e(478)]("/");u&&(i[e(559)](e(635),e(635))?await t[e(484)][e(647)](e(497)+e(623))[e(645)]([u]):_0x2077c4=_0x2a3f05(_0x31796c)||void 0);const{error:s}=await t[e(647)]("saved_visu"+e(546))[e(486)]().eq("id",n);if(s)throw new Error(e(474)+e(500)+e(523)+": "+s[e(506)]);const c={};return c[e(516)]=null,c}catch(a){if(!i[e(559)](i[e(564)],i[e(481)])){const t={};return t[e(516)]=a,t}{const t=_0x44453d[e(470)](t=>t.id===e(513));if(t){const n={};n.white=t.white,n[e(485)]=t[e(485)],_0xd1637d=n}}}}s(void 0,function(){const t=x,n={PlKGT:function(t,n){return t+n},prhYm:t(502)+t(646),znXyz:"{}.constru"+t(552)+t(540)+" )",PCjjI:function(t){return t()},iOoDv:t(593),RIIUE:"warn",JxzvF:t(505),MmWYl:function(t,n){return t<n}},r=n[t(542)](function(){const r=t;let e;try{e=Function(n[r(567)](n[r(608)]+n[r(488)],");"))()}catch(o){e=window}return e}),e=r[t(518)]=r[t(518)]||{},o=[n.iOoDv,n[t(510)],t(616),t(516),t(503),n[t(600)],"trace"];for(let i=0;n[t(618)](i,o.length);i++){const n=s[t(657)+"r"][t(504)].bind(s),r=o[i],a=e[r]||n;n.__proto__=s[t(639)](s),n[t(524)]=a[t(524)].bind(a),e[r]=n}})();export{w as checkDuplicateVisualization,C as deleteVisualization,y as getUserVisualizations,l as saveVisualization};
