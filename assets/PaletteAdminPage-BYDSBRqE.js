import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as m,t as h,P as x,w as f,B as p,bM as j,cj as g,a9 as v,am as w,a1 as y,a2 as N,a3 as C,a4 as b,bC as z,a5 as k,cu as D,b as P}from"./index-Hr12Z3Gc.js";function M(e,s){e-=435;const t=S();let n=t[e];if(void 0===M.kyPZqh){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};M.HvJiAm=a,M.UPzDvZ={},M.kyPZqh=!0}const r=e+t[0],i=M.UPzDvZ[r];if(i)n=i;else{const e=function(e){this.OXmcMg=e,this.ZYkMAE=[1,0,0],this.PVpzpV=function(){return"newState"},this.kQklCu="\\w+ *\\(\\) *{\\w+ *",this.HTJhho="['|\"].+['|\"];? *}"};e.prototype.pYqAns=function(){const e=new RegExp(this.kQklCu+this.HTJhho).test(this.PVpzpV.toString())?--this.ZYkMAE[1]:--this.ZYkMAE[0];return this.qtDUPN(e)},e.prototype.qtDUPN=function(e){return Boolean(~e)?this.tKCOFe(this.OXmcMg):e},e.prototype.tKCOFe=function(e){for(let s=0,t=this.ZYkMAE.length;s<t;s++)this.ZYkMAE.push(Math.round(Math.random())),t=this.ZYkMAE.length;return e(this.ZYkMAE[0])},new e(M).pYqAns(),n=M.HvJiAm(n),M.UPzDvZ[r]=n}return n}!function(){const e=M,s=S();for(;;)try{if(227929===-parseInt(e(435))/1+parseInt(e(489))/2+-parseInt(e(513))/3+-parseInt(e(455))/4+-parseInt(e(442))/5+-parseInt(e(482))/6*(parseInt(e(483))/7)+parseInt(e(438))/8)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const A=function(){const e=M,s={pgFCv:function(e,s){return e(s)},cRoEE:function(e,s){return e+s},uihjC:e(450)+e(465)+e(439)+" )"};let t=!0;return function(n,a){const r=e;if("UGXmp"===r(453)){const e=t?function(){if(a){const e=a[r(491)](n,arguments);return a=null,e}}:function(){};return t=!1,e}_0x1744f0=s[r(503)](_0x42d436,s[r(487)](r(490)+r(437),s.uihjC)+");")()}}()(void 0,function(){const e=M,s={};s.PrLAJ=e(445)+"+$";const t=s;return A[e(461)]()[e(515)](t.PrLAJ)[e(461)]()[e(466)+"r"](A)[e(515)](e(445)+"+$")});A();const q=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[M(491)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();function S(){const e=["zNjVBq","t0XQvwS","D2fYBG","wNjsqK0","zxjYAwrLCW","D2HPDgvFy29SBW","turmwg4","zMLUza","Aw5Zzxj0","mJGXndGXv1forhz5","CNbJ","C2vHCMnO","C2vSzwn0","C2f2zwrFDMLZDq","zgf0yq","yMXHy2TFy29SBW","DgLUzYbSAw5Rzq","x19WCM90B19F","mtGYote0wvL2EffQ","y29Kzq","BMn0Aw9UkcKG","otGZotqWmgn0z0fXrW","CM4GDgHPCYiPka","DxbKyxrL","CuDztgq","nduXotG1AKvlC01j","ChjVDg90ExbL","DhjHy2u","kcGOlISPkYKRkq","A0HiwwS","yMXHy2S","C2LUz2XL","y29UC29Szq","E30Uy29UC3rYDq","CgfSzxr0zv9VDG","zcb2Axn1ywXPEG","vuDyBxa","DMvYC2LVBG","odyZmZeYCuPirKrd","yxrH","Cuzus0W","zgvSzxrL","AgfZx3jVBgu","z2zNB2m","Dg9tDhjPBMC","rwzZvwK","z2HAru4","ywrTAw4","y3rVCIGICMv0Dq","y29UC3rYDwn0BW","ueDsu1qXmty","sKrVshm","DMLZDwfSAxPHDa","uNPWBMC","uuTvC2u","zxjYB3i","CgfSzxr0zuLK","u3b6AvG","yMLUza","ihjVBgu6","vMPKzhG","BgvUz3rO","swLSCxu","Bw9KAwzPzwrFyG","zxHJzxb0Aw9U","mJCZndmXneHjEeT6za","n0vqqKLbsG","Aw9Uu3rHDgu","wwnNzgi","A2LUzYbHzg1PBG","y1jVruu","rxjYB3iGy291BG","nZmZnZH4yu1btfu","CMv0DxjUicHMDq","yxbWBhK","zfPqzfe","D2HPDgu","AwnxB0W","ywXPEMf0Aw9UCW","CgfSzxr0zv9Pza","uNbiCwq","r09Sz1O","DLvWsLC","BM5dvxe","rxjYB3iGy2HLyW","DgfIBgu","CgDgq3y"];return(S=function(){return e})()}async function B(s,t,n,a){const r=M,i={};i[r(474)]=r(451)+"errides",i[r(441)]=function(e,s){return e+s};const c=i;try{const{data:i}=await async function(s){const t=M,n={};n[t(479)]=t(496);const a=n;try{const{data:n,error:r}=await e[t(504)](t(451)+t(508))[t(516)]("*").eq(a[t(479)],s)[t(448)]();if(r&&r[t(436)]!==t(467))throw r;const i={};return i[t(518)]=n,i[t(472)]=null,i}catch(r){if("nnCUq"===t(500)){const e={};return e[t(518)]=null,e[t(472)]=r,e}{const e={};return e[t(518)]=null,e[t(472)]=_0x421416,e}}}(s);if(i){const{error:o}=await e[r(504)](c[r(474)])[r(440)]({white_colors:t,black_colors:n,modified_by:a,version:c[r(441)](i[r(454)],1)}).eq(r(496),s);if(o)throw o;const l={error:null};return l[r(454)]=i.version+1,l}{const i={};i.palette_id=s,i.white_colors=t,i[r(519)+"rs"]=n,i[r(480)+"y"]=a,i[r(454)]=1;const{error:c}=await e[r(504)](r(451)+r(508))[r(512)](i);if(c)throw c;const o={};return o[r(472)]=null,o[r(454)]=1,o}}catch(o){const e={};return e[r(472)]=o,e[r(454)]=0,e}}async function Z(s){const t=M,n={};n[t(462)]="id, game_d"+t(456),n.QKUse=function(e,s){return e===s},n[t(457)]=t(488)+t(520)+t(452)+"ations:";const a=n;try{const{data:n,error:r}=await e.from(t(517)+t(495)).select(a[t(462)]);if(r)throw r;let i=0;for(const e of n||[]){const n=e.game_data[t(469)+t(484)];((null==n?void 0:n[t(473)])===s||a[t(471)](null==n?void 0:n.linkedPaletteId,s))&&i++}return i}catch(r){return 0}}q(void 0,function(){const e=M,s={Vjddx:function(e,s){return e(s)},JDoHs:function(e,s){return e+s},ZrRBM:function(e){return e()},PKySO:"log",Rzpng:e(506),dZPdQ:e(444),GOlgZ:function(e,s){return e<s}},t=s[e(507)](function(){const t=e;let n;try{n=s[t(477)](Function,s[t(468)](t(490)+t(437)+(t(450)+t(465)+t(439)+" )"),");"))()}catch(a){n=window}return n}),n=t[e(449)]=t.console||{},a=[s.PKySO,s[e(470)],"info",e(472),e(481),e(502),s[e(492)]];for(let r=0;s[e(498)](r,a[e(478)]);r++){const s=q.constructor[e(443)][e(475)](q),t=a[r],i=n[t]||s;s[e(521)]=q[e(475)](q),s.toString=i[e(461)][e(475)](i),n[t]=s}})();const L=["k","q","r","b","n","p"],U={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},G=()=>{var A,q,S,G;const{user:H}=s(),Y=t(),[_,K]=n.useState(!1),[W,E]=n.useState(!0),[J,V]=n.useState([]),[X,I]=n.useState(null),[O,F]=n.useState(null),[R,$]=n.useState({}),[T,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!H)return void Y("/");if(!(await async function(s){const t=M,n={};n[t(497)]="(((.+)+)+)+$",n.nnfmN=t(499),n.MyfMW=t(459),n.gfgoc=t(464),n[t(485)]=function(e,s){return e===s},n[t(463)]=t(494);const a=n;try{if("vUpJW"===a.nnfmN){const{data:n,error:r}=await e[t(514)](a.MyfMW,{_user_id:s,_role:a[t(460)]});return!r&&!0===n}{const e=_0x29d921.apply(_0x3d435f,arguments);return _0x8d87d7=null,e}}catch(r){return!a[t(485)](t(494),a.ghZEN)&&_0x5b329d[t(461)]()[t(515)](JLDnJZ[t(497)])[t(461)]()[t(466)+"r"](_0xd22abc)[t(515)](JLDnJZ[t(497)])}}(H.id)))return P.error("Access denied",{description:"Admin privileges required"}),void Y("/");K(!0),await te(),E(!1)})()},[H,Y]);const te=async()=>{const{data:s}=await async function(){const s=M,t={DqRWL:"palette_id"};try{const{data:n,error:a}=await e.from(s(451)+s(508))[s(516)]("*").order(t.DqRWL);if(a)throw a;const r={};return r[s(518)]=n||[],r[s(472)]=null,r}catch(n){const e={};return e[s(518)]=[],e[s(472)]=n,e}}();V(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await Z(e.id);$(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=J.find(s=>s.palette_id===e);I(e),F({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{O&&F({...O,[e]:{...O[e],[s]:t}})},re=async()=>{if(!X||!O||!H)return;Q(!0),se(!1);const{error:e,version:s}=await B(X,O.white,O.black,H.id);e?P.error("Failed to save",{description:e.message}):(P.success("Palette updated!",{description:`Version ${s} saved. ${R[X]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>J.some(s=>s.palette_id===e);return W?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):_?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(X===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(l,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),R[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),R[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[L.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),L.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:X&&O?a.jsxs(o,{children:[a.jsx(m,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(h,{className:"flex items-center gap-2",children:[a.jsx(x,{className:"h-5 w-5"}),null==(A=ie(X))?void 0:A.name]}),a.jsx(f,{children:null==(q=ie(X))?void 0:q.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(X)&&a.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!X)return;Q(!0);const{error:s}=await async function(s){const t=M,n={};n[t(446)]=t(496);const a=n;try{const{error:n}=await e[t(504)]("palette_ov"+t(508))[t(458)]().eq(a[t(446)],s);if(n)throw n;const r={};return r[t(472)]=null,r}catch(r){const e={};return e[t(472)]=r,e}}(X);s?P.error("Failed to revert",{description:s.message}):(P.success("Reverted to defaults"),ne(X),await te()),Q(!1)},disabled:T,children:[a.jsx(j,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(p,{size:"sm",onClick:async()=>{if(!X||!O||!H)return;(R[X]||0)>0?se(!0):await re()},disabled:T,children:[T?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(g,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(l,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(S=ie(X))?void 0:S.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:U[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(v,{type:"color",value:O.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(v,{type:"text",value:O.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(G=ie(X))?void 0:G.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:U[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(v,{type:"color",value:O.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(v,{type:"text",value:O.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(w,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:L.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.white[e]},title:U[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:L.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.black[e]},title:U[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(o,{className:"h-full flex items-center justify-center",children:a.jsxs(l,{className:"text-center py-12",children:[a.jsx(x,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(C,{children:[a.jsxs(b,{className:"flex items-center gap-2",children:[a.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(k,{children:["This palette is linked to ",a.jsx("strong",{children:R[X||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(p,{onClick:re,disabled:T,children:[T?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(D,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{G as default};
