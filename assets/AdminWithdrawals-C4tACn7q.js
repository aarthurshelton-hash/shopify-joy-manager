import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b7 as o,B as l,A as d,cb as u,cR as x,a8 as h,D as m,aB as p,aC as f,aD as v,aE as w,p as j,t as y,w as g,dy as C,dt as N,bo as b,dq as z,cZ as D,a1 as q,a2 as L,a3 as A,a4 as M,a5 as B,aW as _,bC as W,dz as U,b as S,y as I}from"./index-Hr12Z3Gc.js";import{C as H}from"./calendar-De9Rowr8.js";!function(){const e=O,t=E();for(;;)try{if(432172===-parseInt(e(340))/1+-parseInt(e(320))/2*(parseInt(e(410))/3)+-parseInt(e(352))/4+-parseInt(e(341))/5+-parseInt(e(293))/6+-parseInt(e(372))/7*(parseInt(e(386))/8)+parseInt(e(413))/9)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const K=function(){const e=O,t={};t[e(356)]=function(e,t){return e!==t},t[e(282)]="ykecg",t[e(321)]=e(301)+e(358)+'rn this")( )';const s=t;let n=!0;return function(t,r){const a=e,c={OIFwR:function(e,t){return e+t}};c[a(404)]=s[a(321)];const i=c,o=n?function(){const e=a;if(s[e(356)](s.Byhvy,s[e(282)])){const t=_0x57ba91(i[e(339)](e(348)+e(402)+i[e(404)],");"));_0x1cbf6f=t()}else if(r){const s=r[e(329)](t,arguments);return r=null,s}}:function(){};return n=!1,o}}()(void 0,function(){const e=O,t={};t[e(338)]=e(306)+"+$";const s=t;return K[e(350)]()[e(377)](s[e(338)])[e(350)]()[e(417)+"r"](K).search(e(306)+"+$")});function O(e,t){e-=280;const s=E();let n=s[e];if(void 0===O.CvLAdO){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};O.dFrAKy=r,O.AZDIqr={},O.CvLAdO=!0}const a=e+s[0],c=O.AZDIqr[a];if(c)n=c;else{const e=function(e){this.wpttYo=e,this.wsKEOv=[1,0,0],this.hANmYe=function(){return"newState"},this.fAlbfH="\\w+ *\\(\\) *{\\w+ *",this.pJuREt="['|\"].+['|\"];? *}"};e.prototype.kIXIXr=function(){const e=new RegExp(this.fAlbfH+this.pJuREt).test(this.hANmYe.toString())?--this.wsKEOv[1]:--this.wsKEOv[0];return this.xnJPgj(e)},e.prototype.xnJPgj=function(e){return Boolean(~e)?this.NAojmV(this.wpttYo):e},e.prototype.NAojmV=function(e){for(let t=0,s=this.wsKEOv.length;t<s;t++)this.wsKEOv.push(Math.round(Math.random())),s=this.wsKEOv.length;return e(this.wsKEOv[0])},new e(O).kIXIXr(),n=O.dFrAKy(n),O.AZDIqr[a]=n}return n}K();const k=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[O(329)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}();function E(){const e=["ChjVzMLSzxm","BxbMDK4","B3rHBf9LyxjUzq","ChjVDMvKihn0yq","Bw91BNq","zM9YrwfJAa","CeLSsxi","CgvUzgLUz19JBW","BgvUz3rO","x3jLCxvLC3rZ","yw1VDw50x2nLBG","Bgnoy3C","BMn0Aw9UkcKG","DvfXvvq","t2vQs20","BhjvDLK","Dg90ywW","senOuMe","zvzZAMC","y0rLAvK","nZy2ndqZvvbgC0De","B3vUDf9Jzw50CW","y3jLyxrLzf9HDa","mJm3ote1mZzrt1H1Exm","EevUDKO","C3rHDhvZ","DxnVv2u","y29UC3rYDwn0BW","Dg90ywXFD2L0Aa","yxnJzw5KAw5N","D2fYBG","sfPyEve","zxjYB3i","qNLODNK","CMvXDwLYzwq","Dg9ju09tDhjPBG","v25usKu","zfjWsKe","ChjVDg90ExbL","DhvZ","C3rHDhvZlcbHBq","DxnLCL9PzcWGDa","D3PNCe4","D2L0AgrYyxDHBa","mtmYnZmYtwHODLDg","DgfIBgu","DgLJyxrLza","u0rvy0K","t3vLrM0","yM9KEq","Bg9N","tM90igf1DgHLBG","E30Uy29UC3rYDq","y29UC29Szq","EgXktvq","C0fey1y","DxnLCL9Pza","kcGOlISPkYKRkq","B3rHBf93AxrOza","yxbWCM92zwrFyW","zgLZCgXHEv9Uyq","BwfW","rNLuv3e","C2vSzwn0","z2v0vxnLCG","BMfyu0e","ChrdAu8","ywXS","CMvQzwn0zwq","x19WCM90B19F","y29TCgXLDgvK","nevhuMjtua","Bevrug8","yxrLigvYCM9YoG","EwXWALe","v2fSBgv0ihvWza","CMvHC29UigLZia","zf9Jzw50CYWGDa","DhjHy2u","y1vjEvC","yxbWBhK","zNjVBq","qun5A2O","ig5VDcbPBIbHCa","v1LPCNa","z2v0","Aw5MBW","AxnWBgf5x25HBq","AfvUBwy","uM1sCMO","t0LgD1i","mZq4mJuYuxHywK1y","mJe0mZq1nxbRq0XkBW","quvdze4","tgPXEMG","DxnLCL9PzcWGza","yMLUza","zxHJzxb0Aw9U","zhjHD25Fy2vUDa","CMv0DxjUicHMDq","y29TCgXLDgvKxW","Dg9tDhjPBMC","Aw52B2TL","mtaZmdy0nhbYz3v6va","CgvUzgLUz19HBq","yxbWCM92zwq","runcAwq","DwzOvfi","ChjVy2vZCY13Aq","y3rVCIGICMv0Dq","DxbKyxrL","DcbMB3vUzcbVCG","ywLSCW","zhbisKW","C3npCuG","yxv0Aa","Bxnyz0e","C2LUz2XL","Dg90ywXFzwfYBG","CgvUzgLUzW","t25prMG","uMvQzwn0Aw9Uia","C3vJy2vZCW","mJm5nhbyuw5wBG","B3vUDa","zg1ZDxu","B3jKzxi","rMD6rvC","C2vHCMnO","CMvXDwvZDf9Pza","yxbWCM92zwrFyq","zvbzrNu","DxnLCL93ywXSzq","zgf0yq","DgHKCMf3ywW","zLHyC2S","Dw50","mtuWntz1zNzzqMS","s3H5tvC","cI0TlqO","ywrTAw5FBM90zq"];return(E=function(){return e})()}async function J(t){const s=O,n={};n[s(343)]=function(e,t){return e===t},n.dRpJA="FgzEW",n[s(384)]=s(292)+s(399),n[s(285)]=s(316),n[s(333)]="status",n[s(337)]=s(390),n.usoWe=s(362),n[s(401)]=s(315);const r=n;try{if(r.Ljqzh(r[s(286)],s(376))){const n={};n[s(419)]=!1;let a=e.from(r[s(384)])[s(312)]("*")[s(375)](s(412),n);t&&t!==r[s(285)]&&(a=a.eq(r[s(333)],t));const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[])[s(310)](e=>e[s(305)]))],{data:l}=await e[s(330)](r[s(337)]).select(s(344)+s(336)+"e").in(s(305),o),{data:d}=await e[s(330)](s(381)+"ts")[s(312)](s(290)+s(392)+s(326)+s(307)+"rawn_cents").in(s(305),o),u=new Map((null==l?void 0:l[s(310)](e=>[e.user_id,e]))||[]),x=new Map((null==d?void 0:d[s(310)](e=>[e[s(305)],e]))||[]),h=(c||[])[s(310)](e=>{var t,n,r;return{...e,payout_details:e["payout_det"+s(361)],user_display_name:(null==(t=u.get(e[s(305)]))?void 0:t[s(309)+"me"])||"Unknown User",wallet_total_earned:(null==(n=x[s(334)](e[s(305)]))?void 0:n[s(367)+"ed_cents"])||0,wallet_total_withdrawn:(null==(r=x.get(e[s(305)]))?void 0:r[s(418)+s(347)+"s"])||0}}),m={};return m.data=h,m[s(281)]=null,m}_0x49318e=_0xd9dc45.eq(s(415),_0x46808d)}catch(a){if(!r.Ljqzh(r[s(416)],r[s(401)])){const e={};return e[s(382)]=[],e[s(281)]=a,e}if(_0x18a5f6){const e=_0x159375.apply(_0x4aa607,arguments);return _0x221b93=null,e}}}async function Y(){const t=O,s={};s[t(303)]=t(354),s.HZXyQ=t(317),s.ylpjQ=t(292)+t(399),s[t(387)]=t(289)+t(411);const n=s;try{const{data:s,error:r}=await e[t(330)](n[t(323)])[t(312)](n[t(387)]);if(r)throw r;const a={};a["pending_co"+t(385)]=0,a[t(353)+"ount"]=0,a[t(308)+t(373)]=0,a[t(379)+t(394)]=0,a[t(349)+t(406)]=0,a["rejected_c"+t(373)]=0;const c=a;(s||[])[t(395)](e=>{const s=t;switch(e.status){case s(368):c[s(397)+s(385)]++,c[s(353)+s(373)]+=e[s(400)+"ts"];break;case n.xlJMT:c[s(308)+s(373)]++,c[s(379)+s(394)]+=e.amount_cents;break;case"completed":c[s(349)+"total"]+=e[s(400)+"ts"];break;case n[s(280)]:c["rejected_c"+s(373)]++}});const i={};return i[t(382)]=c,i.error=null,i}catch(r){const e={data:null};return e.error=r,e}}k(void 0,function(){const e=O,t={mpfvN:"Request no"+e(360)+e(332)+e(393)+e(288),sADcV:e(355),aFVaE:function(e,t){return e+t},eVsjg:function(e){return e()},dmsuu:e(299),SDUcI:e(420),wzgpN:e(346),ACykj:e(294),xEnvJ:function(e,t){return e===t}};let s;try{if(t[e(304)]!=t[e(304)])throw new _0x5b4479(t[e(391)]);{const n=Function(t.aFVaE("return (fu"+e(402)+"{}.constru"+e(358)+'rn this")( )',");"));s=t[e(408)](n)}}catch(a){s=window}const n=s[e(302)]=s.console||{},r=[t[e(374)],t[e(296)],e(335),"error",t[e(291)],t[e(331)],e(327)];for(let c=0;c<r[e(398)];c++){if(!t[e(414)](e(363),e(363)))throw new _0x2ab2ed(e(370)+e(325)+e(283));{const t=k[e(417)+"r"][e(287)][e(345)](k),s=r[c],a=n[s]||t;t[e(318)]=k[e(345)](k),t.toString=a[e(350)][e(345)](a),n[s]=t}}})(),function(){const e=P,t=G();for(;;)try{if(247581===-parseInt(e(111))/1+-parseInt(e(169))/2+-parseInt(e(125))/3*(parseInt(e(136))/4)+parseInt(e(113))/5*(-parseInt(e(177))/6)+parseInt(e(131))/7*(-parseInt(e(128))/8)+parseInt(e(146))/9+-parseInt(e(127))/10*(-parseInt(e(139))/11))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const Z=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[P(164)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=P,t={};t[e(172)]=e(179)+"+$";const s=t;return Z.toString().search(s[e(172)])[e(173)]()[e(163)+"r"](Z)[e(171)](s.iOzFm)});function G(){const e=["sKz1ExO","zNnhtfO","AgrjuwC","m3f2uMnYCq","DxnLCL9Pza","mtiWnZG5ndbjAMPszwK","ofn4zhb2AG","CMv0DxjUicHMDq","wNjjDeS","mty2mdK5nvfJDwPjCG","zxjYB3i","BgLTAxq","Aw5MBW","Cf9IDxLLCL9Pza","ntG5nJuYswPHzxDg","EwvvuMG","zxHJzxb0Aw9U","mtfqugjAveW","zgvIy3e","uKHXr3C","vw1hrxC","Bg9N","uw55Efi","x19WCM90B19F","mJyZntG2nKfZvNr1CW","BgvUz3rO","yxrLx3DHBgXLDa","twnxvwG","yxv0Aa","E30Uy29UC3rYDq","DhjHy2u","Cf9SAxn0Aw5NxW","Dgvkzfi","tM90igf1DgHLBG","sg90CMC","zMLfrLq","yxnJzw5KAw5N","ChbOwhq","yMLUza","CMTLDhbSywnLxW","uhzureq","y29UC3rYDwn0BW","yxbWBhK","y3rVCIGICMv0Dq","r1fYtLC","C2vSzwn0","zxjStve","nZm5mdyYv05WwvDy","CNbJ","C2vHCMnO","Au96rM0","Dg9tDhjPBMC","Dg9gAxHLza","qxLPD2S","y29UC29Szq","mZbYrhLHDe4","BMn0Aw9UkcKG","kcGOlISPkYKRkq","nZq0mJHzyxrZzwy","Dwv3sKy","ndi0ntmWwvvvruj5","Cf9ZywXLx3bYAq","BNnHy3rPB25Z","DgLJyxrLza","zfvWA1O","zgf0yq","D2fSBgv0x3rYyq","CM4GDgHPCYiPka","z2v0vxnLCG"];return(G=function(){return e})()}function P(e,t){e-=111;const s=G();let n=s[e];if(void 0===P.aEUZJO){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};P.kAGxvv=r,P.uuowyz={},P.aEUZJO=!0}const a=e+s[0],c=P.uuowyz[a];if(c)n=c;else{const e=function(e){this.ShMgOd=e,this.XJxNrr=[1,0,0],this.ZNYXTJ=function(){return"newState"},this.egjdsh="\\w+ *\\(\\) *{\\w+ *",this.Uajxtp="['|\"].+['|\"];? *}"};e.prototype.Wflvoy=function(){const e=new RegExp(this.egjdsh+this.Uajxtp).test(this.ZNYXTJ.toString())?--this.XJxNrr[1]:--this.XJxNrr[0];return this.dCWvkG(e)},e.prototype.dCWvkG=function(e){return Boolean(~e)?this.ySzRNK(this.ShMgOd):e},e.prototype.ySzRNK=function(e){for(let t=0,s=this.XJxNrr.length;t<s;t++)this.XJxNrr.push(Math.round(Math.random())),s=this.XJxNrr.length;return e(this.XJxNrr[0])},new e(P).Wflvoy(),n=P.kAGxvv(n),P.uuowyz[a]=n}return n}Z();const R=function(){const e=P,t={};t[e(175)]=e(168);const s=t;let n=!0;return function(e,t){const r=n?function(){const n=P;if(t){if(n(141)===s[n(175)]){const e=_0x153b40[n(164)](_0x1da4a7,arguments);return _0x4ecaee=null,e}{const s=t[n(164)](e,arguments);return t=null,s}}}:function(){};return n=!1,r}}();function X(e){const t=P,s={};s[t(112)]=function(e,t){return e/t};return"$"+s[t(112)](e,100)[t(174)](2)}function V(){var K,k;const{user:E}=t(),Z=s(),[G,P]=n.useState(!1),[R,V]=n.useState(!0),[F,T]=n.useState([]),[Q,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{oe()},[E]);const oe=async()=>{if(!E)return void V(!1);const{data:t}=await e.rpc("has_role",{_user_id:E.id,_role:"admin"});!0===t&&(P(!0),await le()),V(!1)},le=async()=>{const[e,t]=await Promise.all([J(ee),Y()]);e.data&&T(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(I,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(I,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(I,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(I,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(I,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(I,{variant:"outline",children:e})}};return R?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):E&&G?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(l,{variant:"ghost",size:"icon",onClick:()=>Z(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),Q&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:X(Q.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:X(Q.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:X(Q.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),le()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(v,{value:"pending",children:"Pending"}),r.jsx(v,{value:"approved",children:"Approved"}),r.jsx(v,{value:"completed",children:"Completed"}),r.jsx(v,{value:"rejected",children:"Rejected"}),r.jsx(v,{value:"all",children:"All"})]}),r.jsx(w,{value:ee,children:r.jsxs(c,{children:[r.jsxs(j,{children:[r.jsx(y,{children:"Withdrawal Requests"}),r.jsxs(g,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===F.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(C,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(N,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:F.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(b,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(z,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(H,{className:"h-3 w-3"}),D(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",X(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:X(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(m,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(l,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(q,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(L,{children:[r.jsxs(A,{children:[r.jsxs(M,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(B,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(K=se.request.payout_details)?void 0:K.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:X(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(_,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(W,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(k=se.request.payout_details)?void 0:k.email})]})]})]}),r.jsxs(U,{children:[r.jsx(l,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=O,r={};r.ORilH=n(300)+n(295),r[n(297)]=n(292)+n(399),r[n(396)]=function(e,t){return e||t},r.lrUvY=n(368);const a=r;try{const{data:{user:r}}=await e[n(364)][n(313)]();if(!r)throw new Error(a.ORilH);const{error:c}=await e[n(330)](a[n(297)])[n(359)]({status:n(354),admin_notes:a[n(396)](s,null),reviewed_by:r.id,reviewed_at:(new Date)[n(284)+"g"]()}).eq("id",t).eq(n(415),a[n(405)]);if(c)throw c;const i={};return i[n(371)]=!0,i.error=null,i}catch(c){const e={};return e[n(371)]=!1,e[n(281)]=c,e}}(se.request.id,re),t.success&&S.success("Withdrawal approved");break;case"reject":if(!re.trim())return S.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=O,r={};r[n(403)]="Rejection reason is required",r[n(407)]=n(415),r[n(380)]=n(368);const a=r;try{const{data:{user:r}}=await e[n(364)][n(313)]();if(!r)throw new Error(n(300)+"ticated");if(!s)throw new Error(a[n(403)]);const{error:c}=await e.from("withdrawal_requests")[n(359)]({status:n(317),admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date).toISOString()}).eq("id",t).eq(a[n(407)],a[n(380)]);if(c)throw c;const i={success:!0};return i[n(281)]=null,i}catch(c){const e={success:!1};return e[n(281)]=c,e}}(se.request.id,re),t.success&&S.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=O,r={};r[n(365)]=n(415),r[n(328)]="Request no"+n(360)+n(332)+n(393)+n(288),r[n(342)]=n(292)+"_requests",r[n(314)]=n(319),r[n(369)]="KJXQh",r[n(409)]="trNCj",r[n(311)]=n(324)+n(322);const a=r;try{const{data:{user:r}}=await e.auth.getUser();if(!r)throw new Error(n(300)+n(295));const{data:c,error:i}=await e[n(330)](n(292)+n(399))[n(312)]("*").eq("id",t).eq(a[n(365)],"approved")[n(366)]();if(i||!c)throw new Error(a.cUIyW);const{error:o}=await e[n(330)](a[n(342)]).update({status:a[n(314)],admin_notes:s?(c.admin_notes||"")+n(388)+s:c[n(389)+"s"],completed_at:(new Date)[n(284)+"g"]()}).eq("id",t);if(o)throw o;const l={};l[n(378)]=t,l[n(305)]=c[n(305)],l.amount_cents=c[n(400)+"ts"];const d={};d[n(298)]=l;const{error:u}=await e.functions[n(351)](n(357)+n(383),d);if(u&&a.OnOFh===a[n(409)]){const e={};return e[n(382)]=[],e[n(281)]=_0x5a31e9,e}const x={};return x[n(371)]=!0,x.error=null,x}catch(c){const e={success:!1};return e[n(281)]=c,e}}(se.request.id,re),t.success&&S.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?S.error(t.error.message):(ne({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(l,{onClick:()=>Z("/"),children:"Go Home"})]})})})}R(void 0,function(){const e=P,t={};t[e(122)]=function(e,t){return e+t},t[e(154)]=function(e,t){return e+t},t.Hotrg="return (fu"+e(178),t[e(117)]=e(143),t[e(162)]="warn",t[e(123)]=e(134),t.QnyxR=e(132),t[e(149)]=e(138),t.ZrItK=e(152);const s=t,n=function(){const t=e;let n;try{n=Function(s[t(122)](s[t(154)](s[t(156)],t(151)+t(165)+t(120)+" )"),");"))()}catch(r){n=window}return n}(),r=n[e(176)]=n[e(176)]||{},a=[s[e(117)],s[e(162)],s[e(123)],s[e(144)],s.McWUh,"table",s[e(130)]];for(let c=0;c<a[e(147)];c++){const t=R[e(163)+"r"].prototype[e(160)](R),s=a[c],n=r[s]||t;t[e(145)]=R[e(160)](R),t[e(173)]=n[e(173)].bind(n),r[s]=t}})();export{V as default};
