import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b7 as l,B as o,A as d,cb as u,cR as x,a8 as m,D as h,aB as p,aC as f,aD as v,aE as w,p as j,t as g,w as y,dy as b,dt as C,bo as N,dq as q,cZ as z,a1 as D,a2 as B,a3 as L,a4 as _,a5 as A,aW as M,bC as W,dz as I,b as k,y as R}from"./index-Dq7M-Dd_.js";import{C as Y}from"./calendar-CcmZmUfC.js";!function(){const e=U,t=X();for(;;)try{if(666322===parseInt(e(552))/1*(-parseInt(e(576))/2)+parseInt(e(532))/3*(parseInt(e(527))/4)+parseInt(e(523))/5*(parseInt(e(494))/6)+parseInt(e(476))/7*(parseInt(e(506))/8)+parseInt(e(581))/9*(parseInt(e(588))/10)+parseInt(e(518))/11*(parseInt(e(543))/12)+parseInt(e(566))/13*(-parseInt(e(491))/14))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const G=function(){let e=!0;return function(t,s){const n=U;if(n(528)!=n(528)){const e={};return e[n(511)]=!1,e[n(529)]=_0x2bf38a,e}{const r=e?function(){if(s){const e=s[n(517)](t,arguments);return s=null,e}}:function(){};return e=!1,r}}}()(void 0,function(){const e=U;return G[e(570)]()[e(481)](e(480)+"+$")[e(570)]().constructor(G)[e(481)](e(480)+"+$")});G();const S=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}();async function K(t){const s=U,n={};n[s(582)]="withdrawal"+s(521),n[s(590)]=s(559),n[s(512)]=s(484)+"ts";const r=n;try{const n={};n[s(580)]=!1;let a=e[s(475)](r[s(582)]).select("*")[s(489)](s(592),n);t&&"all"!==t&&(a=a.eq("status",t));const{data:c,error:i}=await a;if(i)throw i;const l=[...new Set((c||[])[s(586)](e=>e[s(559)]))],{data:o}=await e[s(475)](s(504))[s(526)](s(560)+"isplay_name").in(r[s(590)],l),{data:d}=await e[s(475)](r[s(512)])[s(526)](s(553)+s(575)+s(578)+s(550)+s(544)).in(r[s(590)],l),u=new Map((null==o?void 0:o.map(e=>[e[s(559)],e]))||[]),x=new Map((null==d?void 0:d[s(586)](e=>[e[s(559)],e]))||[]),m=(c||[])[s(586)](e=>{var t,n,r;return{...e,payout_details:e[s(539)+"ails"],user_display_name:(null==(t=u[s(531)](e[s(559)]))?void 0:t[s(485)+"me"])||s(533)+"er",wallet_total_earned:(null==(n=x[s(531)](e[s(559)]))?void 0:n[s(567)+s(558)])||0,wallet_total_withdrawn:(null==(r=x[s(531)](e.user_id))?void 0:r[s(545)+"drawn_cents"])||0}}),h={};return h[s(564)]=m,h.error=null,h}catch(a){const e={data:[]};return e[s(529)]=a,e}}function U(e,t){e-=474;const s=X();let n=s[e];if(void 0===U.WjvjYq){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};U.krazhu=r,U.GzBpXJ={},U.WjvjYq=!0}const a=e+s[0],c=U.GzBpXJ[a];if(c)n=c;else{const e=function(e){this.YDnMtg=e,this.qsbJna=[1,0,0],this.nAvrbf=function(){return"newState"},this.XvJaAs="\\w+ *\\(\\) *{\\w+ *",this.jRAARi="['|\"].+['|\"];? *}"};e.prototype.otfBkc=function(){const e=new RegExp(this.XvJaAs+this.jRAARi).test(this.nAvrbf.toString())?--this.qsbJna[1]:--this.qsbJna[0];return this.xWrJkF(e)},e.prototype.xWrJkF=function(e){return Boolean(~e)?this.nfpFnG(this.YDnMtg):e},e.prototype.nfpFnG=function(e){for(let t=0,s=this.qsbJna.length;t<s;t++)this.qsbJna.push(Math.round(Math.random())),s=this.qsbJna.length;return e(this.qsbJna[0])},new e(U).otfBkc(),n=U.krazhu(n),U.GzBpXJ[a]=n}return n}function X(){const e=["mtmWnJa4nMP1twXOvG","wKjyBKG","DgfIBgu","y29UC3rYDwn0BW","yKrduum","DxbKyxrL","DhvZ","CMvHC29UigLZia","x19WCM90B19F","yNH6ALy","ChjVzMLSzxm","Bw91BNq","ohLqy3PTCa","DgLJyxrLza","yxbWCM92zwrFyW","yw1VDw50x2nLBG","D2fYBG","C3vJy2vZCW","vg9SDgm","C3rHDhvZ","Dg90ywW","DeXbCK4","rK9SEfG","yxbWBhK","mJyYmZuXmvbgA3PetG","BuTIzKm","y3rMrNO","x3jLCxvLC3rZ","u3Pos1K","nuvdDMXrrq","y29TCgXLDgvKxW","weLYwKe","C2vSzwn0","mtqYoduYogTOwgnvAq","t1zYuvG","zxjYB3i","z1Djq1K","z2v0","nNH1uwzXBq","vw5RBM93BIbvCW","DuDAs3a","wMXZCg4","ChjVDg90ExbL","CMvXDwvZDf9Pza","z2v0vxnLCG","Cgf5B3v0x2rLDa","E30Uy29UC3rYDq","v253tKy","Dg9ju09tDhjPBG","mJroueTSDLm","CMf3BL9Jzw50CW","Dg90ywXFD2L0Aa","CLb0wuS","zgz6DMm","tM90igf1DgHLBG","DgHKCMf3ywW","B3rHBf93AxrOza","y29UC29Szq","muHZwKDTwG","DxnLCL9PzcWGDa","CgvUzgLUz19JBW","tNbTvMq","BgvUz3rO","yxbWCM92zwq","zwrFy2vUDhm","DxnLCL9Pza","DxnLCL9PzcWGza","uMvQzwn0Aw9Uia","ChjVDMvKihn0yq","CMvQzwn0zwrFyW","zgf0yq","BKHTueC","mtnSA0LgDge","Dg90ywXFzwfYBG","yxbWCM92zwrFyq","CMvXDwLYzwq","Dg9tDhjPBMC","A0L5rwi","C2LUz2XL","v2fSBgv0ihvWza","y29TCgXLDgvK","B3rHBf9LyxjUzq","mtCWodiYz01vEwDy","B3vUDa","zf9Jzw50CYWGDa","yxrLigvYCM9YoG","yxnJzw5KAw5N","ndi4nJa3Au1LuMPR","B0TsDeq","D2L0AgrYyxDHBa","cI0TlqO","ywrTAw5FBM90zq","BwfW","C3rHDhvZlcbHBq","mtGWsfzADePy","BMn0Aw9UkcKG","r1rOy1u","EuPYs3q","y3jLyxrLzf9HDa","DundBvC","CgvUzgLUzW","ChjVy2vZCY13Aq","yxv0Aa","Bg9N","A3bYBLi","Ehv6tKm","yMLUza","zNjVBq","odG0mZe3n2jdy05HDq","Eufbu2W","DcbMB3vUzcbVCG","AMXmzeC","kcGOlISPkYKRkq","C2vHCMnO","CgvUzgLUz19HBq","q2Xktum","DxnLCL93ywXSzq","zgLZCgXHEv9Uyq","ywjVreG","CMvQzwn0zwq","B3vUDf9Jzw50CW","B3jKzxi","y3rVCIGICMv0Dq","mZG4odGZndzRAfvgwKu","rgTTsvi","uMvXDwvZDcbUBW"];return(X=function(){return e})()}async function H(){const t=U,s={};s[t(520)]=t(574),s[t(565)]=t(487),s[t(522)]=t(583)+t(521);const n=s;try{const{data:s,error:r}=await e[t(475)](n.SzNKY)[t(526)](t(587)+t(488));if(r)throw r;const a={};a[t(554)+"unt"]=0,a[t(482)+t(577)]=0,a["approved_c"+t(577)]=0,a[t(568)+t(505)]=0,a["completed_"+t(514)]=0,a[t(563)+t(577)]=0;const c=a;(s||[]).forEach(e=>{const s=t;switch(e[s(513)]){case"pending":c[s(554)+"unt"]++,c[s(482)+s(577)]+=e[s(509)+"ts"];break;case s(557):c[s(508)+s(577)]++,c[s(568)+s(505)]+=e.amount_cents;break;case n[s(520)]:c[s(524)+s(514)]+=e.amount_cents;break;case n[s(565)]:c[s(563)+s(577)]++}});const i={};return i[t(564)]=c,i.error=null,i}catch(r){const e={};return e[t(564)]=null,e[t(529)]=r,e}}function J(e,t){e-=317;const s=O();let n=s[e];if(void 0===J.zQlBXY){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};J.WslJms=r,J.yrwxbt={},J.zQlBXY=!0}const a=e+s[0],c=J.yrwxbt[a];if(c)n=c;else{const e=function(e){this.CNqsHI=e,this.jRnlIR=[1,0,0],this.OixdpO=function(){return"newState"},this.IcwXtB="\\w+ *\\(\\) *{\\w+ *",this.fCyNBP="['|\"].+['|\"];? *}"};e.prototype.XmCxvk=function(){const e=new RegExp(this.IcwXtB+this.fCyNBP).test(this.OixdpO.toString())?--this.jRnlIR[1]:--this.jRnlIR[0];return this.pgmrYE(e)},e.prototype.pgmrYE=function(e){return Boolean(~e)?this.TQDgza(this.CNqsHI):e},e.prototype.TQDgza=function(e){for(let t=0,s=this.jRnlIR.length;t<s;t++)this.jRnlIR.push(Math.round(Math.random())),s=this.jRnlIR.length;return e(this.jRnlIR[0])},new e(J).XmCxvk(),n=J.WslJms(n),J.yrwxbt[a]=n}return n}S(void 0,function(){const e=U,t={ZBXnH:function(e,t){return e(t)},xrhNy:function(e,t){return e+t},Zlspn:"return (fu"+e(589),ClJMC:e(540)+e(490)+'rn this")( )',qMbQk:function(e){return e()},yAASl:e(597),bxzjV:"trace"};let s;try{const n=t[e(495)](Function,t.xrhNy(t[e(535)]+t[e(483)],");"));s=t.qMbQk(n)}catch(a){s=window}const n=s[e(551)]=s[e(551)]||{},r=[t[e(477)],e(510),"info","error","exception",e(496),t[e(503)]];for(let c=0;c<r[e(556)];c++){const t=S[e(497)+"r"][e(536)][e(474)](S),s=r[c],a=n[s]||t;t[e(502)]=S.bind(S),t.toString=a[e(570)].bind(a),n[s]=t}})(),function(){const e=J,t=O();for(;;)try{if(267621===parseInt(e(331))/1*(-parseInt(e(358))/2)+-parseInt(e(324))/3+-parseInt(e(364))/4+-parseInt(e(373))/5+parseInt(e(323))/6*(-parseInt(e(325))/7)+-parseInt(e(333))/8+parseInt(e(356))/9*(parseInt(e(380))/10))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const P=function(){const e=J,t={};t[e(339)]=e(376),t.MNolL=e(374),t[e(381)]="kqtXx";const s=t;let n=!0;return function(t,r){const a=e;if("kqtXx"===s[a(381)]){const e=n?function(){const e=a;if(r){if(s[e(339)]!==s.MNolL){const s=r[e(384)](t,arguments);return r=null,s}{const t={};return t[e(372)]=!1,t[e(371)]=_0x18ca18,t}}}:function(){};return n=!1,e}{const e=_0xa5e369[a(368)+"r"][a(383)][a(340)](_0x31e23c),t=_0x3b9ab4[_0x246dd7],s=_0x9edb0d[t]||e;e[a(369)]=_0x3376f3[a(340)](_0x2329d2),e[a(365)]=s.toString[a(340)](s),_0x46df57[t]=e}}}()(void 0,function(){const e=J,t={};t[e(320)]=e(357)+"+$";const s=t;return P[e(365)]()[e(352)](s.dqhmD)[e(365)]().constructor(P).search(e(357)+"+$")});function O(){const e=["z2v0x29Yx2nYzq","BgLTAxq","y3jLyxrLzf9HDa","qKTrENa","yMLUza","z2v0vxnLCG","BgvUz3rO","vLjUC3a","Dg9gAxHLza","C2vSzwn0","zxHJzxb0Aw9U","qxzlveq","BwPcwfu","E30Uy29UC3rYDq","sLLNq2O","B3jKzxi","C2vHCMnO","BMn0Aw9UkcKG","y3rVCIGICMv0Dq","Bg9N","mtuZDvbsrMDy","kcGOlISPkYKRkq","mti5ntq0DNndrg5h","Cf91C2vYx2LK","tM90igf1DgHLBG","r3DMrMy","yxv0Aa","CNbJ","mZy5otq0A1fkv3LA","Dg9tDhjPBMC","zMzezKO","DMvWv3G","y29UC3rYDwn0BW","x19WCM90B19F","zNjVBq","zxjYB3i","C3vJy2vZCW","mZK5mZC1BvjNtxvO","AMDdwfe","zeLTrwq","ELfSr0m","yxnJzw5KAw5N","s0nJAKe","DxnLCL9Pza","otm3mdeWCeL5v2vz","rwTZvgG","zgf0yq","ChjVDg90ExbL","yxbWBhK","DgLJyxrLza","yxrLx3DHBgXLDa","DhjHy2u","zhfOBuq","BNnHy3rPB25Z","v0LjsLO","mtjVsuDks0m","ndiXote0ALPsv2HT","mtCXoduZnwfACKT1Ca","CMv0DxjUicHMDq","y2vFy2vUDhm","reDjq3y","wuzwseC","vLbPtLO","n1bnB3fOrq","D2fYBG","ntqZmdy0uNHXrLb5","Cf9SAxn0Aw5NxW","y29UC29Szq"];return(O=function(){return e})()}P();const Z=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[J(384)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}();function E(e){return"$"+(e/100)[J(344)](2)}function T(){var G,S;const{user:X}=t(),J=s(),[P,O]=n.useState(!1),[Z,T]=n.useState(!0),[F,V]=n.useState([]),[Q,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{le()},[X]);const le=async()=>{if(!X)return void T(!1);const{data:t}=await e.rpc("has_role",{_user_id:X.id,_role:"admin"});!0===t&&(O(!0),await oe()),T(!1)},oe=async()=>{const[e,t]=await Promise.all([K(ee),H()]);e.data&&V(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(R,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(R,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(R,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(R,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(R,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(R,{variant:"outline",children:e})}};return Z?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):X&&P?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(o,{variant:"ghost",size:"icon",onClick:()=>J(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),Q&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:E(Q.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:E(Q.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:E(Q.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),oe()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(v,{value:"pending",children:"Pending"}),r.jsx(v,{value:"approved",children:"Approved"}),r.jsx(v,{value:"completed",children:"Completed"}),r.jsx(v,{value:"rejected",children:"Rejected"}),r.jsx(v,{value:"all",children:"All"})]}),r.jsx(w,{value:ee,children:r.jsxs(c,{children:[r.jsxs(j,{children:[r.jsx(g,{children:"Withdrawal Requests"}),r.jsxs(y,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===F.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(b,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(C,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:F.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(N,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(q,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(Y,{className:"h-3 w-3"}),z(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",E(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:E(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(o,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(o,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(o,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(D,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(B,{children:[r.jsxs(L,{children:[r.jsxs(_,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(A,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(G=se.request.payout_details)?void 0:G.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:E(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(M,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(W,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(S=se.request.payout_details)?void 0:S.email})]})]})]}),r.jsxs(I,{children:[r.jsx(o,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(o,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=U,r={};r[n(534)]=n(525),r[n(516)]="status",r.uCCmW=n(594),r.jlLdG="gWICY";const a=r;try{if(n(525)!==a[n(534)]){const e={};return e[n(511)]=!1,e[n(529)]=_0x5c820e,e}{const{data:{user:r}}=await e[n(596)][n(538)]();if(!r)throw new Error(n(548)+n(507));const{error:c}=await e[n(475)]("withdrawal"+n(521)).update({status:n(557),admin_notes:s||null,reviewed_by:r.id,reviewed_at:(new Date)[n(542)+"g"]()}).eq("id",t).eq(a.FOlxX,a[n(593)]);if(c)throw c;const i={};return i[n(511)]=!0,i[n(529)]=null,i}}catch(c){if(n(530)===a[n(479)]){const e={success:!1};return e[n(529)]=c,e}{const e={data:[]};return e[n(529)]=_0x25094b,e}}}(se.request.id,re),t.success&&k.success("Withdrawal approved");break;case"reject":if(!re.trim())return k.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=U,r={};r[n(591)]=n(561)+n(501)+n(569),r.aboDH=n(513),r[n(546)]="pending";const a=r;try{const{data:{user:r}}=await e[n(596)].getUser();if(!r)throw new Error("Not authenticated");if(!s){if(n(547)!==n(571))throw new Error(a[n(591)]);{const e=_0x32850c[n(497)+"r"][n(536)][n(474)](_0x42de0a),t=_0x5d1818[_0x6b38d9],s=_0x126aab[t]||e;e[n(502)]=_0x5a52db[n(474)](_0x31be27),e.toString=s[n(570)][n(474)](s),_0x34d415[t]=e}}const{error:c}=await e.from(n(583)+n(521)).update({status:n(487),admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date)[n(542)+"g"]()}).eq("id",t).eq(a[n(486)],a.rPtYK);if(c)throw c;const i={success:!0};return i[n(529)]=null,i}catch(c){const e={};return e[n(511)]=!1,e[n(529)]=c,e}}(se.request.id,re),t.success&&k.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=U,r={};r[n(541)]="Request no"+n(478)+" not in ap"+n(562)+n(500),r[n(519)]=n(583)+n(521),r[n(498)]=n(513),r[n(599)]=n(557),r[n(492)]=function(e,t){return e||t},r[n(515)]=n(598),r.NpmVd=n(574),r.npmSm=n(573)+n(579);const a=r;try{const{data:{user:r}}=await e[n(596)][n(538)]();if(!r)throw new Error(n(548)+n(507));const{data:c,error:i}=await e[n(475)](a[n(519)])[n(526)]("*").eq("id",t).eq(a[n(498)],a[n(599)])[n(572)]();if(a[n(492)](i,!c))throw"cYhFs"===a[n(515)]?new _0x8b491(a.WnwNF):new Error(n(493)+"t found or not in ap"+n(562)+"tus");const{error:l}=await e[n(475)](n(583)+n(521))[n(499)]({status:a[n(555)],admin_notes:s?(c.admin_notes||"")+n(584)+s:c[n(585)+"s"],completed_at:(new Date)[n(542)+"g"]()}).eq("id",t);if(l)throw l;const o={};o[n(537)]=t,o.user_id=c.user_id,o[n(509)+"ts"]=c[n(509)+"ts"];const d={};d.body=o;const{error:u}=await e.functions.invoke(n(595)+n(549),d),x={success:!0};return x[n(529)]=null,x}catch(c){const e={};return e[n(511)]=!1,e.error=c,e}}(se.request.id,re),t.success&&k.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?k.error(t.error.message):(ne({type:null,request:null}),ae(""),await oe())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(l,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(o,{onClick:()=>J("/"),children:"Go Home"})]})})})}Z(void 0,function(){const e=J,t={dImEd:function(e,t){return e(t)},YFVHG:e(355),mjBXU:e(371),nqcFh:e(319),VRnsp:function(e,t){return e<t},AvKTD:e(328)},s=function(){const s=e;let n;try{n=t[s(375)](Function,s(326)+s(353)+(s(349)+s(354)+'rn this")( ));'))()}catch(r){n=window}return n}(),n=s[e(335)]=s[e(335)]||{},r=[t[e(329)],e(332),"info",t[e(348)],e(346),"table",t.nqcFh];for(let a=0;t[e(343)](a,r[e(342)]);a++){if(e(322)===t[e(347)]){const t=_0x90d3bc[e(384)](_0x24b8e7,arguments);return _0x5e0807=null,t}{const t=Z[e(368)+"r"].prototype.bind(Z),s=r[a],c=n[s]||t;t[e(369)]=Z[e(340)](Z),t[e(365)]=c[e(365)][e(340)](c),n[s]=t}}})();export{T as default};
