const n='import React, { useState } from \'react\';\nimport { motion } from \'framer-motion\';\nimport { useQuery } from \'@tanstack/react-query\';\nimport { Link, Navigate } from \'react-router-dom\';\nimport { \n  Crown, \n  Shield, \n  Users, \n  ArrowLeft,\n  RefreshCw,\n  MapPin,\n  TrendingUp,\n  ShoppingBag,\n  Wallet,\n  Activity,\n  Image,\n  Wrench,\n  HeartPulse,\n  Code,\n  Zap,\n  LineChart,\n  Presentation,\n  FileText,\n  Sparkles,\n  Network\n} from \'lucide-react\';\nimport { Card, CardContent } from \'@/components/ui/card\';\nimport { Badge } from \'@/components/ui/badge\';\nimport { Button } from \'@/components/ui/button\';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \'@/components/ui/tabs\';\nimport { AdminLocationAnalytics } from \'@/components/admin/AdminLocationAnalytics\';\nimport { AdminSecurityAuditLog } from \'@/components/admin/AdminSecurityAuditLog\';\nimport { supabase } from \'@/integrations/supabase/client\';\nimport { useAuth } from \'@/hooks/useAuth\';\nimport { Header } from \'@/components/shop/Header\';\nimport { Footer } from \'@/components/shop/Footer\';\nimport { AdminUserDetailModal } from \'@/components/admin/AdminUserDetailModal\';\nimport { AdminUserList } from \'@/components/admin/AdminUserList\';\nimport { AdminOrdersPanel } from \'@/components/admin/AdminOrdersPanel\';\nimport { AdminSubscriptionsPanel } from \'@/components/admin/AdminSubscriptionsPanel\';\nimport { AdminActivityFeed } from \'@/components/admin/AdminActivityFeed\';\nimport { AdminMaintenancePanel } from \'@/components/admin/AdminMaintenancePanel\';\nimport { AdminHealthPanel } from \'@/components/admin/AdminHealthPanel\';\nimport { AdminEconomicsPanel } from \'@/components/admin/AdminEconomicsPanel\';\nimport { AdminUserCountBadge } from \'@/components/admin/AdminUserCountBadge\';\nimport { AutoHealPanel } from \'@/components/pensent-code/AutoHealPanel\';\nimport LiveCodebaseDebugger from \'@/components/pensent-code/LiveCodebaseDebugger\';\nimport { UniversalAdapterMonitor } from \'@/components/admin/UniversalAdapterMonitor\';\nimport { UnifiedSystemDashboard } from \'@/components/admin/UnifiedSystemDashboard\';\n\nconst AdminCEODashboard: React.FC = () => {\n  const { user, isLoading: authLoading } = useAuth();\n  const [searchQuery, setSearchQuery] = useState(\'\');\n  const [selectedUserId, setSelectedUserId] = useState<string | null>(null);\n  const [activeTab, setActiveTab] = useState(\'users\');\n\n  // Check if user is admin\n  const { data: isAdmin, isLoading: adminLoading } = useQuery({\n    queryKey: [\'is-admin\', user?.id],\n    queryFn: async () => {\n      if (!user) return false;\n      const { data } = await supabase.rpc(\'has_role\', { _user_id: user.id, _role: \'admin\' });\n      return data === true;\n    },\n    enabled: !!user,\n  });\n\n  // Fetch platform overview stats\n  const { data: overviewStats, refetch: refetchStats } = useQuery({\n    queryKey: [\'admin-ceo-overview\'],\n    queryFn: async () => {\n      const [\n        usersResult,\n        premiumResult,\n        visionsResult,\n        ordersResult,\n        walletsResult,\n      ] = await Promise.all([\n        supabase.from(\'profiles\').select(\'id\', { count: \'exact\', head: true }),\n        supabase.from(\'user_subscriptions\').select(\'id\', { count: \'exact\', head: true }).eq(\'subscription_status\', \'active\'),\n        supabase.from(\'saved_visualizations\').select(\'id\', { count: \'exact\', head: true }),\n        supabase.from(\'order_financials\').select(\'gross_revenue_cents\'),\n        supabase.from(\'user_wallets\').select(\'balance_cents\'),\n      ]);\n\n      const totalOrders = ordersResult.data || [];\n      const totalRevenue = totalOrders.reduce((sum, o) => sum + (o.gross_revenue_cents || 0), 0);\n      const wallets = walletsResult.data || [];\n      const totalWalletBalance = wallets.reduce((sum, w) => sum + (w.balance_cents || 0), 0);\n\n      return {\n        totalUsers: usersResult.count || 0,\n        premiumUsers: premiumResult.count || 0,\n        freeUsers: (usersResult.count || 0) - (premiumResult.count || 0),\n        totalVisions: visionsResult.count || 0,\n        totalRevenue,\n        totalWalletBalance,\n        ordersCount: totalOrders.length,\n      };\n    },\n    enabled: isAdmin === true,\n    staleTime: 30000,\n  });\n\n  // Redirect if not admin\n  if (!authLoading && !adminLoading && (!user || !isAdmin)) {\n    return <Navigate to="/" replace />;\n  }\n\n  if (authLoading || adminLoading) {\n    return (\n      <div className="min-h-screen bg-background flex items-center justify-center">\n        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary" />\n      </div>\n    );\n  }\n\n  const formatCents = (cents: number) => `$${(cents / 100).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\n\n  return (\n    <div className="min-h-screen bg-background">\n      <Header />\n      \n      <main className="container mx-auto px-4 py-8">\n        {/* Back Navigation */}\n        <div className="flex items-center justify-between mb-6">\n          <Link \n            to="/" \n            className="inline-flex items-center gap-2 text-muted-foreground hover:text-primary transition-colors"\n          >\n            <ArrowLeft className="h-4 w-4" />\n            Back to Home\n          </Link>\n          <Button variant="outline" size="sm" onClick={() => refetchStats()} className="gap-2">\n            <RefreshCw className="h-4 w-4" />\n            Refresh\n          </Button>\n        </div>\n\n        {/* Hero Section */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className="relative overflow-hidden rounded-2xl p-8 mb-8 border border-amber-500/30 bg-gradient-to-br from-amber-500/10 via-primary/5 to-amber-500/10"\n        >\n          <div className="relative z-10">\n            <div className="flex items-center gap-3 mb-4">\n              <div className="p-3 rounded-full bg-amber-500/20">\n                <Crown className="h-6 w-6 text-amber-500" />\n              </div>\n              <div>\n                <h1 className="text-3xl font-bold">CEO Command Center</h1>\n                <p className="text-muted-foreground">Complete user & order management for Alec Arthur Shelton</p>\n              </div>\n              <div className="ml-auto flex items-center gap-2">\n                <AdminUserCountBadge />\n                <Badge className="bg-amber-500/20 text-amber-600 border-amber-500/30">\n                  <Shield className="h-3 w-3 mr-1" />\n                  CEO Access\n                </Badge>\n              </div>\n            </div>\n          </div>\n        </motion.div>\n\n        {/* Quick Stats Row */}\n        <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4 mb-8">\n          <Card>\n            <CardContent className="pt-4 pb-3">\n              <div className="flex items-center gap-2 text-muted-foreground mb-1">\n                <Users className="h-3 w-3" />\n                <span className="text-xs">Total Users</span>\n              </div>\n              <p className="text-xl font-bold">{overviewStats?.totalUsers || 0}</p>\n            </CardContent>\n          </Card>\n\n          <Card className="border-primary/30 bg-gradient-to-br from-primary/5 to-primary/10">\n            <CardContent className="pt-4 pb-3">\n              <div className="flex items-center gap-2 text-muted-foreground mb-1">\n                <Crown className="h-3 w-3" />\n                <span className="text-xs">Premium</span>\n              </div>\n              <p className="text-xl font-bold text-primary">{overviewStats?.premiumUsers || 0}</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className="pt-4 pb-3">\n              <div className="flex items-center gap-2 text-muted-foreground mb-1">\n                <Users className="h-3 w-3" />\n                <span className="text-xs">Free Users</span>\n              </div>\n              <p className="text-xl font-bold">{overviewStats?.freeUsers || 0}</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className="pt-4 pb-3">\n              <div className="flex items-center gap-2 text-muted-foreground mb-1">\n                <Image className="h-3 w-3" />\n                <span className="text-xs">Total Visions</span>\n              </div>\n              <p className="text-xl font-bold">{overviewStats?.totalVisions || 0}</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className="pt-4 pb-3">\n              <div className="flex items-center gap-2 text-muted-foreground mb-1">\n                <ShoppingBag className="h-3 w-3" />\n                <span className="text-xs">Orders</span>\n              </div>\n              <p className="text-xl font-bold">{overviewStats?.ordersCount || 0}</p>\n            </CardContent>\n          </Card>\n\n          <Card className="border-green-500/30 bg-gradient-to-br from-green-500/5 to-green-500/10">\n            <CardContent className="pt-4 pb-3">\n              <div className="flex items-center gap-2 text-muted-foreground mb-1">\n                <TrendingUp className="h-3 w-3" />\n                <span className="text-xs">Revenue</span>\n              </div>\n              <p className="text-xl font-bold text-green-500">{formatCents(overviewStats?.totalRevenue || 0)}</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className="pt-4 pb-3">\n              <div className="flex items-center gap-2 text-muted-foreground mb-1">\n                <Wallet className="h-3 w-3" />\n                <span className="text-xs">Wallet Balance</span>\n              </div>\n              <p className="text-xl font-bold">{formatCents(overviewStats?.totalWalletBalance || 0)}</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Quick Links to CEO-Only Features */}\n        <div className="mb-8">\n          <h3 className="text-sm font-medium text-muted-foreground mb-3">CEO Quick Access</h3>\n          <div className="flex flex-wrap gap-2">\n            <Link to="/stock-predictions">\n              <Button variant="outline" size="sm" className="gap-2 border-amber-500/30 text-amber-500 hover:bg-amber-500/10">\n                <LineChart className="h-4 w-4" />\n                Stock Predictions\n              </Button>\n            </Link>\n            <Link to="/trading">\n              <Button variant="outline" size="sm" className="gap-2 border-amber-500/30 text-amber-500 hover:bg-amber-500/10">\n                <Zap className="h-4 w-4" />\n                Trading Terminal\n              </Button>\n            </Link>\n            <Link to="/strategic-plan">\n              <Button variant="outline" size="sm" className="gap-2 border-amber-500/30 text-amber-500 hover:bg-amber-500/10">\n                <FileText className="h-4 w-4" />\n                Strategic Plan\n              </Button>\n            </Link>\n            <Link to="/code-analysis">\n              <Button variant="outline" size="sm" className="gap-2 border-amber-500/30 text-amber-500 hover:bg-amber-500/10">\n                <Code className="h-4 w-4" />\n                Code Analyzer\n              </Button>\n            </Link>\n            <Link to="/showcase">\n              <Button variant="outline" size="sm" className="gap-2 border-amber-500/30 text-amber-500 hover:bg-amber-500/10">\n                <Presentation className="h-4 w-4" />\n                Showcase Tour\n              </Button>\n            </Link>\n            <Link to="/investor-portal">\n              <Button variant="outline" size="sm" className="gap-2 border-amber-500/30 text-amber-500 hover:bg-amber-500/10">\n                <Sparkles className="h-4 w-4" />\n                Investor Portal\n              </Button>\n            </Link>\n          </div>\n        </div>\n\n        {/* Main Tabs */}\n        <Tabs value={activeTab} onValueChange={setActiveTab} className="space-y-6">\n          <TabsList className="grid w-full grid-cols-11">\n            <TabsTrigger value="users" className="gap-2">\n              <Users className="h-4 w-4" />\n              <span className="hidden sm:inline">Users</span>\n            </TabsTrigger>\n            <TabsTrigger value="economics" className="gap-2">\n              <TrendingUp className="h-4 w-4" />\n              <span className="hidden sm:inline">Econ</span>\n            </TabsTrigger>\n            <TabsTrigger value="orders" className="gap-2">\n              <ShoppingBag className="h-4 w-4" />\n              <span className="hidden sm:inline">Orders</span>\n            </TabsTrigger>\n            <TabsTrigger value="subscriptions" className="gap-2">\n              <Crown className="h-4 w-4" />\n              <span className="hidden sm:inline">Subs</span>\n            </TabsTrigger>\n            <TabsTrigger value="activity" className="gap-2">\n              <Activity className="h-4 w-4" />\n              <span className="hidden sm:inline">Activity</span>\n            </TabsTrigger>\n            <TabsTrigger value="locations" className="gap-2">\n              <MapPin className="h-4 w-4" />\n              <span className="hidden sm:inline">Locations</span>\n            </TabsTrigger>\n            <TabsTrigger value="security" className="gap-2">\n              <Shield className="h-4 w-4" />\n              <span className="hidden sm:inline">Security</span>\n            </TabsTrigger>\n            <TabsTrigger value="maintenance" className="gap-2">\n              <Wrench className="h-4 w-4" />\n              <span className="hidden sm:inline">Maint.</span>\n            </TabsTrigger>\n            <TabsTrigger value="health" className="gap-2">\n              <HeartPulse className="h-4 w-4" />\n              <span className="hidden sm:inline">Health</span>\n            </TabsTrigger>\n            <TabsTrigger value="codebase" className="gap-2 text-amber-500">\n              <Code className="h-4 w-4" />\n              <span className="hidden sm:inline">Code</span>\n            </TabsTrigger>\n            <TabsTrigger value="universal" className="gap-2 text-violet-500">\n              <Network className="h-4 w-4" />\n              <span className="hidden sm:inline">Universal</span>\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value="users">\n            <AdminUserList \n              searchQuery={searchQuery}\n              setSearchQuery={setSearchQuery}\n              onSelectUser={setSelectedUserId}\n            />\n          </TabsContent>\n\n          <TabsContent value="economics">\n            <AdminEconomicsPanel />\n          </TabsContent>\n\n          <TabsContent value="orders">\n            <AdminOrdersPanel />\n          </TabsContent>\n\n          <TabsContent value="subscriptions">\n            <AdminSubscriptionsPanel />\n          </TabsContent>\n\n          <TabsContent value="activity">\n            <AdminActivityFeed />\n          </TabsContent>\n\n          <TabsContent value="locations">\n            <AdminLocationAnalytics />\n          </TabsContent>\n\n          <TabsContent value="security">\n            <AdminSecurityAuditLog />\n          </TabsContent>\n\n          <TabsContent value="maintenance">\n            <AdminMaintenancePanel />\n          </TabsContent>\n\n          <TabsContent value="health">\n            <AdminHealthPanel />\n          </TabsContent>\n\n          <TabsContent value="codebase">\n            <div className="space-y-6">\n              <div className="text-center mb-4">\n                <h2 className="text-2xl font-bold flex items-center justify-center gap-2">\n                  <Code className="h-6 w-6 text-amber-500" />\n                  Self-Healing Codebase System\n                </h2>\n                <p className="text-muted-foreground">\n                  Continuous analysis and auto-fix capabilities for the En Pensent platform\n                </p>\n              </div>\n              \n              {/* Auto-Heal Panel */}\n              <AutoHealPanel />\n              \n              {/* Live Codebase Debugger */}\n              <LiveCodebaseDebugger />\n            </div>\n          </TabsContent>\n\n          <TabsContent value="universal">\n            <div className="space-y-6">\n              <div className="text-center mb-4">\n                <h2 className="text-2xl font-bold flex items-center justify-center gap-2">\n                  <Network className="h-6 w-6 text-violet-500" />\n                  Unified System Command Center\n                </h2>\n                <p className="text-muted-foreground">\n                  Real-time telemetry from code analysis, adapters, evolution events, and cross-domain resonance\n                </p>\n              </div>\n              \n              {/* Unified System Dashboard with live visualizations */}\n              <UnifiedSystemDashboard />\n            </div>\n          </TabsContent>\n        </Tabs>\n\n        {/* User Detail Modal */}\n        <AdminUserDetailModal \n          userId={selectedUserId}\n          open={!!selectedUserId}\n          onClose={() => setSelectedUserId(null)}\n        />\n      </main>\n\n      <Footer />\n    </div>\n  );\n};\n\nexport default AdminCEODashboard;\n';export{n as default};
