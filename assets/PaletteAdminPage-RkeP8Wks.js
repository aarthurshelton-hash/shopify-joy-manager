import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as m,t as h,P as x,w as f,B as p,bM as w,cj as g,a9 as j,am as v,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as k,cu as S,b as D}from"./index-DxnJiuLa.js";function A(){const e=["zNjVBq","y1HUBNC","mJG0mtGYohrZyurfrW","CMv0DxjUicHMDq","Dg9tDhjPBMC","yMLUza","rxjYB3iGAw4Gyq","uw1qEMS","BwviBMC","C2vSzwn0","yMXHy2TFy29SBW","mZa1mdC1nK9tD3H0rG","yMXHy2S","DgzdA20","qLLUCwm","txj3ug4","DhjHy2u","zMLUza","r3flyLC","yLngyNe","BMn0Aw9UkcKG","ihjVBgu6","kcGOlISPkYKRkq","veviA2y","odCZnZi5nw9QChj4Aq","y29UC3rYDwn0BW","C2vHCMnO","ueDsu1qXmty","DLjzCLC","zgf0yq","rxjYB3iGy291BG","Eg5QBuq","DNzfqxK","zeTyAwC","zcb2Axn1ywXPEG","mJaXodC5shDtrg5L","y3rVCIGICMv0Dq","zgvSzxrL","ndbMz2XqwKG","zgfrrM8","ywrTAw4","ywXPEMf0Aw9UCW","AwXjB2G","uK5RwNm","mteZmJboA1LND3m","yxbWBhK","B3ztqwK","Bg9N","D2HPDgu","zg1PBIbJAgvJAW","zxjYAwrLCW","CgfSzxr0zv9Pza","Bw9KAwzPzwrFyG","mtC5mZiXnfb3D3zpuG","otG1wNjpzwTb","ChjVDg90ExbL","v25mB0S","CgfSzxr0zv9VDG","x19WCM90B19F","B3jKzxi","ELDpr3K","DMLZDwfSAxPHDa","ELDxvvG","x3jVBgu","DgLUzYbSAw5Rzq","E30Uy29UC3rYDq","rxjYB3iGy2HLyW","BgLUA2vKugfSzq","A2LUzYbHzg1PBG","Bfj3ufy","Dw1Hrwq","y29Kzq","mte3ow5KDxLnyW","s3Hqq0S","CNbJ","DMvYC2LVBG","Aw5MBW","DxbKyxrL","C2f2zwrFDMLZDq","DgfIBgu","mZy2nZj2rM9psuq","DhrLswq","AgfZx3jVBgu","D2HPDgvFy29SBW","mtiWvLbMC2vJ","zxjYB3i","BgvUz3rO","y29UC29Szq","weHrrxG"];return(A=function(){return e})()}!function(){const e=L,s=A();for(;;)try{if(942831===parseInt(e(478))/1+parseInt(e(552))/2*(parseInt(e(549))/3)+parseInt(e(525))/4+parseInt(e(479))/5*(parseInt(e(505))/6)+-parseInt(e(538))/7+-parseInt(e(469))/8*(-parseInt(e(497))/9)+parseInt(e(509))/10*(-parseInt(e(516))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const B=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[L(470)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=L,s={};s.daQFo=e(536)+"+$";const t=s;return B[e(518)]()[e(540)](t[e(553)]).toString()[e(539)+"r"](B)[e(540)](t.daQFo)});B();const q=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[L(470)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();async function P(s,t,n,r){const a=L,i={};i.bSFbq=a(482)+a(475),i[a(542)]=function(e,s){return e+s},i[a(545)]=function(e,s){return e+s};const c=i;try{const{data:i}=await async function(s){const t=L,n={};n.LsZsF=t(476),n[t(471)]=t(541);const r=n;try{const{data:n,error:a}=await e.from(t(482)+t(475))[t(523)]("*").eq(r.LsZsF,s).single();if(a&&a[t(496)]!==r[t(471)])throw a;const i={};return i[t(543)]=n,i[t(510)]=null,i}catch(a){const e={data:null};return e[t(510)]=a,e}}(s);if(i){const{error:o}=await e[a(514)](c[a(533)])[a(502)]({white_colors:t,black_colors:n,modified_by:r,version:c[a(542)](i[a(500)],1)}).eq(a(476),s);if(o)throw o;return{error:null,version:c.xnjmD(i[a(500)],1)}}{const i={};i[a(476)]=s,i[a(508)+"rs"]=t,i[a(524)+"rs"]=n,i[a(477)+"y"]=r,i[a(500)]=1;const{error:o}=await e[a(514)](c[a(533)]).insert(i);if(o)throw o;const l={};return l[a(510)]=null,l[a(500)]=1,l}}catch(o){const e={};return e[a(510)]=o,e[a(500)]=0,e}}function L(e,s){e-=466;const t=A();let n=t[e];if(void 0===L.SLAbNG){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};L.HWEMoT=r,L.hiVApa={},L.SLAbNG=!0}const a=e+t[0],i=L.hiVApa[a];if(i)n=i;else{const e=function(e){this.NgReLg=e,this.EANrwP=[1,0,0],this.hSTGOR=function(){return"newState"},this.zfnHeF="\\w+ *\\(\\) *{\\w+ *",this.SKwhnA="['|\"].+['|\"];? *}"};e.prototype.pcPQZo=function(){const e=new RegExp(this.zfnHeF+this.SKwhnA).test(this.hSTGOR.toString())?--this.EANrwP[1]:--this.EANrwP[0];return this.kljDSg(e)},e.prototype.kljDSg=function(e){return Boolean(~e)?this.HGObPQ(this.NgReLg):e},e.prototype.HGObPQ=function(e){for(let s=0,t=this.EANrwP.length;s<t;s++)this.EANrwP.push(Math.round(Math.random())),t=this.EANrwP.length;return e(this.EANrwP[0])},new e(L).pcPQZo(),n=L.HWEMoT(n),L.hiVApa[a]=n}return n}async function M(s){const t=L,n={};n[t(522)]="id, game_data",n[t(467)]=function(e,s){return e===s},n.zWWUX=t(544)+t(489)+t(548)+"ations:";const r=n;try{const{data:n,error:a}=await e[t(514)](t(503)+t(466))[t(523)](r[t(522)]);if(a)throw a;let i=0;for(const e of n||[]){const n=e.game_data[t(486)+"ionState"];((null==n?void 0:n.paletteId)===s||r[t(467)](null==n?void 0:n[t(492)+t(506)],s))&&i++}return i}catch(a){return 0}}q(void 0,function(){const e=L,s={YDxqD:function(e,s){return e+s},qKgEK:function(e,s){return e+s},TEHkf:function(e){return e()},RNkZs:e(472),lRwPV:"exception",GqKbW:function(e,s){return e<s},KxPCK:function(e,s){return e!==s},SWlhk:"tPgol"};let t;try{const n=Function(s.YDxqD(s.qKgEK(e(517)+e(534),e(490)+e(550)+'rn this")( )'),");"));t=s[e(537)](n)}catch(a){t=window}const n=t[e(512)]=t[e(512)]||{},r=[s[e(468)],"warn",e(501),e(510),s[e(494)],e(504),e(530)];for(let i=0;s[e(532)](i,r[e(511)]);i++)if(s[e(498)](s.SWlhk,"tPgol")){if(_0x31c040){const s=_0x337be9[e(470)](_0x520036,arguments);return _0x27485c=null,s}}else{const s=q[e(539)+"r"][e(480)].bind(q),t=r[i],a=n[t]||s;s[e(483)]=q[e(519)](q),s.toString=a[e(518)].bind(a),n[t]=s}})();const G=["k","q","r","b","n","p"],K={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},E=()=>{var A,B,q,E;const{user:W}=s(),H=t(),[U,I]=n.useState(!1),[_,F]=n.useState(!0),[Z,Y]=n.useState([]),[R,V]=n.useState(null),[T,X]=n.useState(null),[Q,O]=n.useState({}),[$,J]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!W)return void H("/");if(!(await async function(s){const t=L,n={MrwPn:function(e){return e()},cXnnw:t(507),BYnqc:t(491)+t(493)+t(535),QmPzk:t(485)};try{const r={};r._user_id=s,r[t(488)]=t(554);const{data:a,error:i}=await e[t(499)](n[t(515)],r);return!i&&!0===a}catch(r){if(n[t(521)]===t(485))return!1;{const e=_0x9484ef("return (fu"+t(534)+(t(490)+t(550))+'rn this")( ));');_0x33887b=ptUUsr[t(529)](e)}}}(W.id)))return D.error("Access denied",{description:"Admin privileges required"}),void H("/");I(!0),await te(),F(!1)})()},[W,H]);const te=async()=>{const{data:s}=await async function(){const s=L,t={};t.tfCkm="palette_ov"+s(475),t.WnLoK=s(476);const n=t;try{const{data:t,error:r}=await e.from(n[s(527)])[s(523)]("*")[s(484)](n[s(481)]);if(r)throw r;const a={};return a[s(543)]=t||[],a[s(510)]=null,a}catch(r){const e={};return e[s(543)]=[],e.error=r,e}}();Y(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await M(e.id);O(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=Z.find(s=>s.palette_id===e);V(e),X({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{T&&X({...T,[e]:{...T[e],[s]:t}})},ae=async()=>{if(!R||!T||!W)return;J(!0),se(!1);const{error:e,version:s}=await P(R,T.white,T.black,W.id);e?D.error("Failed to save",{description:e.message}):(D.success("Palette updated!",{description:`Version ${s} saved. ${Q[R]||0} visualizations will use the new colors.`}),await te()),J(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>Z.some(s=>s.palette_id===e);return _?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):U?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(R===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),Q[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),Q[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[G.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),G.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:R&&T?r.jsxs(o,{children:[r.jsx(m,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(h,{className:"flex items-center gap-2",children:[r.jsx(x,{className:"h-5 w-5"}),null==(A=ie(R))?void 0:A.name]}),r.jsx(f,{children:null==(B=ie(R))?void 0:B.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(R)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!R)return;J(!0);const{error:s}=await async function(s){const t=L,n={};n[t(547)]=t(546),n[t(513)]=t(482)+t(475);const r=n;try{if(t(546)===r[t(547)]){const{error:n}=await e[t(514)](r[t(513)])[t(551)]().eq(t(476),s);if(n)throw n;const a={};return a[t(510)]=null,a}{const e={};return e[t(543)]=null,e.error=_0x3311e,e}}catch(a){const e={};return e[t(510)]=a,e}}(R);s?D.error("Failed to revert",{description:s.message}):(D.success("Reverted to defaults"),ne(R),await te()),J(!1)},disabled:$,children:[r.jsx(w,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!R||!T||!W)return;(Q[R]||0)>0?se(!0):await ae()},disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(g,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(q=ie(R))?void 0:q.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:G.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:K[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:T.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:T.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(E=ie(R))?void 0:E.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:G.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:K[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:T.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:T.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(v,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:G.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:T.white[e]},title:K[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:G.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:T.black[e]},title:K[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(x,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(k,{children:["This palette is linked to ",r.jsx("strong",{children:Q[R||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(S,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{E as default};
