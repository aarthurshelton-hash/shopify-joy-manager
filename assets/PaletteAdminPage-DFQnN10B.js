import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as l,x as o,y as d,aP as u,p as x,t as m,P as h,w as f,B as v,bM as p,cj as j,a9 as g,am as w,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as k,cu as B,b as D}from"./index-Ddz_gr3U.js";!function(){const e=_,s=M();for(;;)try{if(977487===-parseInt(e(451))/1+parseInt(e(445))/2*(parseInt(e(352))/3)+-parseInt(e(402))/4*(parseInt(e(391))/5)+parseInt(e(436))/6+parseInt(e(431))/7*(parseInt(e(390))/8)+parseInt(e(456))/9+parseInt(e(432))/10*(-parseInt(e(363))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const q=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[_(415)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=_,s={};s.BbBjF=e(410)+"+$";const t=s;return q[e(356)]()[e(381)](t[e(407)])[e(356)]()[e(371)+"r"](q)[e(381)](e(410)+"+$")});q();const P=function(){const e=_,s={};s[e(392)]=function(e,s){return e!==s},s[e(379)]=e(428),s[e(447)]=function(e,s){return e+s},s[e(446)]=e(364)+e(424),s[e(384)]=e(366);const t=s;let n=!0;return function(s,r){const a=e,i={MNRNg:function(e,s){return t[_(447)](e,s)},Axvps:t[a(446)]};if(t.uwFVd!==t[a(384)])return _0x162145[a(438)](a(406)+a(370)+":",_0x1cc74f),!1;{const e=n?function(){const e=a;if(r){if(!t[e(392)](t.iQENU,t.iQENU)){const e=r.apply(s,arguments);return r=null,e}_0x533c0c=_0x5dbe70(i[e(394)](i[e(389)],e(382)+'ctor("return this")( )')+");")()}}:function(){};return n=!1,e}}}();function _(e,s){e-=352;const t=M();let n=t[e];if(void 0===_.hBqrRy){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};_.cwjagf=r,_.dVrubB={},_.hBqrRy=!0}const a=e+t[0],i=_.dVrubB[a];if(i)n=i;else{const e=function(e){this.hnhOWP=e,this.NkjuQV=[1,0,0],this.cCtgND=function(){return"newState"},this.UcdVJe="\\w+ *\\(\\) *{\\w+ *",this.gBPEuM="['|\"].+['|\"];? *}"};e.prototype.KRkOGO=function(){const e=new RegExp(this.UcdVJe+this.gBPEuM).test(this.cCtgND.toString())?--this.NkjuQV[1]:--this.NkjuQV[0];return this.vqOWwD(e)},e.prototype.vqOWwD=function(e){return Boolean(~e)?this.FnNBfN(this.hnhOWP):e},e.prototype.FnNBfN=function(e){for(let s=0,t=this.NkjuQV.length;s<t;s++)this.NkjuQV.push(Math.round(Math.random())),t=this.NkjuQV.length;return e(this.NkjuQV[0])},new e(_).KRkOGO(),n=_.cwjagf(n),_.dVrubB[a]=n}return n}async function A(s){const t=_,n={};n[t(449)]=t(419)+t(441),n[t(434)]=function(e,s){return e!==s},n[t(388)]=t(380);const r=n;try{const{data:n,error:a}=await e[t(387)](r[t(449)])[t(448)]("*").eq(t(421),s)[t(420)]();if(a&&r.TsLCW(a[t(412)],r[t(388)]))throw a;const i={};return i[t(362)]=n,i[t(438)]=null,i}catch(a){const e={data:null};return e[t(438)]=a,e}}function M(){const e=["vfD3ruW","zgPPD3m","C2f2zwrFDMLZDq","B3jKzxi","yLnKq0q","zgf0yq","mtu1ntCZqururfPR","CMv0DxjUicHMDq","yMLUza","sKHHBxy","zMLUza","AgfZx3jVBgu","yMXHy2S","zg1PBIbJAgvJAW","y29UC3rYDwn0BW","sgDbz1C","z2fTzv9KyxrH","zgvSzxrL","r2DTyvi","A1P3B3C","wvjMBeK","C2vmq3G","AvfftLu","ueDsu1qXmty","C2vHCMnO","E30Uy29UC3rYDq","uuPzzKe","DxDgvMq","DhrLswq","DKfMEKG","zNjVBq","BvzTveO","qxH2Chm","ofnbvw52wG","mJaYmgDmt3v3BW","u2PYC0G","DgfIBgu","tu5stMC","D2HPDgvFy29SBW","qwTitNy","DMLZDwfSAxPHDa","yMXHy2TFy29SBW","q0nZyMK","zLz1zxm","rxjYB3iGy291BG","mtq4ndbywgXyBLu","D2fYBG","DMvYC2LVBG","D2HPDgu","rxjYB3iGAw4Gyq","qMjcAKy","vwrPtwG","zcb2Axn1ywXPEG","kcGOlISPkYKRkq","ywXPEMf0Aw9UCW","y29Kzq","rxjYB3iGy2HLyW","DhjHy2u","yxbWBhK","D1zvr1G","sLDrs28","ihjVBgu6","CgfSzxr0zv9VDG","C2LUz2XL","CgfSzxr0zv9Pza","B1nQuuq","ChjVDg90ExbL","BMn0Aw9UkcKG","Aw5Zzxj0","y29UC29Szq","y3rVCIGICMv0Dq","BKTiwNm","ywrTAw4","ANHqzuu","ntiZnJaYmvz2wxvVqq","mteWwK90tLPt","rvncuNG","vhnmq1C","Aw9Uu3rHDgu","mta5mZG5mgD2zvLyDW","Aw5MBW","zxjYB3i","zxHJzxb0Aw9U","Bw9KAwzPzwrFyG","zxjYAwrLCW","tMLKseG","qwHdBLO","BgvUz3rO","mty1nfjmsKPqsG","rNLkv0O","AKP3u00","C2vSzwn0","wLvNANO","Dhb0yuK","ntKYnJCXrLLPENvV","x19WCM90B19F","DgLUzYbSAw5Rzq","CgfSzxr0zuLK","wuzZzem","mtyYndK0nJrnEfvNq00","mtC3m2rxzu5kqq","tLrvq3y","v2vjzeu","CM4GDgHPCYiPka","Dg9tDhjPBMC"];return(M=function(){return e})()}async function K(s){const t=_,n={};n[t(386)]=t(359)+t(411),n.CBVBP=function(e,s){return e===s},n[t(383)]=function(e,s){return e===s},n[t(422)]=t(401)+t(453)+t(409)+"ations:";const r=n;try{const{data:n,error:a}=await e.from(r[t(386)])[t(448)]("id, game_data");if(a)throw a;let i=0;for(const e of n||[]){const n=e[t(373)][t(397)+t(435)];if((null==n?void 0:n[t(454)])===s||r.CBVBP(null==n?void 0:n["linkedPale"+t(385)],s)){if(r[t(383)](t(376),t(375))){const e=_0x1ca627[t(415)](_0x36e718,arguments);return _0x1dc0d2=null,e}i++}}return i}catch(a){return 0}}P(void 0,function(){const e=_,s={};s[e(399)]=e(361),s[e(417)]=e(364)+e(424),s[e(430)]=e(382)+e(427)+e(355)+" )",s[e(372)]=e(403),s[e(400)]=e(437),s[e(433)]=e(438),s[e(455)]=e(439),s[e(408)]=e(393),s.gadye=e(414);const t=s,n=function(){const s=e;if("bSdCD"===t[s(399)]){let e;try{e=Function(t.JWQKo+t[s(430)]+");")()}catch(n){e=window}return e}return _0x2ecc67.error(s(401)+"ting linke"+s(409)+"ations:",_0x1f5b34),0}(),r=n[e(426)]=n[e(426)]||{},a=["log",t.HgAgW,t[e(400)],t.ESBRx,t[e(455)],t[e(408)],t.gadye];for(let i=0;i<a[e(444)];i++){const s=P[e(371)+"r"][e(423)][e(365)](P),t=a[i],n=r[t]||s;s[e(452)]=P[e(365)](P),s[e(356)]=n[e(356)][e(365)](n),r[t]=s}})();const L=["k","q","r","b","n","p"],S={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},G=()=>{var q,P,M,G;const{user:V}=s(),W=t(),[H,U]=n.useState(!1),[O,E]=n.useState(!0),[I,Y]=n.useState([]),[R,Q]=n.useState(null),[F,T]=n.useState(null),[J,Z]=n.useState({}),[$,X]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!V)return void W("/");if(!(await async function(s){const t=_,n={};n[t(358)]=t(357),n[t(354)]=t(368),n[t(378)]=t(429);const r=n;try{if(t(357)!==r[t(358)]){const e=_0x3df209.apply(_0xabfbdd,arguments);return _0x56786f=null,e}{const{data:n,error:a}=await e.rpc(r[t(354)],{_user_id:s,_role:r[t(378)]});return!a&&!0===n}}catch(a){return!1}}(V.id)))return D.error("Access denied",{description:"Admin privileges required"}),void W("/");U(!0),await te(),E(!1)})()},[V,W]);const te=async()=>{const{data:s}=await async function(){const s=_;try{const{data:t,error:n}=await e[s(387)](s(419)+s(441))[s(448)]("*")[s(360)](s(421));if(n)throw n;const r={};return r.data=t||[],r[s(438)]=null,r}catch(t){const e={};return e[s(362)]=[],e[s(438)]=t,e}}();Y(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await K(e.id);Z(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=I.find(s=>s.palette_id===e);Q(e),T({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{F&&T({...F,[e]:{...F[e],[s]:t}})},ae=async()=>{if(!R||!F||!V)return;X(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,r){const a=_,i={raQyz:function(e,s){return e(s)},NTUCv:function(e,s){return e+s},HkOEG:function(e,s){return e!==s},AkHNv:a(419)+a(441),fhgKy:function(e,s){return e===s},glvpA:"RtlbV"};try{const{data:c}=await i.raQyz(A,s);if(c){const{error:l}=await e.from(a(419)+a(441)).update({white_colors:t,black_colors:n,modified_by:r,version:i[a(353)](c[a(404)],1)}).eq(a(421),s);if(l)throw l;const o={};return o[a(438)]=null,o.version=c.version+1,o}if(i.HkOEG(a(442),a(442))){const e={};return e[a(362)]=null,e.error=_0x1c2be2,e}{const c={};c.palette_id=s,c[a(395)+"rs"]=t,c[a(398)+"rs"]=n,c[a(440)+"y"]=r,c[a(404)]=1;const{error:l}=await e.from(i[a(396)])[a(425)](c);if(l)throw l;const o={};return o[a(438)]=null,o[a(404)]=1,o}}catch(c){if(i.fhgKy(a(377),i.glvpA)){const e=_0x5c7026?function(){if(_0x552823){const e=_0x402107[a(415)](_0x4f928b,arguments);return _0x5bf9b3=null,e}}:function(){};return _0x212577=!1,e}{const e={};return e[a(438)]=c,e.version=0,e}}}(R,F.white,F.black,V.id);s?D.error("Failed to save",{description:s.message}):(D.success("Palette updated!",{description:`Version ${t} saved. ${J[R]||0} visualizations will use the new colors.`}),await te()),X(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>I.some(s=>s.palette_id===e);return O?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):H?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(l,{className:"cursor-pointer transition-all hover:border-primary/50 "+(R===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(o,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),J[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),J[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[L.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),L.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:R&&F?r.jsxs(l,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(m,{className:"flex items-center gap-2",children:[r.jsx(h,{className:"h-5 w-5"}),null==(q=ie(R))?void 0:q.name]}),r.jsx(f,{children:null==(P=ie(R))?void 0:P.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(R)&&r.jsxs(v,{variant:"outline",size:"sm",onClick:async()=>{if(!R)return;X(!0);const{error:s}=await async function(s){const t=_,n={AhCnZ:function(e,s){return e!==s}};try{if(n[t(443)](t(450),t(416))){const{error:n}=await e[t(387)]("palette_ov"+t(441))[t(374)]().eq(t(421),s);if(n)throw n;const r={};return r[t(438)]=null,r}if(_0x143d9f){const e=_0x3d54e9[t(415)](_0x2dea68,arguments);return _0x21c100=null,e}}catch(r){const e={};return e[t(438)]=r,e}}(R);s?D.error("Failed to revert",{description:s.message}):(D.success("Reverted to defaults"),ne(R),await te()),X(!1)},disabled:$,children:[r.jsx(p,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(v,{size:"sm",onClick:async()=>{if(!R||!F||!V)return;(J[R]||0)>0?se(!0):await ae()},disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(j,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(o,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(M=ie(R))?void 0:M.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:S[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(g,{type:"color",value:F.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(g,{type:"text",value:F.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(G=ie(R))?void 0:G.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:S[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(g,{type:"color",value:F.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(g,{type:"text",value:F.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(w,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:L.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:F.white[e]},title:S[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:L.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:F.black[e]},title:S[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(l,{className:"h-full flex items-center justify-center",children:r.jsxs(o,{className:"text-center py-12",children:[r.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(k,{children:["This palette is linked to ",r.jsx("strong",{children:J[R||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(v,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(v,{onClick:ae,disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(B,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{G as default};
