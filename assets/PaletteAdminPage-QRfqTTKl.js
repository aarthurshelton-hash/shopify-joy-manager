import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as l,x as o,y as d,aP as u,p as m,t as x,P as h,w as f,B as p,bM as j,cj as g,a9 as v,am as w,a1 as y,a2 as N,a3 as C,a4 as b,bC as z,a5 as B,cu as k,b as L}from"./index-D4HOopRf.js";!function(){const e=A,s=M();for(;;)try{if(805171===parseInt(e(371))/1+-parseInt(e(433))/2+parseInt(e(389))/3*(parseInt(e(384))/4)+parseInt(e(406))/5*(parseInt(e(426))/6)+parseInt(e(423))/7+parseInt(e(374))/8*(parseInt(e(377))/9)+parseInt(e(427))/10)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const P=function(){const e={};e[A(396)]=function(e,s){return e!==s};const s=e;let t=!0;return function(e,n){const r=t?function(){const t=A;if(n){if(s[t(396)]("KPkci","KPkci")){const e={};return e.error=_0x132f1d,e}{const s=n[t(385)](e,arguments);return n=null,s}}}:function(){};return t=!1,r}}()(void 0,function(){const e=A;return P[e(454)]()[e(416)](e(425)+"+$")[e(454)]().constructor(P)[e(416)](e(425)+"+$")});P();const D=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[A(385)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();async function S(s){const t=A,n={};n[t(435)]="palette_overrides",n[t(445)]="palette_id",n[t(431)]=t(394);const r=n;try{const{data:n,error:a}=await e[t(369)](r[t(435)])[t(401)]("*").eq(r[t(445)],s)[t(424)]();if(a&&a[t(405)]!==r[t(431)])throw a;const i={};return i.data=n,i[t(390)]=null,i}catch(a){const e={};return e[t(412)]=null,e.error=a,e}}function M(){const e=["B3jKzxi","DgfIBgu","yMXHy2TFy29SBW","C2vHCMnO","DMLZDwfSAxPHDa","CNbJ","quDdCLG","AMPnCeS","ywrTAw4","AgfZx3jVBgu","ote5odi4BhHSDMXc","C2LUz2XL","kcGOlISPkYKRkq","nZiWnK1LDMfQzW","mty5otyXmgjvwNP5uq","yMXHy2S","CMHmvLG","reD3q20","EMLnBvK","zxjYAwrLCW","mZa1mZiXmg15CgzeuG","qunHwLC","tKzZt0q","zMLUza","x3jVBgu","yMLUza","ihjVBgu6","CgfSzxr0zv9VDG","zxHJzxb0Aw9U","yxrH","BM5Lq3G","DhjHy2u","shvPEwW","BMn0Aw9UkcKG","zg1PBIbJAgvJAW","r3HVrgy","CgfSzxr0zv9Pza","EKDmD0C","DMvYC2LVBG","BxbnB2C","E30Uy29UC3rYDq","Dg9tDhjPBMC","D2HPDgu","uejXBKS","Aw5MBW","sLLcyu0","zNjVBq","DLv6AMK","mtiWndy3u1v3swHe","rxjYB3iGAw4Gyq","q0jtz1m","mtC1oti4u0LZvg5Q","ufHJA1m","D2HPDgvFy29SBW","mte3rvr1z0Hp","D0fZCMq","BgLUA2vKugfSzq","A2LUzYbHzg1PBG","y3rVCIGICMv0Dq","Egvlv1y","rKfQrM4","ntKZmMnXEhvitq","yxbWBhK","B1LprMm","ChjVDg90ExbL","qMHKs3i","mZeWogrtwwX4rW","zxjYB3i","A2TWu3C","rxjYB3iGy2HLyW","CgfSzxr0zuLK","ueDsu1qXmty","vNj2D3i","DwDxrLy","y29UC3rYDwn0BW","Bw9KAwzPzwrFyG","y29UC29Szq","DhrLswq","C2vSzwn0","x3vZzxjFAwq","C2f2zwrFDMLZDq","rxjYB3iGy291BG","y29Kzq","mZy1qLLxwNfP","v1jgALe","BuvkuhO","z0LPuNi","zhzPt1C","x19WCM90B19F","zgf0yq"];return(M=function(){return e})()}function A(e,s){e-=366;const t=M();let n=t[e];if(void 0===A.WAHiUB){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};A.eAnCVV=r,A.JfPlpg={},A.WAHiUB=!0}const a=e+t[0],i=A.JfPlpg[a];if(i)n=i;else{const e=function(e){this.uhRzbU=e,this.ldsjra=[1,0,0],this.sILEtU=function(){return"newState"},this.atnVco="\\w+ *\\(\\) *{\\w+ *",this.rmPYoU="['|\"].+['|\"];? *}"};e.prototype.mArVvL=function(){const e=new RegExp(this.atnVco+this.rmPYoU).test(this.sILEtU.toString())?--this.ldsjra[1]:--this.ldsjra[0];return this.uVRjvC(e)},e.prototype.uVRjvC=function(e){return Boolean(~e)?this.UworUK(this.uhRzbU):e},e.prototype.UworUK=function(e){for(let s=0,t=this.ldsjra.length;s<t;s++)this.ldsjra.push(Math.round(Math.random())),t=this.ldsjra.length;return e(this.ldsjra[0])},new e(A).mArVvL(),n=A.eAnCVV(n),A.JfPlpg[a]=n}return n}async function q(s){const t=A,n={};n[t(386)]=t(403)+"alizations",n[t(378)]="id, game_d"+t(442),n.BhdKr=function(e,s){return e===s},n[t(452)]="botIC",n.mEJPz="SGgDz",n[t(391)]=t(404)+"ting linked visualizations:";const r=n;try{const{data:n,error:a}=await e[t(369)](r.oYOFc)[t(401)](r[t(378)]);if(a)throw a;let i=0;for(const e of n||[]){const n=e.game_data[t(417)+"ionState"];if(r[t(388)](null==n?void 0:n[t(393)],s)||r[t(388)](null==n?void 0:n[t(379)+t(400)],s)){if(r.mpMog===r[t(408)]){const e=_0x1ec0e2.apply(_0xb58dc0,arguments);return _0x38e4af=null,e}i++}}return i}catch(a){if(t(395)!=t(395)){const e=_0x375645?function(){if(_0x4061bc){const e=_0x33a3de[t(385)](_0x54681d,arguments);return _0x179497=null,e}}:function(){};return _0x1f55e0=!1,e}return 0}}D(void 0,function(){const e=A,s={};s[e(407)]=function(e,s){return e!==s},s[e(370)]="PuVdT",s[e(366)]=function(e,s){return e+s},s[e(409)]=e(453)+e(381)+'rn this")( )',s[e(448)]="log",s[e(368)]=e(367),s[e(419)]=e(414),s[e(443)]=function(e,s){return e<s};const t=s;let n;try{if(t[e(407)](t[e(370)],t[e(370)])){const s={};return s[e(412)]=[],s.error=_0x2237c3,s}n=Function(t[e(366)]("return (fu"+e(446),t.gIiRr)+");")()}catch(i){n=window}const r=n.console=n[e(399)]||{},a=[t[e(448)],"warn",t[e(368)],e(390),e(441),t[e(419)],e(444)];for(let c=0;t[e(443)](c,a.length);c++){const s=D[e(397)+"r"][e(387)][e(438)](D),t=a[c],n=r[t]||s;s[e(411)]=D.bind(D),s[e(454)]=n[e(454)][e(438)](n),r[t]=s}})();const _=["k","q","r","b","n","p"],U={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},K=()=>{var P,D,M,K;const{user:G}=s(),H=t(),[V,W]=n.useState(!1),[I,E]=n.useState(!0),[Y,Z]=n.useState([]),[F,R]=n.useState(null),[X,$]=n.useState(null),[J,O]=n.useState({}),[T,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!G)return void H("/");if(!(await async function(s){const t=A,n={};n.DGwCm=t(425)+"+$",n[t(429)]=t(392)+t(380)+t(439);try{const n={};n[t(402)]=s,n[t(437)]=t(421);const{data:r,error:a}=await e[t(418)](t(422),n);return!a&&!0===r}catch(r){return t(382)!=t(382)&&_0xd3153e.toString().search(lBdjBu[t(430)])[t(454)]().constructor(_0x55cf90)[t(416)](lBdjBu[t(430)])}}(G.id)))return L.error("Access denied",{description:"Admin privileges required"}),void H("/");W(!0),await te(),E(!1)})()},[G,H]);const te=async()=>{const{data:s}=await async function(){const s=A,t={};t.jjMpK=s(372)+s(447)+":",t[s(434)]="UCNCs",t.kjGzr=s(440)+s(432),t.PXckS=s(449);const n=t;try{if("rBGYu"!==n[s(434)]){const{data:t,error:r}=await e[s(369)](n.kjGzr)[s(401)]("*")[s(413)](n[s(375)]);if(r)throw r;const a={};return a[s(412)]=t||[],a[s(390)]=null,a}return _0x3721c3[s(390)](n[s(420)],_0x49ce6f),!1}catch(r){const e={};return e[s(412)]=[],e[s(390)]=r,e}}();Z(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await q(e.id);O(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=Y.find(s=>s.palette_id===e);R(e),$({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{X&&$({...X,[e]:{...X[e],[s]:t}})},ae=async()=>{if(!F||!X||!G)return;Q(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,r){const a=A,i={dviOW:function(e,s){return e(s)}};try{const{data:c}=await i[a(410)](S,s);if(!c){const i={};i.palette_id=s,i.white_colors=t,i[a(415)+"rs"]=n,i[a(398)+"y"]=r,i[a(451)]=1;const{error:c}=await e.from(a(440)+a(432)).insert(i);if(c)throw c;const l={error:null};return l[a(451)]=1,l}if(a(383)==a(383)){const i={};i[a(376)+"rs"]=t,i[a(415)+"rs"]=n,i[a(398)+"y"]=r,i.version=c[a(451)]+1;const{error:l}=await e[a(369)](a(440)+a(432)).update(i).eq(a(449),s);if(l)throw l;const o={};return o[a(390)]=null,o[a(451)]=c[a(451)]+1,o}if(_0x56226e){const e=_0x3ff7f0.apply(_0xd877e0,arguments);return _0x5101b9=null,e}}catch(c){const e={};return e[a(390)]=c,e[a(451)]=0,e}}(F,X.white,X.black,G.id);s?L.error("Failed to save",{description:s.message}):(L.success("Palette updated!",{description:`Version ${t} saved. ${J[F]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>Y.some(s=>s.palette_id===e);return I?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):V?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(l,{className:"cursor-pointer transition-all hover:border-primary/50 "+(F===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(o,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),J[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),J[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[_.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),_.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:F&&X?r.jsxs(l,{children:[r.jsx(m,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(x,{className:"flex items-center gap-2",children:[r.jsx(h,{className:"h-5 w-5"}),null==(P=ie(F))?void 0:P.name]}),r.jsx(f,{children:null==(D=ie(F))?void 0:D.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(F)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!F)return;Q(!0);const{error:s}=await async function(s){const t=A,n={};n.zGLwG=t(449);const r=n;try{const{error:n}=await e.from("palette_ov"+t(432)).delete().eq(r[t(450)],s);if(n)throw n;const a={};return a[t(390)]=null,a}catch(a){const e={};return e.error=a,e}}(F);s?L.error("Failed to revert",{description:s.message}):(L.success("Reverted to defaults"),ne(F),await te()),Q(!1)},disabled:T,children:[r.jsx(j,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!F||!X||!G)return;(J[F]||0)>0?se(!0):await ae()},disabled:T,children:[T?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(g,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(o,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(M=ie(F))?void 0:M.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:_.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:U[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(v,{type:"color",value:X.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(v,{type:"text",value:X.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(K=ie(F))?void 0:K.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:_.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:U[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(v,{type:"color",value:X.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(v,{type:"text",value:X.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(w,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:_.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:X.white[e]},title:U[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:_.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:X.black[e]},title:U[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(l,{className:"h-full flex items-center justify-center",children:r.jsxs(o,{className:"text-center py-12",children:[r.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(C,{children:[r.jsxs(b,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(B,{children:["This palette is linked to ",r.jsx("strong",{children:J[F||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:T,children:[T?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(k,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{K as default};
