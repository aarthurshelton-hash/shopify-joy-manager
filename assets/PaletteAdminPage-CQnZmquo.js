import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as m,P as h,w as f,B as p,bM as w,cj as j,a9 as v,am as g,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as k,cu as B,b as D}from"./index-DeSwrHRg.js";!function(){const e=K,s=q();for(;;)try{if(711838===parseInt(e(197))/1*(-parseInt(e(156))/2)+parseInt(e(221))/3*(-parseInt(e(193))/4)+-parseInt(e(238))/5+-parseInt(e(212))/6*(parseInt(e(157))/7)+-parseInt(e(173))/8+parseInt(e(159))/9*(parseInt(e(178))/10)+parseInt(e(207))/11)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const S=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[K(162)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=K,s={};s[e(175)]="(((.+)+)+)+$";const t=s;return S.toString().search(t[e(175)])[e(188)]()[e(223)+"r"](S).search(t[e(175)])});S();const A=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[K(162)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();function q(){const e=["x3vZzxjFAwq","zNjVBq","CgfSzxr0zv9VDG","CgfSzxr0zv9Pza","ChjVDg90ExbL","ANvhtxK","DgfIBgu","nJa3ote0ufzvv3vR","yMXHy2S","y29UC3rYDwn0BW","D2HPDgu","Bg9N","zMLUza","ueDsu1qXmty","rufJzvO","y3rVCIGICMv0Dq","A2LUzYbHzg1PBG","q2TkrK8","CMv0DxjUicHMDq","B3jKzxi","wgzZA3K","Aw5Zzxj0","D2HPDgvFy29SBW","y1jbsey","nte3mZi1nuDwwwzqza","EgnzqNi","rxjYB3iGAw4Gyq","BhfRq24","x19WCM90B19F","zgf0yq","DvPdwwC","odqYotCYs0rmre5l","nJG2mJfQqwP1sLC","DMvYC2LVBG","nZm1mdndENzRsM4","q2PjwwS","swLoB2G","yxbWBhK","r25WCg0","wwzor3q","zgvSzxrL","rLnUvuq","zxjYB3i","yMLUza","zg1PBIbJAgvJAW","DMLZDwfSAxPHDa","z2fTzv9KyxrH","C2LUz2XL","nJC5mte0nfbYBK1LwG","y29Kzq","y1fIyvu","Bw9KAwzPzwrFyG","t0Hvv0G","nduWCfvsywj4","EhbQufe","yxrPB25ZoG","yxrH","yxzWC0G","rwH6tKS","rxjYB3iGy2HLyW","yMXHy2TFy29SBW","ywXPEMf0Aw9UCW","BKLJBxq","Dg9tDhjPBMC","u21oCfq","tLDxAMK","C2vHCMnO","D05cvMK","mtzrDNbbDLi","ywrTAw4","Aw9Uu3rHDgu","Aw5MBW","mM93zvn1Ea","EhbitNK","x3jVBgu","CNbJ","DgLUzYbSAw5Rzq","CgfSzxr0zuLK","D1DTzLO","E30Uy29UC3rYDq","BgLUA2vKugfSzq","zcb2Axn1ywXPEG","ntC0nJG0mJjUzuTfyKW","q3zpuuy","zxjYAwrLCW","uKT0zuO","C2vSzwn0","odiYDg1eAgLe","D2fYBG"];return(q=function(){return e})()}function K(e,s){e-=152;const t=q();let n=t[e];if(void 0===K.rWxgfS){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};K.YDKwpV=a,K.eknuBW={},K.rWxgfS=!0}const r=e+t[0],i=K.eknuBW[r];if(i)n=i;else{const e=function(e){this.jRmtkv=e,this.ftbxQw=[1,0,0],this.UnYWpf=function(){return"newState"},this.JRmDOj="\\w+ *\\(\\) *{\\w+ *",this.SrWTkD="['|\"].+['|\"];? *}"};e.prototype.XKnyrU=function(){const e=new RegExp(this.JRmDOj+this.SrWTkD).test(this.UnYWpf.toString())?--this.ftbxQw[1]:--this.ftbxQw[0];return this.artvip(e)},e.prototype.artvip=function(e){return Boolean(~e)?this.ojxCBa(this.jRmtkv):e},e.prototype.ojxCBa=function(e){for(let s=0,t=this.ftbxQw.length;s<t;s++)this.ftbxQw.push(Math.round(Math.random())),t=this.ftbxQw.length;return e(this.ftbxQw[0])},new e(K).XKnyrU(),n=K.YDKwpV(n),K.eknuBW[r]=n}return n}async function P(s,t,n,a){const r=K,i={};i.lqkCn=r(240)+r(169)+":",i[r(182)]=r(216)+"errides",i[r(219)]=function(e,s){return e+s},i[r(210)]=function(e,s){return e!==s},i[r(190)]=r(161),i[r(203)]=r(160);const c=i;try{const{data:i}=await async function(s){const t=K,n={aAOdB:"palette_overrides"};n.EhzNK=t(227);const a=n;try{const{data:n,error:r}=await e.from(a.aAOdB)[t(211)]("*").eq(t(217),s)[t(172)]();if(r&&r[t(174)]!==a[t(183)])throw r;const i={};return i[t(154)]=n,i.error=null,i}catch(r){const e={};return e[t(154)]=null,e[t(167)]=r,e}}(s);if(i){const o={};o.white_colors=t,o[r(185)+"rs"]=n,o[r(176)+"y"]=a,o[r(158)]=i[r(158)]+1;const{error:l}=await e[r(215)](c[r(182)]).update(o).eq(r(217),s);if(l)throw l;return{error:null,version:c[r(219)](i[r(158)],1)}}if(c[r(210)](c[r(190)],c[r(203)])){const i={};i.palette_id=s,i[r(236)+"rs"]=t,i.black_colors=n,i.modified_by=a,i[r(158)]=1;const{error:o}=await e[r(215)](c.avpsH)[r(235)](i);if(o)throw o;const l={};return l[r(167)]=null,l[r(158)]=1,l}return _0x4a2d12[r(167)](c[r(152)],_0x2d6bee),!1}catch(o){const e={};return e[r(167)]=o,e[r(158)]=0,e}}async function W(s){const t=K,n={};n[t(231)]="(((.+)+)+)+$",n[t(163)]=t(164),n[t(177)]="id, game_d"+t(181),n[t(208)]=function(e,s){return e===s},n[t(166)]="Error coun"+t(201)+t(206)+t(180);const a=n;try{if(a[t(163)]==a[t(163)]){const{data:n,error:r}=await e[t(215)]("saved_visu"+t(186)).select(a[t(177)]);if(r)throw r;let i=0;for(const e of n||[]){const n=e[t(171)][t(170)+"ionState"];(a[t(208)](null==n?void 0:n[t(202)],s)||(null==n?void 0:n[t(205)+"tteId"])===s)&&i++}return i}return _0x3dbd40[t(188)]().search("(((.+)+)+)+$")[t(188)]()[t(223)+"r"](_0x135bad)[t(191)](mfSXdE[t(231)])}catch(r){return 0}}A(void 0,function(){const e=K,s={wANay:function(e,s){return e+s},cRAHF:function(e){return e()},nIcmt:e(225),xpjPQ:e(167),xpHNy:"exception",YQVCm:e(220),EAceZ:e(234)};let t;try{const n=Function(s.wANay(e(232)+"nction() "+(e(204)+e(229))+'rn this")( )',");"));t=s[e(237)](n)}catch(r){t=window}const n=t.console=t.console||{},a=[s[e(187)],e(213),e(196),s[e(179)],s[e(198)],s.YQVCm,"trace"];for(let i=0;i<a.length;i++)if(e(192)===s[e(228)]){const s=_0x2f5086[e(171)]["visualizat"+e(195)];((null==s?void 0:s[e(202)])===_0x4d6fc0||(null==s?void 0:s[e(205)+"tteId"])===_0x16706e)&&_0x45da11++}else{const s=A[e(223)+"r"][e(218)][e(168)](A),t=a[i],r=n[t]||s;s[e(153)]=A[e(168)](A),s[e(188)]=r[e(188)][e(168)](r),n[t]=s}})();const L=["k","q","r","b","n","p"],M={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},U=()=>{var S,A,q,U;const{user:I}=s(),Y=t(),[_,E]=n.useState(!1),[G,H]=n.useState(!0),[R,J]=n.useState([]),[Q,T]=n.useState(null),[V,F]=n.useState(null),[O,$]=n.useState({}),[X,Z]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!I)return void Y("/");if(!(await async function(s){const t=K;try{const n={};n[t(214)]=s,n[t(199)]=t(194);const{data:a,error:r}=await e[t(200)]("has_role",n);return!r&&!0===a}catch(n){return!1}}(I.id)))return D.error("Access denied",{description:"Admin privileges required"}),void Y("/");E(!0),await te(),H(!1)})()},[I,Y]);const te=async()=>{const{data:s}=await async function(){const s=K,t={};t.SmNpT=s(217);const n=t;try{const{data:t,error:a}=await e.from(s(216)+s(209)).select("*")[s(233)](n[s(189)]);if(a)throw a;const r={};return r[s(154)]=t||[],r[s(167)]=null,r}catch(a){const e={};return e[s(154)]=[],e[s(167)]=a,e}}();J(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await W(e.id);$(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=R.find(s=>s.palette_id===e);T(e),F({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{V&&F({...V,[e]:{...V[e],[s]:t}})},re=async()=>{if(!Q||!V||!I)return;Z(!0),se(!1);const{error:e,version:s}=await P(Q,V.white,V.black,I.id);e?D.error("Failed to save",{description:e.message}):(D.success("Palette updated!",{description:`Version ${s} saved. ${O[Q]||0} visualizations will use the new colors.`}),await te()),Z(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>R.some(s=>s.palette_id===e);return G?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):_?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(Q===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(l,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),O[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),O[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[L.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),L.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:Q&&V?a.jsxs(o,{children:[a.jsx(x,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(m,{className:"flex items-center gap-2",children:[a.jsx(h,{className:"h-5 w-5"}),null==(S=ie(Q))?void 0:S.name]}),a.jsx(f,{children:null==(A=ie(Q))?void 0:A.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(Q)&&a.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!Q)return;Z(!0);const{error:s}=await async function(s){const t=K,n={};n[t(239)]="palette_id";const a=n;try{const{error:n}=await e[t(215)](t(216)+t(209))[t(165)]().eq(a[t(239)],s);if(n)throw n;const r={};return r[t(167)]=null,r}catch(r){const e={};return e[t(167)]=r,e}}(Q);s?D.error("Failed to revert",{description:s.message}):(D.success("Reverted to defaults"),ne(Q),await te()),Z(!1)},disabled:X,children:[a.jsx(w,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(p,{size:"sm",onClick:async()=>{if(!Q||!V||!I)return;(O[Q]||0)>0?se(!0):await re()},disabled:X,children:[X?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(j,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(l,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(q=ie(Q))?void 0:q.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:M[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(v,{type:"color",value:V.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(v,{type:"text",value:V.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(U=ie(Q))?void 0:U.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:M[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(v,{type:"color",value:V.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(v,{type:"text",value:V.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:L.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:V.white[e]},title:M[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:L.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:V.black[e]},title:M[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(o,{className:"h-full flex items-center justify-center",children:a.jsxs(l,{className:"text-center py-12",children:[a.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(b,{children:[a.jsxs(C,{className:"flex items-center gap-2",children:[a.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(k,{children:["This palette is linked to ",a.jsx("strong",{children:O[Q||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(p,{onClick:re,disabled:X,children:[X?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(B,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{U as default};
