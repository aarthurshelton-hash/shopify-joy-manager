import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as m,P as h,w as f,B as p,bM as g,cj as j,a9 as v,am as w,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as B,cu as D,b as k}from"./index-DBmMOexX.js";!function(){const e=q,s=G();for(;;)try{if(925376===parseInt(e(302))/1*(parseInt(e(372))/2)+parseInt(e(335))/3*(-parseInt(e(370))/4)+parseInt(e(297))/5+parseInt(e(378))/6+parseInt(e(389))/7*(-parseInt(e(364))/8)+parseInt(e(321))/9+parseInt(e(323))/10*(-parseInt(e(388))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const L=function(){const e={wBOmt:"sKIUp"},s=e;let t=!0;return function(e,n){const r=q;if(r(291)===s.wBOmt){const s=t?function(){if(n){const s=n[r(303)](e,arguments);return n=null,s}}:function(){};return t=!1,s}{const e={};return e.error=_0x586fef,e}}}()(void 0,function(){const e=q,s={};s[e(316)]=e(353)+"+$";const t=s;return L[e(375)]().search(t[e(316)])[e(375)]()[e(351)+"r"](L)[e(332)](e(353)+"+$")});function G(){const e=["y3rVCIGICMv0Dq","u1v1t2G","yxrPB25ZoG","vfrmExG","ngDmswTjuq","renswxG","mtaWmtC4ofbHCgj0vG","CM4GDgHPCYiPka","CgfSzxr0zv9Pza","Dg9tDhjPBMC","C2vSzwn0","uvL4CvK","ndC3mJGZogX1DwfSyG","vwfUtMy","DhrLswq","rMrxB2K","Aw9Uu3rHDgu","CMLdyLu","y29UC29Szq","x19WCM90B19F","CgjPDw4","yMXHy2S","mtf2veHbAw4","n3vztvzsrG","DMLZDwfSAxPHDa","C0Tjvxa","BgLUA2vKugfSzq","DMvYC2LVBG","AwqSigDHBwvFza","y1Dmvhm","BMn0Aw9UkcKG","mZy5nZK1ANHqzxDr","yMLUza","zcb2Axn1ywXPEG","D2HPDgvFy29SBW","x3vZzxjFAwq","m2j6AvDUAa","yxbWBhK","sM9Trfi","zNjVBq","Dvr5s1C","rNLYthy","D2HPDgu","B3jKzxi","ywrTAw4","rxjYB3iGy2HLyW","Bg9N","ihjVBgu6","B3ziBMm","DgLUzYbSAw5Rzq","yKf5v2W","z2fTzv9KyxrH","v1HLBhq","rxjYB3iGy291BG","y29Kzq","mtiXntuWodv4BLP4wNm","x3jVBgu","odi4odmWEeruqKjX","DgfIBgu","seL4rK4","D2fYBG","zLLLyNG","DfDbr3m","CgfSzxr0zv9VDG","zg1PBIbJAgvJAW","zMLUza","C2vHCMnO","yMXHy2TFy29SBW","yKDpD1q","ntiYntKZnhrNqM9kqW","sKTJy2G","Auj0A08","A3D5zhu","ChjVDg90ExbL","Aw5Zzxj0","C2f2zwrFDMLZDq","CgfSzxr0zuLK","Eu5UCKm","z05cseK","wunNuLq","seDZz0y","DhjHy2u","DeDcweG","zgf0yq","Bw9KAwzPzwrFyG","y29UC3rYDwn0BW","zxjYAwrLCW","kcGOlISPkYKRkq","CfjsCe0","BgvUz3rO","zxjYB3i","teXNrg4","A2LUzYbHzg1PBG","qMj5AgO","ueDsu1qXmty","r0PQCMS","AgfZx3jVBgu","CMv0DxjUicHMDq","nZC3otuZnLjPuNLTrW","suLRBge"];return(G=function(){return e})()}L();const S=function(){const e=q,s={JmcLx:function(e,s){return e!==s}};s.uTyKW=e(327);const t=s;let n=!0;return function(s,r){const a=e;if(t.JmcLx(t[a(306)],a(327))){const e=_0x3e73c4[a(303)](_0x4c1172,arguments);return _0x189ace=null,e}{const e=n?function(){if(r){const e=r.apply(s,arguments);return r=null,e}}:function(){};return n=!1,e}}}();function q(e,s){e-=290;const t=G();let n=t[e];if(void 0===q.WfXDTe){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};q.zoEttC=r,q.gqVLln={},q.WfXDTe=!0}const a=e+t[0],i=q.gqVLln[a];if(i)n=i;else{const e=function(e){this.FPGtdl=e,this.gbpYBx=[1,0,0],this.zjcGgT=function(){return"newState"},this.cxgubh="\\w+ *\\(\\) *{\\w+ *",this.ESDGpx="['|\"].+['|\"];? *}"};e.prototype.FjBuMU=function(){const e=new RegExp(this.cxgubh+this.ESDGpx).test(this.zjcGgT.toString())?--this.gbpYBx[1]:--this.gbpYBx[0];return this.OrFwzj(e)},e.prototype.OrFwzj=function(e){return Boolean(~e)?this.KTZgyE(this.FPGtdl):e},e.prototype.KTZgyE=function(e){for(let s=0,t=this.gbpYBx.length;s<t;s++)this.gbpYBx.push(Math.round(Math.random())),t=this.gbpYBx.length;return e(this.gbpYBx[0])},new e(q).FjBuMU(),n=q.zoEttC(n),q.gqVLln[a]=n}return n}async function M(s){const t=q,n={};n[t(338)]="palette_id",n.UanNf=t(360);const r=n;try{const{data:n,error:a}=await e.from("palette_ov"+t(352)).select("*").eq(r.kwydu,s).single();if(a&&a[t(320)]!==r[t(379)])throw a;const i={};return i.data=n,i[t(356)]=null,i}catch(a){const e={data:null};return e[t(356)]=a,e}}async function A(s){const t=q,n={};n[t(367)]=t(353)+"+$",n[t(337)]=t(294)+"ata";const r=n;try{const{data:n,error:a}=await e.from(t(341)+"alizations").select(r[t(337)]);if(a)throw a;let i=0;for(const e of n||[]){if(t(365)!=t(365))return _0x349553[t(375)]()[t(332)](t(353)+"+$")[t(375)]()[t(351)+"r"](_0x3ceb9c).search(XlNPwE[t(367)]);{const n=e[t(317)][t(290)+t(382)];((null==n?void 0:n[t(342)])===s||(null==n?void 0:n[t(292)+t(380)])===s)&&i++}}return i}catch(a){return 0}}S(void 0,function(){const e=q,s={bGOwT:function(e,s){return e(s)},gNBHI:function(e,s){return e+s},LolWO:e(363)+e(296),TTLyx:"{}.constru"+e(366)+e(373)+" )",QnrDY:function(e,s){return e!==s},JKcch:e(307),YQfWL:function(e,s){return e(s)},ovHnc:function(e,s){return e+s},riCbU:function(e){return e()},tGBXH:"info",Bbyhj:e(356),tWAGs:e(324)},t=s[e(383)](function(){const t=e;let n;try{s.QnrDY(s[t(336)],t(307))?_0x6b9868=s[t(334)](_0x241941,s[t(344)](s.LolWO,s[t(369)])+");")():n=s.YQfWL(Function,s.gNBHI(s[t(314)](t(363)+t(296),"{}.constru"+t(366)+t(373)+" )"),");"))()}catch(r){n=window}return n}),n=t[e(384)]=t[e(384)]||{},r=[e(312),e(326),s[e(348)],s[e(359)],"exception",s[e(328)],e(347)];for(let a=0;a<r[e(355)];a++){const s=S[e(351)+"r"][e(339)][e(298)](S),t=r[a],i=n[t]||s;s[e(385)]=S[e(298)](S),s[e(375)]=i.toString[e(298)](i),n[t]=s}})();const P=["k","q","r","b","n","p"],K={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},W=()=>{var L,G,S,W;const{user:Y}=s(),H=t(),[_,T]=n.useState(!1),[U,I]=n.useState(!0),[F,E]=n.useState([]),[Z,R]=n.useState(null),[O,X]=n.useState(null),[V,$]=n.useState({}),[J,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!Y)return void H("/");if(!(await async function(s){const t=q;({})[t(377)]=t(311)+t(358)+" role:";try{const n={};n[t(301)]=s,n[t(322)]=t(310);const{data:r,error:a}=await e.rpc(t(362),n);return!a&&!0===r}catch(n){return!1}}(Y.id)))return k.error("Access denied",{description:"Admin privileges required"}),void H("/");T(!0),await te(),I(!1)})()},[Y,H]);const te=async()=>{const{data:s}=await async function(){const s=q,t={};t[s(343)]=s(311)+"king admin"+s(313),t.pRRpM=function(e,s){return e===s},t[s(386)]=s(329)+s(352),t.HGsgF=s(374),t[s(357)]=s(381);const n=t;try{if(n[s(354)](s(345),s(345))){const{data:t,error:r}=await e[s(305)](n[s(386)])[s(376)]("*")[s(309)](n[s(346)]);if(r)throw r;const a={};return a[s(349)]=t||[],a[s(356)]=null,a}return _0x1ab197.error(n[s(343)],_0x175df3),!1}catch(r){if(n.pRRpM(s(381),n[s(357)])){const e={};return e[s(349)]=[],e.error=r,e}{const e={};return e[s(349)]=null,e[s(356)]=_0x18d516,e}}}();E(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await A(e.id);$(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=F.find(s=>s.palette_id===e);R(e),X({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{O&&X({...O,[e]:{...O[e],[s]:t}})},ae=async()=>{if(!Z||!O||!Y)return;Q(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,r){const a=q,i={DCRYx:a(319)+a(315)+a(299)+a(368),JomDR:function(e,s){return e(s)},GJjrk:function(e,s){return e===s},WXelt:"palette_ov"+a(352)};try{const{data:c}=await i[a(304)](M,s);if(c){if(i[a(361)]("cWLTs",a(295))){const i={};i.white_colors=t,i[a(333)+"rs"]=n,i[a(350)+"y"]=r,i[a(293)]=c[a(293)]+1;const{error:o}=await e[a(305)]("palette_overrides").update(i).eq("palette_id",s);if(o)throw o;const l={error:null};return l[a(293)]=c.version+1,l}{const e={};return e[a(349)]=[],e[a(356)]=_0x101209,e}}{const c={};c[a(374)]=s,c[a(300)+"rs"]=t,c[a(333)+"rs"]=n,c[a(350)+"y"]=r,c[a(293)]=1;const{error:o}=await e[a(305)](i[a(318)])[a(340)](c);if(o)throw o;const l={error:null};return l[a(293)]=1,l}}catch(c){if("HIxFN"!==a(325))return _0x2de7bf.error(i[a(371)],_0x51d0bb),0;{const e={};return e[a(356)]=c,e[a(293)]=0,e}}}(Z,O.white,O.black,Y.id);s?k.error("Failed to save",{description:s.message}):(k.success("Palette updated!",{description:`Version ${t} saved. ${V[Z]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>F.some(s=>s.palette_id===e);return U?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):_?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(Z===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),V[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),V[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[P.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),P.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:Z&&O?r.jsxs(o,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(m,{className:"flex items-center gap-2",children:[r.jsx(h,{className:"h-5 w-5"}),null==(L=ie(Z))?void 0:L.name]}),r.jsx(f,{children:null==(G=ie(Z))?void 0:G.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(Z)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!Z)return;Q(!0);const{error:s}=await async function(s){const t=q;try{const{error:n}=await e[t(305)](t(329)+t(352)).delete().eq(t(374),s);if(n)throw n;const r={};return r[t(356)]=null,r}catch(n){const e={};return e.error=n,e}}(Z);s?k.error("Failed to revert",{description:s.message}):(k.success("Reverted to defaults"),ne(Z),await te()),Q(!1)},disabled:J,children:[r.jsx(g,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!Z||!O||!Y)return;(V[Z]||0)>0?se(!0):await ae()},disabled:J,children:[J?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(j,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(S=ie(Z))?void 0:S.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:P.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:K[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(v,{type:"color",value:O.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(v,{type:"text",value:O.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(W=ie(Z))?void 0:W.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:P.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:K[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(v,{type:"color",value:O.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(v,{type:"text",value:O.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(w,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:P.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.white[e]},title:K[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:P.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.black[e]},title:K[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(B,{children:["This palette is linked to ",r.jsx("strong",{children:V[Z||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:J,children:[J?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(D,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{W as default};
