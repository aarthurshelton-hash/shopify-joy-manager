import{s as t,ca as r,dG as n,dH as i}from"./index-f_XxDhCa.js";import{v as e,a as o,b as a}from"./visualizationSchemas-sFl5yS99.js";import"./flagContent-BaPtqzn8.js";!function(){const t=c,r=l();for(;;)try{if(999895===-parseInt(t(233))/1*(-parseInt(t(229))/2)+parseInt(t(259))/3+-parseInt(t(205))/4+-parseInt(t(207))/5+parseInt(t(132))/6+-parseInt(t(262))/7+-parseInt(t(193))/8*(parseInt(t(125))/9))break;r.push(r.shift())}catch(n){r.push(r.shift())}}();const s=function(){let t=!0;return function(r,n){const i=t?function(){if(n){const t=n[c(228)](r,arguments);return n=null,t}}:function(){};return t=!1,i}}()(void 0,function(){const t=c,r={};r[t(240)]=t(280)+"+$";const n=r;return s.toString()[t(149)]("(((.+)+)+)+$")[t(250)]()[t(237)+"r"](s)[t(149)](n.MLCTu)});function c(t,r){t-=108;const n=l();let i=n[t];if(void 0===c.boGOao){var e=function(t){let r="",n="",i=r+e;for(let e,o,a=0,s=0;o=t.charAt(s++);~o&&(e=a%4?64*e+o:o,a++%4)?r+=i.charCodeAt(s+10)-10!=0?String.fromCharCode(255&e>>(-2*a&6)):a:0)o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(let e=0,o=r.length;e<o;e++)n+="%"+("00"+r.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(n)};c.wXjbOm=e,c.YtRNxI={},c.boGOao=!0}const o=t+n[0],a=c.YtRNxI[o];if(a)i=a;else{const t=function(t){this.OgGtAp=t,this.SyltjL=[1,0,0],this.SsGZFE=function(){return"newState"},this.YDjvXs="\\w+ *\\(\\) *{\\w+ *",this.iVYxtH="['|\"].+['|\"];? *}"};t.prototype.rZAPHJ=function(){const t=new RegExp(this.YDjvXs+this.iVYxtH).test(this.SsGZFE.toString())?--this.SyltjL[1]:--this.SyltjL[0];return this.pRNgio(t)},t.prototype.pRNgio=function(t){return Boolean(~t)?this.SgspJF(this.OgGtAp):t},t.prototype.SgspJF=function(t){for(let r=0,n=this.SyltjL.length;r<n;r++)this.SyltjL.push(Math.round(Math.random())),n=this.SyltjL.length;return t(this.SyltjL[0])},new t(c).rZAPHJ(),i=c.wXjbOm(i),c.YtRNxI[o]=i}return i}s();const u=function(){let t=!0;return function(r,n){const i=t?function(){if(n){const t=n[c(228)](r,arguments);return n=null,t}}:function(){};return t=!1,i}}();function l(){const t=["zxjYB3i","CgfSzxr0zuLK","BwvFzgf0yq","uLbet2C","zMv0y2GGDMLZDq","CefmCNK","zxHJzxb0Aw9U","Bg9JywXLq29TCa","BwvZC2fNzq","DgfIBgu","zxHPC3rPBMDdBW","yxbWBhK","mM1mvg5jyW","Cgf0Ag5HBwu","EMrgrgG","vvH6D2C","mtyWmti1n0Xqr0XsDG","AxnuB29tAw1PBa","y29SB3jtAw1PBa","BgL6yxrPB246ia","y29UC3rYDwn0BW","y0DHBwu","CMvUDfvZzxi","tuXdvhu","y3vZDg9T","y29Kzq","y3jLyxrLzf9HDa","zvbIyNO","ELbrsxC","wvnLwfC","rMfPBgvKihrVia","ywLUCYbPBMfWCa","rxHHy3qGzhvWBa","Dg9tDhjPBMC","jsbZAw1PBgfYia","Bg9YCW","sg1iC3O","D1nwthq","sNLiywm","B3DUzwrcEun1CG","AxPHDgLVBIaTia","Aw4GEw91CIbNyq","mZGZmti0nMrkv0Httq","C3bSAxq","AwnHDguGzxHPCW","mteWmJu1ntnks0H5yuu","x19WCM90B19F","y3rVCIGICMv0Dq","yvrrAgm","BMCGyxqGBgvHCW","CMvTB3zL","Bg9N","yMXHy2S","B0n3se4","AgvJAZO","CYbHBhjLywr5ia","z2fTzv9KyxrH","ywXPEMf0Aw9UCW","zxr0zuLK","BMn0Aw9UkcKG","Bw9KzxjU","B3jKzxi","vvLMqu4","kcGOlISPkYKRkq","Evj0zvu","ywXPEMf0Aw9UoG","BgLUA2vKugfSzq","yxjPDhK","vgHPCYb2Axn1yq","CgLLy2vdB2XVCG","D2fYBG","Aw5Zzxj0","z2u6ia","yxnJzw5KAw5N","DxnLCL9Pza","y3vYCMvUDe1VDG","sw50D00","q2zSAxK","C3rVCMfNzq","CgDU","lNbUzW","zxzLBNq","Dca4ignVBg9YCW","v0Hlrhm","rKzQALq","rxjYB3iGy2HLyW","rvrvt20","sw52ywXPzcbqrW","C2f2zwrFDMLZDq","yMLUza","rxjYB3iGAw4Gza","CM4GDgHPCYiPka","C3vJy2vZCW","DgXL","Bwf0y2HLzeDHBq","mZmZBfPhC093","Dw5K","Aw5MBW","zcWGCgDUlcbNyq","y29UDgvUDfr5Ca","yxjL","ChjVDg90ExbL","nZi3otC2nfHZCMPRCq","A2LUzYbKDxbSAq","BfriwKy","BKrIExC","yw5VDgHLCIbJBW","zgf0yq","C2fMzq","ww91igHHDMuGyq","r3DPuvm","ueDsu1qXmty","DhrLswq","Aw9Uig5VDcbMBW","zNjVBq","Dg9mB3DLCKnHCW","yKT5Cw8","yM9HCMq","Du5nt1K","C2vHCMnO","C3vHBgL6yxrPBW","zxHPC3rPBMDjza","Aw1Hz2uVCg5N","Aw9Uu3rHDgu","B3DUzxjeAxnWBa","zgfYA01Vzgu","BNPIwMu","BIbIEsa","vfjvAK0","AM9PBG","zgLZCgXHEv9Uyq","z2fTzurHDge","vevSBMy","D2HPDgu","B250zw50","sxvXuvK","CM91BMq","Aw9UCW","DMLZDwfSAxPHDa","CM9WCMLHDguGyW","zgvSzxrL","zxr0zvnPBwLSyq","C3rYAw5NAwz5","EhbVA1u","zMLUza","zunHCMq","CgLLy2vuExbL","C29YDa","BgXLy3rVCG","Dg8Gysb2AxnPBW","DxbSAwnHDguGyW","DhjPBq","zgf0zq","CMvZDwX0","Dg90ywXnB3zLCW","AxneDxbSAwnHDa","zxHPC3rPBMDwAq","Bw92zxm","BgvUz3rO","AwqSihvZzxjFAq","C2XPy2u","BgXLCNK","AfrsvK8","mtG4mdi0u1LOqKXQ","C2vSzwn0","ENHyzui","wwT2tKq","sw52ywXPzcb0Aq","y2f0zxm6","DxbSB2fKigLTyq","yvL5D0O","C2LUz2XL","yxLoyw1L","CMvHC29U","y1bHBgv0Dgu","mJa2ndmWneDgAM9gBa","DMXlEfG","nJu0odyWAfj1thn2","AxnjBNrYAw5ZAq","Bwf0y2HLzfbHBa","y29UC29Szq","CML0Eq","qw9uAMq","ChjVzMLSzxm","y3vZDg9Tq29SBW","DxbZzxj0","zMLUzeLUzgv4"];return(l=function(){return t})()}function f(t,r,n){const i=c,e={};e[i(270)]="all";const o=e;return(t||r[i(109)]||"")[i(181)]().replace(/\s+/g," ")+"::"+(n?JSON[i(172)]({palette:n.paletteId||i(277),darkMode:n[i(155)]||!1,currentMove:n[i(292)+"e"]===1/0?o[i(270)]:n[i(292)+"e"],lockedPieces:(n.lockedPieces||[])[i(177)]((t,r)=>(t[i(286)]+"-"+t[i(176)])[i(224)+i(130)](r[i(286)]+"-"+r[i(176)]))}):"{}")}async function w(e,o,a,s){const u=c,l={aTQhc:function(t,r,n,i){return t(r,n,i)},JyHac:u(189)+u(128)+u(219),pALry:function(t,r){return t===r},IntwM:"Another collector",scQMF:u(241),ePbbz:u(212),yRteU:function(t,r,n,i,e,o){return t(r,n,i,e,o)},YkvND:function(t,r){return t(r)}};try{const c=l[u(265)](f,o,a,s),{data:w,error:y}=await t.from(u(118)+"alizations")[u(194)](l[u(255)]);if(y){const t={isDuplicate:!1};return t[u(234)+"ar"]=!1,t}for(const r of w||[]){const n=r[u(273)],i=l[u(265)](f,r[u(109)]||void 0,n,n[u(168)+"ionState"]);if(l[u(222)](c,i)){const n=r[u(291)]===e;let i;if(!n){const{data:n}=await t[u(144)](u(213))[u(194)](u(160)+"me").eq(u(291),r[u(291)])[u(201)]();i=(null==n?void 0:n[u(160)+"me"])||l[u(293)]}const o={};return o[u(185)+"e"]=!0,o[u(234)+"ar"]=!0,o[u(151)]=r.id,o[u(256)+"rentUser"]=n,o[u(154)+u(202)]=i,o[u(235)+"arity"]=100,o[u(203)]=u(249)+u(261)+"ts",o}}const g=(null==s?void 0:s[u(218)])||u(277);let z;if(null==s?void 0:s.customColors)z=s[u(214)+"rs"];else if(l.pALry(g,l.scQMF)){if(l[u(244)]!=l[u(244)]){_0x1334f8[u(217)](u(115)+u(133)+u(198),_0x177bc0);const t={isDuplicate:!1};return t[u(234)+"ar"]=!1,t}{const t=r[u(174)](t=>t.id===u(241));if(t){const r={};r[u(163)]=t[u(163)],r[u(269)]=t[u(269)],z=r}}}const C=await l[u(281)](n,e,o,a,g,z);if(C[u(234)+"ar"]){const t={isDuplicate:!1};return t[u(234)+"ar"]=!0,t.existingId=C[u(186)+u(150)+"nId"],t[u(256)+u(239)]=C[u(256)+u(239)],t[u(154)+u(202)]=C[u(154)+u(202)],t.colorSimilarity=C[u(235)+u(284)],t[u(203)]=C[u(203)],t[u(227)+u(252)]=C[u(227)+u(252)],t["isIntrinsi"+u(204)]=C[u(208)+u(204)],t[u(208)+"cGame"]=C["isIntrinsi"+u(238)],t[u(124)+u(175)]=C["matchedGam"+u(175)],t[u(209)+u(275)]=C[u(209)+u(275)],t[u(209)+u(171)+u(211)]=C[u(209)+u(171)+u(211)],t}let D;z&&(D=l[u(196)](i,z)||void 0);const v={};return v[u(185)+"e"]=!1,v[u(234)+"ar"]=!1,v["linkedPale"+u(142)]=D,v[u(235)+"arity"]=C[u(235)+"arity"],v[u(208)+"cPalette"]=C.isIntrinsicPalette,v[u(208)+"cGame"]=C[u(208)+u(238)],v[u(124)+u(175)]=C["matchedGam"+u(175)],v[u(209)+u(275)]=C[u(209)+u(275)],v[u(209)+u(171)+"rity"]=C[u(209)+"etteSimilarity"],v}catch(w){const t={isDuplicate:!1};return t[u(234)+"ar"]=!1,t}}async function y(r,n,i,s,u,l){const f=c,y={zPQIw:f(197)+f(123),xpokU:function(t,r){return t(r)},aYywJ:"visualizat"+f(167),ETUOm:"saved_visu"+f(274),zdFDh:function(t,r){return t||r}};try{const c=e(n);if(!c[f(122)])return{data:null,error:new Error(c[f(217)]||y[f(245)])};const g=await y.xpokU(o,n);if(!g[f(138)])return{data:null,error:new Error(g[f(203)]||"Title cont"+f(248)+f(169)+f(164))};const z=y[f(173)](a,u);if(!z[f(122)])return{data:null,error:new Error(z.error||f(117)+"N data")};const C=await w(r,u,i.gameData,l);if(C.isDuplicate){const t=C[f(256)+f(239)]?f(285)+"lization i"+f(272)+f(258)+f(191):f(285)+"lization is owned by "+(C[f(154)+f(202)]||f(136)+f(178));return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:C[f(256)+f(239)],ownerDisplayName:C[f(154)+f(202)],colorSimilarity:100}}if(C[f(234)+"ar"]){const t=C[f(256)+"rentUser"]?f(139)+" very similar visual"+f(257)+"try changi"+f(266)+f(112)+" for uniqueness":"This is "+Math[f(166)](C[f(235)+f(284)]||30)+(f(251)+f(179)+f(157))+(C[f(154)+f(202)]||f(136)+"llector");return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:C[f(256)+f(239)],ownerDisplayName:C[f(154)+f(202)],colorSimilarity:C["colorSimil"+f(284)],reason:C[f(203)]}}const D={...l};D[f(283)+f(142)]=C[f(283)+f(142)];const v=D,B=r+"/"+Date.now()+"-"+n.replace(/[^a-z0-9]/gi,"-")[f(145)+"e"]()+f(110),x={};x[f(129)+"e"]=f(152),x[f(215)]=!1;const{error:L}=await t[f(108)].from(y[f(200)]).upload(B,s,x);if(L)throw new Error(f(247)+f(199)+"ge: "+L[f(225)]);const{data:h}=t[f(108)][f(144)](f(168)+f(167)).getPublicUrl(B),m={};m[f(163)]=i.gameData[f(163)],m[f(269)]=i.gameData[f(269)],m[f(111)]=i[f(161)][f(111)],m.date=i[f(161)][f(182)],m[f(183)]=i.gameData[f(183)],m[f(109)]=i.gameData[f(109)],m[f(187)]=i.gameData[f(187)],m.board=i[f(147)],m.totalMoves=i[f(184)],m[f(168)+f(153)]=v;const A=m,{data:M,error:d}=await t[f(144)](y[f(116)])[f(288)]({user_id:r,title:n,pgn:y[f(231)](u,null),game_data:A,image_path:h.publicUrl})[f(194)]()[f(201)]();if(d)throw await t[f(108)][f(144)](f(168)+f(167))[f(267)]([B]),new Error(f(247)+"save visua"+f(236)+d.message);const q={};return q[f(137)]=M,q[f(217)]=null,q}catch(g){const t={};return t[f(137)]=null,t[f(217)]=g,t}}async function g(r){const n=c,i={};i[n(253)]=n(118)+n(274),i[n(232)]=n(243);const e=i;try{const i={};i[n(290)]=!1;const{data:o,error:a}=await t.from(e.HmHsz).select("*").eq(n(291),r)[n(278)](e[n(232)],i);if(a)throw new Error(n(247)+n(221)+"alizations: "+a[n(225)]);const s={};return s[n(137)]=o||[],s.error=null,s}catch(o){const t={};return t[n(137)]=[],t[n(217)]=o,t}}async function z(r,n){const i=c,e={};e[i(192)]=i(168)+i(167),e[i(206)]=i(118)+"alizations";const o=e;try{const e=new URL(n)[i(230)][i(260)]("/"),a=e[i(216)](t=>t==="visualizat"+i(167)),s=e[i(190)](a+1)[i(159)]("/");s&&await t[i(108)].from(o.hTRVO)[i(267)]([s]);const{error:c}=await t.from(o[i(206)])[i(170)]().eq("id",r);if(c)throw new Error(i(247)+"delete visualization: "+c[i(225)]);const u={};return u[i(217)]=null,u}catch(a){const t={};return t.error=a,t}}u(void 0,function(){const t=c,r={lTHZF:"return (fu"+t(276),UYfAN:function(t){return t()},GwiQS:t(268),TRUjM:t(223),Cfliy:t(226),wSVLt:"trace"};let n;try{const i=Function(r[t(134)]+"{}.constru"+t(264)+t(121)+" ));");n=r[t(279)](i)}catch(o){n=window}const i=n[t(210)]=n[t(210)]||{},e=[r[t(140)],t(287),t(127),t(217),r[t(158)],r[t(294)],r[t(254)]];for(let a=0;a<e[t(188)];a++){const r=u[t(237)+"r"][t(131)][t(119)](u),n=e[a],o=i[n]||r;r[t(263)]=u[t(119)](u),r[t(250)]=o[t(250)].bind(o),i[n]=r}})();export{w as checkDuplicateVisualization,z as deleteVisualization,g as getUserVisualizations,y as saveVisualization};
