import{s as n,ca as t,dG as r,dH as e}from"./index-CN5tH3TC.js";import{v as i,a as o,b as a}from"./visualizationSchemas-DBSP0dWk.js";import"./flagContent-BhRNeO80.js";!function(){const n=f,t=c();for(;;)try{if(322715===-parseInt(n(322))/1*(-parseInt(n(297))/2)+-parseInt(n(174))/3*(parseInt(n(319))/4)+-parseInt(n(242))/5*(parseInt(n(254))/6)+parseInt(n(286))/7+-parseInt(n(226))/8+-parseInt(n(233))/9*(-parseInt(n(288))/10)+parseInt(n(196))/11*(parseInt(n(245))/12))break;t.push(t.shift())}catch(r){t.push(t.shift())}}();const s=function(){let n=!0;return function(t,r){const e=n?function(){if(r){const n=r[f(179)](t,arguments);return r=null,n}}:function(){};return n=!1,e}}()(void 0,function(){const n=f;return s[n(263)]()[n(258)]("(((.+)+)+)+$")[n(263)]()[n(202)+"r"](s).search("(((.+)+)+)+$")});s();const u=function(){let n=!0;return function(t,r){const e=n?function(){if(r){const n=r[f(179)](t,arguments);return r=null,n}}:function(){};return n=!1,e}}();function c(){const n=["B3DUzxjeAxnWBa","z2u6ia","Bw9KzxjU","mJeWmtm4yLfOt3br","BgL6yxrPB24GAq","AMDiELO","C29YDa","zgLZCgXHEv9Uyq","yxbWBhK","Aw9Uig5VDcbMBW","DgXL","zxHPC3rPBMDdBW","zxr0zvnPBwLSyq","CM91BMq","AxPHDgLVBIaTia","sw52ywXPzcbqrW","Aw9UCW","quDkr1O","igzVCIb1BMLXDq","C2vSzwn0","s0TVD3G","BwvFzgf0yq","z0nsy0u","zxjYB3i","svnmDMe","ndrjvgfnDKi","DxbSAwnHDguGyW","E30Uy29UC3rYDq","y2f0zxm6","BgXLy3rVCG","Aw5MBW","y29UC3rYDwn0BW","AxnuB29tAw1PBa","Aw1Hz2vFCgf0Aa","C2T3rKy","rxjYB3iGAw4Gza","DxnLCL9Pza","BgvUz3rO","DhjHy2u","zxHPC3rPBMDjza","CML0Eq","BIbIEsa","Aw1Hz2uVCg5N","C2f2zwrFDMLZDq","D2fYBG","yxjPDhK","Dg90ywXnB3zLCW","C3rVCMfNzq","y3vZDg9Tq29SBW","zMLUza","vgHPCYbPCYa","Chjsr3q","rxHHy3qGzhvWBa","wgfqt3u","BwvZC2fNzq","mZy4ntyZmKncBw1pCG","Bg9JywXLq29TCa","z2v0uhvIBgLJvq","DgL0Bgu","y29Kzq","BMzfqMi","DwfSAxPHDgLVBG","nty4mZy4vKryqM1Y","AM9PBG","sw52ywXPzcb0Aq","CgLLy2vuExbL","BMn0Aw9UkcKG","Bg9JA2vKugLLyW","CMv0DxjUicHMDq","wff5AuC","zxzLBNq","mJa2mJKXmhbzBu9YDa","jsbZAw1PBgfYia","weLitwe","oduYndKYA2jWDevf","y1bHBgv0Dgu","rxjYB3iGy2HLyW","DxbSB2fK","y3jLyxrLzf9HDa","Dg9mB3DLCKnHCW","rhfYtMK","BMCGyxqGBgvHCW","A2LUzYbKDxbSAq","nNbbyuzJBG","Aw9Uu3rHDgu","CYbVD25LzcbIEq","Bwf0y2HLzfbHBa","C2vHCMnO","Bg9YCW","qw5VDgHLCIbJBW","AgvJAZO","DhjPBq","Dg9tDhjPBMC","EKf0Aue","BgL6yxrPB246ia","ueDsu1qXmty","Bg9N","C3vJy2vZCW","zcWGCgDUlcbNyq","t0n3qK4","AwqSihvZzxjFAq","C1H2tfq","Aw4GEw91CIbNyq","C2f2zsb2Axn1yq","DgfIBgu","yxnJzw5KAw5N","z1DsvLe","B1bbyMS","zw5LC3m","zgvSzxrLihzPCW","DxbSB2fKigLTyq","Bw92zxm","AxnjBNrYAw5ZAq","ihzLCNKGC2LTAq","CMvZDwX0","mZK5nZyXnKXXAgrJEa","rMfPBgvKihrVia","nJbJyu1hzKm","ywXPEMf0Aw9UCW","y29UC29Szq","x19WCM90B19F","B2PIDuC","y29UDgvUDfr5Ca","Dw5K","BgXLCNK","zxr0zuLK","mtm3ntHTBgjyCMO","EujfvMi","B250zw50","tgTHyNK","De51rw0","ywXS","AxneDxbSAwnHDa","CMvHC29U","y3rVCIGICMv0Dq","tuXyCva","Dhj5ignOyw5NAq","D2HPDgu","uuLgrwi","yxjL","wKLcvvi","Dg8Gysb2AxnPBW","zMLUzeLUzgv4","D2nuyMO","C2fMzq","yMLUza","yM9HCMq","zgf0yq","mtjPy2LTq3m","yxLoyw1L","CgfSzxr0zuLK","mJvivwjrru0","ywXPEMf0Aw9UoG","CgLLy2vdB2XVCG","zxHPC3rPBMDwAq","CMvTB3zL","zNjVBq","EuPwEwe","vgL0BguGy29UDa","DhrLswq","z2fTzv9KyxrH","y1DlvfC","rxHxsgu","DMLZDwfSAxPHDa","zMv0y2GGDMLZDq","ChjVDg90ExbL","CMvUDfvZzxi","y3vYCMvUDe1VDG","CgDU","y3vZDg9T","qwP1Bxu","Avrqr1i","zgvSzxrL","C3rYAw5NAwz5","vhHpwuK","y29SB3jtAw1PBa","tIbKyxrH","veHKCgG","y0DHBwu","CMvWBgfJzq","zxHJzxb0Aw9U","BKLK","EM9AuLG","BgLUA2vKugfSzq","uuzRr3i","CM9WCMLHDguGyW","yw5VDgHLCIbJBW","yMXHy2S","Bwf0y2HLzeDHBq","C2LUz2XL","zgf0zq","BgfYihzPC3vHBa","z2fTzurHDge","DxbZzxj0","zunHCMq","BM93","vgHPCYb2Axn1yq","B3DUzwrcEun1CG","BMfQALa"];return(c=function(){return n})()}function f(n,t){n-=143;const r=c();let e=r[n];if(void 0===f.fyFYBS){var i=function(n){let t="",r="",e=t+i;for(let i,o,a=0,s=0;o=n.charAt(s++);~o&&(i=a%4?64*i+o:o,a++%4)?t+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&i>>(-2*a&6)):a:0)o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(let i=0,o=t.length;i<o;i++)r+="%"+("00"+t.charCodeAt(i).toString(16)).slice(-2);return decodeURIComponent(r)};f.dGCsPD=i,f.EYgQKI={},f.fyFYBS=!0}const o=n+r[0],a=f.EYgQKI[o];if(a)e=a;else{const n=function(n){this.kBKfUN=n,this.OWMnCm=[1,0,0],this.RDeyCy=function(){return"newState"},this.dQtRJw="\\w+ *\\(\\) *{\\w+ *",this.nbJQHO="['|\"].+['|\"];? *}"};n.prototype.mkhUUF=function(){const n=new RegExp(this.dQtRJw+this.nbJQHO).test(this.RDeyCy.toString())?--this.OWMnCm[1]:--this.OWMnCm[0];return this.aNkOWG(n)},n.prototype.aNkOWG=function(n){return Boolean(~n)?this.TVbYcP(this.kBKfUN):n},n.prototype.TVbYcP=function(n){for(let t=0,r=this.OWMnCm.length;t<r;t++)this.OWMnCm.push(Math.round(Math.random())),r=this.OWMnCm.length;return n(this.OWMnCm[0])},new n(f).mkhUUF(),e=f.dGCsPD(e),f.EYgQKI[o]=e}return e}function y(n,t,r){const e=f,i={};i[e(309)]=function(n,t){return n===t};const o=i;return(n||t[e(339)]||"")[e(262)]()[e(151)](/\s+/g," ")+"::"+(r?JSON[e(145)]({palette:r[e(321)]||e(173),darkMode:r.darkMode||!1,currentMove:o[e(309)](r[e(338)+"e"],1/0)?e(302):r.currentMove,lockedPieces:(r[e(238)+"es"]||[])[e(177)]((n,t)=>(n[e(324)]+"-"+n.pieceType)[e(227)+e(310)](t.pieceColor+"-"+t[e(236)]))}):"{}")}async function w(i,o,a,s){const u=f,c={OVDul:function(n,t){return n!==t},nnnEY:"SlKPG",ELpxq:function(n,t,r,e){return n(t,r,e)},prRGt:u(214)+"alizations",jgHzZ:u(247)+u(253)+u(199),tNuEm:function(n,t){return n===t},DzgmS:"display_name",iTPGR:u(207),aVHEE:u(260)+u(200),cWKTW:u(173),Lkaby:function(n,t){return n===t},ISLva:u(170),XQyiG:function(n,t){return n===t},Ajumu:u(311)};try{if(c.OVDul(c.nnnEY,c.nnnEY))return{data:null,error:new _0x14802e(_0x50d702.error||u(235)+u(181))};{const f=c.ELpxq(y,o,a,s),{data:w,error:l}=await n.from(c[u(222)])[u(190)](u(271)+u(269)+u(192));if(l){const n={isDuplicate:!1};return n[u(203)+"ar"]=!1,n}for(const t of w||[]){const r=t.game_data,e=y(t[u(339)]||void 0,r,r[u(334)+"ionState"]);if(c[u(301)](f,e)){const r=c[u(301)](t.user_id,i);let e;if(!r){const{data:r}=await n[u(327)]("profiles")[u(190)](c.DzgmS).eq(c[u(143)],t[u(207)]).single();e=(null==r?void 0:r[u(178)+"me"])||c.aVHEE}const o={};return o[u(303)+"e"]=!0,o[u(203)+"ar"]=!0,o[u(210)]=t.id,o[u(169)+u(337)]=r,o["ownerDispl"+u(320)]=e,o[u(147)+u(216)]=100,o[u(304)]=u(223)+"icate exists",o}}const C=(null==s?void 0:s[u(321)])||c[u(332)];let g;if(null==s?void 0:s[u(219)+"rs"])g=s[u(219)+"rs"];else if(c[u(300)](C,u(340))){const n=t[u(220)](n=>n.id===u(340));if(n){if(c[u(195)]!=c[u(195)]){const n={};return n[u(318)]=null,n[u(194)]=_0x5a3988,n}{const t={};t[u(308)]=n.white,t[u(159)]=n.black,g=t}}}const D=await r(i,o,a,C,g);if(D[u(203)+"ar"]){const n={};return n[u(303)+"e"]=!1,n.isTooSimilar=!0,n[u(210)]=D[u(325)+"sualizatio"+u(153)],n[u(169)+"rentUser"]=D["ownedByCur"+u(337)],n[u(171)+u(320)]=D[u(171)+u(320)],n.colorSimilarity=D["colorSimil"+u(216)],n[u(304)]=D[u(304)],n[u(182)+u(259)]=D["existingCo"+u(259)],n[u(283)+u(246)]=D[u(283)+u(246)],n["isIntrinsi"+u(150)]=D[u(283)+"cGame"],n[u(160)+u(166)]=D["matchedGam"+u(166)],n[u(257)+"etteId"]=D[u(257)+"etteId"],n["matchedPal"+u(183)+"rity"]=D[u(257)+"etteSimila"+u(211)],n}let z;if(g){if(!c[u(240)](c[u(341)],u(311))){const n=_0xf78ec8?function(){if(_0x7ed076){const n=_0x20bf28[u(179)](_0x2e1e04,arguments);return _0x262ac7=null,n}}:function(){};return _0x1741fa=!1,n}z=e(g)||void 0}const B={};return B[u(303)+"e"]=!1,B[u(203)+"ar"]=!1,B[u(155)+u(330)]=z,B.colorSimilarity=D[u(147)+"arity"],B[u(283)+u(246)]=D[u(283)+"cPalette"],B[u(283)+"cGame"]=D["isIntrinsi"+u(150)],B.matchedGameCard=D[u(160)+u(166)],B["matchedPal"+u(296)]=D[u(257)+u(296)],B.matchedPaletteSimilarity=D[u(257)+u(183)+u(211)],B}}catch(w){const n={};return n[u(303)+"e"]=!1,n.isTooSimilar=!1,n}}async function l(t,r,e,s,u,c){const y=f,l={THdph:y(206)+"uplicate check:",XaPOu:function(n,t){return n(t)},ICSFr:y(329)+"ains inapp"+y(157)+y(299),gPlLJ:function(n,t){return n(t)},oPAbk:y(168)+y(175)+"s already "+y(273)+y(295),ExWHe:y(158)+y(200),MLXqP:function(n,t){return n!==t},WmLXo:y(231),TxOYI:"You have a"+y(284)+y(163)+y(185)+y(307)+y(252)+"t 8 colors"+y(189)+y(279),wcTbj:y(334)+y(187),XIHMa:y(214)+y(289),gCRcE:y(272)};try{const f=i(r);if(!f[y(268)])return{data:null,error:new Error(f[y(194)]||y(235)+y(181))};const C=await l[y(224)](o,r);if(!C[y(315)])return{data:null,error:new Error(C[y(304)]||l.ICSFr)};const g=l.gPlLJ(a,u);if(!g[y(268)])return{data:null,error:new Error(g[y(194)]||y(186)+y(148))};const D=await w(t,u,e[y(164)],c);if(D[y(303)+"e"]){const n=D[y(169)+y(337)]?l[y(278)]:y(168)+y(175)+y(256)+" "+(D[y(171)+y(320)]||l[y(333)]);return{data:null,error:new Error(n),isDuplicate:!0,ownedByCurrentUser:D[y(169)+y(337)],ownerDisplayName:D[y(171)+y(320)],colorSimilarity:100}}if(D[y(203)+"ar"]){if(l[y(306)](y(264),l.WmLXo)){const n=D[y(169)+y(337)]?l[y(146)]:y(221)+Math[y(184)](D[y(147)+"arity"]||30)+(y(243)+y(312)+y(212))+(D[y(171)+y(320)]||l[y(333)]);return{data:null,error:new Error(n),isTooSimilar:!0,ownedByCurrentUser:D[y(169)+y(337)],ownerDisplayName:D["ownerDispl"+y(320)],colorSimilarity:D[y(147)+y(216)],reason:D.reason}}_0x58db18=_0x54076e[y(219)+"rs"]}const z={...c};z[y(155)+y(330)]=D[y(155)+"tteId"];const B=z,x=t+"/"+Date[y(167)]()+"-"+r[y(151)](/[^a-z0-9]/gi,"-")[y(250)+"e"]()+".png",L={};L[y(293)+"e"]=y(213),L[y(165)]=!1;const{error:m}=await n[y(218)][y(327)](l[y(314)])[y(248)](x,s,L);if(m)throw new Error("Failed to "+y(281)+y(172)+m[y(225)]);const{data:v}=n[y(218)].from(y(334)+y(187))[y(228)+"rl"](x),h={};h[y(308)]=e[y(164)][y(308)],h.black=e[y(164)][y(159)],h[y(241)]=e[y(164)][y(241)],h[y(162)]=e[y(164)].date,h[y(285)]=e[y(164)][y(285)],h[y(339)]=e[y(164)][y(339)],h[y(282)]=e.gameData[y(282)],h[y(317)]=e[y(317)],h[y(217)]=e[y(217)],h["visualizat"+y(255)]=B;const d=h,M={};M[y(207)]=t,M[y(229)]=r,M.pgn=u||null,M[y(331)]=d,M[y(204)]=v.publicUrl;const{data:q,error:A}=await n[y(327)](l[y(244)]).insert(M).select()[y(161)]();if(A)throw await n[y(218)][y(327)](y(334)+y(187))[y(326)]([x]),new Error(y(287)+y(274)+y(265)+A.message);const b={};return b[y(318)]=q,b[y(194)]=null,b}catch(C){if(l[y(193)]!==y(272)){_0x467c1e.error(l[y(149)],_0x301e0b);const n={};return n[y(303)+"e"]=!1,n[y(203)+"ar"]=!1,n}{const n={};return n[y(318)]=null,n.error=C,n}}}async function C(t){const r=f,e={};e[r(292)]=r(214)+r(289);const i=e;try{const e={};e[r(276)]=!1;const{data:o,error:a}=await n.from(i.ojbuG)[r(190)]("*").eq("user_id",t).order(r(249),e);if(a)throw new Error(r(287)+r(335)+r(289)+": "+a.message);const s={};return s[r(318)]=o||[],s[r(194)]=null,s}catch(o){const n={};return n[r(318)]=[],n[r(194)]=o,n}}async function g(t,r){const e=f,i={};i[e(298)]=function(n,t){return n+t},i[e(188)]=e(334)+e(187),i[e(277)]="saved_visualizations";const o=i;try{const i=new URL(r).pathname.split("/"),a=i[e(313)](n=>n===e(334)+e(187)),s=i.slice(o[e(298)](a,1))[e(234)]("/");s&&await n.storage[e(327)](o[e(188)])[e(326)]([s]);const{error:u}=await n[e(327)](o[e(277)])[e(144)]().eq("id",t);if(u)throw new Error(e(287)+e(280)+e(232)+": "+u.message);const c={error:null};return c}catch(a){const n={};return n[e(194)]=a,n}}u(void 0,function(){const n=f,t={QFkGr:function(n,t){return n(t)},QiaKJ:function(n,t){return n+t},yJVya:n(239)+n(237),zoZRX:n(267),qnExQ:n(215),fbfxF:n(275),OCwBN:n(209)};let r;try{r=t[n(156)](Function,t.QiaKJ(t[n(328)]+(n(198)+n(305)+'rn this")( )'),");"))()}catch(o){r=window}const e=r.console=r[n(290)]||{},i=[t[n(154)],t.qnExQ,n(201),n(194),n(152),t.fbfxF,t[n(270)]];for(let a=0;a<i[n(208)];a++){const t=u[n(202)+"r"][n(336)].bind(u),r=i[a],o=e[r]||t;t[n(291)]=u[n(316)](u),t[n(263)]=o[n(263)].bind(o),e[r]=t}})();export{w as checkDuplicateVisualization,g as deleteVisualization,C as getUserVisualizations,l as saveVisualization};
