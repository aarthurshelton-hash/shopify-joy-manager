const n='import { useEffect, useState } from \'react\';\nimport { useParams, Link } from \'react-router-dom\';\nimport { motion } from \'framer-motion\';\nimport { supabase } from \'@/integrations/supabase/client\';\nimport { Button } from \'@/components/ui/button\';\nimport { Card, CardContent, CardHeader, CardTitle } from \'@/components/ui/card\';\nimport { Progress } from \'@/components/ui/progress\';\nimport { ArrowLeft, Brain, GitBranch, Share2, Download, ExternalLink, Copy, Check, Calendar, Users, FileCode } from \'lucide-react\';\nimport { useToast } from \'@/hooks/use-toast\';\n\ninterface AnalysisReport {\n  id: string;\n  repository_url: string;\n  repository_name: string;\n  owner: string;\n  fingerprint: string;\n  archetype: string;\n  dominant_force: string;\n  flow_direction: string;\n  intensity: number;\n  quadrant_profile: {\n    q1: number;\n    q2: number;\n    q3: number;\n    q4: number;\n  };\n  temporal_flow: {\n    opening: number;\n    midgame: number;\n    endgame: number;\n  };\n  code_metrics: {\n    featureRatio: number;\n    bugfixRatio: number;\n    refactorRatio: number;\n    totalCommits: number;\n  };\n  total_commits: number;\n  total_contributors: number;\n  analysis_period_start: string;\n  analysis_period_end: string;\n  predicted_outcome: string;\n  outcome_confidence: number;\n  recommendations: string[];\n  created_at: string;\n}\n\nexport default function SharedAnalysisReport() {\n  const { id } = useParams<{ id: string }>();\n  const [report, setReport] = useState<AnalysisReport | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [copied, setCopied] = useState(false);\n  const { toast } = useToast();\n\n  useEffect(() => {\n    const fetchReport = async () => {\n      if (!id) {\n        setError(\'Invalid report ID\');\n        setLoading(false);\n        return;\n      }\n\n      try {\n        const { data, error: fetchError } = await supabase\n          .from(\'code_repository_patterns\')\n          .select(\'*\')\n          .eq(\'id\', id)\n          .single();\n\n        if (fetchError) throw fetchError;\n        if (!data) throw new Error(\'Report not found\');\n\n        setReport(data as unknown as AnalysisReport);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : \'Failed to load report\');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchReport();\n  }, [id]);\n\n  const copyShareLink = () => {\n    const url = window.location.href;\n    navigator.clipboard.writeText(url);\n    setCopied(true);\n    toast({ title: \'Link Copied!\', description: \'Share this URL to show your analysis\' });\n    setTimeout(() => setCopied(false), 2000);\n  };\n\n  if (loading) {\n    return (\n      <div className="min-h-screen bg-background flex items-center justify-center">\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          className="text-center"\n        >\n          <Brain className="h-12 w-12 text-primary animate-pulse mx-auto mb-4" />\n          <p className="text-muted-foreground">Loading analysis report...</p>\n        </motion.div>\n      </div>\n    );\n  }\n\n  if (error || !report) {\n    return (\n      <div className="min-h-screen bg-background flex items-center justify-center">\n        <Card className="max-w-md">\n          <CardContent className="p-8 text-center">\n            <p className="text-destructive mb-4">{error || \'Report not found\'}</p>\n            <Link to="/code-analysis">\n              <Button>Go to Code Analysis</Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const archetypeColors: Record<string, string> = {\n    \'Methodical Architect\': \'text-blue-500\',\n    \'Rapid Innovator\': \'text-orange-500\',\n    \'Quality Guardian\': \'text-green-500\',\n    \'Fire Fighter\': \'text-red-500\',\n    \'Balanced Builder\': \'text-purple-500\',\n  };\n\n  return (\n    <div className="min-h-screen bg-background">\n      {/* Header */}\n      <header className="border-b bg-card/50 backdrop-blur-sm sticky top-0 z-50">\n        <div className="container mx-auto px-4 py-4">\n          <div className="flex items-center justify-between">\n            <div className="flex items-center gap-4">\n              <Link to="/code-analysis">\n                <Button variant="ghost" size="sm">\n                  <ArrowLeft className="h-4 w-4 mr-2" />\n                  Analyze Another\n                </Button>\n              </Link>\n              <div className="flex items-center gap-2">\n                <div className="p-2 rounded-lg bg-primary/10">\n                  <Brain className="h-6 w-6 text-primary" />\n                </div>\n                <div>\n                  <h1 className="font-bold text-lg">En Pensent Code™ Report</h1>\n                  <p className="text-xs text-muted-foreground">Shareable Analysis</p>\n                </div>\n              </div>\n            </div>\n            <Button onClick={copyShareLink} variant="outline" className="gap-2">\n              {copied ? <Check className="h-4 w-4" /> : <Share2 className="h-4 w-4" />}\n              Share Report\n            </Button>\n          </div>\n        </div>\n      </header>\n\n      <main className="container mx-auto px-4 py-8 max-w-5xl">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n        >\n          {/* Repository Info */}\n          <Card className="mb-8">\n            <CardContent className="p-6">\n              <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">\n                <div>\n                  <div className="flex items-center gap-2 mb-2">\n                    <GitBranch className="h-5 w-5 text-muted-foreground" />\n                    <h2 className="text-2xl font-bold">{report.owner}/{report.repository_name}</h2>\n                  </div>\n                  <a \n                    href={report.repository_url} \n                    target="_blank" \n                    rel="noopener noreferrer"\n                    className="text-sm text-primary hover:underline flex items-center gap-1"\n                  >\n                    View on GitHub <ExternalLink className="h-3 w-3" />\n                  </a>\n                </div>\n                <div className="flex flex-wrap gap-4 text-sm text-muted-foreground">\n                  <div className="flex items-center gap-1">\n                    <FileCode className="h-4 w-4" />\n                    {report.total_commits} commits\n                  </div>\n                  <div className="flex items-center gap-1">\n                    <Users className="h-4 w-4" />\n                    {report.total_contributors} contributors\n                  </div>\n                  <div className="flex items-center gap-1">\n                    <Calendar className="h-4 w-4" />\n                    {new Date(report.created_at).toLocaleDateString()}\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Archetype & Prediction */}\n          <div className="grid md:grid-cols-2 gap-6 mb-8">\n            <Card>\n              <CardHeader>\n                <CardTitle className="text-lg">Development Archetype</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className={`text-3xl font-bold mb-2 ${archetypeColors[report.archetype] || \'text-primary\'}`}>\n                  {report.archetype}\n                </p>\n                <p className="text-sm text-muted-foreground mb-4">\n                  Fingerprint: <code className="text-xs bg-muted px-1 py-0.5 rounded">{report.fingerprint.slice(0, 16)}...</code>\n                </p>\n                <div className="grid grid-cols-2 gap-4 text-sm">\n                  <div>\n                    <span className="text-muted-foreground">Dominant Force:</span>\n                    <p className="font-medium capitalize">{report.dominant_force}</p>\n                  </div>\n                  <div>\n                    <span className="text-muted-foreground">Flow Direction:</span>\n                    <p className="font-medium capitalize">{report.flow_direction}</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className="text-lg">Predicted Outcome</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className={`text-3xl font-bold mb-2 capitalize ${\n                  report.predicted_outcome === \'success\' ? \'text-green-500\' : \n                  report.predicted_outcome === \'failure\' ? \'text-red-500\' : \'text-yellow-500\'\n                }`}>\n                  {report.predicted_outcome}\n                </p>\n                <div className="mb-4">\n                  <div className="flex justify-between text-sm mb-1">\n                    <span className="text-muted-foreground">Confidence</span>\n                    <span className="font-medium">{Math.round(report.outcome_confidence * 100)}%</span>\n                  </div>\n                  <Progress value={report.outcome_confidence * 100} />\n                </div>\n                <div>\n                  <div className="flex justify-between text-sm mb-1">\n                    <span className="text-muted-foreground">Intensity</span>\n                    <span className="font-medium">{Math.round(report.intensity * 100)}%</span>\n                  </div>\n                  <Progress value={report.intensity * 100} />\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Quadrant Profile */}\n          <Card className="mb-8">\n            <CardHeader>\n              <CardTitle className="text-lg">Quadrant Profile (Spatial Distribution)</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className="grid grid-cols-2 gap-4">\n                {Object.entries(report.quadrant_profile).map(([key, value]) => (\n                  <div key={key} className="p-4 bg-muted rounded-lg">\n                    <div className="flex justify-between items-center mb-2">\n                      <span className="text-sm font-medium uppercase">{key}</span>\n                      <span className="text-sm text-muted-foreground">{Math.round(value * 100)}%</span>\n                    </div>\n                    <Progress value={value * 100} />\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Temporal Flow */}\n          <Card className="mb-8">\n            <CardHeader>\n              <CardTitle className="text-lg">Temporal Flow (Activity Over Time)</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className="grid grid-cols-3 gap-4">\n                {Object.entries(report.temporal_flow).map(([phase, value]) => (\n                  <div key={phase} className="text-center p-4 bg-muted rounded-lg">\n                    <p className="text-sm text-muted-foreground capitalize mb-1">{phase}</p>\n                    <p className="text-2xl font-bold">{Math.round(value * 100)}%</p>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Recommendations */}\n          {report.recommendations && report.recommendations.length > 0 && (\n            <Card className="mb-8">\n              <CardHeader>\n                <CardTitle className="text-lg">Strategic Recommendations</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ul className="space-y-3">\n                  {report.recommendations.map((rec, index) => (\n                    <li key={index} className="flex gap-3">\n                      <span className="flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 text-primary text-sm font-medium flex items-center justify-center">\n                        {index + 1}\n                      </span>\n                      <span className="text-sm">{rec}</span>\n                    </li>\n                  ))}\n                </ul>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Footer */}\n          <div className="text-center py-8 border-t">\n            <p className="text-sm text-muted-foreground mb-4">\n              Analyzed with En Pensent™ Universal Pattern Recognition Engine\n            </p>\n            <div className="flex flex-wrap gap-4 justify-center">\n              <Link to="/academic-paper">\n                <Button variant="outline" size="sm" className="gap-2">\n                  <ExternalLink className="h-4 w-4" />\n                  Read the Paper\n                </Button>\n              </Link>\n              <Link to="/sdk-docs">\n                <Button variant="outline" size="sm" className="gap-2">\n                  <ExternalLink className="h-4 w-4" />\n                  SDK Documentation\n                </Button>\n              </Link>\n              <Link to="/code-analysis">\n                <Button size="sm" className="gap-2">\n                  <Brain className="h-4 w-4" />\n                  Analyze Your Repo\n                </Button>\n              </Link>\n            </div>\n            <p className="text-xs text-muted-foreground mt-6">\n              © 2024 En Pensent Technologies. Patent Pending. All rights reserved.\n            </p>\n          </div>\n        </motion.div>\n      </main>\n    </div>\n  );\n}\n';export{n as default};
