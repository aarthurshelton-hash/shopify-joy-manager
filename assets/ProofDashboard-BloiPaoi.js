const e='/**\n * Visual Proof Dashboard v6.64\n * \n * Real-time evidence of En Pensent hybrid superiority in prediction.\n * Shows breakthrough cases, disagreement analysis, and cumulative proof.\n * \n * v6.64 CHANGES:\n * - REALTIME SYNC: Uses useRealtimeAccuracyContext for live updates\n * - AUTO-REFRESH: Subscribes to chess prediction changes\n * - INSTANT UI: Stats update immediately when new predictions come in\n */\n\nimport React, { useEffect, useState, useCallback } from \'react\';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \'@/components/ui/card\';\nimport { Badge } from \'@/components/ui/badge\';\nimport { Progress } from \'@/components/ui/progress\';\nimport { ScrollArea } from \'@/components/ui/scroll-area\';\nimport { Separator } from \'@/components/ui/separator\';\nimport { motion } from \'framer-motion\';\nimport { \n  Brain, \n  Zap, \n  Trophy, \n  Target, \n  TrendingUp, \n  AlertTriangle,\n  Sparkles,\n  Activity,\n  Clock,\n  Calendar,\n  Timer\n} from \'lucide-react\';\nimport {\n  getDisagreementStats,\n  getHybridBreakthroughs,\n  DisagreementCase,\n  DisagreementStats,\n  formatEval,\n  getDisagreementInsight,\n  formatTimeControl,\n} from \'@/lib/chess/disagreementTracker\';\nimport { getCumulativeStats } from \'@/lib/chess/benchmarkPersistence\';\nimport { useRealtimeAccuracyContext } from \'@/providers/RealtimeAccuracyProvider\';\nimport { format, parseISO, isValid } from \'date-fns\';\n\ninterface CumulativeStats {\n  totalRuns: number;\n  totalGamesAnalyzed: number;\n  overallHybridAccuracy: number;\n  overallStockfishAccuracy: number;\n  hybridNetWins: number;\n  bestArchetype: string | null;\n  worstArchetype: string | null;\n}\n\nexport function ProofDashboard() {\n  const [stats, setStats] = useState<DisagreementStats | null>(null);\n  const [breakthroughs, setBreakthroughs] = useState<DisagreementCase[]>([]);\n  const [cumulative, setCumulative] = useState<CumulativeStats | null>(null);\n  const [loading, setLoading] = useState(true);\n  \n  // v6.64: Use realtime context for instant updates\n  const { chessStats, updateCount } = useRealtimeAccuracyContext();\n\n  // v6.64: Load initial data and refresh when realtime updates occur\n  const loadData = useCallback(async () => {\n    const [disagreementStats, breakthroughCases, cumulativeStats] = await Promise.all([\n      getDisagreementStats(),\n      getHybridBreakthroughs(10),\n      getCumulativeStats(),\n    ]);\n    setStats(disagreementStats);\n    setBreakthroughs(breakthroughCases);\n    setCumulative(cumulativeStats);\n    setLoading(false);\n  }, []);\n\n  // Initial load\n  useEffect(() => {\n    loadData();\n  }, [loadData]);\n\n  // v6.64: Auto-refresh when realtime updates come in\n  useEffect(() => {\n    if (updateCount > 0) {\n      loadData();\n    }\n  }, [updateCount, loadData]);\n\n  if (loading) {\n    return (\n      <Card className="bg-card/50 backdrop-blur border-primary/20">\n        <CardContent className="p-8 text-center">\n          <Activity className="w-8 h-8 mx-auto animate-pulse text-primary" />\n          <p className="mt-4 text-muted-foreground">Loading proof data...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const hybridAdvantage = cumulative \n    ? cumulative.overallHybridAccuracy - cumulative.overallStockfishAccuracy \n    : 0;\n\n  const disagreementWinRate = stats && stats.totalDisagreements > 0\n    ? (stats.hybridWinsDisagreements / stats.totalDisagreements) * 100\n    : 0;\n\n  return (\n    <div className="space-y-6">\n      {/* Header Stats */}\n      <div className="grid grid-cols-1 md:grid-cols-4 gap-4">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.1 }}\n        >\n          <Card className="bg-gradient-to-br from-primary/10 to-primary/5 border-primary/30">\n            <CardContent className="p-4">\n              <div className="flex items-center gap-3">\n                <div className="p-2 bg-primary/20 rounded-lg">\n                  <Brain className="w-5 h-5 text-primary" />\n                </div>\n                <div>\n                  <p className="text-xs text-muted-foreground">Games Analyzed</p>\n                  <p className="text-2xl font-bold">{cumulative?.totalGamesAnalyzed || 0}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.2 }}\n        >\n          <Card className={`border ${hybridAdvantage > 0 ? \'border-green-500/30 bg-green-500/5\' : \'border-destructive/30 bg-destructive/5\'}`}>\n            <CardContent className="p-4">\n              <div className="flex items-center gap-3">\n                <div className={`p-2 rounded-lg ${hybridAdvantage > 0 ? \'bg-green-500/20\' : \'bg-destructive/20\'}`}>\n                  <TrendingUp className={`w-5 h-5 ${hybridAdvantage > 0 ? \'text-green-500\' : \'text-destructive\'}`} />\n                </div>\n                <div>\n                  <p className="text-xs text-muted-foreground">Hybrid Advantage</p>\n                  <p className="text-2xl font-bold">\n                    {hybridAdvantage >= 0 ? \'+\' : \'\'}{hybridAdvantage.toFixed(1)}%\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.3 }}\n        >\n          <Card className="bg-gradient-to-br from-yellow-500/10 to-orange-500/5 border-yellow-500/30">\n            <CardContent className="p-4">\n              <div className="flex items-center gap-3">\n                <div className="p-2 bg-yellow-500/20 rounded-lg">\n                  <Sparkles className="w-5 h-5 text-yellow-500" />\n                </div>\n                <div>\n                  <p className="text-xs text-muted-foreground">Breakthrough Cases</p>\n                  <p className="text-2xl font-bold">{stats?.breakthroughCases || 0}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.4 }}\n        >\n          <Card className="bg-gradient-to-br from-purple-500/10 to-pink-500/5 border-purple-500/30">\n            <CardContent className="p-4">\n              <div className="flex items-center gap-3">\n                <div className="p-2 bg-purple-500/20 rounded-lg">\n                  <Trophy className="w-5 h-5 text-purple-500" />\n                </div>\n                <div>\n                  <p className="text-xs text-muted-foreground">Disagreement Win Rate</p>\n                  <p className="text-2xl font-bold">{disagreementWinRate.toFixed(0)}%</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      </div>\n\n      {/* Main Content */}\n      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">\n        {/* Breakthrough Cases */}\n        <Card className="bg-card/80 backdrop-blur border-primary/20">\n          <CardHeader>\n            <CardTitle className="flex items-center gap-2">\n              <Zap className="w-5 h-5 text-yellow-500" />\n              Breakthrough Cases\n            </CardTitle>\n            <CardDescription>\n              Where En Pensent was RIGHT and Stockfish was WRONG\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <ScrollArea className="h-[400px] pr-4">\n              {breakthroughs.length === 0 ? (\n                <div className="text-center py-8 text-muted-foreground">\n                  <Target className="w-12 h-12 mx-auto mb-4 opacity-50" />\n                  <p>No breakthrough cases recorded yet.</p>\n                  <p className="text-sm">Run benchmarks to collect evidence.</p>\n                </div>\n              ) : (\n                <div className="space-y-4">\n                  {breakthroughs.map((case_, index) => {\n                    // v6.18: Pass gameName for ELO-based inference when time_control is null\n                    const timeControlInfo = formatTimeControl(case_.timeControl, case_.gameName);\n                    const analysisDate = case_.createdAt ? parseISO(case_.createdAt) : null;\n                    const gameDate = case_.gameDate ? parseISO(case_.gameDate) : null;\n                    \n                    return (\n                      <motion.div\n                        key={case_.id}\n                        initial={{ opacity: 0, x: -20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        transition={{ delay: index * 0.1 }}\n                        className="p-4 bg-gradient-to-r from-green-500/10 to-transparent rounded-lg border border-green-500/20"\n                      >\n                        <div className="flex items-start justify-between mb-2">\n                          <div className="flex flex-col gap-1">\n                            <div className="flex items-center gap-2 flex-wrap">\n                              <Badge variant="outline" className="bg-green-500/20 text-green-400 border-green-500/30">\n                                {case_.significance === \'breakthrough\' ? \'ðŸŒŸ BREAKTHROUGH\' : \'âœ“ Notable\'}\n                              </Badge>\n                              <Badge variant="outline" className={`${timeControlInfo.color} border-current/30 bg-current/10`}>\n                                {timeControlInfo.icon} {timeControlInfo.label}\n                              </Badge>\n                              {(case_.whiteElo || case_.blackElo) && (\n                                <Badge variant="outline" className="text-muted-foreground">\n                                  ~{Math.round(((case_.whiteElo || 0) + (case_.blackElo || 0)) / 2)} ELO\n                                </Badge>\n                              )}\n                            </div>\n                            <p className="text-sm font-medium mt-1">{case_.gameName}</p>\n                          </div>\n                          <span className="text-xs text-muted-foreground whitespace-nowrap">\n                            Move {case_.moveNumber}\n                          </span>\n                        </div>\n\n                        {/* Date Information */}\n                        <div className="flex items-center gap-4 text-xs text-muted-foreground mb-3 flex-wrap">\n                          {gameDate && isValid(gameDate) && (\n                            <div className="flex items-center gap-1">\n                              <Calendar className="w-3 h-3" />\n                              <span>Played: {format(gameDate, \'MMM d, yyyy\')}</span>\n                            </div>\n                          )}\n                          {analysisDate && isValid(analysisDate) && (\n                            <div className="flex items-center gap-1">\n                              <Timer className="w-3 h-3 text-primary" />\n                              <span className="text-primary">Analyzed: {format(analysisDate, \'MMM d, yyyy h:mm a\')}</span>\n                            </div>\n                          )}\n                        </div>\n                        \n                        <div className="grid grid-cols-3 gap-2 text-xs">\n                          <div className="text-center p-2 bg-destructive/10 rounded">\n                            <p className="text-muted-foreground">Stockfish</p>\n                            <p className="font-mono font-bold text-destructive">{formatEval(case_.stockfishEval)}</p>\n                            <p className="text-destructive">â†’ {case_.stockfishPrediction}</p>\n                          </div>\n                          <div className="text-center p-2 bg-green-500/10 rounded">\n                            <p className="text-muted-foreground">Hybrid</p>\n                            <p className="font-bold text-green-400">{case_.hybridArchetype}</p>\n                            <p className="text-green-400">â†’ {case_.hybridPrediction}</p>\n                          </div>\n                          <div className="text-center p-2 bg-primary/10 rounded">\n                            <p className="text-muted-foreground">Actual</p>\n                            <p className="font-bold text-primary">{case_.actualResult}</p>\n                            <p className="text-primary">âœ“ Hybrid correct</p>\n                          </div>\n                        </div>\n\n                        <p className="text-xs text-muted-foreground mt-3 italic">\n                          {getDisagreementInsight(case_)}\n                        </p>\n                      </motion.div>\n                    );\n                  })}\n                </div>\n              )}\n            </ScrollArea>\n          </CardContent>\n        </Card>\n\n        {/* Disagreement Analysis */}\n        <Card className="bg-card/80 backdrop-blur border-primary/20">\n          <CardHeader>\n            <CardTitle className="flex items-center gap-2">\n              <AlertTriangle className="w-5 h-5 text-orange-500" />\n              Disagreement Analysis\n            </CardTitle>\n            <CardDescription>\n              When Hybrid and Stockfish predict different outcomes\n            </CardDescription>\n          </CardHeader>\n          <CardContent className="space-y-6">\n            {/* Win/Loss in Disagreements */}\n            <div>\n              <div className="flex justify-between text-sm mb-2">\n                <span>Hybrid wins disagreements</span>\n                <span className="font-bold text-green-400">\n                  {stats?.hybridWinsDisagreements || 0} / {stats?.totalDisagreements || 0}\n                </span>\n              </div>\n              <Progress \n                value={disagreementWinRate} \n                className="h-3 bg-destructive/20"\n              />\n              <div className="flex justify-between text-xs text-muted-foreground mt-1">\n                <span>Stockfish: {stats?.stockfishWinsDisagreements || 0}</span>\n                <span>Hybrid: {stats?.hybridWinsDisagreements || 0}</span>\n              </div>\n            </div>\n\n            <Separator />\n\n            {/* Stockfish Confidence When Wrong */}\n            <div>\n              <h4 className="text-sm font-medium mb-2">\n                Avg Stockfish Confidence When Wrong\n              </h4>\n              <div className="flex items-center gap-4">\n                <div className="text-3xl font-bold font-mono">\n                  {formatEval(stats?.averageStockfishConfidenceWhenWrong || 0)}\n                </div>\n                <p className="text-xs text-muted-foreground">\n                  When hybrid beats Stockfish, Stockfish was typically this confident in the wrong direction\n                </p>\n              </div>\n            </div>\n\n            <Separator />\n\n            {/* Archetype Performance in Disagreements */}\n            <div>\n              <h4 className="text-sm font-medium mb-3">\n                Top Archetypes in Disagreements\n              </h4>\n              <div className="space-y-2">\n                {(stats?.topArchetypesInDisagreements || []).map((arch, i) => (\n                  <div key={arch.archetype} className="flex items-center justify-between">\n                    <div className="flex items-center gap-2">\n                      <span className="text-xs text-muted-foreground">#{i + 1}</span>\n                      <Badge variant="outline">{arch.archetype}</Badge>\n                    </div>\n                    <div className="flex items-center gap-3">\n                      <span className="text-xs text-muted-foreground">{arch.count} cases</span>\n                      <span className={`text-sm font-bold ${arch.winRate > 50 ? \'text-green-400\' : \'text-destructive\'}`}>\n                        {arch.winRate.toFixed(0)}%\n                      </span>\n                    </div>\n                  </div>\n                ))}\n                {(!stats?.topArchetypesInDisagreements || stats.topArchetypesInDisagreements.length === 0) && (\n                  <p className="text-sm text-muted-foreground text-center py-4">\n                    Run benchmarks to collect archetype data\n                  </p>\n                )}\n              </div>\n            </div>\n\n            <Separator />\n\n            {/* Key Insight */}\n            <div className="p-4 bg-primary/5 rounded-lg border border-primary/20">\n              <h4 className="text-sm font-medium mb-2 flex items-center gap-2">\n                <Brain className="w-4 h-4 text-primary" />\n                Key Insight\n              </h4>\n              <p className="text-xs text-muted-foreground">\n                When En Pensent and Stockfish disagree, the hybrid system wins{\' \'}\n                <span className="text-primary font-bold">{disagreementWinRate.toFixed(0)}%</span> of the time.\n                This proves that Color Flow pattern recognition adds genuine value\n                beyond pure tactical calculation.\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Proof Statement */}\n      <Card className="bg-gradient-to-r from-primary/10 via-purple-500/10 to-pink-500/10 border-primary/30">\n        <CardContent className="p-6 text-center">\n          <h3 className="text-xl font-bold mb-2">\n            The Evidence\n          </h3>\n          <p className="text-muted-foreground max-w-2xl mx-auto">\n            Over <span className="text-primary font-bold">{cumulative?.totalGamesAnalyzed || 0}</span> real grandmaster games,\n            En Pensent\'s hybrid prediction system achieves{\' \'}\n            <span className="text-primary font-bold">{(cumulative?.overallHybridAccuracy || 0).toFixed(1)}%</span> accuracy\n            vs Stockfish 17 NNUE\'s{\' \'}\n            <span className="text-muted-foreground">{(cumulative?.overallStockfishAccuracy || 0).toFixed(1)}%</span>.\n            In disagreements, pattern recognition wins{\' \'}\n            <span className="text-green-400 font-bold">{disagreementWinRate.toFixed(0)}%</span> of the time.\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n';export{e as default};
