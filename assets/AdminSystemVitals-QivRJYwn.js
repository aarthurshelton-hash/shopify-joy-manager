import{s as e,r as s,j as t,C as n,p as r,t as a,w as c,B as i,v as l,x as o,aB as d,aC as u,aD as m,bj as h,ad as x,aE as f,z as j,bF as g,D as v,aA as p,d$ as N,ce as y,y as w,a_ as b,dK as C,d1 as M,aQ as D,aq as B,bJ as z,eV as k,b as L,eU as I,fs as _}from"./index-CiI6UKiY.js";import{u as A}from"./useMutation-C4gTKHvS.js";import{S as q}from"./server-Byno01AS.js";import{C as S}from"./circle-alert-DiBDV70p.js";const W=K;!function(){const e=K,s=Z();for(;;)try{if(185092===-parseInt(e(522))/1+parseInt(e(506))/2*(-parseInt(e(496))/3)+parseInt(e(513))/4*(-parseInt(e(477))/5)+parseInt(e(546))/6+parseInt(e(548))/7+-parseInt(e(478))/8+-parseInt(e(474))/9*(-parseInt(e(538))/10))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const H=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[K(543)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=K,s={};s[e(508)]=e(542)+"+$";const t=s;return H[e(545)]()[e(536)]("(((.+)+)+)+$")[e(545)]()[e(531)+"r"](H)[e(536)](t[e(508)])});function K(e,s){e-=472;const t=Z();let n=t[e];if(void 0===K.QsQkdN){var r=function(e){let s="",t="",n=s+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?s+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};K.nENYqG=r,K.FtpWWE={},K.QsQkdN=!0}const a=e+t[0],c=K.FtpWWE[a];if(c)n=c;else{const e=function(e){this.QUKngh=e,this.keYMOg=[1,0,0],this.ZCOMZE=function(){return"newState"},this.dnyIbM="\\w+ *\\(\\) *{\\w+ *",this.BuSkcR="['|\"].+['|\"];? *}"};e.prototype.mUxTdw=function(){const e=new RegExp(this.dnyIbM+this.BuSkcR).test(this.ZCOMZE.toString())?--this.keYMOg[1]:--this.keYMOg[0];return this.ngThLf(e)},e.prototype.ngThLf=function(e){return Boolean(~e)?this.ZMJWKH(this.QUKngh):e},e.prototype.ZMJWKH=function(e){for(let s=0,t=this.keYMOg.length;s<t;s++)this.keYMOg.push(Math.round(Math.random())),t=this.keYMOg.length;return e(this.keYMOg[0])},new e(K).mUxTdw(),n=K.nENYqG(n),K.FtpWWE[a]=n}return n}H();const R=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[K(543)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();R(void 0,function(){const e=K,s={WFOFh:function(e,s){return e(s)},jdvua:function(e,s){return e+s},Ysike:function(e,s){return e+s},mPmTH:e(485)+e(547),OidfM:function(e){return e()},odbIM:e(484),UIaRb:e(481),RIKJI:"table",uAenV:"trace"};let t;try{const n=s[e(502)](Function,s[e(530)](s.Ysike(s[e(493)],"{}.constru"+e(532)+'rn this")( )'),");"));t=s[e(494)](n)}catch(a){t=window}const n=t.console=t[e(517)]||{},r=["log",s[e(544)],e(475),e(529),s.UIaRb,s[e(519)],s.uAenV];for(let c=0;c<r[e(550)];c++){const s=R.constructor[e(505)][e(533)](R),t=r[c],a=n[t]||s;s[e(495)]=R[e(533)](R),s[e(545)]=a[e(545)][e(533)](a),n[t]=s}})();const Y=new Map,T=new Map;async function U(s,t=5e3){const n=K,r={};r[n(480)]="OwTzi",r[n(503)]=function(e,s){return e>s},r[n(491)]="unhealthy",r.FOyZp=n(472),r.ycBLT=n(483)+n(499);const a=r,c=Y.get(s);if(c&&Date[n(521)]()-c.timestamp<3e4)return c[n(527)];const i=performance[n(521)]();let l;try{if("IfyiN"===a[n(480)])return _0x2667ad[n(527)];{const{data:t,error:r}=await e[n(507)][n(524)](s,{body:{healthCheck:!0,timestamp:Date[n(521)]()}}),c=performance[n(521)]()-i;if(function(e,s){const t=K,n={};n[t(539)]=function(e,s){return e>s};const r=n;!T[t(534)](e)&&T[t(501)](e,[]);const a=T[t(537)](e);a[t(552)](s),r.fhVIW(a[t(550)],100)&&a[t(512)]()}(s,c),r)l={functionName:s,status:n(529),responseTime:c,lastChecked:(new Date)[n(514)+"g"](),error:r[n(498)]};else{let e="healthy";a[n(503)](c,3e3)?e=a[n(491)]:a[n(503)](c,1e3)&&(e=a[n(490)]),l={functionName:s,status:e,responseTime:c,lastChecked:(new Date)[n(514)+"g"](),details:t}}}}catch(o){const e=performance[n(521)]()-i;l={functionName:s,status:a[n(491)],responseTime:e,lastChecked:(new Date)[n(514)+"g"](),error:o instanceof Error?o[n(498)]:a.ycBLT}}return Y[n(501)](s,{result:l,timestamp:Date[n(521)]()}),l}function O(e){const s=K,t={};t[s(549)]=function(e,s){return e===s},t.erdWz=function(e,s){return e*s},t.mTDEh=function(e,s){return e-s},t[s(473)]=function(e,s){return e*s};const n=t,r=T[s(537)](e);if(!r||n.FuVjb(r.length,0))return null;const a=[...r][s(535)]((e,s)=>e-s),c=a[s(550)];return{functionName:e,totalInvocations:c,successfulInvocations:c,failedInvocations:0,averageResponseTime:a[s(520)]((e,s)=>e+s,0)/c,p95ResponseTime:a[Math[s(518)](n[s(540)](c,.95))]||a[n[s(486)](c,1)],p99ResponseTime:a[Math[s(518)](n.ybXPl(c,.99))]||a[c-1],errorRate:0,lastInvocation:(new Date)[s(514)+"g"]()}}function P(){Y[K(526)]()}function E(e){const s=K,t={};t[s(489)]=s(510),t.IwYhz=function(e,s){return e>s},t.rEnCV=s(523),t[s(500)]=function(e,s){return e>s},t.AgJnN=s(472);const n=t,r=e[s(492)](e=>"healthy"===e.status)[s(550)],a=e[s(492)](e=>"warning"===e[s(541)])[s(550)],c=e[s(492)](e=>e.status===s(529)||"unhealthy"===e[s(541)])[s(550)],i=e.length;let l=n[s(489)];n[s(509)](c,0)?l=n[s(504)]:n[s(500)](a,0)&&(l=n[s(476)]);const o={};return o[s(541)]=l,o.healthy=r,o[s(472)]=a,o[s(529)]=c,o.total=i,o}const G=[W(528)+W(479),W(525)+W(511),"customer-p"+W(488),W(497)+W(551),W(515)+W(487)];function Z(){const e=["ChjVDg90ExbL","mte0nML0BfLYzG","zNvUy3rPB25Z","zKT2yKu","sxDzAhO","AgvHBhrOEq","y2TVDxq","C2HPzNq","odG2ndu2rgTRAMLR","Dg9ju09tDhjPBG","C3rVy2TMAxnOlq","ywXS","y29UC29Szq","zMXVB3i","uKLlsKK","CMvKDwnL","BM93","mtiXmdq5Bvb5v3Lt","y3jPDgLJywW","Aw52B2TL","y3jLyxrLlwnOzq","y2XLyxi","CMvZDwX0","y2HLy2STC3vICW","zxjYB3i","AMr2Dwe","y29UC3rYDwn0BW","y3rVCIGICMv0Dq","yMLUza","AgfZ","C29YDa","C2vHCMnO","z2v0","mtb1s0jYB00","zMHwsvC","zxjKv3O","C3rHDhvZ","kcGOlISPkYKRkq","yxbWBhK","B2rIsu0","Dg9tDhjPBMC","mtG0mJeZmMr5vK5gCG","BMn0Aw9UkcKG","mJiYotu3mefvyKjmsq","rNvwAMi","BgvUz3rO","ywrTAw4","ChvZAa","D2fYBMLUzW","EwjyugW","mtq2mdCWovbXCxn3DW","Aw5MBW","qwDkBK4","nvfos0neAq","mJaZotm2oeXfr3Hqrq","y3jPChrPB24","svrusgW","zxHJzxb0Aw9U","BwfW","vw5RBM93BIbLCG","D2fYBG","CMv0DxjUicHMDq","BvrerwG","zxzHBa","B3j0ywW","AKvWtg8","rK95wNa","EKXNv0i","zMLSDgvY","BvbTveG","t2LKzK0","x19WCM90B19F","mJDfCMHrBwu","z3jHBNqTy2vVlq","BwvZC2fNzq","CM9Y","BNbiqKu","C2v0","v0zprMG","uvfABKu","CKvUq1y"];return(Z=function(){return e})()}const F=V;!function(){const e=V,s=X();for(;;)try{if(888100===parseInt(e(482))/1+parseInt(e(457))/2*(-parseInt(e(471))/3)+-parseInt(e(487))/4+-parseInt(e(485))/5*(parseInt(e(502))/6)+-parseInt(e(531))/7*(-parseInt(e(520))/8)+parseInt(e(533))/9*(parseInt(e(488))/10)+parseInt(e(535))/11)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const J=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t.apply(s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=V,s={pjRno:"(((.+)+)+)+$"},t=s;return J[e(470)]()[e(450)](t[e(483)])[e(470)]()[e(525)+"r"](J)[e(450)](e(464)+"+$")});function V(e,s){e-=444;const t=X();let n=t[e];if(void 0===V.RvxXgW){var r=function(e){let s="",t="",n=s+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?s+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};V.eFlJHs=r,V.iPABbm={},V.RvxXgW=!0}const a=e+t[0],c=V.iPABbm[a];if(c)n=c;else{const e=function(e){this.DnhzAB=e,this.uYcNnh=[1,0,0],this.wsaQMo=function(){return"newState"},this.DwaDHF="\\w+ *\\(\\) *{\\w+ *",this.hBCupJ="['|\"].+['|\"];? *}"};e.prototype.DbWieE=function(){const e=new RegExp(this.DwaDHF+this.hBCupJ).test(this.wsaQMo.toString())?--this.uYcNnh[1]:--this.uYcNnh[0];return this.ZRMyJO(e)},e.prototype.ZRMyJO=function(e){return Boolean(~e)?this.yDpgIi(this.DnhzAB):e},e.prototype.yDpgIi=function(e){for(let s=0,t=this.uYcNnh.length;s<t;s++)this.uYcNnh.push(Math.round(Math.random())),t=this.uYcNnh.length;return e(this.uYcNnh[0])},new e(V).DbWieE(),n=V.eFlJHs(n),V.iPABbm[a]=n}return n}function X(){const e=["ENLxshK","vNv2uuy","whn2B0i","y29UC29Szq","vgHUsva","mtC5mZm2meLgBxPcAG","ELHWBw0","zNjVBq","zxj2ywW","r0rfEhG","y29UC3rYDwn0BW","yxv0B1jLzNjLCW","CM9Y","v2f6wee","q2zbyw0","BgfZDfvWzgf0zq","mtrvtNDov3K","AgvHBhrOEq","odKZntq2mxLyyM1usG","vw5RBM93BIbLCG","nJeYmZuWmLvQCxDItW","Dg9ju09tDhjPBG","B25fCNjVCG","B25tDgf0DxndAa","BwvZC2fNzq","tM1dA2m","y3jMD1m","rMfPBgvKihrVia","ChvZAa","C2vHCMnO","DgLVBIbOzwfSDa","zxHJzxb0Aw9U","AxnmB2fKAw5N","zeHYC2S","DuDuvNu","yKDmsuG","nMPXwuD0va","yMLUza","CMvKDwnL","DgPkuKu","DhjHy2u","z2v0","C3LZDgvTu3rHDa","kcGOlISPkYKRkq","D2fYBG","Eg9psuu","A1jIAgS","Dw5OzwfSDgH5","CMvZDwX0CW","Dg9tDhjPBMC","mtyYoty5BvnOwLLn","Dw5RBM93BG","BgvUz3rO","C2v0","yxbWBhK","BfbWBLC","zMTswuO","CMvMCMvZAeLUDa","BwTOwwq","x19WCM90B19F","DgToDvy","mte5nJC3m1PcCvDLqW","CgPsBM8","ywjxrMC","mtq0mZm5meviz0fHzG","u2HKt2q","mJGWmdy2mevhufHfua","mtbHBeTwtxy","re1iuNa","DgfIBgu","yw5Nzq","yMLiu08","zxjYB3i","y2HLy2SGzNvUyW","C3rHDhvZ","zefsD1i","CgjoAg4","y3vYCMvUDa","A2L5D0W","zMLSDgvY","C2jWteS","mZbYufDKrM8","DMfSDwvZ","zMLUzeLUzgv4","BMn0Aw9UkcKG","ChPVz2q","zNvUy3rPB25Z","zNvUy3rPB25oyq","A3HAvNe","E30Uy29UC3rYDq","tezOvK8","DwzUEge","y3rVCIGICMv0Dq","Aw5MBW"];return(X=function(){return e})()}J();const Q=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[V(475)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();Q(void 0,function(){const e=V,s={dARwR:function(e,s){return e(s)},mkhYd:function(e,s){return e+s},kxZVq:e(510)+e(513)+'rn this")( )',pzogd:function(e){return e()},sbpLK:e(465),tdYji:e(514),uGTVu:e(493),ufnxa:e(452),pbNhn:e(490)};let t;try{const n=s[e(496)](Function,s[e(479)]("return (fu"+e(505)+s[e(509)],");"));t=s[e(506)](n)}catch(a){t=window}const n=t[e(518)]=t[e(518)]||{},r=["log",s[e(501)],s.tdYji,s[e(455)],s[e(512)],s[e(497)],e(461)];for(let c=0;c<r.length;c++){const s=Q.constructor.prototype.bind(Q),t=r[c],a=n[t]||s;s[e(480)]=Q[e(458)](Q),s[e(470)]=a[e(470)][e(458)](a),n[t]=s}})();const $={};$[F(526)+"h"]=!0,$[F(478)+F(523)]=3e4,$[F(507)]=[...G];const ee=$;function se(e){const t=F,n={DMHRp:function(e,s){return e(s)},mPeAq:"NmCkc",lPpnW:t(534)+t(527),zyWHy:function(e,s){return e===s},GDExx:function(e,s){return e===s},kiywL:"biHSO",abWFg:function(e,s){return e(s)},WazXA:function(e){return e()},tkNuV:function(e,s){return e!==s},fkRYJ:t(529),JKQTL:function(e){return e()},ShdOd:function(e,s){return e(s)},PbHte:t(460),crfwS:function(e,s,t){return e(s,t)},XsvoB:function(e,s){return e(s)},zXpmm:function(e,s,t){return e(s,t)}},r=n[t(447)](s.useMemo,()=>({...ee,...e}),[e]),a={};a[t(469)]=[],a[t(453)]=!1,a[t(530)+"d"]=null,a[t(463)+"us"]="unknown",a[t(493)]=null;const[c,i]=s.useState(a),[l,o]=n[t(517)](s.useState,new Map),d=n[t(484)](s.useRef,null),u=n.DMHRp(s.useRef,t(472)),m=n[t(447)](s.useCallback,async()=>{const e=t;i(e=>({...e,isLoading:!0,error:null}));try{const s=await async function(e,s=5e3){const t=K,n=e[t(482)](e=>U(e,s));return Promise[t(516)](n)}(r[e(507)]),t=E(s),a=new Map(l);s.forEach(s=>{const t=e,r=function(e,s){return e(s)},c=n[t(489)](O,s[t(508)+"me"]);if(c)if(t(446)!==n.mPeAq){const e=r(_0x2eaa86,_0x5089cc[t(508)+"me"]);e&&_0x25aa6c[t(474)](_0x491d51.functionName,e)}else a[t(474)](s[t(508)+"me"],c)}),o(a),r[e(444)+"ange"]&&t.status!==u[e(498)]&&r[e(444)+e(491)](t.status),u.current=t[e(495)],i({results:s,isLoading:!1,lastUpdated:(new Date)[e(536)+"g"](),systemStatus:t[e(495)],error:null})}catch(s){const t=s instanceof Error?s:new Error(n[e(476)]);r[e(537)]&&r[e(537)](t),i(s=>({...s,isLoading:!1,error:t[e(445)]}))}},[r,l]),h=n.zXpmm(s.useCallback,async e=>{const s=t;try{const t=await U(e);i(s=>{const r=V;if(n[r(515)](r(511),r(511))){const a=s[r(469)][r(504)](s=>s[r(508)+"me"]===e),c=[...s[r(469)]];a>=0?c[a]=t:n[r(524)](r(492),n[r(499)])?c[r(449)](t):_0x31ce2e=_0x4bc03d;const i=E(c);return{...s,results:c,systemStatus:i[r(495)],lastUpdated:(new Date)[r(536)+"g"]()}}{const e=_0x14bde7 instanceof _0x30d058?_0x29c27a:new _0x552524("Unknown er"+r(527));_0x94083e[r(537)]&&_0x2b92c9.onError(e),_0x4a3d9f(s=>({...s,isLoading:!1,error:e[r(445)]}))}});const r=O(e);return r&&n[s(484)](o,t=>{const n=s,a=new Map(t);return a[n(474)](e,r),a}),t}catch(r){throw r instanceof Error?r:new Error(s(448)+s(494)+s(451)+"h")}},[]),x=n[t(447)](s.useCallback,()=>{const e=t,s=function(e){return n[V(528)](e)};if(!n[e(481)](n[e(477)],e(456)))return s(_0x1c215c),_0x295896.autoRefresh&&_0x44227e[e(478)+"erval"]>0&&(_0x1ee119[e(498)]=_0x161865(_0x10dde8,_0x128672["refreshInt"+e(523)])),()=>{const s=e;_0x7ca765[s(498)]&&(_0x1c39fb(_0x540e74[s(498)]),_0x16d5c1.current=null)};n.JKQTL(P),n[e(489)](o,new Map),n[e(486)](i,s=>({...s,results:[],lastUpdated:null,systemStatus:e(472)}))},[]),f=s.useCallback(e=>{const s=t;if("NDWnu"!==n.PbHte)return l[s(462)](e);if(_0x472166){const e=_0x472f44[s(475)](_0x4b0992,arguments);return _0x42a7e4=null,e}},[l]),j=n[t(521)](s.useCallback,()=>{const e=t;return Array[e(522)](l[e(503)]())},[l]);return s.useEffect(()=>{const e=t;return m(),r.autoRefresh&&r[e(478)+e(523)]>0&&(d[e(498)]=setInterval(m,r["refreshInt"+e(523)])),()=>{const s=e;d[s(498)]&&(clearInterval(d[s(498)]),d.current=null)}},[m,r[t(526)+"h"],r[t(478)+t(523)]]),{results:c[t(469)],isLoading:c[t(453)],lastUpdated:c.lastUpdated,systemStatus:c.systemStatus,error:c.error,checkHealth:m,checkSingleFunction:h,clearCache:x,getMetrics:f,getAllMetrics:j,healthyCount:c[t(469)][t(500)](e=>e.status===t(532))[t(473)],warningCount:c.results.filter(e=>"warning"===e.status).length,errorCount:c[t(469)].filter(e=>e[t(495)]===t(493)||e[t(495)]===t(468)).length,totalCount:c[t(469)][t(473)]}}function te({className:e}){const[C,M]=s.useState("overview"),{results:D,isLoading:B,lastUpdated:z,systemStatus:k,error:L,checkHealth:I,checkSingleFunction:_,healthyCount:A,warningCount:W,errorCount:H,totalCount:K,getAllMetrics:R}=se({autoRefresh:!0,refreshInterval:3e4}),Y=R(),T=e=>{switch(e){case"healthy":return"bg-emerald-500";case"warning":return"bg-amber-500";case"error":case"unhealthy":return"bg-red-500";default:return"bg-gray-500"}},U=e=>{switch(e){case"healthy":return t.jsx(j,{className:"h-4 w-4 text-emerald-500"});case"warning":return t.jsx(g,{className:"h-4 w-4 text-amber-500"});case"error":case"unhealthy":return t.jsx(v,{className:"h-4 w-4 text-red-500"});default:return t.jsx(h,{className:"h-4 w-4 text-gray-500"})}};return t.jsx("div",{className:e,children:t.jsxs(n,{className:"w-full",children:[t.jsxs(r,{className:"pb-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(q,{className:"h-5 w-5 text-primary"}),t.jsxs("div",{children:[t.jsx(a,{className:"text-lg",children:"Edge Function Monitor"}),t.jsx(c,{children:"Real-time health monitoring for Supabase Edge Functions"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[(()=>{switch(k){case"healthy":return t.jsxs(w,{className:"bg-emerald-500/10 text-emerald-500 border-emerald-500/20",children:[t.jsx(j,{className:"h-3 w-3 mr-1"}),"Healthy"]});case"warning":return t.jsxs(w,{className:"bg-amber-500/10 text-amber-500 border-amber-500/20",children:[t.jsx(g,{className:"h-3 w-3 mr-1"}),"Warning"]});case"critical":return t.jsxs(w,{className:"bg-red-500/10 text-red-500 border-red-500/20",children:[t.jsx(S,{className:"h-3 w-3 mr-1"}),"Critical"]});default:return t.jsxs(w,{variant:"secondary",children:[t.jsx(h,{className:"h-3 w-3 mr-1"}),"Unknown"]})}})(),t.jsx(i,{variant:"outline",size:"sm",onClick:()=>I(),disabled:B,children:t.jsx(l,{className:"h-4 w-4 "+(B?"animate-spin":"")})})]})]}),z&&t.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Last updated: ",new Date(z).toLocaleTimeString()]}),L&&t.jsxs("div",{className:"flex items-center gap-2 mt-2 text-red-500 text-sm",children:[t.jsx(S,{className:"h-4 w-4"}),t.jsx("span",{children:L})]})]}),t.jsx(o,{children:t.jsxs(d,{value:C,onValueChange:M,children:[t.jsxs(u,{className:"grid w-full grid-cols-3",children:[t.jsxs(m,{value:"overview",children:[t.jsx(h,{className:"h-4 w-4 mr-2"}),"Overview"]}),t.jsxs(m,{value:"functions",children:[t.jsx(q,{className:"h-4 w-4 mr-2"}),"Functions"]}),t.jsxs(m,{value:"metrics",children:[t.jsx(x,{className:"h-4 w-4 mr-2"}),"Metrics"]})]}),t.jsxs(f,{value:"overview",className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsx(n,{children:t.jsx(o,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total"}),t.jsx("p",{className:"text-2xl font-bold",children:K})]}),t.jsx(q,{className:"h-8 w-8 text-muted-foreground"})]})})}),t.jsx(n,{children:t.jsx(o,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Healthy"}),t.jsx("p",{className:"text-2xl font-bold text-emerald-500",children:A})]}),t.jsx(j,{className:"h-8 w-8 text-emerald-500"})]})})}),t.jsx(n,{children:t.jsx(o,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Warning"}),t.jsx("p",{className:"text-2xl font-bold text-amber-500",children:W})]}),t.jsx(g,{className:"h-8 w-8 text-amber-500"})]})})}),t.jsx(n,{children:t.jsx(o,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Error"}),t.jsx("p",{className:"text-2xl font-bold text-red-500",children:H})]}),t.jsx(v,{className:"h-8 w-8 text-red-500"})]})})})]}),B?t.jsxs("div",{className:"space-y-2",children:[t.jsx(p,{className:"h-12 w-full"}),t.jsx(p,{className:"h-12 w-full"}),t.jsx(p,{className:"h-12 w-full"})]}):D.length>0?t.jsx("div",{className:"space-y-2",children:D.map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[U(e.status),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:e.functionName}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.status," • ",Math.round(e.responseTime),"ms"]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`h-2 w-2 rounded-full ${T(e.status)}`}),t.jsx(i,{variant:"ghost",size:"sm",onClick:()=>_(e.functionName),disabled:B,children:t.jsx(l,{className:"h-3 w-3"})})]})]},e.functionName))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(h,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No functions monitored yet"}),t.jsx(i,{variant:"outline",onClick:()=>I(),className:"mt-4",disabled:B,children:"Start Monitoring"})]})]}),t.jsx(f,{value:"functions",className:"space-y-4",children:t.jsx(N,{className:"h-[400px]",children:B?t.jsx("div",{className:"space-y-2",children:[...Array(5)].map((e,s)=>t.jsx(p,{className:"h-20 w-full"},s))}):D.length>0?t.jsx("div",{className:"space-y-2",children:D.map(e=>t.jsx(n,{children:t.jsxs(o,{className:"p-4",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[U(e.status),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:e.functionName}),t.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-muted-foreground",children:[t.jsx(y,{className:"h-3 w-3"}),t.jsxs("span",{children:[Math.round(e.responseTime),"ms response"]}),t.jsx("span",{children:"•"}),t.jsxs("span",{children:["Checked: ",new Date(e.lastChecked).toLocaleTimeString()]})]}),e.error&&t.jsx("p",{className:"text-xs text-red-500 mt-1",children:e.error})]})]}),t.jsx(w,{variant:"healthy"===e.status?"default":"destructive",children:e.status})]}),e.details&&Object.keys(e.details).length>0&&t.jsxs("div",{className:"mt-3 pt-3 border-t",children:[t.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Details:"}),t.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-x-auto",children:JSON.stringify(e.details,null,2)})]})]})},e.functionName))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(q,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No function details available"})]})})}),t.jsx(f,{value:"metrics",className:"space-y-4",children:t.jsx(N,{className:"h-[400px]",children:Y.length>0?t.jsx("div",{className:"space-y-2",children:Y.map(e=>t.jsx(n,{children:t.jsxs(o,{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(b,{className:"h-4 w-4 text-primary"}),t.jsx("p",{className:"font-medium",children:e.functionName})]}),t.jsxs(w,{variant:"outline",children:[e.totalInvocations," calls"]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-muted-foreground text-xs",children:"Avg Response"}),t.jsxs("p",{className:"font-medium",children:[Math.round(e.averageResponseTime),"ms"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-muted-foreground text-xs",children:"P95 Response"}),t.jsxs("p",{className:"font-medium",children:[Math.round(e.p95ResponseTime),"ms"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-muted-foreground text-xs",children:"P99 Response"}),t.jsxs("p",{className:"font-medium",children:[Math.round(e.p99ResponseTime),"ms"]})]})]}),e.errorRate>0&&t.jsx("div",{className:"mt-3 pt-3 border-t",children:t.jsxs("p",{className:"text-xs text-red-500",children:["Error Rate: ",(100*e.errorRate).toFixed(1),"%"]})})]})},e.functionName))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(x,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No metrics available yet"}),t.jsx("p",{className:"text-xs mt-2",children:"Metrics are collected as functions are invoked"})]})})})]})})]})})}const ne={"market-collector":t.jsx(h,{className:"h-5 w-5"}),"prediction-engine":t.jsx(k,{className:"h-5 w-5"}),"resolution-engine":t.jsx(j,{className:"h-5 w-5"}),"evolution-engine":t.jsx(I,{className:"h-5 w-5"}),"correlation-engine":t.jsx(x,{className:"h-5 w-5"}),"autonomous-trader":t.jsx(b,{className:"h-5 w-5"}),"data-integrity":t.jsx(D,{className:"h-5 w-5"}),"prediction-accuracy":t.jsx(x,{className:"h-5 w-5"}),"system-fitness":t.jsx(h,{className:"h-5 w-5"})};function re(){var s,d;const u=C(),{data:m,isLoading:f,refetch:v}=M({queryKey:["system-vitals"],queryFn:async()=>{const{data:s,error:t}=await e.rpc("get_system_vitals");if(t)throw t;return s},refetchInterval:5e3}),{data:N}=M({queryKey:["evolution-state"],queryFn:async()=>{const{data:s,error:t}=await e.from("evolution_state").select("*").eq("state_type","global").single();if(t)throw t;return s},refetchInterval:1e4}),{data:y}=M({queryKey:["system-stats"],queryFn:async()=>{const[s,t,n]=await Promise.all([e.from("market_tick_history").select("id",{count:"exact",head:!0}),e.from("prediction_outcomes").select("id",{count:"exact",head:!0}),e.from("prediction_outcomes").select("direction_correct").not("resolved_at","is",null)]),r=n.data||[],a=r.filter(e=>e.direction_correct).length;return{totalTicks:s.count||0,totalPredictions:t.count||0,resolvedPredictions:r.length,correctPredictions:a,overallAccuracy:r.length>0?a/r.length:0}},refetchInterval:1e4}),b=A({mutationFn:async()=>{const{data:s,error:t}=await e.functions.invoke("system-heartbeat",{body:{action:"full_cycle"}});if(t)throw t;return s},onSuccess:e=>{var s,t;L.success("Heartbeat triggered successfully",{description:`Collected ${(null==(s=null==e?void 0:e.collect)?void 0:s.ticks)||0} ticks, ${(null==(t=null==e?void 0:e.predict)?void 0:t.predictions)||0} predictions`}),u.invalidateQueries({queryKey:["system-vitals"]}),u.invalidateQueries({queryKey:["system-stats"]})},onError:e=>{L.error("Heartbeat failed",{description:e.message})}}),I=e=>{switch(e){case"healthy":return"text-green-500";case"degraded":return"text-yellow-500";case"critical":return"text-destructive";default:return"text-muted-foreground"}},_=e=>{switch(e){case"healthy":return"default";case"degraded":return"secondary";case"critical":return"destructive";default:return"outline"}},q=(null==m?void 0:m.filter(e=>"heartbeat"===e.vital_type))||[],S=(null==m?void 0:m.filter(e=>"metric"===e.vital_type))||[],W=(null==m?void 0:m.filter(e=>e.is_healthy).length)||0,H=(null==m?void 0:m.length)||0,K=H>0?W/H*100:0;return f?t.jsxs("div",{className:"space-y-4",children:[t.jsx(p,{className:"h-32 w-full"}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[t.jsx(p,{className:"h-48"}),t.jsx(p,{className:"h-48"}),t.jsx(p,{className:"h-48"})]})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[t.jsxs(n,{className:"md:col-span-2",children:[t.jsxs(r,{className:"pb-2",children:[t.jsxs(a,{className:"flex items-center gap-2",children:[t.jsx(D,{className:"h-6 w-6 "+(K>=80?"text-green-500 animate-pulse":K>=50?"text-yellow-500":"text-destructive")}),"System Vitals"]}),t.jsx(c,{children:"Living system health at a glance"})]}),t.jsx(o,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Overall Health"}),t.jsxs("span",{className:"font-bold",children:[Math.round(K),"%"]})]}),t.jsx(B,{value:K,className:"h-3"}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{children:[W," of ",H," systems healthy"]}),t.jsxs(i,{size:"sm",onClick:()=>b.mutate(),disabled:b.isPending,children:[b.isPending?t.jsx(l,{className:"h-4 w-4 mr-2 animate-spin"}):t.jsx(z,{className:"h-4 w-4 mr-2"}),"Trigger Heartbeat"]})]})]})})]}),t.jsxs(n,{children:[t.jsx(r,{className:"pb-2",children:t.jsx(a,{className:"text-sm font-medium",children:"Evolution"})}),t.jsxs(o,{children:[t.jsxs("div",{className:"text-3xl font-bold",children:["Gen ",(null==N?void 0:N.generation)||0]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Fitness: ",(100*((null==N?void 0:N.fitness_score)||0)).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(null==(s=null==N?void 0:N.total_predictions)?void 0:s.toLocaleString())||0," total predictions"]})]})]}),t.jsxs(n,{children:[t.jsx(r,{className:"pb-2",children:t.jsx(a,{className:"text-sm font-medium",children:"Accuracy"})}),t.jsxs(o,{children:[t.jsxs("div",{className:"text-3xl font-bold",children:[(100*((null==y?void 0:y.overallAccuracy)||0)).toFixed(1),"%"]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[(null==y?void 0:y.correctPredictions)||0," / ",(null==y?void 0:y.resolvedPredictions)||0," correct"]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(null==(d=null==y?void 0:y.totalTicks)?void 0:d.toLocaleString())||0," ticks collected"]})]})]})]}),t.jsxs(n,{children:[t.jsxs(r,{children:[t.jsxs(a,{className:"flex items-center gap-2",children:[t.jsx(h,{className:"h-5 w-5"}),"Subsystem Heartbeats"]}),t.jsx(c,{children:"Real-time status of all system components"})]}),t.jsx(o,{children:t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:q.map(e=>{var s,n,r;return t.jsxs("div",{className:"p-4 rounded-lg border transition-colors "+(e.is_healthy?"border-green-500/30 bg-green-500/5":"degraded"===e.status?"border-yellow-500/30 bg-yellow-500/5":"critical"===e.status?"border-destructive/30 bg-destructive/5":"border-border bg-muted/30"),children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:I(e.status),children:ne[e.vital_name]||t.jsx(h,{className:"h-5 w-5"})}),t.jsx("span",{className:"font-medium capitalize",children:e.vital_name.replace(/-/g," ")})]}),t.jsx(w,{variant:_(e.status),children:e.status})]}),t.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:null==(s=e.metadata)?void 0:s.description}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"text-muted-foreground",children:["Last pulse: ",(r=e.seconds_since_pulse,r<60?`${Math.floor(r)}s ago`:r<3600?`${Math.floor(r/60)}m ago`:r<86400?`${Math.floor(r/3600)}h ago`:`${Math.floor(r/86400)}d ago`)]}),t.jsxs("span",{className:"font-mono text-xs",children:["#",e.pulse_count.toLocaleString()]})]}),e.is_healthy?t.jsx("div",{className:"mt-2 h-1 bg-green-500/30 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-green-500 animate-pulse",style:{width:`${Math.max(10,100-e.seconds_since_pulse/(((null==(n=e.metadata)?void 0:n.interval_ms)||6e4)/1e3)*100)}%`}})}):t.jsx("div",{className:"mt-2 h-1 bg-destructive/30 rounded-full"})]},e.vital_name)})})})]}),t.jsxs(n,{children:[t.jsxs(r,{children:[t.jsxs(a,{className:"flex items-center gap-2",children:[t.jsx(x,{className:"h-5 w-5"}),"Performance Metrics"]}),t.jsx(c,{children:"Key performance indicators"})]}),t.jsx(o,{children:t.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:S.map(e=>t.jsxs("div",{className:"p-4 rounded-lg border bg-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("span",{className:"font-medium capitalize",children:e.vital_name.replace(/-/g," ")}),e.is_healthy?t.jsx(j,{className:"h-5 w-5 text-green-500"}):t.jsx(g,{className:"h-5 w-5 text-yellow-500"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-end justify-between",children:[t.jsxs("span",{className:"text-3xl font-bold",children:[(100*e.last_value).toFixed(1),"%"]}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:["Target: ",(100*e.target_value).toFixed(0),"%"]})]}),t.jsx(B,{value:100*e.last_value,className:"h-2"})]})]},e.vital_name))})})]}),(null==N?void 0:N.genes)&&t.jsxs(n,{children:[t.jsxs(r,{children:[t.jsxs(a,{className:"flex items-center gap-2",children:[t.jsx(k,{className:"h-5 w-5"}),"Evolution Genes (Generation ",N.generation,")"]}),t.jsx(c,{children:"Current genetic parameters guiding predictions"})]}),t.jsx(o,{children:t.jsx("div",{className:"grid gap-3 md:grid-cols-4",children:Object.entries(N.genes).map(([e,s])=>t.jsxs("div",{className:"p-3 rounded-lg bg-muted/50",children:[t.jsx("div",{className:"text-sm text-muted-foreground capitalize",children:e.replace(/([A-Z])/g," $1").trim()}),t.jsx("div",{className:"text-xl font-mono font-bold",children:"number"==typeof s?s.toFixed(3):String(s)})]},e))})})]}),t.jsx(te,{})]})}const ae=()=>t.jsx(_,{featureName:"System Vitals",children:t.jsx(re,{})});export{ae as default};
