const e='import React, { useEffect, useState } from \'react\';\nimport { useNavigate } from \'react-router-dom\';\nimport { Header } from \'@/components/shop/Header\';\nimport { useAuth } from \'@/hooks/useAuth\';\nimport { supabase } from \'@/integrations/supabase/client\';\nimport { Button } from \'@/components/ui/button\';\nimport { \n  Palette, \n  Trash2, \n  ArrowLeft, \n  Loader2, \n  PlayCircle,\n  Calendar,\n  Globe,\n  Lock,\n} from \'lucide-react\';\nimport { toast } from \'sonner\';\nimport { setCustomColor, setActivePalette, PieceType } from \'@/lib/chess/pieceColors\';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \'@/components/ui/alert-dialog\';\nimport { Switch } from \'@/components/ui/switch\';\n\ninterface SavedPalette {\n  id: string;\n  name: string;\n  description: string | null;\n  white_colors: Record<string, string>;\n  black_colors: Record<string, string>;\n  created_at: string;\n  is_public: boolean;\n}\n\nconst MyPalettes: React.FC = () => {\n  const { user, isLoading: authLoading } = useAuth();\n  const navigate = useNavigate();\n  const [palettes, setPalettes] = useState<SavedPalette[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [deleteId, setDeleteId] = useState<string | null>(null);\n  const [isDeleting, setIsDeleting] = useState(false);\n\n  const pieces: PieceType[] = [\'k\', \'q\', \'r\', \'b\', \'n\', \'p\'];\n\n  useEffect(() => {\n    if (!authLoading && !user) {\n      navigate(\'/\');\n      toast.error(\'Please sign in to view your palettes\');\n    }\n  }, [user, authLoading, navigate]);\n\n  useEffect(() => {\n    if (user) {\n      fetchPalettes();\n    }\n  }, [user]);\n\n  const fetchPalettes = async () => {\n    setIsLoading(true);\n    try {\n      const { data, error } = await supabase\n        .from(\'saved_palettes\')\n        .select(\'*\')\n        .order(\'created_at\', { ascending: false });\n\n      if (error) throw error;\n      \n      setPalettes((data || []).map(item => ({\n        ...item,\n        white_colors: item.white_colors as Record<string, string>,\n        black_colors: item.black_colors as Record<string, string>,\n      })));\n    } catch (error) {\n      console.error(\'Error fetching palettes:\', error);\n      toast.error(\'Failed to load palettes\');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleLoadPalette = (palette: SavedPalette) => {\n    // Apply the saved colors to the custom palette\n    pieces.forEach(piece => {\n      setCustomColor(\'w\', piece, palette.white_colors[piece]);\n      setCustomColor(\'b\', piece, palette.black_colors[piece]);\n    });\n    \n    // Set custom as active palette\n    setActivePalette(\'custom\');\n    \n    toast.success(`"${palette.name}" loaded!`, {\n      description: \'Navigate home to use it in your visualization.\',\n    });\n    \n    navigate(\'/\');\n  };\n\n  const handleDeletePalette = async () => {\n    if (!deleteId) return;\n    \n    setIsDeleting(true);\n    try {\n      const { error } = await supabase\n        .from(\'saved_palettes\')\n        .delete()\n        .eq(\'id\', deleteId);\n\n      if (error) throw error;\n      \n      setPalettes(prev => prev.filter(p => p.id !== deleteId));\n      toast.success(\'Palette deleted\');\n    } catch (error) {\n      console.error(\'Error deleting palette:\', error);\n      toast.error(\'Failed to delete palette\');\n    } finally {\n      setIsDeleting(false);\n      setDeleteId(null);\n    }\n  };\n\n  const handleTogglePublic = async (paletteId: string, currentValue: boolean) => {\n    try {\n      const { error } = await supabase\n        .from(\'saved_palettes\')\n        .update({ is_public: !currentValue })\n        .eq(\'id\', paletteId);\n\n      if (error) throw error;\n      \n      setPalettes(prev => prev.map(p => \n        p.id === paletteId ? { ...p, is_public: !currentValue } : p\n      ));\n      \n      toast.success(!currentValue ? \'Palette is now public!\' : \'Palette is now private\');\n    } catch (error) {\n      console.error(\'Error updating palette:\', error);\n      toast.error(\'Failed to update palette visibility\');\n    }\n  };\n\n  const formatDate = (dateStr: string) => {\n    return new Date(dateStr).toLocaleDateString(\'en-US\', {\n      month: \'short\',\n      day: \'numeric\',\n      year: \'numeric\',\n    });\n  };\n\n  if (authLoading) {\n    return (\n      <div className="min-h-screen bg-background">\n        <Header />\n        <div className="flex items-center justify-center py-20">\n          <Loader2 className="h-8 w-8 animate-spin text-primary" />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className="min-h-screen bg-background">\n      <Header />\n      \n      <main className="container mx-auto px-4 py-12">\n        <div className="max-w-4xl mx-auto">\n          {/* Header */}\n          <div className="flex items-center justify-between mb-8">\n            <div className="flex items-center gap-4">\n              <Button\n                variant="ghost"\n                size="sm"\n                onClick={() => navigate(\'/\')}\n              >\n                <ArrowLeft className="h-4 w-4 mr-2" />\n                Return\n              </Button>\n              <div>\n                <h1 className="text-2xl md:text-3xl font-display font-bold flex items-center gap-3">\n                  <Palette className="h-7 w-7 text-primary" />\n                  My Palettes\n                </h1>\n                <p className="text-muted-foreground text-sm mt-1 font-serif">\n                  Your saved color palettes\n                </p>\n              </div>\n            </div>\n          </div>\n\n          {/* Palettes Grid */}\n          {isLoading ? (\n            <div className="flex items-center justify-center py-20">\n              <Loader2 className="h-8 w-8 animate-spin text-primary" />\n            </div>\n          ) : palettes.length === 0 ? (\n            <div className="text-center py-20 space-y-4">\n              <div className="w-20 h-20 rounded-full bg-muted flex items-center justify-center mx-auto">\n                <Palette className="h-10 w-10 text-muted-foreground" />\n              </div>\n              <h2 className="text-xl font-display font-semibold">No palettes yet</h2>\n              <p className="text-muted-foreground font-serif max-w-md mx-auto">\n                Create a custom palette on the home page and save it to see it here.\n              </p>\n              <Button onClick={() => navigate(\'/\')} className="mt-4">\n                Create Your First Palette\n              </Button>\n            </div>\n          ) : (\n            <div className="grid gap-4 md:grid-cols-2">\n              {palettes.map((palette) => (\n                <div\n                  key={palette.id}\n                  className="p-5 rounded-lg border border-border/50 bg-card hover:border-primary/30 transition-all duration-300 group"\n                >\n                  {/* Palette name and date */}\n                  <div className="flex items-start justify-between mb-4">\n                    <div>\n                      <h3 className="font-display font-semibold text-lg flex items-center gap-2">\n                        {palette.name}\n                        {palette.is_public ? (\n                          <Globe className="h-4 w-4 text-primary" />\n                        ) : (\n                          <Lock className="h-4 w-4 text-muted-foreground" />\n                        )}\n                      </h3>\n                      <p className="text-xs text-muted-foreground flex items-center gap-1 mt-1">\n                        <Calendar className="h-3 w-3" />\n                        {formatDate(palette.created_at)}\n                      </p>\n                    </div>\n                    \n                    {/* Public toggle */}\n                    <div className="flex items-center gap-2">\n                      <span className="text-xs text-muted-foreground">\n                        {palette.is_public ? \'Public\' : \'Private\'}\n                      </span>\n                      <Switch\n                        checked={palette.is_public}\n                        onCheckedChange={() => handleTogglePublic(palette.id, palette.is_public)}\n                      />\n                    </div>\n                  </div>\n\n                  {/* Color swatches */}\n                  <div className="space-y-2 mb-4">\n                    <div className="flex items-center gap-1">\n                      <span className="text-[10px] text-muted-foreground w-10">White</span>\n                      <div className="flex gap-1">\n                        {pieces.map((piece) => (\n                          <div\n                            key={`w-${piece}`}\n                            className="w-7 h-7 rounded-sm shadow-sm ring-1 ring-black/10"\n                            style={{ backgroundColor: palette.white_colors[piece] }}\n                            title={`White ${piece.toUpperCase()}`}\n                          />\n                        ))}\n                      </div>\n                    </div>\n                    <div className="flex items-center gap-1">\n                      <span className="text-[10px] text-muted-foreground w-10">Black</span>\n                      <div className="flex gap-1">\n                        {pieces.map((piece) => (\n                          <div\n                            key={`b-${piece}`}\n                            className="w-7 h-7 rounded-sm shadow-sm ring-1 ring-black/10"\n                            style={{ backgroundColor: palette.black_colors[piece] }}\n                            title={`Black ${piece.toUpperCase()}`}\n                          />\n                        ))}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Actions */}\n                  <div className="flex items-center gap-2 pt-3 border-t border-border/50">\n                    <Button\n                      size="sm"\n                      onClick={() => handleLoadPalette(palette)}\n                      className="flex-1 gap-2"\n                    >\n                      <PlayCircle className="h-4 w-4" />\n                      Load & Use\n                    </Button>\n                    <Button\n                      size="sm"\n                      variant="outline"\n                      onClick={() => setDeleteId(palette.id)}\n                      className="text-destructive hover:text-destructive hover:bg-destructive/10"\n                    >\n                      <Trash2 className="h-4 w-4" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </main>\n\n      {/* Delete Confirmation Dialog */}\n      <AlertDialog open={!!deleteId} onOpenChange={() => setDeleteId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Palette</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete this palette? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel disabled={isDeleting}>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleDeletePalette}\n              disabled={isDeleting}\n              className="bg-destructive hover:bg-destructive/90"\n            >\n              {isDeleting ? (\n                <Loader2 className="h-4 w-4 animate-spin" />\n              ) : (\n                \'Delete\'\n              )}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n};\n\nexport default MyPalettes;\n';export{e as default};
