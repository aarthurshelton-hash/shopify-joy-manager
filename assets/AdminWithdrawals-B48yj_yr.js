import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b7 as o,B as l,A as d,cb as u,cR as x,a8 as m,D as h,aB as p,aC as f,aD as j,aE as w,p as v,t as y,w as g,dy as C,dt as N,bo as b,dq as z,cZ as q,a1 as D,a2 as L,a3 as M,a4 as B,a5 as _,aW as A,bC as S,dz as I,b as W,y as k}from"./index-ckGSTu6A.js";import{C as U}from"./calendar-cLD8asKf.js";!function(){const e=V,t=Y();for(;;)try{if(584955===parseInt(e(171))/1*(-parseInt(e(208))/2)+parseInt(e(155))/3+-parseInt(e(153))/4*(-parseInt(e(152))/5)+-parseInt(e(121))/6*(parseInt(e(124))/7)+-parseInt(e(211))/8+parseInt(e(191))/9+-parseInt(e(218))/10*(parseInt(e(187))/11))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const H=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[V(172)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=V;return H[e(144)]().search("(((.+)+)+)+$")[e(144)]().constructor(H).search("(((.+)+)+)+$")});H();const R=function(){const e=V,t={};t[e(212)]=function(e,t){return e!==t},t[e(130)]="mLkcq",t[e(215)]="status";const s=t;let n=!0;return function(t,r){const a=e,c={};c[a(203)]=s[a(215)];const i=c,o=n?function(){const e=a;if(s[e(212)](s.MTjec,e(217))){if(r){const s=r[e(172)](t,arguments);return r=null,s}}else _0x4c8600=_0x2ad2bd.eq(i[e(203)],_0x4cf3ba)}:function(){};return n=!1,o}}();function Y(){const e=["Cwj0D0S","B3rHBf93AxrOza","z2v0vxnLCG","EuPvwgS","yxbWCM92zwrFyW","vgzktxy","nJKWBfrNANrY","D2fYBG","zNvUy3rPB25Z","zgf0yq","x3jLCxvLC3rZ","zeLztfG","CwLuDhG","zNjVBq","CMvXDwLYzwq","B0TouLi","Cgf5B3v0x2rLDa","rMjVrg0","BMjkshi","C3rHDhvZ","yw1VDw50x2nLBG","Dg90ywXFzwfYBG","CM4GDgHPCYiPka","nJK2q0LnB2Tf","qKHdzuy","y3rVCIGICMv0Dq","ndC1ntHnEKvYt1K","cI0TlqO","yxnJzw5KAw5N","CMv0DxjUicHMDq","ywLSCW","yxrLigvYCM9YoG","tvrQzwm","CMvQzwn0zwq","zgLZCgXHEv9Uyq","CgvUzgLUz19HBq","qwX5uwq","ruHAA3y","C3vJy2vZCW","B3rHBf9LyxjUzq","y29UC3rYDwn0BW","tM90igf1DgHLBG","DxnLCL9Pza","B1DRzNq","y3jLyxrLzf9HDa","vhnKtMG","Dg9tDhjPBMC","vML0CMO","C25xtLe","A0nruLu","Dw50","B3vUDa","zxjYB3i","yMr6A0W","mJaWnJviBKLhq3e","oti0weXxs1z5","CgvUzgLUzW","mZmYodmYnKzAv0nfCa","BMn0Aw9UkcKG","ywXS","zM9YrwfJAa","rNn1txy","yM9KEq","ChjVzMLSzxm","yu5XtNK","z2v0","BvzqD2e","CgvUzgLUz19JBW","C2LUz2XL","y2jcBvu","z0jiz0G","zMrgvLq","DgLJyxrLza","oda0otu5uwzmru5L","yxbWBhK","C3Hqv2W","y29TCgXLDgvKxW","uLbztMq","zhjHD25Fy2vUDa","yxv0Aa","v2fSBgv0ihvWza","yMLUza","Bw91BNq","x19WCM90B19F","zxHJzxb0Aw9U","DgHKCMf3ywW","uMvQzwn0Aw9Uia","zwrFy2vUDhm","AxnWBgf5x25HBq","nZy3mtrPtLDuDfe","C2vSzwn0","Dg90ywW","DhvZ","nJa2mZmWou5xChLwDa","CMvHC29UigLZia","C3rHDhvZlcbHBq","CMvQzwn0zwrFyW","DxnLCL9PzcWGDa","DxbKyxrL","y29UC29Szq","vw5RBM93BIbvCW","DxnLCL93ywXSzq","BwfW","uMvXDwvZDcbUBW","ig5VDcbPBIbHCa","r0XgCxi","yxbWCM92zwrFyq","D2L0AgrYyxDHBa","yxbWCM92zwq","Aw5MBW","mK5irevovW","tvDrvLu","Bg9N","nda3mZC2AuLwEvjQ"];return(Y=function(){return e})()}async function K(t){const s=V,n={};n.mPXdm=s(157),n[s(135)]=s(117),n[s(141)]="user_id, d"+s(186)+"e",n[s(168)]=s(140);const r=n;try{const n={};n[s(126)]=!1;let a=e[s(225)](s(205)+s(222))[s(188)]("*").order(s(142),n);t&&t!==r.mPXdm&&(a=a.eq(r[s(135)],t));const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[])[s(200)](e=>e[s(140)]))],{data:l}=await e[s(225)](s(161)).select(r[s(141)]).in(s(140),o),{data:d}=await e[s(225)](s(199)+"ts").select(s(195)+s(137)+"d_cents, t"+s(213)+"rawn_cents").in(r[s(168)],o),u=new Map((null==l?void 0:l.map(e=>[e.user_id,e]))||[]),x=new Map((null==d?void 0:d[s(200)](e=>[e.user_id,e]))||[]),m=(c||[]).map(e=>{var t,n,r;return{...e,payout_details:e[s(228)+s(128)],user_display_name:(null==(t=u.get(e[s(140)]))?void 0:t[s(132)+"me"])||s(198)+"er",wallet_total_earned:(null==(n=x[s(163)](e[s(140)]))?void 0:n[s(119)+s(185)])||0,wallet_total_withdrawn:(null==(r=x[s(163)](e[s(140)]))?void 0:r["total_with"+s(176)+"s"])||0}}),h={};return h[s(221)]=m,h.error=null,h}catch(a){const e={};return e[s(221)]=[],e[s(150)]=a,e}}function V(e,t){e-=117;const s=Y();let n=s[e];if(void 0===V.EMficq){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};V.EDtuNk=r,V.IpTzCT={},V.EMficq=!0}const a=e+s[0],c=V.IpTzCT[a];if(c)n=c;else{const e=function(e){this.QUjoKO=e,this.MckejV=[1,0,0],this.nCwxND=function(){return"newState"},this.ISXCDk="\\w+ *\\(\\) *{\\w+ *",this.xkfSCW="['|\"].+['|\"];? *}"};e.prototype.jNeDEU=function(){const e=new RegExp(this.ISXCDk+this.xkfSCW).test(this.nCwxND.toString())?--this.MckejV[1]:--this.MckejV[0];return this.dzblpl(e)},e.prototype.dzblpl=function(e){return Boolean(~e)?this.yXldIz(this.QUjoKO):e},e.prototype.yXldIz=function(e){for(let t=0,s=this.MckejV.length;t<s;t++)this.MckejV.push(Math.round(Math.random())),s=this.MckejV.length;return e(this.MckejV[0])},new e(V).jNeDEU(),n=V.EDtuNk(n),V.IpTzCT[a]=n}return n}async function X(){const t=V,s={};s[t(145)]="pending",s[t(175)]=t(206),s[t(230)]=t(131),s[t(209)]=t(193)+"ount_cents";const n=s;try{const{data:s,error:r}=await e[t(225)](t(205)+"_requests")[t(188)](n.MWQVU);if(r)throw r;const a={};a["pending_co"+t(148)]=0,a[t(133)+t(149)]=0,a[t(216)+"ount"]=0,a[t(204)+"mount"]=0,a[t(174)+t(189)]=0,a[t(194)+"ount"]=0;const c=a;(s||[])[t(158)](e=>{const s=t;switch(e[s(117)]){case n[s(145)]:c[s(165)+"unt"]++,c.pending_amount+=e.amount_cents;break;case n[s(175)]:c.approved_count++,c[s(204)+s(180)]+=e[s(118)+"ts"];break;case"completed":c[s(174)+s(189)]+=e[s(118)+"ts"];break;case n.nbJHr:c[s(194)+"ount"]++}});const i={};return i[t(221)]=c,i[t(150)]=null,i}catch(r){const e={};return e[t(221)]=null,e[t(150)]=r,e}}function P(e,t){e-=171;const s=G();let n=s[e];if(void 0===P.xINyxm){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};P.VTXqSn=r,P.oMzaps={},P.xINyxm=!0}const a=e+s[0],c=P.oMzaps[a];if(c)n=c;else{const e=function(e){this.xJmqhT=e,this.CRYxzj=[1,0,0],this.ALVDps=function(){return"newState"},this.QKYFro="\\w+ *\\(\\) *{\\w+ *",this.wlRSou="['|\"].+['|\"];? *}"};e.prototype.AlHqZU=function(){const e=new RegExp(this.QKYFro+this.wlRSou).test(this.ALVDps.toString())?--this.CRYxzj[1]:--this.CRYxzj[0];return this.jCUoVq(e)},e.prototype.jCUoVq=function(e){return Boolean(~e)?this.eusIAb(this.xJmqhT):e},e.prototype.eusIAb=function(e){for(let t=0,s=this.CRYxzj.length;t<s;t++)this.CRYxzj.push(Math.round(Math.random())),s=this.CRYxzj.length;return e(this.CRYxzj[0])},new e(P).AlHqZU(),n=P.VTXqSn(n),P.oMzaps[a]=n}return n}R(void 0,function(){const e=V,t={gmyXP:function(e,t){return e+t},mVPwa:e(127)+e(156),oKNRR:function(e,t){return e===t},Ldjbc:e(224),aNqNy:function(e){return e()},sxPWl:e(182),snWNQ:"trace"},s=t[e(162)](function(){const s=e;let n;try{n=Function(t.gmyXP(t[s(164)]+"{}.constru"+s(123)+s(120)+" )",");"))()}catch(r){if(!t[s(227)](t.Ldjbc,"qiTtx"))throw new _0x1675a4(s(201)+"t found or"+s(202)+"proved sta"+s(190));n=window}return n}),n=s[e(197)]=s[e(197)]||{},r=[e(210),e(219),e(207),e(150),t[e(173)],"table",t[e(146)]];for(let a=0;a<r.length;a++){const t=R[e(138)+"r"].prototype.bind(R),s=r[a],c=n[s]||t;t[e(181)]=R.bind(R),t.toString=c[e(144)][e(179)](c),n[s]=t}})(),function(){const e=P,t=G();for(;;)try{if(645485===-parseInt(e(226))/1*(-parseInt(e(242))/2)+parseInt(e(241))/3*(-parseInt(e(237))/4)+parseInt(e(239))/5+-parseInt(e(214))/6*(-parseInt(e(222))/7)+parseInt(e(191))/8*(-parseInt(e(211))/9)+parseInt(e(179))/10*(-parseInt(e(220))/11)+parseInt(e(228))/12*(parseInt(e(210))/13))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const E=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=P,t={};t[e(221)]=e(193)+"+$";const s=t;return E[e(229)]().search(s[e(221)])[e(229)]()[e(195)+"r"](E)[e(185)](s[e(221)])});E();const Z=function(){const e={piXkt:function(e,t){return e+t},XQxfm:function(e){return e()}};let t=!0;return function(s,n){const r=P,a={ofxSW:function(t,s){return e[P(235)](t,s)},ZEvmR:r(194)+"nction() ",EsycB:function(t){return e[r(205)](t)}},c=t?function(){const e=r,t={DpJEI:function(e,t){return a[P(244)](e,t)},faIfh:a[e(182)],iHZVw:e(213)+e(232)+e(212)+" )",sErnS:function(t){return a[e(176)](t)}};if(n){if("iSfav"!==e(236)){const t=n[e(219)](s,arguments);return n=null,t}{const s=_0x1555a7(t[e(188)](t[e(192)]+t.iHZVw,");"));_0x377dfb=t[e(201)](s)}}}:function(){};return t=!1,c}}();function G(){const e=["mZCYmda5mhrbz01vCG","qxvUAxG","m3LRs3btAW","nZHgy0vUAhe","Bg9N","B2z4u1C","z2v0x29Yx2nYzq","B0XRDeu","DgLJyxrLza","C2fSzq","tM90igf1DgHLBG","rxn5y0i","y29UC29Szq","C3vJy2vZCW","mtb1DgPIEgS","Cf9IDxLLCL9Pza","z1j0qK4","wKv2Bvi","zNjVBq","C2vSzwn0","C2vHCMnO","Cf9ZywXLx3bYAq","uur4ENq","rhbkruK","B3jKzxi","ChjVy2vZC19Tyq","oentzxDSra","zMfjzMG","kcGOlISPkYKRkq","CMv0DxjUicHMDq","y29UC3rYDwn0BW","DhjHy2u","yxnJzw5KAw5N","BNnHy3rPB25Z","CMTLDhbSywnLxW","yxv0Aa","C0vYBLm","yxrLx3DHBgXLDa","yMLUza","DgfIBgu","wff4zM0","vKjMzhm","BgvUz3rO","tffpsu8","y3jLyxrLzf9HDa","mta0se1hswXZ","mta4mduXmZL1swrqrhy","CM4GDgHPCYiPka","E30Uy29UC3rYDq","nMLNvwn5rq","y2vFy2vUDhm","ywv6vwm","rwXUAva","z2v0vxnLCG","yxbWBhK","otq5mJK2n0XTAwPbzG","yNvJzxe","nZu3ndqYn05HAgj2Aq","x19WCM90B19F","Cf91C2vYx2LK","D2fSBgv0x3rYyq","mty4mZnWtKz4qwO","ChjVDg90ExbL","ntGXote2yKzhDKXY","Dg9tDhjPBMC","Dg9gAxHLza","zxjYB3i","y3rVCIGICMv0Dq","Cf9SAxn0Aw5NxW","DNfQr3O","CgLyA3q","DgzsyMK","nJq1odi4AgLytvPu","zgf0yq"];return(G=function(){return e})()}function T(e){const t=P,s={};s[t(240)]=function(e,t){return e/t};return"$"+s[t(240)](e,100)[t(230)](2)}function J(){var H,R;const{user:Y}=t(),P=s(),[E,Z]=n.useState(!1),[G,J]=n.useState(!0),[O,Q]=n.useState([]),[F,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{oe()},[Y]);const oe=async()=>{if(!Y)return void J(!1);const{data:t}=await e.rpc("has_role",{_user_id:Y.id,_role:"admin"});!0===t&&(Z(!0),await le()),J(!1)},le=async()=>{const[e,t]=await Promise.all([K(ee),X()]);e.data&&Q(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(k,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(k,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(k,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(k,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(k,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(k,{variant:"outline",children:e})}};return G?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):Y&&E?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(l,{variant:"ghost",size:"icon",onClick:()=>P(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),F&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:F.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:T(F.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:F.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:T(F.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:T(F.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:F.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),le()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(j,{value:"pending",children:"Pending"}),r.jsx(j,{value:"approved",children:"Approved"}),r.jsx(j,{value:"completed",children:"Completed"}),r.jsx(j,{value:"rejected",children:"Rejected"}),r.jsx(j,{value:"all",children:"All"})]}),r.jsx(w,{value:ee,children:r.jsxs(c,{children:[r.jsxs(v,{children:[r.jsx(y,{children:"Withdrawal Requests"}),r.jsxs(g,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===O.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(C,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(N,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:O.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(b,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(z,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(U,{className:"h-3 w-3"}),q(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",T(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:T(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(l,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(D,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(L,{children:[r.jsxs(M,{children:[r.jsxs(B,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(_,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(H=se.request.payout_details)?void 0:H.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:T(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(A,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(S,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(R=se.request.payout_details)?void 0:R.email})]})]})]}),r.jsxs(I,{children:[r.jsx(l,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=V,r={};r[n(147)]=function(e,t){return e||t},r.FboDm=n(117),r.VUVNL=n(154);const a=r;try{const{data:{user:r}}=await e[n(177)][n(214)]();if(!r)throw new Error(n(139)+n(170));const{error:c}=await e[n(225)](n(205)+n(222))[n(196)]({status:n(206),admin_notes:a[n(147)](s,null),reviewed_by:r.id,reviewed_at:(new Date).toISOString()}).eq("id",t).eq(a[n(229)],a.VUVNL);if(c)throw c;const i={};return i[n(136)]=!0,i[n(150)]=null,i}catch(c){const e={};return e[n(136)]=!1,e[n(150)]=c,e}}(se.request.id,re),t.success&&W.success("Withdrawal approved");break;case"reject":if(!re.trim())return W.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=V,r={};r[n(122)]=n(184)+n(192)+n(226),r[n(169)]=n(205)+n(222),r.ZhwCm=n(131),r.fQMbd=n(117),r.bdzkL="pending";const a=r;try{const{data:{user:r}}=await e[n(177)][n(214)]();if(!r)throw new Error(n(139)+n(170));if(!s)throw new Error(a[n(122)]);const{error:c}=await e[n(225)](a[n(169)]).update({status:a.ZhwCm,admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date).toISOString()}).eq("id",t).eq(a.fQMbd,a[n(151)]);if(c)throw c;return{success:!0,error:null}}catch(c){const e={};return e[n(136)]=!1,e[n(150)]=c,e}}(se.request.id,re),t.success&&W.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=V,r={};r[n(143)]=n(205)+n(222),r[n(167)]=function(e,t){return e||t},r[n(134)]="completed",r[n(223)]="process-wi"+n(183),r[n(159)]=n(178)+n(129);const a=r;try{const{data:{user:r}}=await e[n(177)].getUser();if(!r)throw new Error(n(139)+n(170));const{data:c,error:i}=await e[n(225)](a.TsdNh)[n(188)]("*").eq("id",t).eq(n(117),n(206))[n(166)]();if(a[n(167)](i,!c))throw new Error(n(201)+"t found or"+n(202)+"proved sta"+n(190));const{error:o}=await e.from(a.TsdNh)[n(196)]({status:a[n(134)],admin_notes:s?(c.admin_notes||"")+n(125)+s:c.admin_notes,completed_at:(new Date).toISOString()}).eq("id",t);if(o)throw o;const l={};l.request_id=t,l[n(140)]=c[n(140)],l[n(118)+"ts"]=c[n(118)+"ts"];const d={};d[n(160)]=l;const{error:u}=await e[n(220)].invoke(a.dIYLX,d),x={};return x[n(136)]=!0,x[n(150)]=null,x}catch(c){const e={};return e[n(136)]=!1,e[n(150)]=c,e}}(se.request.id,re),t.success&&W.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?W.error(t.error.message):(ne({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(l,{onClick:()=>P("/"),children:"Go Home"})]})})})}Z(void 0,function(){const e=P,t={LQOIO:e(187),gRtBN:function(e,t){return e(t)},ovNqq:e(194)+"nction() ",csGzS:e(243),VBfds:"exception",Eyxyl:e(204),fkRQC:e(196)};let s;try{if(t[e(208)]!==e(187)){const t={data:[]};return t[e(231)]=_0x4dc79d,t}s=t[e(181)](Function,t.ovNqq+(e(213)+e(232)+e(212)+" ));"))()}catch(a){s=window}const n=s[e(177)]=s[e(177)]||{},r=[t.csGzS,"warn","info",e(231),t[e(206)],t.Eyxyl,t.fkRQC];for(let c=0;c<r[e(207)];c++){const t=Z[e(195)+"r"][e(227)][e(203)](Z),s=r[c],a=n[s]||t;t[e(223)]=Z.bind(Z),t[e(229)]=a.toString.bind(a),n[s]=t}})();export{J as default};
