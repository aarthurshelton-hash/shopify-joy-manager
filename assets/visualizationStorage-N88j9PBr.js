import{s as t,ca as n,dG as r,dH as e}from"./index-D4HOopRf.js";import{v as o,a,b as i}from"./visualizationSchemas-D_UKKBqh.js";import"./flagContent-aydX2Xjk.js";!function(){const t=w,n=x();for(;;)try{if(266818===-parseInt(t(217))/1+parseInt(t(207))/2+-parseInt(t(247))/3*(parseInt(t(239))/4)+parseInt(t(249))/5+-parseInt(t(201))/6*(-parseInt(t(307))/7)+parseInt(t(289))/8*(parseInt(t(206))/9)+-parseInt(t(266))/10*(-parseInt(t(238))/11))break;n.push(n.shift())}catch(r){n.push(n.shift())}}();const s=function(){let t=!0;return function(n,r){const e=w,o={};o[e(342)]=e(325),o[e(256)]=e(378);const a=o,i=t?function(){const t=e;if(a[t(342)]===a[t(256)]){const n=_0x246e02[t(224)](t=>"custom"===t.id);if(n){const r={};r[t(323)]=n[t(323)],r.black=n[t(184)],_0x3fac8d=r}}else if(r){const e=r[t(261)](n,arguments);return r=null,e}}:function(){};return t=!1,i}}()(void 0,function(){const t=w,n={};n[t(302)]=t(326)+"+$";const r=n;return s.toString()[t(379)](r[t(302)])[t(225)]()[t(305)+"r"](s)[t(379)](t(326)+"+$")});s();const c=function(){let t=!0;return function(n,r){const e=t?function(){if(r){const t=r[w(261)](n,arguments);return r=null,t}}:function(){};return t=!1,e}}();function u(t,n,r){const e=w,o={};o[e(375)]=e(229),o[e(333)]=function(t,n){return t===n};const a=o;return(t||n[e(313)]||"")[e(185)]()[e(280)](/\s+/g," ")+"::"+(r?JSON[e(279)]({palette:r[e(314)]||a[e(375)],darkMode:r[e(250)]||!1,currentMove:a[e(333)](r.currentMove,1/0)?"all":r[e(255)+"e"],lockedPieces:(r[e(199)+"es"]||[])[e(223)]((t,n)=>(t[e(263)]+"-"+t[e(228)])[e(262)+e(285)](n[e(263)]+"-"+n.pieceType))}):"{}")}async function f(o,a,i,s){const c=w,f={psPTY:c(229),rpXSh:function(t,n){return t===n},sgGtZ:c(350)+c(320)+c(301)+"ontent",dDhlO:function(t,n){return t===n},jQqam:"YEhxl",toOgs:function(t,n,r,e){return t(n,r,e)},hlruy:"saved_visu"+c(354),PhRAl:c(338)+c(273)+c(334),EsYmO:function(t,n){return t===n},InDsz:c(196),QiZnA:c(284),CaAoo:"Another collector",SWUxL:c(299),TNNhQ:c(212),XWfnu:function(t,n){return t!==n}};try{if(f[c(359)](f[c(297)],"IrXBM"))throw new _0x5295ba(c(192)+c(267)+c(354)+": "+_0x19c403.message);{const l=f.toOgs(u,a,i,s),{data:w,error:g}=await t.from(f[c(234)])[c(227)](c(281)+c(360)+c(235));if(g){const t={};return t[c(366)+"e"]=!1,t.isTooSimilar=!1,t}for(const n of w||[]){const r=n[c(214)];if(l===u(n[c(313)]||void 0,r,r[c(270)+c(340)])){const r=f[c(276)](n[c(284)],o);let e;if(!r){const{data:r}=await t[c(213)](f[c(336)])[c(227)]("display_name").eq(f.QiZnA,n.user_id)[c(294)]();e=(null==r?void 0:r.display_name)||f[c(209)]}const a={};return a[c(366)+"e"]=!0,a.isTooSimilar=!0,a[c(332)]=n.id,a[c(339)+"rentUser"]=r,a[c(202)+c(253)]=e,a["colorSimil"+c(364)]=100,a.reason=c(220)+c(219)+"ts",a}}const x=(null==s?void 0:s[c(314)])||c(229);let y;if(null==s?void 0:s[c(300)+"rs"])if(f[c(205)]===c(321)){const t={};t[c(323)]=_0x369adc[c(323)],t[c(184)]=_0x24e23c[c(184)],_0x142f89=t}else y=s[c(300)+"rs"];else if(x===f[c(194)]){const t=n.find(t=>"custom"===t.id);if(t){if(!f[c(293)](c(369),c(358))){const t=(_0xa4b7f||_0x3d3aaf.pgn||"")[c(185)]()[c(280)](/\s+/g," ");return t+"::"+(_0x474a95?_0x5b5003.stringify({palette:_0x4f9ea8.paletteId||f.psPTY,darkMode:_0x5d6f50[c(250)]||!1,currentMove:f[c(322)](_0x210404.currentMove,_0x70d51e)?c(264):_0x5acd6d.currentMove,lockedPieces:(_0x37a61e[c(199)+"es"]||[])[c(223)]((t,n)=>(t[c(263)]+"-"+t[c(228)])[c(262)+c(285)](n[c(263)]+"-"+n.pieceType))}):"{}")}{const n={};n[c(323)]=t.white,n[c(184)]=t[c(184)],y=n}}}const C=await r(o,a,i,x,y);if(C[c(343)+"ar"]){const t={};return t[c(366)+"e"]=!1,t[c(343)+"ar"]=!0,t[c(332)]=C[c(311)+c(183)+"nId"],t[c(339)+c(187)]=C.ownedByCurrentUser,t[c(202)+c(253)]=C[c(202)+c(253)],t[c(277)+c(364)]=C.colorSimilarity,t[c(370)]=C[c(370)],t["existingCo"+c(318)]=C[c(218)+c(318)],t.isIntrinsicPalette=C["isIntrinsi"+c(260)],t[c(268)+c(341)]=C[c(268)+c(341)],t[c(211)+c(348)]=C.matchedGameCard,t[c(316)+c(231)]=C[c(316)+c(231)],t[c(316)+"etteSimila"+c(287)]=C.matchedPaletteSimilarity,t}let d;if(y){if(c(274)!=c(274))return{data:null,error:new _0x420a76(_0x5f042d[c(370)]||f[c(244)])};d=e(y)||void 0}const z={};return z[c(366)+"e"]=!1,z[c(343)+"ar"]=!1,z[c(362)+"tteId"]=d,z[c(277)+c(364)]=C[c(277)+c(364)],z[c(268)+c(260)]=C[c(268)+"cPalette"],z[c(268)+c(341)]=C[c(268)+c(341)],z[c(211)+"eCard"]=C["matchedGam"+c(348)],z["matchedPal"+c(231)]=C[c(316)+c(231)],z[c(316)+c(319)+c(287)]=C[c(316)+c(319)+"rity"],z}}catch(l){const t={isDuplicate:!1};return t[c(343)+"ar"]=!1,t}}async function l(n,r,e,s,c,u){const l=w,g={};g[l(248)]=function(t,n){return t===n},g.JhOgt=l(236)+l(353),g.isDhl="This visua"+l(208)+"s already "+l(222)+l(310),g[l(345)]="another collector",g[l(241)]="saved_visu"+l(354),g.NoNnS=function(t,n){return t||n},g.cfAOD="visualizat"+l(193);const x=g;try{const w=o(r);if(!w[l(259)])return x[l(248)](l(278),l(282))?_0x4c1942[l(225)]().search(l(326)+"+$")[l(225)]()[l(305)+"r"](_0x1d3c54).search(l(326)+"+$"):{data:null,error:new Error(w[l(347)]||x[l(309)])};const g=await a(r);if(!g[l(374)])return{data:null,error:new Error(g[l(370)]||l(350)+l(320)+l(301)+l(292))};const y=i(c);if(!y[l(259)])return{data:null,error:new Error(y.error||l(203)+"N data")};const C=await f(n,c,e[l(251)],u);if(C[l(366)+"e"]){const t=C[l(339)+l(187)]?x[l(252)]:l(190)+l(208)+l(312)+" "+(C["ownerDispl"+l(253)]||x[l(345)]);return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:C[l(339)+l(187)],ownerDisplayName:C.ownerDisplayName,colorSimilarity:100}}if(C[l(343)+"ar"]){const t=C["ownedByCur"+l(187)]?"You have a"+l(377)+l(372)+"ization - "+l(242)+"ng at leas"+l(269)+" for uniqueness":"This is "+Math.round(C[l(277)+l(364)]||30)+(l(298)+l(265)+l(363))+(C[l(202)+l(253)]||"another co"+l(373));return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:C[l(339)+"rentUser"],ownerDisplayName:C[l(202)+l(253)],colorSimilarity:C[l(277)+l(364)],reason:C[l(370)]}}const d={...u};d[l(362)+l(304)]=C[l(362)+l(304)];const z=d,D=n+"/"+Date.now()+"-"+r[l(280)](/[^a-z0-9]/gi,"-").toLowerCase()+".png",v={};v[l(216)+"e"]="image/png",v.upsert=!1;const{error:B}=await t.storage[l(213)](l(270)+l(193))[l(258)](D,s,v);if(B)throw new Error(l(192)+l(246)+l(330)+B[l(286)]);const{data:h}=t[l(204)][l(213)](l(270)+l(193))[l(327)+"rl"](D),L={};L[l(323)]=e[l(251)][l(323)],L.black=e[l(251)][l(184)],L.event=e.gameData[l(351)],L[l(296)]=e[l(251)][l(296)],L[l(346)]=e.gameData[l(346)],L.pgn=e[l(251)][l(313)],L.moves=e.gameData[l(257)],L[l(355)]=e[l(355)],L[l(189)]=e.totalMoves,L[l(270)+l(340)]=z;const m=L,{data:M,error:q}=await t.from(x[l(241)])[l(283)]({user_id:n,title:r,pgn:x[l(221)](c,null),game_data:m,image_path:h.publicUrl})[l(227)]()[l(294)]();if(q)throw await t[l(204)][l(213)](x[l(356)])[l(243)]([D]),new Error("Failed to save visua"+l(188)+q.message);const A={};return A[l(317)]=M,A[l(347)]=null,A}catch(y){const t={};return t[l(317)]=null,t.error=y,t}}function w(t,n){t-=179;const r=x();let e=r[t];if(void 0===w.IvBBtf){var o=function(t){let n="",r="",e=n+o;for(let o,a,i=0,s=0;a=t.charAt(s++);~a&&(o=i%4?64*o+a:a,i++%4)?n+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&o>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let o=0,a=n.length;o<a;o++)r+="%"+("00"+n.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(r)};w.QdpyTR=o,w.AxlXlI={},w.IvBBtf=!0}const a=t+r[0],i=w.AxlXlI[a];if(i)e=i;else{const t=function(t){this.PJQXSq=t,this.ktbgXZ=[1,0,0],this.exKAOn=function(){return"newState"},this.khsdHE="\\w+ *\\(\\) *{\\w+ *",this.aLKdbe="['|\"].+['|\"];? *}"};t.prototype.xUmcGa=function(){const t=new RegExp(this.khsdHE+this.aLKdbe).test(this.exKAOn.toString())?--this.ktbgXZ[1]:--this.ktbgXZ[0];return this.OFpmCw(t)},t.prototype.OFpmCw=function(t){return Boolean(~t)?this.mtcyHi(this.PJQXSq):t},t.prototype.mtcyHi=function(t){for(let n=0,r=this.ktbgXZ.length;n<r;n++)this.ktbgXZ.push(Math.round(Math.random())),r=this.ktbgXZ.length;return t(this.ktbgXZ[0])},new t(w).xUmcGa(),e=w.QdpyTR(e),w.AxlXlI[a]=e}return e}async function g(n){const r=w;try{const e={ascending:!1},{data:o,error:a}=await t[r(213)]("saved_visu"+r(354))[r(227)]("*").eq(r(284),n).order(r(186),e);if(a)throw new Error("Failed to "+r(267)+r(354)+": "+a[r(286)]);const i={};return i[r(317)]=o||[],i.error=null,i}catch(e){const t={};return t[r(317)]=[],t[r(347)]=e,t}}function x(){const t=["rxHHy3qGzhvWBa","tM9oBLm","Aw4GEw91CIbNyq","C29YDa","zMLUza","Dg9tDhjPBMC","DwfSAxPHDgLVBG","C2vSzwn0","CgLLy2vuExbL","Bw9KzxjU","C2f2zwrFDMLZDq","zxr0zuLK","Aw9Uig5VDcbMBW","Ce9xyxu","AgXYDxK","BwvFzgf0yq","sw52ywXPzcb0Aq","zMLUzeLUzgv4","mtfbuvfqu3y","nhbTqNvMzq","v0Xbzu8","t0PVCem","Dhj5ignOyw5NAq","CMvTB3zL","C2DhDfO","vMnPu1m","DxbSB2fKigLTyq","ndG1otmXEMPsBKH0","DgXhEum","ndC0ntmWC1n4vhzM","zgfYA01Vzgu","z2fTzurHDge","AxneAgW","yxLoyw1L","zxHJzxb0Aw9U","y3vYCMvUDe1VDG","uKzosLO","Bw92zxm","DxbSB2fK","C3vJy2vZCW","y1bHBgv0Dgu","yxbWBhK","Bg9JywXLq29TCa","CgLLy2vdB2XVCG","ywXS","Dg8Gysb2AxnPBW","mti3mdmWv2XNs095","zMv0y2GGDMLZDq","AxnjBNrYAw5ZAq","Dca4ignVBg9YCW","DMLZDwfSAxPHDa","DgfIBgu","Aw5MBW","A2LUzYbKDxbSAq","CLPsqNK","AgvJAZO","rxnzBu8","y29SB3jtAw1PBa","suLfy3m","C3rYAw5NAwz5","CMvWBgfJzq","AwqSihvZzxjFAq","q3ryEuq","Aw5Zzxj0","DxnLCL9Pza","yxjL","BwvZC2fNzq","CML0Eq","y29Kzq","mJrlBgDerKS","BgTJvu8","yNDUsLi","B250zw50","wfDMBNu","C2LUz2XL","DgTqB0O","zgf0zq","ALfXyw0","jsbZAw1PBgfYia","tLr2zM8","y3vZDg9Tq29SBW","CM9WCMLHDguGyW","DNrgDxm","C2XPy2u","DhrLswq","y29UC3rYDwn0BW","q296z28","mZiYnJm3sKXhq3fw","CM4GDgHPCYiPka","sMHpz3q","BgXLCNK","zxHPC3rPBMDwAq","CYbVD25LzcbIEq","CgDU","CgfSzxr0zuLK","DxbSAwnHDguGyW","Bwf0y2HLzfbHBa","zgf0yq","Bg9YCW","zxr0zvnPBwLSyq","ywLUCYbPBMfWCa","C3zty3a","CNbyu2G","D2HPDgu","rffQvwW","qKPZD1y","kcGOlISPkYKRkq","z2v0uhvIBgLJvq","BKLK","rxjYB3iGAw4Gza","z2u6ia","BgvUz3rO","zxHPC3rPBMDjza","EKDsC3q","y2f0zxm6","BMn0Aw9UkcKG","sw5eC3O","yvbIwgS","rxjYB3iGy2HLyW","B3DUzwrcEun1CG","Aw9Uu3rHDgu","y0DHBwu","y2TAz0q","AxnuB29tAw1PBa","C1zwzgS","BKDuAwy","CMvZDwX0","zxjYB3i","zunHCMq","sgPsuKC","vgL0BguGy29UDa","zxzLBNq","Bg9N","DgXL","ywXPEMf0Aw9UCW","yM9HCMq","y2zbt0q","D21Nt3y","vMjhuwu","zerOBe8","zcWGCgDUlcbNyq","y3rVCIGICMv0Dq","BgLUA2vKugfSzq","BIbIEsa","yxjPDhK","vMLZDwfSAxPHDa","AxneDxbSAwnHDa","wLr6rwi","yMLUza","s0rRrM4","CMvHC29U","y29UC29Szq","BgfYihzPC3vHBa","BgXLy3rVCG","C2fMzq","wwLTwxq","CMv0DxjUicHMDq","ihzLCNKGC2LTAq","teTcEvO","C2vHCMnO","DhjHy2u","rw9Auey","rgfzvMK","zgvSzxrL","C3vHBgL6yxrPBW","yMXHy2S","DhjPBq","y3jLyxrLzf9HDa","CMvUDfvZzxi","BgL6yxrPB246ia","Dg90ywXnB3zLCW","vgHPCYb2Axn1yq","wfLvywS","rMfPBgvKihrVia","Aw9UCW","ve5oAfe","Cgf0Ag5HBwu","ChjVzMLSzxm","wLLwteu","zgvSzxrLihzPCW","Bg9JA2vKugLLyW","ywXPEMf0Aw9UoG","nJzsyLr2qKq","B3DUzxjeAxnWBa","sw52ywXPzcbqrW","C3rVCMfNzq","u1DvEeW","mtK3mde5tMLLz1LH","mZKYndi4uvn3veXX","BgL6yxrPB24GAq","q2fbB28","ChjVDg90ExbL","Bwf0y2HLzeDHBq","y3vZDg9T","zNjVBq","z2fTzv9KyxrH","ugHsqwW","y29UDgvUDfr5Ca","ndq3nZaYtNjKsevM","zxHPC3rPBMDdBW","AwnHDguGzxHPCW"];return(x=function(){return t})()}async function y(n,r){const e=w,o={pOWau:function(t,n){return t(n)},bwnJR:function(t,n){return t+n},tkPoJ:function(t){return t()},VciSS:e(271),aVyIz:e(179),aPbXk:"saved_visu"+e(354),HjRRG:"ZTzEb"};try{const i=new URL(r)[e(195)].split("/"),s=i[e(237)](t=>t===e(270)+e(193)),c=i[e(303)](s+1).join("/");c&&await t.storage.from(e(270)+"ions")[e(243)]([c]);const{error:u}=await t[e(213)](o[e(337)])[e(182)]().eq("id",n);if(u){if(o[e(349)]===e(367))throw new Error("Failed to "+e(198)+e(226)+": "+u[e(286)]);{let t;try{const n=xZSMGC[e(233)](_0x506246,xZSMGC[e(291)](xZSMGC[e(291)](e(376)+e(335),"{}.constru"+e(361)+e(308)+" )"),");"));t=xZSMGC[e(295)](n)}catch(a){t=_0x3f7bb9}const n=t[e(371)]=t[e(371)]||{},r=[e(352),"warn",e(272),e(347),e(254),xZSMGC[e(245)],xZSMGC.aVyIz];for(let o=0;o<r[e(331)];o++){const t=_0x5a4774.constructor[e(210)][e(368)](_0x427327),a=r[o],i=n[a]||t;t.__proto__=_0x26c940.bind(_0x20d8e9),t[e(225)]=i[e(225)].bind(i),n[a]=t}}}const f={};return f[e(347)]=null,f}catch(i){const t={};return t[e(347)]=i,t}}c(void 0,function(){const t=w,n={DQjUl:function(t,n){return t===n},ZYVLE:function(t){return t()},EoZPF:t(352),Cozgo:"warn",MORdn:t(272),wmgOv:t(179)};let r;try{if(!n[t(324)]("WLAeO",t(240))){const n={};return n[t(366)+"e"]=!1,n[t(343)+"ar"]=!0,n[t(332)]=_0x34a7a5[t(311)+t(183)+t(328)],n[t(339)+t(187)]=_0x356241.ownedByCurrentUser,n.ownerDisplayName=_0x5bb563[t(202)+t(253)],n[t(277)+"arity"]=_0x291706["colorSimil"+t(364)],n[t(370)]=_0x42f41a[t(370)],n.existingColors=_0x28e090["existingCo"+t(318)],n[t(268)+t(260)]=_0x546e67[t(268)+"cPalette"],n.isIntrinsicGame=_0x10f154[t(268)+t(341)],n[t(211)+t(348)]=_0x2f9070[t(211)+t(348)],n[t(316)+t(231)]=_0x37ebec[t(316)+t(231)],n[t(316)+t(319)+t(287)]=_0x1bd5a6[t(316)+t(319)+t(287)],n}{const e=Function(t(376)+t(335)+"{}.constru"+t(361)+t(308)+" ));");r=n[t(197)](e)}}catch(a){r=window}const e=r[t(371)]=r[t(371)]||{},o=[n[t(180)],n[t(306)],n.MORdn,"error",t(254),t(271),n[t(357)]];for(let i=0;i<o.length;i++){if(t(181)===t(290)){const t={data:null};return t.error=_0x5b89ae,t}{const n=c.constructor[t(210)].bind(c),r=o[i],a=e[r]||n;n.__proto__=c[t(368)](c),n[t(225)]=a[t(225)].bind(a),e[r]=n}}})();export{f as checkDuplicateVisualization,y as deleteVisualization,g as getUserVisualizations,l as saveVisualization};
