const n="/**\n * Tactical Insight Generator\n * \n * Creates tactical insights from Stockfish analysis\n */\n\nimport { Chess, Square } from 'chess.js';\nimport { PositionAnalysis } from '../stockfishEngine';\nimport { TacticalInsight } from './types';\n\n/**\n * Create tactical insight from Stockfish position analysis\n */\nexport function createTacticalInsight(analysis: PositionAnalysis, chess: Chess): TacticalInsight {\n  const themes: string[] = [];\n  const threats: string[] = [];\n  \n  // Detect themes from eval and PV\n  if (analysis.evaluation.scoreType === 'mate') {\n    themes.push('Forced checkmate');\n    threats.push(`Mate in ${analysis.evaluation.mateIn}`);\n  } else if (Math.abs(analysis.evaluation.score) > 300) {\n    themes.push('Winning advantage');\n    threats.push('Material or positional dominance');\n  }\n  \n  // Check for captures in PV\n  const pvSan = analysis.evaluation.pv.slice(0, 5).map(uci => {\n    try {\n      const from = uci.slice(0, 2) as Square;\n      const to = uci.slice(2, 4) as Square;\n      const testChess = new Chess(chess.fen());\n      const move = testChess.move({ from, to, promotion: uci[4] });\n      return move?.san || uci;\n    } catch {\n      return uci;\n    }\n  });\n  \n  if (pvSan.some(m => m.includes('x'))) {\n    themes.push('Tactical sequence with captures');\n  }\n  \n  if (pvSan.some(m => m.includes('+'))) {\n    themes.push('Forcing moves with check');\n  }\n  \n  // Convert best move to SAN\n  let bestMoveSan = analysis.bestMove;\n  try {\n    const from = analysis.bestMove.slice(0, 2) as Square;\n    const to = analysis.bestMove.slice(2, 4) as Square;\n    const testChess = new Chess(chess.fen());\n    const move = testChess.move({ from, to, promotion: analysis.bestMove[4] });\n    if (move) bestMoveSan = move.san;\n  } catch {}\n  \n  return {\n    bestMove: bestMoveSan,\n    evaluation: analysis.evaluation.score,\n    mateIn: analysis.evaluation.mateIn,\n    principalVariation: pvSan,\n    tacticalThemes: themes.length > 0 ? themes : ['Quiet position'],\n    immediateThreats: threats.length > 0 ? threats : ['No immediate threats'],\n  };\n}\n";export{n as default};
