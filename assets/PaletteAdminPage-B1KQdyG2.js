import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as m,P as h,w as f,B as p,bM as w,cj as v,a9 as j,am as g,a1 as y,a2 as b,a3 as N,a4 as z,bC as C,a5 as P,cu as S,b as B}from"./index-UzGFh8Yo.js";function k(e,s){e-=283;const t=_();let n=t[e];if(void 0===k.fJTMMy){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};k.ygWEUD=r,k.EXRfQW={},k.fJTMMy=!0}const a=e+t[0],i=k.EXRfQW[a];if(i)n=i;else{const e=function(e){this.ZhqizT=e,this.wGPSPn=[1,0,0],this.PLjsJp=function(){return"newState"},this.ReCeyr="\\w+ *\\(\\) *{\\w+ *",this.xYtEsm="['|\"].+['|\"];? *}"};e.prototype.LFrNRw=function(){const e=new RegExp(this.ReCeyr+this.xYtEsm).test(this.PLjsJp.toString())?--this.wGPSPn[1]:--this.wGPSPn[0];return this.oyMOQx(e)},e.prototype.oyMOQx=function(e){return Boolean(~e)?this.oervSg(this.ZhqizT):e},e.prototype.oervSg=function(e){for(let s=0,t=this.wGPSPn.length;s<t;s++)this.wGPSPn.push(Math.round(Math.random())),t=this.wGPSPn.length;return e(this.wGPSPn[0])},new e(k).LFrNRw(),n=k.ygWEUD(n),k.EXRfQW[a]=n}return n}!function(){const e=k,s=_();for(;;)try{if(810088===parseInt(e(332))/1*(parseInt(e(305))/2)+parseInt(e(287))/3*(-parseInt(e(372))/4)+-parseInt(e(320))/5+parseInt(e(370))/6*(-parseInt(e(326))/7)+-parseInt(e(373))/8*(-parseInt(e(296))/9)+parseInt(e(285))/10+parseInt(e(360))/11)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const M=function(){const e=k,s={};s[e(331)]=e(284),s[e(352)]=e(309);const t=s;let n=!0;return function(s,r){const a=e;if(t[a(331)]!==t[a(352)]){const e=n?function(){if(r){const e=r.apply(s,arguments);return r=null,e}}:function(){};return n=!1,e}{const e=_0x280037[a(292)+"r"][a(283)][a(297)](_0x35fc41),s=_0x2e3e29[_0x10f978],t=_0x5c57ed[s]||e;e[a(314)]=_0x275670.bind(_0x2daa5b),e.toString=t.toString.bind(t),_0x26fc86[s]=e}}}()(void 0,function(){const e=k,s={CizUv:"(((.+)+)+)+$"},t=s;return M.toString().search("(((.+)+)+)+$")[e(367)]()[e(292)+"r"](M).search(t[e(356)])});M();const q=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[k(365)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();async function D(s,t,n,r){const a=k,i={qGVVQ:function(e,s){return e+s}};i[a(374)]="palette_id",i[a(334)]=a(306),i[a(295)]=a(322)+"errides";const c=i;try{const{data:i}=await async function(s){const t=k,n={};n[t(288)]=t(322)+"errides",n.hJIHB=t(350),n[t(348)]=function(e,s){return e!==s};const r=n;try{const{data:n,error:a}=await e[t(301)](r[t(288)])[t(302)]("*").eq(r.hJIHB,s).single();if(a&&r[t(348)](a.code,"PGRST116"))throw a;const i={};return i[t(375)]=n,i.error=null,i}catch(a){const e={};return e[t(375)]=null,e[t(324)]=a,e}}(s);if(i){const{error:o}=await e[a(301)](a(322)+"errides")[a(351)]({white_colors:t,black_colors:n,modified_by:r,version:c[a(347)](i[a(317)],1)}).eq(c[a(374)],s);if(o)throw o;const l={};return l[a(324)]=null,l[a(317)]=i.version+1,l}if("NOMjR"===c.SnFeN){const i={};i[a(350)]=s,i[a(361)+"rs"]=t,i[a(342)+"rs"]=n,i[a(336)+"y"]=r,i[a(317)]=1;const{error:o}=await e[a(301)](c[a(295)]).insert(i);if(o)throw o;const l={error:null};return l[a(317)]=1,l}if(_0x11c261){const e=_0x469b14[a(365)](_0x26cafc,arguments);return _0x312e0b=null,e}}catch(o){const e={};return e.error=o,e.version=0,e}}async function A(s){const t=k,n={};n[t(339)]=t(330)+"alizations",n.VmumQ=function(e,s){return e===s};const r=n;try{const{data:n,error:a}=await e.from(r[t(339)]).select("id, game_d"+t(310));if(a)throw a;let i=0;for(const e of n||[]){const n=e[t(289)][t(371)+"ionState"];(r.VmumQ(null==n?void 0:n[t(311)],s)||(null==n?void 0:n["linkedPale"+t(323)])===s)&&i++}return i}catch(a){return 0}}function _(){const e=["CgfSzxr0zv9VDG","DhrLswq","zxjYB3i","D2HPDgu","mJe5nJzezw9nr0q","DgfIBgu","vvvrAxG","rKrIugy","C2f2zwrFDMLZDq","Bu9QBwi","mJiXqvLusNnA","A3rVELi","u25gzu4","rwXlBu8","Bw9KAwzPzwrFyG","zxjYAwrLCW","CMv0DxjUicHMDq","z0POzvm","qxbduhC","y3rVCIGICMv0Dq","yMXHy2TFy29SBW","zxHJzxb0Aw9U","vvjnu0K","zKv1Bei","DgLUzYbSAw5Rzq","CuDwvLe","zw5byvO","x3vZzxjFAwq","CgfSzxr0zv9Pza","DxbKyxrL","EMPNv3O","CM4GDgHPCYiPka","r2Tvs3u","sfj1u3y","q2L6vxy","twnvEM0","rxjYB3iGy291BG","y2PJww8","mJy5otm4nJHSA09YyKS","D2HPDgvFy29SBW","yxrPB25ZoG","A2LUzYbHzg1PBG","BMn0Aw9UkcKG","yxbWBhK","uefeAui","Dg9tDhjPBMC","x3jVBgu","BwPsB2i","mJu4nMrztu9tBG","DMLZDwfSAxPHDa","mJu0mZeWog5MAgvMuG","ofznwwfIBq","rhjyrLy","zgf0yq","ChjVDg90ExbL","zxzjseO","nZy2otq3mgLtt3vgsG","DMjlu0G","nNDiq1LmDW","werUv1O","z2fTzv9KyxrH","E30Uy29UC3rYDq","ihjVBgu6","y29UC3rYDwn0BW","CvrVC1K","yMXHy2S","tgXdqMy","ntaZntGXnwjxu3zHrW","yMLUza","A01qA0m","yw14uMu","BeXpBKG","zNjVBq","C2vSzwn0","zgvSzxrL","zcb2Axn1ywXPEG","ndz3yKnHBhq","tK9nALi","zMLUza","Efveyxe","EfD4uxq","yxrH","CgfSzxr0zuLK","ywrTAw4","BgvUz3rO","x19WCM90B19F","rxjYB3iGAw4Gyq","zg1PBIbJAgvJAW","DMvYC2LVBG","s3fiwee","wevRC2G","mtC1nZe2nxv5AKvTsa","Aw5MBW"];return(_=function(){return e})()}q(void 0,function(){const e=k,s={mjRob:function(e,s){return e(s)},McUzm:function(e,s){return e+s},xUDaq:e(338)+e(364),amxRe:"{}.constru"+e(341)+e(353)+" )",ShjXQ:function(e){return e()},KqHXA:"warn",bzHxP:e(321),qTosY:e(327),kMPkC:"trace"},t=s.ShjXQ(function(){const t=e;let n;try{n=s[t(369)](Function,s[t(357)](s[t(308)],s[t(299)])+");")()}catch(r){n=window}return n}),n=t.console=t.console||{},r=["log",s[e(318)],s.bzHxP,e(324),e(343),s[e(293)],s[e(298)]];for(let a=0;a<r[e(313)];a++){const s=q[e(292)+"r"][e(283)][e(297)](q),t=r[a],i=n[t]||s;s[e(314)]=q[e(297)](q),s[e(367)]=i[e(367)][e(297)](i),n[t]=s}})();const G=["k","q","r","b","n","p"],L={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},H=()=>{var M,q,_,H;const{user:U}=s(),E=t(),[I,K]=n.useState(!1),[R,T]=n.useState(!0),[W,J]=n.useState([]),[V,Y]=n.useState(null),[X,F]=n.useState(null),[Q,O]=n.useState({}),[Z,$]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!U)return void E("/");if(!(await async function(s){const t=k,n={HRuSv:function(e,s){return e+s}};n.vbKSH=t(338)+t(364),n[t(366)]=t(312),n.DVToH=function(e,s){return e!==s},n.lLOnH=t(354),n[t(345)]="Error chec"+t(363)+t(291),n[t(333)]=function(e,s){return e===s},n.lxbZy=t(315)+t(316)+":";const r=n;try{const n={};n[t(349)]=s,n[t(368)]=r[t(366)];const{data:a,error:i}=await e.rpc("has_role",n);if(i){if(!r.DVToH(r[t(300)],t(354)))return!1;_0x30713f=_0x4c9334(maYTtq[t(355)](maYTtq[t(286)]+(t(290)+'ctor("retu')+t(353)+" )",");"))()}return r[t(333)](a,!0)}catch(a){return!1}}(U.id)))return B.error("Access denied",{description:"Admin privileges required"}),void E("/");K(!0),await te(),T(!1)})()},[U,E]);const te=async()=>{const{data:s}=await async function(){const s=k,t={};t[s(340)]="palette_id";const n=t;try{const{data:t,error:r}=await e[s(301)]("palette_ov"+s(337))[s(302)]("*").order(n.ApCPw);if(r)throw r;const a={};return a[s(375)]=t||[],a.error=null,a}catch(r){const e={};return e[s(375)]=[],e[s(324)]=r,e}}();J(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await A(e.id);O(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=W.find(s=>s.palette_id===e);Y(e),F({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{X&&F({...X,[e]:{...X[e],[s]:t}})},ae=async()=>{if(!V||!X||!U)return;$(!0),se(!1);const{error:e,version:s}=await D(V,X.white,X.black,U.id);e?B.error("Failed to save",{description:e.message}):(B.success("Palette updated!",{description:`Version ${s} saved. ${Q[V]||0} visualizations will use the new colors.`}),await te()),$(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>W.some(s=>s.palette_id===e);return R?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):I?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(V===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),Q[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),Q[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[G.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),G.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:V&&X?r.jsxs(o,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(m,{className:"flex items-center gap-2",children:[r.jsx(h,{className:"h-5 w-5"}),null==(M=ie(V))?void 0:M.name]}),r.jsx(f,{children:null==(q=ie(V))?void 0:q.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(V)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!V)return;$(!0);const{error:s}=await async function(s){const t=k,n={};n[t(335)]=function(e,s){return e!==s},n[t(328)]=t(322)+"errides",n[t(319)]=t(350);const r=n;try{if(r[t(335)](t(329),t(344))){const{error:n}=await e[t(301)](r.UUQix)[t(303)]().eq(r[t(319)],s);if(n)throw n;const a={};return a[t(324)]=null,a}{const e=_0x3cb194?function(){if(_0x8a777){const e=_0x3126ca.apply(_0x79b204,arguments);return _0x9b9f36=null,e}}:function(){};return _0x2eeacb=!1,e}}catch(a){const e={};return e[t(324)]=a,e}}(V);s?B.error("Failed to revert",{description:s.message}):(B.success("Reverted to defaults"),ne(V),await te()),$(!1)},disabled:Z,children:[r.jsx(w,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!V||!X||!U)return;(Q[V]||0)>0?se(!0):await ae()},disabled:Z,children:[Z?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(v,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(_=ie(V))?void 0:_.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:G.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:X.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:X.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(H=ie(V))?void 0:H.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:G.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:X.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:X.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:G.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:X.white[e]},title:L[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:G.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:X.black[e]},title:L[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(b,{children:[r.jsxs(N,{children:[r.jsxs(z,{className:"flex items-center gap-2",children:[r.jsx(C,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(P,{children:["This palette is linked to ",r.jsx("strong",{children:Q[V||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:Z,children:[Z?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(S,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{H as default};
