const n='import React, { useState } from \'react\';\nimport { useAuth } from \'@/hooks/useAuth\';\nimport { Button } from \'@/components/ui/button\';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \'@/components/ui/card\';\nimport { Badge } from \'@/components/ui/badge\';\nimport { Separator } from \'@/components/ui/separator\';\nimport { Crown, Calendar, CreditCard, RefreshCw, Loader2, CheckCircle, XCircle, AlertCircle } from \'lucide-react\';\nimport { toast } from \'sonner\';\nimport { format } from \'date-fns\';\n\nconst SubscriptionManagement: React.FC = () => {\n  const { \n    user, \n    isPremium, \n    subscriptionStatus, \n    isCheckingSubscription, \n    checkSubscription, \n    openCheckout, \n    openCustomerPortal \n  } = useAuth();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n\n  const handleRefresh = async () => {\n    setIsRefreshing(true);\n    try {\n      await checkSubscription();\n      toast.success(\'Subscription status updated\');\n    } catch (error) {\n      toast.error(\'Failed to refresh status\');\n    } finally {\n      setIsRefreshing(false);\n    }\n  };\n\n  const handleUpgrade = async () => {\n    setIsLoading(true);\n    try {\n      await openCheckout();\n    } catch (error) {\n      console.error(\'Checkout error:\', error);\n      toast.error(\'Failed to open checkout\', {\n        description: error instanceof Error ? error.message : \'Please try again\',\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleManageSubscription = async () => {\n    setIsLoading(true);\n    try {\n      await openCustomerPortal();\n    } catch (error) {\n      console.error(\'Portal error:\', error);\n      toast.error(\'Failed to open subscription management\', {\n        description: error instanceof Error ? error.message : \'Please try again\',\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (!user) {\n    return null;\n  }\n\n  const subscriptionEnd = subscriptionStatus?.subscriptionEnd \n    ? new Date(subscriptionStatus.subscriptionEnd) \n    : null;\n\n  const isExpiringSoon = subscriptionEnd && \n    (subscriptionEnd.getTime() - Date.now()) < 7 * 24 * 60 * 60 * 1000; // 7 days\n\n  return (\n    <Card className="border-border/50">\n      <CardHeader>\n        <div className="flex items-center justify-between">\n          <div className="flex items-center gap-2">\n            <Crown className="h-5 w-5 text-primary" />\n            <CardTitle className="text-lg">Subscription</CardTitle>\n          </div>\n          <Button\n            variant="ghost"\n            size="sm"\n            onClick={handleRefresh}\n            disabled={isRefreshing || isCheckingSubscription}\n          >\n            <RefreshCw className={`h-4 w-4 ${isRefreshing || isCheckingSubscription ? \'animate-spin\' : \'\'}`} />\n          </Button>\n        </div>\n        <CardDescription>\n          Manage your Visionary premium subscription\n        </CardDescription>\n      </CardHeader>\n      <CardContent className="space-y-6">\n        {/* Status Section */}\n        <div className="flex items-center justify-between">\n          <div className="flex items-center gap-2">\n            <span className="text-sm text-muted-foreground">Status</span>\n          </div>\n          {isPremium ? (\n            <Badge className="bg-green-500/10 text-green-500 border-green-500/20">\n              <CheckCircle className="h-3 w-3 mr-1" />\n              Active\n            </Badge>\n          ) : (\n            <Badge variant="secondary" className="bg-muted">\n              <XCircle className="h-3 w-3 mr-1" />\n              Inactive\n            </Badge>\n          )}\n        </div>\n\n        <Separator />\n\n        {isPremium ? (\n          <>\n            {/* Premium Details */}\n            <div className="space-y-4">\n              {/* Renewal Date */}\n              <div className="flex items-center justify-between">\n                <div className="flex items-center gap-2 text-sm text-muted-foreground">\n                  <Calendar className="h-4 w-4" />\n                  <span>Renewal Date</span>\n                </div>\n                <div className="text-sm font-medium">\n                  {subscriptionEnd ? format(subscriptionEnd, \'MMMM d, yyyy\') : \'N/A\'}\n                </div>\n              </div>\n\n              {/* Expiring Soon Warning */}\n              {isExpiringSoon && (\n                <div className="flex items-center gap-2 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20">\n                  <AlertCircle className="h-4 w-4 text-amber-500" />\n                  <span className="text-sm text-amber-500">\n                    Your subscription renews in less than 7 days\n                  </span>\n                </div>\n              )}\n\n              {/* Benefits */}\n              <div className="p-4 rounded-lg bg-primary/5 border border-primary/10">\n                <h4 className="text-sm font-medium mb-2">Your Benefits</h4>\n                <ul className="text-sm text-muted-foreground space-y-1">\n                  <li>• Unlimited HD downloads</li>\n                  <li>• No watermarks on exports</li>\n                  <li>• Personal vision gallery</li>\n                  <li>• Early access to new features</li>\n                </ul>\n              </div>\n            </div>\n\n            <Separator />\n\n            {/* Manage Button */}\n            <Button\n              variant="outline"\n              className="w-full"\n              onClick={handleManageSubscription}\n              disabled={isLoading}\n            >\n              {isLoading ? (\n                <Loader2 className="h-4 w-4 animate-spin mr-2" />\n              ) : (\n                <CreditCard className="h-4 w-4 mr-2" />\n              )}\n              Manage Subscription\n            </Button>\n\n            <p className="text-xs text-center text-muted-foreground">\n              Update payment method, cancel, or view invoices\n            </p>\n          </>\n        ) : (\n          <>\n            {/* Upgrade Prompt */}\n            <div className="space-y-4">\n              <div className="p-4 rounded-lg bg-primary/5 border border-primary/10">\n                <h4 className="text-sm font-medium mb-2">Premium Benefits</h4>\n                <ul className="text-sm text-muted-foreground space-y-1">\n                  <li>• Unlimited HD downloads</li>\n                  <li>• No watermarks on exports</li>\n                  <li>• Personal vision gallery</li>\n                  <li>• Early access to new features</li>\n                </ul>\n              </div>\n\n              <div className="text-center">\n                <span className="text-2xl font-bold">$7</span>\n                <span className="text-muted-foreground">/month</span>\n              </div>\n            </div>\n\n            <Button\n              className="w-full btn-luxury"\n              onClick={handleUpgrade}\n              disabled={isLoading}\n            >\n              {isLoading ? (\n                <Loader2 className="h-4 w-4 animate-spin mr-2" />\n              ) : (\n                <Crown className="h-4 w-4 mr-2" />\n              )}\n              Upgrade to Premium\n            </Button>\n\n            <p className="text-xs text-center text-muted-foreground">\n              Cancel anytime. Secure payment via Stripe.\n            </p>\n          </>\n        )}\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default SubscriptionManagement;\n';export{n as default};
