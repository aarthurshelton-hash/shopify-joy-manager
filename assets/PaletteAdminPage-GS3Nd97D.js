import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as m,t as x,P as h,w as f,B as j,bM as w,cj as g,a9 as p,am as v,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as k,cu as L,b as B}from"./index-C_PxF1MG.js";function A(e,s){e-=481;const t=_();let n=t[e];if(void 0===A.fOVLeb){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};A.viEnvn=r,A.KFNifi={},A.fOVLeb=!0}const a=e+t[0],i=A.KFNifi[a];if(i)n=i;else{const e=function(e){this.TKJGIt=e,this.ecVJcm=[1,0,0],this.tuSzrK=function(){return"newState"},this.cjYMWj="\\w+ *\\(\\) *{\\w+ *",this.vdgCii="['|\"].+['|\"];? *}"};e.prototype.OKmmRQ=function(){const e=new RegExp(this.cjYMWj+this.vdgCii).test(this.tuSzrK.toString())?--this.ecVJcm[1]:--this.ecVJcm[0];return this.yHuNJs(e)},e.prototype.yHuNJs=function(e){return Boolean(~e)?this.mJgoUJ(this.TKJGIt):e},e.prototype.mJgoUJ=function(e){for(let s=0,t=this.ecVJcm.length;s<t;s++)this.ecVJcm.push(Math.round(Math.random())),t=this.ecVJcm.length;return e(this.ecVJcm[0])},new e(A).OKmmRQ(),n=A.viEnvn(n),A.KFNifi[a]=n}return n}!function(){const e=A,s=_();for(;;)try{if(291468===parseInt(e(531))/1+parseInt(e(518))/2+-parseInt(e(541))/3+-parseInt(e(533))/4*(-parseInt(e(588))/5)+parseInt(e(564))/6*(-parseInt(e(530))/7)+parseInt(e(559))/8*(parseInt(e(568))/9)+parseInt(e(550))/10*(-parseInt(e(502))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const K=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[A(532)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=A,s={};s.jgYEo=e(520)+"+$";const t=s;return K[e(555)]()[e(526)](t.jgYEo).toString()[e(488)+"r"](K)[e(526)](t[e(583)])});K();const D=function(){const e=A,s={};s[e(529)]=e(561),s.QvFYd=e(539),s.rYSjQ=e(562),s[e(554)]="PZVoG";const t=s;let n=!0;return function(e,s){const r=n?function(){const n=A;if(t.bScIt===t[n(575)])_0x1ff122++;else if(s){if(t[n(544)]!==t[n(554)]){const t=s[n(532)](e,arguments);return s=null,t}return _0x2982bd[n(496)](n(572)+"ting linked visualiz"+n(501),_0x4fa93d),0}}:function(){};return n=!1,r}}();function _(){const e=["zMLUza","Cfj2rLC","E30Uy29UC3rYDq","D2HPDgu","AMDzrw8","x3vZzxjFAwq","zgf0yq","CKTntfO","DM9hC2y","mJa1mZm2nuDQs1DWyW","zg1PBIbJAgvJAW","BMn0Aw9UkcKG","DhrLswq","B3jKzxi","A0f1CLC","t2HLA0u","yMXHy2TFy29SBW","Bw9KAwzPzwrFyG","ChjVDg90ExbL","y29UC3rYDwn0BW","rxjYB3iGy2HLyW","Aw5Zzxj0","zfnhA04","ihjVBgu6","DuzqCxK","AxLJze8","rgHdvNK","zxjYB3i","AwT6weq","uuvvu1K","yMLUza","Cu5gsuO","yxrPB25ZoG","mJjcrLfhB0m","y29Kzq","tezhrLa","ENHVwgO","CgfSzxr0zuLK","D0LrBgC","yxrH","CMv0DxjUicHMDq","zNjVBq","CgfSzxr0zv9Pza","yMXHy2S","CLbhqKW","vgvbChK","zen3wwK","zxjYAwrLCW","EwXAAfm","nJu0odaYD1rkDfjf","ywXPEMf0Aw9UCW","kcGOlISPkYKRkq","C2vSzwn0","y3LREuS","DMvYC2LVBG","C2f2zwrFDMLZDq","Bg9N","C2vHCMnO","zxHJzxb0Aw9U","r09nBwS","yLnJsxq","ody5mZuXrfjyu1Ls","mti0odC0CMnjrLDd","yxbWBhK","nfrnuuzJEa","D2HPDgvFy29SBW","BgLUA2vKugfSzq","zfPzyNq","wu55BLe","ww5IBgq","sLzuEg4","CM4GDgHPCYiPka","ntu0mdrIvxniA1u","sgHzqLy","Ahv3z1q","CLLtALe","zMXnrwi","wMntDw4","C2LUz2XL","ueDsu1qXmty","rxjYB3iGAw4Gyq","mZC0mde0mhjKCeXIuG","CgfSzxr0zv9VDG","t2jvzeO","EgXis3a","svDsANK","Dg9tDhjPBMC","y3rVCIGICMv0Dq","thvYBxK","A2fMshK","oduXmJi0ywvQu1bo","qufbEwe","Bu95wNq","r01TvMu","x3jVBgu","nLjTy0j4qW","BwPoEg8","ugnbEwu","CNbJ","mJDfCg1HBfK","ywrTAw4","Aw9Uu3rHDgu","wMvgzLK","rxjYB3iGy291BG","zgvSzxrL","DMLZDwfSAxPHDa","uxzgwwq","zcb2Axn1ywXPEG","zunjug4","Aw5MBW"];return(_=function(){return e})()}async function S(s){const t=A,n={ZcSun:"palette_id"};n[t(514)]=t(548);const r=n;try{const{data:n,error:a}=await e.from(t(551)+t(516))[t(521)]("*").eq(r[t(546)],s)[t(547)]();if(a&&a[t(503)]!==r.TeApy)throw a;const i={};return i[t(585)]=n,i.error=null,i}catch(a){const e={};return e[t(585)]=null,e.error=a,e}}async function J(s){const t=A,n={};n[t(560)]=t(520)+"+$",n.zxoXj="id, game_d"+t(508),n.rKMLZ=function(e,s){return e!==s},n[t(587)]=t(495),n[t(558)]=t(542),n[t(504)]=function(e,s){return e===s};const r=n;try{const{data:n,error:a}=await e.from(t(524)+t(519)).select(r[t(505)]);if(a)throw a;let i=0;for(const e of n||[]){if(!r[t(586)](r[t(587)],r[t(558)]))return _0x3b1e26[t(555)]()[t(526)](oyPRcb[t(560)])[t(555)]()[t(488)+"r"](_0x80b380)[t(526)](t(520)+"+$");{const n=e.game_data[t(574)+t(570)];(r.LFGFP(null==n?void 0:n[t(506)],s)||r[t(504)](null==n?void 0:n[t(535)+t(481)],s))&&i++}}return i}catch(a){return 0}}D(void 0,function(){const e=A,s={ikzXD:function(e,s){return e+s},Ynbld:e(509)+"nction() ",wIQlg:function(e){return e()},pRvFW:e(525),YNynQ:"warn",iycdO:e(496),cykyK:e(571)},t=s[e(507)](function(){const t=e;let n;try{n=Function(s[t(497)](s[t(538)]+(t(581)+t(556)+t(540)+" )"),");"))()}catch(r){n=window}return n}),n=t.console=t.console||{},r=[s[e(580)],s[e(537)],e(578),s[e(494)],e(527),"table","trace"];for(let a=0;a<r.length;a++)if(e(577)===s[e(522)]){if(_0x64775c){const s=_0x427681[e(532)](_0x4495cc,arguments);return _0xbcaa5c=null,s}}else{const s=D[e(488)+"r"][e(487)][e(499)](D),t=r[a],i=n[t]||s;s.__proto__=D[e(499)](D),s[e(555)]=i[e(555)][e(499)](i),n[t]=s}})();const M=["k","q","r","b","n","p"],q={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},P=()=>{var K,D,_,P;const{user:E}=s(),I=t(),[G,Y]=n.useState(!1),[U,V]=n.useState(!0),[H,W]=n.useState([]),[F,T]=n.useState(null),[O,X]=n.useState(null),[Z,R]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!E)return void I("/");if(!(await async function(s){const t=A,n={};n[t(484)]=t(569),n.mjNxo=t(549)+t(589)+":";const r=n;try{const n={};n[t(584)]=s,n[t(563)]=r[t(484)];const{data:a,error:i}=await e[t(567)]("has_role",n);return!i&&!0===a}catch(a){return!1}}(E.id)))return B.error("Access denied",{description:"Admin privileges required"}),void I("/");Y(!0),await te(),V(!1)})()},[E,I]);const te=async()=>{const{data:s}=await async function(){const s=A,t={flMEb:function(e,s){return e(s)},mPjxk:function(e,s){return e+s},rPGBL:s(581)+s(556)+s(540)+" )",kAurW:s(566),dCwYi:"palette_overrides"};try{if(t[s(483)]!==s(491)){const{data:n,error:r}=await e[s(510)](t[s(515)])[s(521)]("*")[s(482)](s(511));if(r)throw r;const a={};return a[s(585)]=n||[],a.error=null,a}_0x584942=yLKyBJ[s(545)](_0x48cb36,yLKyBJ.mPjxk(s(509)+s(590)+yLKyBJ[s(513)],");"))()}catch(n){const e={};return e[s(585)]=[],e[s(496)]=n,e}}();W(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await J(e.id);R(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=H.find(s=>s.palette_id===e);T(e),X({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{O&&X({...O,[e]:{...O[e],[s]:t}})},ae=async()=>{if(!F||!O||!E)return;Q(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,r){const a=A,i={uFPqy:a(557),huwgT:function(e,s){return e(s)},xnAgT:function(e,s){return e===s},ztJgZ:a(553),ylZhS:function(e,s){return e+s},saLKv:a(551)+a(516),ObUdJ:function(e,s){return e!==s},CUGCD:a(500)};try{if(a(498)!==i[a(493)]){const{data:c}=await i[a(543)](S,s);if(c){if(i.xnAgT(a(553),i.ztJgZ)){const o={};o.white_colors=t,o[a(485)+"rs"]=n,o[a(486)+"y"]=r,o[a(523)]=c[a(523)]+1;const{error:l}=await e[a(510)]("palette_ov"+a(516)).update(o).eq(a(511),s);if(l)throw l;return{error:null,version:i[a(517)](c[a(523)],1)}}return _0x4e285d.error(a(489)+"king admin"+a(492),_0x2a0063),!1}{const c={};c.palette_id=s,c[a(534)+"rs"]=t,c.black_colors=n,c[a(486)+"y"]=r,c.version=1;const{error:o}=await e[a(510)](i.saLKv)[a(490)](c);if(o)throw o;const l={error:null};return l[a(523)]=1,l}}return _0x46218b[a(496)](a(549)+a(589)+":",_0x57d822),!1}catch(c){if(i[a(552)](i.CUGCD,"EVwRT")){const e={};return e[a(496)]=c,e[a(523)]=0,e}_0x527db7=_0x3f906d}}(F,O.white,O.black,E.id);s?B.error("Failed to save",{description:s.message}):(B.success("Palette updated!",{description:`Version ${t} saved. ${Z[F]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>H.some(s=>s.palette_id===e);return U?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):G?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(F===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),Z[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),Z[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[M.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),M.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:F&&O?r.jsxs(o,{children:[r.jsx(m,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(x,{className:"flex items-center gap-2",children:[r.jsx(h,{className:"h-5 w-5"}),null==(K=ie(F))?void 0:K.name]}),r.jsx(f,{children:null==(D=ie(F))?void 0:D.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(F)&&r.jsxs(j,{variant:"outline",size:"sm",onClick:async()=>{if(!F)return;Q(!0);const{error:s}=await async function(s){const t=A;try{const{error:n}=await e[t(510)](t(551)+t(516))[t(573)]().eq("palette_id",s);if(n)throw n;const r={};return r[t(496)]=null,r}catch(n){if(t(528)!==t(536)){const e={};return e.error=n,e}{const e=_0x68a86d.apply(_0x33df54,arguments);return _0x1ec63c=null,e}}}(F);s?B.error("Failed to revert",{description:s.message}):(B.success("Reverted to defaults"),ne(F),await te()),Q(!1)},disabled:$,children:[r.jsx(w,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(j,{size:"sm",onClick:async()=>{if(!F||!O||!E)return;(Z[F]||0)>0?se(!0):await ae()},disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(g,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(_=ie(F))?void 0:_.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:M.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:q[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(p,{type:"color",value:O.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(p,{type:"text",value:O.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(P=ie(F))?void 0:P.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:M.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:q[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(p,{type:"color",value:O.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(p,{type:"text",value:O.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(v,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:M.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.white[e]},title:q[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:M.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.black[e]},title:q[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(k,{children:["This palette is linked to ",r.jsx("strong",{children:Z[F||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(j,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(j,{onClick:ae,disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(L,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{P as default};
