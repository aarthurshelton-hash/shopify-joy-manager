import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b7 as o,B as l,A as d,cb as u,cR as h,a8 as m,D as x,aB as p,aC as f,aD as w,aE as j,p as v,t as g,w as y,dy as C,dt as N,bo as b,dq as q,cZ as z,a1 as D,a2 as B,a3 as L,a4 as _,a5 as A,aW as M,bC as S,dz as U,b as W,y as P}from"./index-CESOpT9D.js";import{C as k}from"./calendar-le4uojde.js";function I(){const e=["DxnLCL9PzcWGza","BgvUz3rO","y29TCgXLDgvK","CLjnvNm","C3rHDhvZlcbHBq","AejWA2e","DxnLCL9Pza","DxbKyxrL","zwrFy2vUDhm","C2vSzwn0","AxnWBgf5x25HBq","yxnJzw5KAw5N","CMvQzwn0zwq","Dg9ju09tDhjPBG","tM90igf1DgHLBG","zgDIBgi","Dg90ywXFzwfYBG","mJH6vgXqB0e","zhjHD25Fy2vUDa","AujAv20","DgHKCMf3ywW","sKHtv2y","yM9KEq","zf9Jzw50CYWGDa","y3rVCIGICMv0Dq","zfvXzvm","y29TCgXLDgvKxW","yw1VDw50x2nLBG","zxjYB3i","vwPfAhO","zgf0yq","CMf3BL9Jzw50CW","BgPyq0K","CgvUzgLUz19HBq","mtmWD1zUtNrz","B3vUDf9Jzw50CW","mteYmtK4ofPcEhbfCq","yxbWCM92zwq","ChjVy2vZCY13Aq","q1His3e","v2fSBgv0ihvWza","BvPKvfC","mte2nda3nur5suLpra","z2fXrxu","Dg90ywW","DgLJyxrLza","C2vHCMnO","zM9YrwfJAa","BeDzz0C","yxbWBhK","z2v0","t0nuzu4","uMvXDwvZDcbUBW","oejlqxbVsq","BwfW","C29szeO","ywrTAw5FBM90zq","DhjHy2u","Be1nCfa","yxrLigvYCM9YoG","B09zrxi","yxv0Aa","CMvQzwn0zwrFyW","nZG2mdC5B1zvqwTk","yMLUza","DxnLCL93ywXSzq","zNjVBq","sLfnDve","DcbMB3vUzcbVCG","mZe5otL5wMXHt1G","s3fPtLK","Dg90ywXFD2L0Aa","Aw52B2TL","z2v0vxnLCG","Bg9N","ChjVzMLSzxm","sKPdAKS","zNvUy3rPB25Z","D2fYBG","yxbWCM92zwrFyq","txPNA2u","kcGOlISPkYKRkq","C3vJy2vZCW","Aw5MBW","y29UC29Szq","ogLUq0Xlzq","ChjVDg90ExbL","CMv0DxjUicHMDq","x3jLCxvLC3rZ","rgHVzfm","C3rHDhvZ","zxHJzxb0Aw9U","y3jLyxrLzf9HDa","zfbXzxm","zgHUA0m","ChjVDMvKihn0yq","ChjAr3C","yxbWCM92zwrFyW","tKjOBMS","ywXS","C2LUz2XL","CMvHC29UigLZia","ote0ntLtrhzrquu","Bxbptgq","s09Qqxu","ig5VDcbPBIbHCa","BMn0Aw9UkcKG","CMvXDwvZDf9Pza","Dg9tDhjPBMC","E30Uy29UC3rYDq","uMvQzwn0Aw9Uia","cI0TlqO","odmWntKYzNrNsg9Y","CMvXDwLYzwq","CgvUzgLUzW","mtmXotG4zgTythvj","B3vUDa","CgvUzgLUz19JBW","B3jKzxi","D2L0AgrYyxDHBa","Bw91BNq"];return(I=function(){return e})()}!function(){const e=F,t=I();for(;;)try{if(195181===parseInt(e(351))/1*(-parseInt(e(302))/2)+parseInt(e(364))/3*(parseInt(e(387))/4)+parseInt(e(291))/5+parseInt(e(406))/6+-parseInt(e(312))/7*(parseInt(e(334))/8)+-parseInt(e(361))/9+-parseInt(e(404))/10*(-parseInt(e(318))/11))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const H=function(){const e=F,t={};t.gaqEu=e(307);const s=t;let n=!0;return function(e,t){const r=n?function(){const n=F,r={};r[n(395)]=function(e,t){return e+t};const a=r;if(s[n(292)]!==n(347)){if(t){const s=t[n(298)](e,arguments);return t=null,s}}else _0x596911=_0x1d1690(a[n(395)](n(336)+n(355)+(n(358)+n(394)+'rn this")( )'),");"))()}:function(){};return n=!1,r}}()(void 0,function(){const e=F,t={};t[e(389)]=e(330)+"+$";const s=t;return H.toString()[e(295)](s.iBZWm)[e(357)]().constructor(H)[e(295)](e(330)+"+$")});H();const K=function(){const e=F,t={};t[e(373)]=function(e,t){return e===t},t[e(325)]=e(353);const s=t;let n=!0;return function(t,r){const a=e;if(s[a(373)](s[a(325)],s[a(325)])){const e=n?function(){if(r){const e=r[a(298)](t,arguments);return r=null,e}}:function(){};return n=!1,e}{const e={};return e[a(331)]=!1,e[a(398)]=_0x477ca5,e}}}();function F(e,t){e-=290;const s=I();let n=s[e];if(void 0===F.iGoPHX){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};F.MKTFIo=r,F.BwzuPF={},F.iGoPHX=!0}const a=e+s[0],c=F.BwzuPF[a];if(c)n=c;else{const e=function(e){this.BJGhYq=e,this.rjpSfw=[1,0,0],this.fmkIlR=function(){return"newState"},this.WJsAiV="\\w+ *\\(\\) *{\\w+ *",this.JALQzI="['|\"].+['|\"];? *}"};e.prototype.UzDbSQ=function(){const e=new RegExp(this.WJsAiV+this.JALQzI).test(this.fmkIlR.toString())?--this.rjpSfw[1]:--this.rjpSfw[0];return this.iqvZDm(e)},e.prototype.iqvZDm=function(e){return Boolean(~e)?this.FuWTCn(this.BJGhYq):e},e.prototype.FuWTCn=function(e){for(let t=0,s=this.rjpSfw.length;t<s;t++)this.rjpSfw.push(Math.round(Math.random())),s=this.rjpSfw.length;return e(this.rjpSfw[0])},new e(F).UzDbSQ(),n=F.MKTFIo(n),F.BwzuPF[a]=n}return n}async function G(t){const s=F,n={};n[s(290)]=s(324),n[s(304)]=s(370)+s(380)+"e",n[s(342)]=s(376);const r=n;try{const n={};n[s(381)]=!1;let a=e[s(315)](s(368)+s(337))[s(379)]("*")[s(367)](s(341),n);t&&t!==s(348)&&(a=a.eq(s(339),t));const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[])[s(303)](e=>e[s(376)]))],{data:l}=await e[s(315)](r[s(290)])[s(379)](r[s(304)]).in(r[s(342)],o),{data:d}=await e.from(s(314)+"ts").select("user_id, total_earne"+s(393)+"otal_withd"+s(401)).in(s(376),o),u=new Map((null==l?void 0:l.map(e=>[e[s(376)],e]))||[]),h=new Map((null==d?void 0:d[s(303)](e=>[e[s(376)],e]))||[]),m=(c||[])[s(303)](e=>{var t,n,r;return{...e,payout_details:e.payout_details,user_display_name:(null==(t=u.get(e[s(376)]))?void 0:t.display_name)||"Unknown User",wallet_total_earned:(null==(n=h[s(299)](e.user_id))?void 0:n[s(386)+s(378)])||0,wallet_total_withdrawn:(null==(r=h[s(299)](e.user_id))?void 0:r[s(320)+s(388)+"s"])||0}}),x={};return x[s(400)]=m,x[s(398)]=null,x}catch(a){const e={};return e[s(400)]=[],e[s(398)]=a,e}}async function Y(){const t=F,s={};s[t(375)]=t(372),s[t(338)]="withdrawal"+t(337),s[t(385)]=t(374)+t(405);const n=s;try{const{data:s,error:r}=await e[t(315)](n[t(338)])[t(379)](n[t(385)]);if(r)throw r;const a={pending_count:0};a[t(403)+"ount"]=0,a.approved_count=0,a[t(328)+t(369)]=0,a[t(396)+t(293)]=0,a[t(311)+t(365)]=0;const c=a;(s||[])[t(296)](e=>{const s=t;switch(e[s(339)]){case"pending":c[s(366)+"unt"]++,c[s(403)+s(365)]+=e.amount_cents;break;case"approved":c[s(346)+s(365)]++,c[s(328)+"mount"]+=e[s(397)+"ts"];break;case n.hBpka:c[s(396)+s(293)]+=e.amount_cents;break;case s(382):c["rejected_c"+s(365)]++}});const i={};return i[t(400)]=c,i[t(398)]=null,i}catch(r){const e={data:null};return e.error=r,e}}K(void 0,function(){const e=F,t={JQMuQ:function(e,t){return e+t},xUPRl:function(e,t){return e+t},NBdkn:function(e){return e()},ljXCI:e(323),prZGw:"table",koJOW:function(e,t){return e<t}},s=t.NBdkn(function(){const s=e;let n;try{n=Function(t[s(316)](t.xUPRl(s(336)+"nction() ","{}.constru"+s(394)+'rn this")( )'),");"))()}catch(r){n=window}return n}),n=s.console=s[e(333)]||{},r=[t[e(402)],e(327),e(332),e(398),e(340),t[e(345)],e(306)];for(let a=0;t.koJOW(a,r[e(371)]);a++){const t=K.constructor[e(335)][e(313)](K),s=r[a],c=n[s]||t;t.__proto__=K[e(313)](K),t[e(357)]=c[e(357)].bind(c),n[s]=t}})(),function(){const e=Z,t=E();for(;;)try{if(816383===-parseInt(e(469))/1+-parseInt(e(492))/2+parseInt(e(498))/3+-parseInt(e(445))/4+-parseInt(e(461))/5+parseInt(e(448))/6*(-parseInt(e(455))/7)+-parseInt(e(466))/8*(-parseInt(e(481))/9))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const R=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[Z(454)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=Z,t={};t[e(458)]=e(500)+"+$";const s=t;return R[e(478)]()[e(452)](s[e(458)])[e(478)]()[e(443)+"r"](R)[e(452)](e(500)+"+$")});R();const X=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[Z(454)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}();function Z(e,t){e-=440;const s=E();let n=s[e];if(void 0===Z.FGyagy){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};Z.OQSIup=r,Z.MRSKLe={},Z.FGyagy=!0}const a=e+s[0],c=Z.MRSKLe[a];if(c)n=c;else{const e=function(e){this.NMqXde=e,this.FUhifd=[1,0,0],this.GczBDX=function(){return"newState"},this.TWdErE="\\w+ *\\(\\) *{\\w+ *",this.RriCaq="['|\"].+['|\"];? *}"};e.prototype.hRradS=function(){const e=new RegExp(this.TWdErE+this.RriCaq).test(this.GczBDX.toString())?--this.FUhifd[1]:--this.FUhifd[0];return this.yPNAVQ(e)},e.prototype.yPNAVQ=function(e){return Boolean(~e)?this.oCdkFF(this.NMqXde):e},e.prototype.oCdkFF=function(e){for(let t=0,s=this.FUhifd.length;t<s;t++)this.FUhifd.push(Math.round(Math.random())),s=this.FUhifd.length;return e(this.FUhifd[0])},new e(Z).hRradS(),n=Z.OQSIup(n),Z.MRSKLe[a]=n}return n}function E(){const e=["C2vHCMnO","rNHZr1y","yxbWBhK","nZDKz2fkqwy","y2vFy2vUDhm","Cf9ZywXLx3bYAq","D2DmAwC","z2v0x29Yx2nYzq","C3vJy2vZCW","mJaWmdq4nuTpB3rwqq","yMLUza","EejTwfy","yxrLx3DHBgXLDa","CKLMD20","odH5BgPfu1q","ChjVDg90ExbL","Aw5MBW","mtaZntyXmfvOCfHwvq","tLnNv24","BNnHy3rPB25Z","E30Uy29UC3rYDq","s1HyCu4","Dg9gAxHLza","DhjHy2u","CNbJ","CxD5zxe","Dg9tDhjPBMC","wuP2reK","C2vSzwn0","mJqYody0mvLdCuXUuq","BLPqvvu","DxnLCL9Pza","y29UC29Szq","vgThCwm","z2v0vxnLCG","C2fSzq","yxv0Aa","tM90igf1DgHLBG","BMn0Aw9UkcKG","Cf91C2vYx2LK","mJuYodq0q29csfrt","zNjVBq","DgLJyxrLza","D2fSBgv0x3rYyq","rev3AM8","zxjYB3i","ntKWnZy2yxvxvgrj","x19WCM90B19F","kcGOlISPkYKRkq","B3jKzxi","DgfIBgu","tNDeqxq","A3LHywy","Afvjzvi","Cf9IDxLLCL9Pza","y29UC3rYDwn0BW","zgf0yq","mJe4mJi0EersthDX","CM4GDgHPCYiPka","yxnJzw5KAw5N","mZK5mZC4yLLgEhHK","BgLTAxq","CMTLDhbSywnLxW","ChjVy2vZC19Tyq"];return(E=function(){return e})()}function J(e){return"$"+(e/100)[Z(474)](2)}function V(){var I,H;const{user:K}=t(),R=s(),[X,Z]=n.useState(!1),[E,V]=n.useState(!0),[O,T]=n.useState([]),[Q,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{oe()},[K]);const oe=async()=>{if(!K)return void V(!1);const{data:t}=await e.rpc("has_role",{_user_id:K.id,_role:"admin"});!0===t&&(Z(!0),await le()),V(!1)},le=async()=>{const[e,t]=await Promise.all([G(ee),Y()]);e.data&&T(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(P,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(P,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(P,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(P,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(P,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(P,{variant:"outline",children:e})}};return E?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):K&&X?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(l,{variant:"ghost",size:"icon",onClick:()=>R(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),Q&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:J(Q.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:J(Q.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:J(Q.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),le()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(w,{value:"pending",children:"Pending"}),r.jsx(w,{value:"approved",children:"Approved"}),r.jsx(w,{value:"completed",children:"Completed"}),r.jsx(w,{value:"rejected",children:"Rejected"}),r.jsx(w,{value:"all",children:"All"})]}),r.jsx(j,{value:ee,children:r.jsxs(c,{children:[r.jsxs(v,{children:[r.jsx(g,{children:"Withdrawal Requests"}),r.jsxs(y,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===O.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(C,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(N,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:O.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(b,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(q,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(k,{className:"h-3 w-3"}),z(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",J(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:J(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(l,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(D,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(B,{children:[r.jsxs(L,{children:[r.jsxs(_,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(A,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(I=se.request.payout_details)?void 0:I.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:J(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(M,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(S,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(H=se.request.payout_details)?void 0:H.email})]})]})]}),r.jsxs(U,{children:[r.jsx(l,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=F,r={};r[n(300)]="withdrawal_requests",r[n(343)]=n(407),r[n(309)]=function(e,t){return e||t};const a=r;try{const{data:{user:r}}=await e[n(310)][n(322)]();if(!r)throw new Error(n(384)+n(294));const{error:c}=await e[n(315)](a[n(300)])[n(377)]({status:a[n(343)],admin_notes:a[n(309)](s,null),reviewed_by:r.id,reviewed_at:(new Date).toISOString()}).eq("id",t).eq(n(339),n(363));if(c)throw c;const i={};return i[n(331)]=!0,i[n(398)]=null,i}catch(c){const e={success:!1};return e.error=c,e}}(se.request.id,re),t.success&&W.success("Withdrawal approved");break;case"reject":if(!re.trim())return W.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=F,r={};r[n(399)]=n(384)+n(294);const a=r;try{const{data:{user:r}}=await e[n(310)][n(322)]();if(!r)throw new Error(a.UjEhz);if(!s)throw new Error(n(359)+n(350)+n(362));const{error:c}=await e[n(315)](n(368)+"_requests")[n(377)]({status:n(382),admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date)[n(383)+"g"]()}).eq("id",t).eq(n(339),n(363));if(c)throw c;const i={success:!0};return i[n(398)]=null,i}catch(c){const e={};return e[n(331)]=!1,e[n(398)]=c,e}}(se.request.id,re),t.success&&W.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=F,r={};r.KqiNY="Not authen"+n(294),r.lGYgG="completed",r[n(409)]=n(329),r[n(352)]=n(391);const a=r;try{const{data:{user:r}}=await e[n(310)][n(322)]();if(!r)throw new Error(a[n(319)]);const{data:c,error:i}=await e[n(315)]("withdrawal_requests")[n(379)]("*").eq("id",t).eq(n(339),"approved")[n(349)]();if(i||!c)throw new Error(n(301)+n(317)+n(354)+n(344)+"tus");const{error:o}=await e.from(n(368)+n(337))[n(377)]({status:a[n(297)],admin_notes:s?(c[n(305)+"s"]||"")+n(360)+s:c[n(305)+"s"],completed_at:(new Date)[n(383)+"g"]()}).eq("id",t);if(o)throw o;const l={};l[n(356)]=t,l[n(376)]=c[n(376)],l[n(397)+"ts"]=c[n(397)+"ts"];const d={};d[n(392)]=l;const{error:u}=await e[n(326)][n(321)](n(408)+n(390),d),h={};return h[n(331)]=!0,h[n(398)]=null,h}catch(c){if(a[n(409)]!==a.mpOLd){const e={success:!1};return e.error=c,e}if(_0x5615c0){const e=_0x13ffd8[n(298)](_0x209df4,arguments);return _0xa25345=null,e}}}(se.request.id,re),t.success&&W.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?W.error(t.error.message):(ne({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(l,{onClick:()=>R("/"),children:"Go Home"})]})})})}X(void 0,function(){const e=Z,t={nZPUU:function(e,t){return e(t)},qwyeq:function(e,t){return e+t},FxsGV:function(e,t){return e+t},kyaaf:e(472)+'ctor("retu'+e(446)+" )",DZAYE:e(468)},s=function(){const s=e;let n;try{n=t[s(482)](Function,t[s(477)](t[s(453)]("return (fu"+s(490),t[s(440)]),");"))()}catch(r){n=window}return n}(),n=s[e(484)]=s[e(484)]||{},r=["log","warn",t.DZAYE,"error","exception",e(502),e(475)];for(let a=0;a<r.length;a++){const t=X[e(443)+"r"][e(467)].bind(X),s=r[a],c=n[s]||t;t[e(499)]=X[e(462)](X),t.toString=c.toString[e(462)](c),n[s]=t}})();export{V as default};
