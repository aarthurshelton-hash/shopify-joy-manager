import{s as t,ca as r,dG as n,dH as e}from"./index-Cppn2aUX.js";import{v as o,a as i,b as a}from"./visualizationSchemas-Cf_W9KQc.js";import"./flagContent-C_Aw-rF3.js";!function(){const t=l,r=f();for(;;)try{if(703045===parseInt(t(554))/1*(parseInt(t(443))/2)+parseInt(t(561))/3*(parseInt(t(389))/4)+parseInt(t(469))/5*(-parseInt(t(523))/6)+-parseInt(t(449))/7+parseInt(t(442))/8+-parseInt(t(548))/9*(-parseInt(t(444))/10)+-parseInt(t(577))/11)break;r.push(r.shift())}catch(n){r.push(r.shift())}}();const s=function(){let t=!0;return function(r,n){const e=t?function(){if(n){const t=n.apply(r,arguments);return n=null,t}}:function(){};return t=!1,e}}()(void 0,function(){const t=l;return s[t(549)]()[t(553)]("(((.+)+)+)+$")[t(549)]()[t(492)+"r"](s).search(t(558)+"+$")});s();const u=function(){let t=!0;return function(r,n){const e=t?function(){const t=l,e={};e[t(455)]=t(428)+t(582)+t(567);const o=e;if(n){if(t(594)!=t(594)){_0x45767b[t(430)](o.cGegy,_0x5b1617);const r={};return r[t(569)+"e"]=!1,r.isTooSimilar=!1,r}{const e=n[t(507)](r,arguments);return n=null,e}}}:function(){};return t=!1,e}}();function c(t,r,n){const e=l,o={};o.cNtxA=e(420);const i=o;return(t||r[e(426)]||"")[e(531)]()[e(527)](/\s+/g," ")+"::"+(n?JSON[e(537)]({palette:n.paletteId||e(566),darkMode:n.darkMode||!1,currentMove:n.currentMove===1/0?i[e(402)]:n[e(403)+"e"],lockedPieces:(n[e(586)+"es"]||[])[e(413)]((t,r)=>(t[e(590)]+"-"+t.pieceType)["localeComp"+e(572)](r[e(590)]+"-"+r[e(489)]))}):"{}")}function f(){const t=["DK91Dve","zxHPC3rPBMDdBW","D2fYBG","y29UDgvUDfr5Ca","DhjHy2u","EeP4uNC","zgf0yq","BgfYihzPC3vHBa","ww91igHHDMuGyq","v3DZvNe","Bg9YCW","r0rMvuS","yM1ot0m","yxbWBhK","AxPHDgLVBIaTia","ywLUCYbPBMfWCa","BgLUA2vKugfSzq","wLPZvwy","yw5VDgHLCIbJBW","x19WCM90B19F","EwzrswW","zgLZCgXHEv9Uyq","BwvFzgf0yq","B3fXEhe","qw5VDgHLCIbJBW","yxjPDhK","Aw9Uu3rHDgu","C2vSzwn0","Aw5MBW","nKzsEhbZAW","Dhj5ignOyw5NAq","AxnjBNrYAw5ZAq","AM9PBG","CMvWBgfJzq","Bg9JywXLq29TCa","CMvTB3zL","Ehnerhq","DhjPBq","qxnQvvO","C3rVCMfNzq","ueDsu1qXmty","vNzvB0C","zunHCMq","C3rYAw5NAwz5","tuDQDxi","u1r0vva","zgf0zq","Dg9mB3DLCKnHCW","y0DHBwu","C2LUz2XL","Aw9Uig5VDcbMBW","qMrQsuO","vMLZDwfSAxPHDa","zuThr3e","ow95sezYsq","Dg9tDhjPBMC","D2HPDgu","Cgf0Ag5HBwu","CYbVD25LzcbIEq","C2vHCMnO","mtiWndm0vfvAr0jb","z2v0uhvIBgLJvq","twnfCgu","DMLZDwfSAxPHDa","kcGOlISPkYKRkq","rMfPBgvKihrVia","Dg8Gysb2AxnPBW","m05gs25QCa","y1bHBgv0Dgu","AuXOsuK","DwfSAxPHDgLVBG","BKLK","Bw9KzxjU","y2f0zxm6","Bwf0y2HLzfbHBa","AxneDxbSAwnHDa","wMvWyxG","B3DUzwrcEun1CG","yxjL","v0jnAva","BgL6yxrPB246ia","z2u6ia","BgXLCNK","nZe0mZG3m3ziAhfcsG","yxLoyw1L","wMXMvwu","ywXPEMf0Aw9UCW","uhzguei","A2LUzYbKDxbSAq","zMLUza","refhtNG","CML0Eq","Bg9JA2vKugLLyW","B3jKzxi","zxHPC3rPBMDjza","BwvZC2fNzq","CgLLy2vdB2XVCG","E30Uy29UC3rYDq","Dw5K","wuHbBK8","D0DqAwe","Dg90ywXnB3zLCW","igzVCIb1BMLXDq","zgfYA01Vzgu","vgHPCYbPCYa","yxnJzw5KAw5N","DgfIBgu","tLnIwLG","Dca4ignVBg9YCW","mJGXnta4neLNveX2BW","CM9WCMLHDguGyW","CMvZDwX0","rxjYB3iGAw4Gza","DfnHA24","wMXVD3a","CMvUDfvZzxi","CNPWwwS","DxbSAwnHDguGyW","BgXLy3rVCG","DxnLCL9Pza","AuTHuxC","C1f4zMm","y050Eee","y3vYCMvUDe1VDG","y3vZDg9T","ueLUyMm","AxnuB29tAw1PBa","vgHPCYb2Axn1yq","CgfSzxr0zuLK","zxr0zuLK","r0r4yMO","ihzLCNKGC2LTAq","AxvsC2y","C29YDa","y29Kzq","A1zHyMi","CMvHC29U","CM4GDgHPCYiPka","C3bSAxq","zMv0y2GGDMLZDq","ywXS","zw5LC3m","y29UC29Szq","sw52ywXPzcbqrW","tNfptwC","CM91BMq","CgDU","z2fTzurHDge","rxjYB3iGy2HLyW","wfjAAu8","zxjYB3i","AwzUCvO","vhvYzhi","CMv0DxjUicHMDq","BIbIEsa","verVCKS","AgvJAZO","C2XPy2u","zcWGCgDUlcbNyq","ywXPEMf0Aw9UoG","DhrLswq","ChvIBgLJvxjS","mtKYmdC1mLjqr2rjBW","mLvTs2npCW","mteWnZC0mtbuB3jeDLK","C3vHBgL6yxrPBW","C3vJy2vZCW","lNbUzW","Aw5Zzxj0","mti1nZC0nLHivLLduq","sw52ywXPzcb0Aq","z2fTzv9KyxrH","B3DUzxjeAxnWBa","BenUAKG","Bwf0y2HLzeDHBq","y0DLz3K","ChjVDg90ExbL","ChbHte8","zgXOB2G","zxr0zvnPBwLSyq","vxrbuMe","Bg9N","BMn0Aw9UkcKG","zNjVBq","BgvUz3rO","yMXHy2S","uhzws1C","zgvSzxrLihzPCW","zMLUzeLUzgv4","mZe5otm3mhbUA3vTAq","Aw9UCW","jsbZAw1PBgfYia","yMLUza","zxzLBNq","y29SB3jtAw1PBa","vgL0BguGy29UDa","C2f2zsb2Axn1yq","Bw92zxm","zgvSzxrL","u1ruuM8","wgPuufu","B2XLqwy","DxbSB2fK","yM9HCMq","ELL0DKG","wxnXveC","AwnHDguGzxHPCW","y3vZDg9Tq29SBW","C2f2zwrFDMLZDq","CgLLy2vuExbL","rLvYA0i","BgL6yxrPB24GAq","y29UC3rYDwn0BW","y3rVCIGICMv0Dq"];return(f=function(){return t})()}function l(t,r){t-=387;const n=f();let e=n[t];if(void 0===l.dNfCHt){var o=function(t){let r="",n="",e=r+o;for(let o,i,a=0,s=0;i=t.charAt(s++);~i&&(o=a%4?64*o+i:i,a++%4)?r+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=r.length;o<i;o++)n+="%"+("00"+r.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(n)};l.mDmPJA=o,l.fgHVvS={},l.dNfCHt=!0}const i=t+n[0],a=l.fgHVvS[i];if(a)e=a;else{const t=function(t){this.Mfpfub=t,this.vPlykA=[1,0,0],this.uMdKsb=function(){return"newState"},this.Eddkrp="\\w+ *\\(\\) *{\\w+ *",this.PSmlVJ="['|\"].+['|\"];? *}"};t.prototype.FNuXfV=function(){const t=new RegExp(this.Eddkrp+this.PSmlVJ).test(this.uMdKsb.toString())?--this.vPlykA[1]:--this.vPlykA[0];return this.qjldOq(t)},t.prototype.qjldOq=function(t){return Boolean(~t)?this.Cqqnqr(this.Mfpfub):t},t.prototype.Cqqnqr=function(t){for(let r=0,n=this.vPlykA.length;r<n;r++)this.vPlykA.push(Math.round(Math.random())),n=this.vPlykA.length;return t(this.vPlykA[0])},new t(l).FNuXfV(),e=l.mDmPJA(e),l.fgHVvS[i]=e}return e}async function w(o,i,a,s){const u=l,f={oqqxq:"id, user_i"+u(438)+u(516),UWnqu:"Error chec"+u(582)+u(567),yfQIl:function(t,r,n,e){return t(r,n,e)},RwyVH:function(t,r){return t===r},AsjUZ:"profiles",sQxfc:u(515)+"me",bmNOC:u(399),oleAf:"Exact dupl"+u(486)+"ts",NqOMg:u(566),iLhII:function(t,r){return t===r}};try{const l=c(i,a,s),{data:w,error:y}=await t[u(463)](u(488)+u(580))[u(521)](f[u(517)]);if(y){const t={};return t[u(569)+"e"]=!1,t[u(406)+"ar"]=!1,t}for(const r of w||[]){const n=r[u(451)],e=f[u(514)](c,r.pgn||void 0,n,n["visualizat"+u(520)]);if(f.RwyVH(l,e)){const n=r[u(399)]===o;let e;if(!n){const{data:n}=await t[u(463)](f[u(532)])[u(521)](f[u(401)]).eq(f[u(506)],r[u(399)])[u(543)]();e=(null==n?void 0:n[u(515)+"me"])||u(518)+u(398)}const i={isDuplicate:!0,isTooSimilar:!0};return i[u(588)]=r.id,i[u(571)+"rentUser"]=n,i[u(452)+"ayName"]=e,i[u(474)+u(519)]=100,i[u(416)]=f[u(481)],i}}const C=(null==s?void 0:s[u(408)])||f[u(424)];let g;if(null==s?void 0:s[u(487)+"rs"])g=s[u(487)+"rs"];else if(f[u(563)](C,u(404))){const t=r[u(583)](t=>t.id===u(404));if(t){const r={};r[u(550)]=t.white,r.black=t[u(465)],g=r}}const v=await n(o,i,a,C,g);if(v[u(406)+"ar"]){const t={isDuplicate:!1,isTooSimilar:!0};return t[u(588)]=v["existingVi"+u(445)+u(565)],t[u(571)+u(395)]=v[u(571)+"rentUser"],t[u(452)+u(578)]=v[u(452)+u(578)],t["colorSimil"+u(519)]=v["colorSimil"+u(519)],t[u(416)]=v[u(416)],t["existingCo"+u(504)]=v[u(495)+u(504)],t["isIntrinsi"+u(562)]=v[u(525)+u(562)],t[u(525)+u(542)]=v[u(525)+u(542)],t[u(454)+u(536)]=v[u(454)+u(536)],t[u(568)+u(409)]=v["matchedPal"+u(409)],t[u(568)+u(459)+u(585)]=v["matchedPal"+u(459)+u(585)],t}let x;g&&(x=e(g)||void 0);const D={};return D[u(569)+"e"]=!1,D[u(406)+"ar"]=!1,D[u(510)+u(440)]=x,D[u(474)+u(519)]=v[u(474)+"arity"],D[u(525)+u(562)]=v[u(525)+u(562)],D["isIntrinsi"+u(542)]=v[u(525)+u(542)],D[u(454)+u(536)]=v[u(454)+u(536)],D[u(568)+"etteId"]=v["matchedPal"+u(409)],D[u(568)+u(459)+u(585)]=v[u(568)+"etteSimila"+u(585)],D}catch(w){const t={};return t[u(569)+"e"]=!1,t[u(406)+"ar"]=!1,t}}async function y(r,n,e,s,u,c){const f=l,y={TDorK:f(502)+f(411)+"lar visual"+f(508)+f(524)+"ng at leas"+f(388)+f(596)+f(421),YsqTG:f(512)+"llector",ZlfUe:f(450)+"tle",XXlJU:f(573),dlhoh:function(t,r,n,e,o){return t(r,n,e,o)},ZZsUf:"This visua"+f(491)+"s already in your ga"+f(576),vOuuQ:f(535),Turdr:"image/png",rzpYk:f(557)+f(470),iKaQw:function(t,r){return t||r}};try{const l=o(n);if(!l[f(446)])return{data:null,error:new Error(l[f(430)]||y[f(579)])};const C=await i(n);if(!C.safe)return{data:null,error:new Error(C[f(416)]||f(475)+f(509)+f(390)+"ontent")};const g=a(u);if(!g[f(446)]){if(y.XXlJU===f(484)){const t=_0x2b4c83[f(571)+f(395)]?y[f(435)]:f(598)+_0x4189c8[f(425)](_0x4e4087[f(474)+"arity"]||30)+(f(471)+"to a vision by ")+(_0x31d154[f(452)+f(578)]||y.YsqTG);return{data:null,error:new _0x43ed13(t),isTooSimilar:!0,ownedByCurrentUser:_0x57f16d[f(571)+f(395)],ownerDisplayName:_0x38d2ab[f(452)+f(578)],colorSimilarity:_0x1bc94d[f(474)+f(519)],reason:_0x29fca7[f(416)]}}return{data:null,error:new Error(g[f(430)]||f(423)+"N data")}}const v=await y[f(458)](w,r,u,e[f(427)],c);if(v[f(569)+"e"]){const t=v[f(571)+f(395)]?y[f(511)]:f(407)+f(491)+f(552)+" "+(v[f(452)+f(578)]||y[f(485)]);return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:v[f(571)+f(395)],ownerDisplayName:v["ownerDispl"+f(578)],colorSimilarity:100}}if(v[f(406)+"ar"]){if("VvUoG"!==y[f(494)]){const t={};return t[f(430)]=_0x21f1d4,t}{const t=v[f(571)+f(395)]?f(502)+f(411)+f(501)+f(508)+"try changing at leas"+f(388)+" for uniqueness":f(598)+Math[f(425)](v[f(474)+f(519)]||30)+"% similar "+f(560)+f(434)+(v[f(452)+"ayName"]||f(512)+"llector");return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:v["ownedByCur"+f(395)],ownerDisplayName:v[f(452)+f(578)],colorSimilarity:v[f(474)+f(519)],reason:v[f(416)]}}}const x={...c};x[f(510)+f(440)]=v[f(510)+f(440)];const D=x,z=r+"/"+Date.now()+"-"+n[f(527)](/[^a-z0-9]/gi,"-")[f(541)+"e"]()+f(447),B={};B[f(497)+"e"]=y[f(432)],B.upsert=!1;const{error:d}=await t[f(533)][f(463)](f(557)+f(470))[f(482)](z,s,B);if(d)throw new Error(f(559)+"upload ima"+f(575)+d.message);const{data:h}=t[f(533)][f(463)](y[f(396)])[f(555)+"rl"](z),A={};A[f(550)]=e[f(427)][f(550)],A.black=e.gameData[f(465)],A.event=e.gameData[f(473)],A[f(540)]=e[f(427)][f(540)],A[f(391)]=e[f(427)][f(391)],A.pgn=e.gameData.pgn,A[f(477)]=e.gameData[f(477)],A[f(483)]=e[f(483)],A[f(595)]=e[f(595)],A["visualizat"+f(520)]=D;const L=A,{data:q,error:m}=await t[f(463)](f(488)+f(580))[f(448)]({user_id:r,title:n,pgn:y[f(400)](u,null),game_data:L,image_path:h[f(441)]}).select()[f(543)]();if(m)throw await t[f(533)][f(463)](f(557)+f(470))[f(529)]([z]),new Error(f(559)+f(476)+f(574)+m[f(589)]);const M={};return M[f(500)]=q,M.error=null,M}catch(C){const t={};return t[f(500)]=null,t.error=C,t}}async function C(r){const n=l,e={};e[n(570)]=n(566),e.XRZiO=n(488)+n(580),e.xsDDt="user_id",e[n(556)]="created_at",e[n(538)]=n(539),e[n(547)]=n(584),e[n(490)]=n(387);const o=e;try{const e={};e[n(599)]=!1;const{data:i,error:a}=await t[n(463)](o[n(429)])[n(521)]("*").eq(o[n(530)],r)[n(587)](o[n(556)],e);if(a){if("STtUP"===o.MGjur)throw new Error("Failed to "+n(419)+n(580)+": "+a[n(589)]);{const t=_0x5f3cac?function(){if(_0x2cc550){const t=_0x3eff1b[n(507)](_0x1ccfe7,arguments);return _0x246ad9=null,t}}:function(){};return _0xb432a7=!1,t}}const s={};return s[n(500)]=i||[],s.error=null,s}catch(i){if(o[n(547)]===o.FUrkB){return(_0x27bb7f||_0x52b20a[n(426)]||"")[n(531)]()[n(527)](/\s+/g," ")+"::"+(_0x141a75?_0x2c4ba2[n(537)]({palette:_0x3a1bc7[n(408)]||o[n(570)],darkMode:_0x51ce5f[n(597)]||!1,currentMove:_0xa531f2[n(403)+"e"]===_0x208451?n(420):_0x5c0b9c[n(403)+"e"],lockedPieces:(_0x13c284[n(586)+"es"]||[])[n(413)]((t,r)=>(t[n(590)]+"-"+t[n(489)])[n(528)+n(572)](r[n(590)]+"-"+r[n(489)]))}):"{}")}{const t={};return t[n(500)]=[],t[n(430)]=i,t}}}async function g(r,n){const e=l,o={BdjIJ:function(t,r){return t===r}};o[e(480)]=function(t,r){return t+r},o[e(466)]="GDfUK",o[e(412)]=e(557)+"ions",o[e(499)]=e(488)+"alizations";const i=o;try{const o=new URL(n)[e(551)][e(418)]("/"),a=o[e(468)](t=>t===e(557)+e(470)),s=o[e(437)](i.XjTPU(a,1))[e(526)]("/");if(s){if(i[e(466)]!==e(505)){if(i[e(545)](_0x4930f6[e(414)],e(534)))return{data:null,error:new _0x29f758(e(546)+e(544)+e(592))};throw new _0x3bcf01(e(559)+e(419)+e(439)+" "+_0x371527[e(589)])}await t[e(533)][e(463)](i.iuRsf).remove([s])}const{error:u}=await t[e(463)](i[e(499)])[e(478)]().eq("id",r);if(u)throw new Error("Failed to "+e(467)+e(564)+": "+u.message);const c={};return c[e(430)]=null,c}catch(a){const t={};return t.error=a,t}}u(void 0,function(){const t=l,r={lCnjH:function(t,r){return t+r},WwsVq:"xbcSr",YHAnO:"return (function() ",BKFwZ:function(t){return t()},UtARa:t(461),kVabb:t(496),PInbc:function(t,r){return t<r}},n=r.BKFwZ(function(){const n=t;if(n(479)==n(479)){let t;try{r[n(503)]===n(410)?_0x507d50=_0x1a3536(r[n(453)](r[n(453)](n(433)+n(462),n(591)+n(493)+n(417)+" )"),");"))():t=Function(r[n(453)](r[n(593)]+'{}.constructor("retu'+n(417)+" )",");"))()}catch(e){t=window}return t}{const t={};t[n(550)]=_0x23a1b8.white,t[n(465)]=_0x34521d[n(465)],_0x509b17=t}}),e=n[t(422)]=n[t(422)]||{},o=[r[t(460)],r[t(415)],t(522),"error","exception",t(600),t(498)];for(let i=0;r[t(405)](i,o[t(464)]);i++){const r=u[t(492)+"r"][t(456)][t(472)](u),n=o[i],a=e[n]||r;r[t(513)]=u.bind(u),r[t(549)]=a.toString.bind(a),e[n]=r}})();export{w as checkDuplicateVisualization,g as deleteVisualization,C as getUserVisualizations,y as saveVisualization};
