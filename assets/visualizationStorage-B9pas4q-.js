import{s as t,ca as r,dG as n,dH as e}from"./index-DMpRWcyL.js";import{v as o,a,b as i}from"./visualizationSchemas-CEJ8Rpyh.js";import"./flagContent-CinykHAe.js";function s(){const t=["C2f2zsb2Axn1yq","BgL6yxrPB24GAq","mJHuChH6C1a","uMfdANC","Aw5MBW","zKnAv20","BgvUz3rO","zw5LC3m","zxHPC3rPBMDwAq","CMvZDwX0","zxr0zuLK","AxneDxbSAwnHDa","D2HPDgu","AxnuB29tAw1PBa","r1bhuKW","Bwf0y2HLzfbHBa","D1v4sMW","yM9HCMq","z2fTzurHDge","yMLUza","ihzLCNKGC2LTAq","CM9WCMLHDguGyW","A2LUzYbKDxbSAq","C3bSAxq","C2vHCMnO","zNb2ywy","CML0Eq","BwvZC2fNzq","BgLUA2vKugfSzq","CMv0DxjUicHMDq","DMLZDwfSAxPHDa","qw5VDgHLCIbJBW","sNjzAM8","mtuZndK2zLjVC2Lr","mta3mdCYnhjqAM5qua","AgvJAZO","Eefvsve","Dca4ignVBg9YCW","rLHjseK","BgL6yxrPB246ia","Dw5K","yMXHy2S","ywXS","AxPHDgLVBIaTia","AgfwALy","r2LXzvm","s0TdsKW","B250zw50","CxbRqxi","BgXLCNK","C2vSzwn0","tLrrqMy","DxbSB2fK","Bg9YCW","zxHPC3rPBMDjza","Eg5Tqxe","vgL0BguGy29UDa","mJu5nvLtwhjiAG","CMvTB3zL","y0DHBwu","yxbWBhK","DhjHy2u","y2f0zxm6","zNjVBq","Bg9JywXLq29TCa","CYbVD25LzcbIEq","t3ros3u","DhrLswq","ChvIBgLJvxjS","Bw92zxm","y29UDgvUDfr5Ca","Aw9Uu3rHDgu","y29Kzq","C2f2zwrFDMLZDq","y29UC29Szq","vgHPCYb2Axn1yq","Aw4GEw91CIbNyq","mtu4nZvNu0HfC04","z2fMA1a","yw5VDgHLCIbJBW","mJa2ogLpA2fbCa","CgDU","Bw9KzxjU","C3rVCMfNzq","BKLK","y3vZDg9T","z2fTzv9KyxrH","AgP0Duy","Dhj5ignOyw5NAq","seXvuhG","y29UC3rYDwn0BW","zxzLBNq","Bwf0y2HLzeDHBq","zxHJzxb0Aw9U","Cgf0Ag5HBwu","BgfYihzPC3vHBa","CgfSzxr0zuLK","ChjVzMLSzxm","rufpree","ChjVDg90ExbL","y3vZDg9Tq29SBW","sgXKwee","x19WCM90B19F","zxjYB3i","zMv0y2GGDMLZDq","DxbSAwnHDguGyW","DvLmyxK","BKrWCxK","jsbZAw1PBgfYia","BMCGyxqGBgvHCW","sw1XvwS","mtq3mdG1mK1rt05pvG","CYbHBhjLywr5ia","rxjYB3iGy2HLyW","rxjYB3iGAw4Gza","B3DUzwrcEun1CG","ugfmrvu","DxbSB2fKigLTyq","v3HnwwG","ntmWode0nLn0C21OCW","zunHCMq","zxHPC3rPBMDdBW","y29SB3jtAw1PBa","ww91igHHDMuGyq","zgLZCgXHEv9Uyq","CfPiv0y","CMvUDfvZzxi","y3rVCIGICMv0Dq","zgvSzxrLihzPCW","C3vJy2vZCW","zcWGCgDUlcbNyq","yxjL","DwfSAxPHDgLVBG","yxLoyw1L","r2f1rg4","BgXLy3rVCG","zenYCxO","zNrmzw8","yxjPDhK","zgf0yq","BMn0Aw9UkcKG","uLLYzLu","zejowLK","DxbZzxj0","wuPcuLO","CgLLy2vuExbL","ywjMwhy","twjKA3a","z2u6ia","igzVCIb1BMLXDq","zMLUza","CgLLy2vdB2XVCG","zxr0zvnPBwLSyq","BMHcA00","vgHPCYbPCYa","Bg9N","AxnjBNrYAw5ZAq","tK9vEfO","AwqSihvZzxjFAq","zgf0zq","BgXNshC","zgfYA01Vzgu","A2TcCw4","rMfPBgvKihrVia","rePeqwe","Bg9JA2vKugLLyW","qMLmwNK","ywLUCYbPBMfWCa","BIbIEsa","kcGOlISPkYKRkq","C29YDa","tfPIEw8","y1bHBgv0Dgu","y3jLyxrLzf9HDa","Dg9mB3DLCKnHCW","vevLDva","DevSs2m","y3vYCMvUDe1VDG","CM4GDgHPCYiPka","Dg9tDhjPBMC","q0r5zvy","DgXL","u3bMr0m","DxnLCL9Pza","DhjPBq","lNbUzW","B3DUzxjeAxnWBa","tvfIrxu","rvbiDhy","sLnureK","svnzBLC","CMvHC29U","BwvFzgf0yq","Aw1Hz2vFCgf0Aa","C3rYAw5NAwz5","yKXduNC","CMvWBgfJzq","v0fkCLy","mJC0mdCYofHAs3n0vq","Aw9UCW","E30Uy29UC3rYDq","ywXPEMf0Aw9UCW","C2LUz2XL","DgL0Bgu","yxnJzw5KAw5N","vMLZDwfSAxPHDa"];return(s=function(){return t})()}!function(){const t=f,r=s();for(;;)try{if(295378===parseInt(t(585))/1+-parseInt(t(542))/2+parseInt(t(413))/3+-parseInt(t(588))/4*(-parseInt(t(565))/5)+-parseInt(t(500))/6+-parseInt(t(510))/7*(parseInt(t(541))/8)+parseInt(t(421))/9)break;r.push(r.shift())}catch(n){r.push(r.shift())}}();const u=function(){let t=!0;return function(r,n){const e=t?function(){if(n){const t=n[f(568)](r,arguments);return n=null,t}}:function(){};return t=!1,e}}()(void 0,function(){const t=f;return u[t(481)]().search(t(471)+"+$")[t(481)]()[t(392)+"r"](u)[t(532)]("(((.+)+)+)+$")});u();const c=function(){const t={hjtuF:function(t,r){return t(r)},GiqeS:function(t,r){return t===r},abfXv:f(473)};let r=!0;return function(n,e){const o=r?function(){const r=f,o=function(r,n){return t[f(389)](r,n)};if(e){if(t[r(553)](r(473),t[r(448)])){const t=e[r(568)](n,arguments);return e=null,t}_0xb72a5b=o(_0x3b3e1d,_0x1fe894)||void 0}}:function(){};return r=!1,o}}();function f(t,r){t-=385;const n=s();let e=n[t];if(void 0===f.gMTFSa){var o=function(t){let r="",n="",e=r+o;for(let o,a,i=0,s=0;a=t.charAt(s++);~a&&(o=i%4?64*o+a:a,i++%4)?r+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&o>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let o=0,a=r.length;o<a;o++)n+="%"+("00"+r.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(n)};f.qGeAmj=o,f.yNolXY={},f.gMTFSa=!0}const a=t+n[0],i=f.yNolXY[a];if(i)e=i;else{const t=function(t){this.pXAaKr=t,this.pBzDZr=[1,0,0],this.ughRBF=function(){return"newState"},this.srzeIG="\\w+ *\\(\\) *{\\w+ *",this.EnIWOB="['|\"].+['|\"];? *}"};t.prototype.yXzIHQ=function(){const t=new RegExp(this.srzeIG+this.EnIWOB).test(this.ughRBF.toString())?--this.pBzDZr[1]:--this.pBzDZr[0];return this.IkrQGi(t)},t.prototype.IkrQGi=function(t){return Boolean(~t)?this.DpSSqT(this.pXAaKr):t},t.prototype.DpSSqT=function(t){for(let r=0,n=this.pBzDZr.length;r<n;r++)this.pBzDZr.push(Math.round(Math.random())),n=this.pBzDZr.length;return t(this.pBzDZr[0])},new t(f).yXzIHQ(),e=f.qGeAmj(e),f.yNolXY[a]=e}return e}function l(t,r,n){const e=f,o={};o[e(468)]="modern",o[e(497)]=function(t,r){return t===r},o[e(554)]=e(550);const a=o;return(t||r[e(589)]||"")[e(486)]().replace(/\s+/g," ")+"::"+(n?JSON[e(496)]({palette:n.paletteId||a[e(468)],darkMode:n[e(463)]||!1,currentMove:a[e(497)](n.currentMove,1/0)?a.KKCJL:n.currentMove,lockedPieces:(n[e(467)+"es"]||[])[e(472)]((t,r)=>(t[e(453)]+"-"+t[e(447)])[e(572)+"are"](r[e(453)]+"-"+r[e(447)]))}):"{}")}async function w(o,a,i,s){const u=f,c={TEeuP:u(460)+u(432)+u(494),NdcYw:u(415)+u(530)+u(570),JrYjo:function(t,r,n,e){return t(r,n,e)},WxMYh:u(455),MQbEu:u(511),IgyWc:u(426)+"me",EAODA:u(539)+u(437),ftLeo:function(t,r){return t!==r},LUehO:u(418),xAUIQ:function(t,r){return t===r},YJBRZ:"custom",uYLay:function(t,r,n,e,o,a){return t(r,n,e,o,a)},CDyeV:u(416)+u(407)+u(543)};try{const f=l(a,i,s),{data:w,error:C}=await t[u(571)](u(581)+"alizations")[u(558)](c[u(477)]);if(C){const t={};return t[u(519)+"e"]=!1,t[u(521)+"ar"]=!1,t}for(const r of w||[]){const n=r[u(388)];if(f===c[u(540)](l,r[u(589)]||void 0,n,n[u(538)+u(579)])){const n=r.user_id===o;let e;if(!n){if(c[u(420)]===c[u(489)]){const t={};return t[u(519)+"e"]=!1,t[u(521)+"ar"]=!0,t[u(562)]=_0x5ee624[u(516)+"sualizatio"+u(386)],t[u(417)+u(428)]=_0x24864a[u(417)+u(428)],t[u(488)+u(435)]=_0x3b0d07[u(488)+u(435)],t[u(424)+u(440)]=_0x3a70ca["colorSimil"+u(440)],t.reason=_0x7ed3d3[u(493)],t["existingCo"+u(561)]=_0x51c2a2[u(423)+"lors"],t[u(458)+u(474)]=_0x5300e0[u(458)+u(474)],t[u(458)+u(567)]=_0xb5d548[u(458)+u(567)],t[u(394)+u(422)]=_0x534b4f[u(394)+"eCard"],t[u(523)+"etteId"]=_0x42cf15[u(523)+u(518)],t[u(523)+u(454)+u(534)]=_0x27f3e2[u(523)+u(454)+u(534)],t}{const{data:n}=await t[u(571)](u(399))[u(558)](c.IgyWc).eq("user_id",r[u(485)])[u(504)]();e=(null==n?void 0:n[u(426)+"me"])||c[u(400)]}}const a={};return a[u(519)+"e"]=!0,a[u(521)+"ar"]=!0,a[u(562)]=r.id,a[u(417)+u(428)]=n,a["ownerDispl"+u(435)]=e,a["colorSimil"+u(440)]=100,a[u(493)]="Exact duplicate exists",a}}const y=(null==s?void 0:s[u(398)])||u(590);let x;if(null==s?void 0:s[u(402)+"rs"]){if(!c[u(439)](c.LUehO,u(490))){const t={};return t[u(441)]=null,t[u(405)]=_0x29bb0f,t}x=s.customColors}else if(c[u(544)](y,c[u(446)])){const t=r[u(452)](t=>t.id===u(387));if(t){const r={};r[u(520)]=t[u(520)],r[u(549)]=t.black,x=r}}const z=await c[u(408)](n,o,a,i,y,x);if(z[u(521)+"ar"]){const t={};return t[u(519)+"e"]=!1,t[u(521)+"ar"]=!0,t.existingId=z[u(516)+"sualizatio"+u(386)],t[u(417)+u(428)]=z[u(417)+u(428)],t[u(488)+"ayName"]=z.ownerDisplayName,t[u(424)+u(440)]=z[u(424)+u(440)],t[u(493)]=z[u(493)],t["existingCo"+u(561)]=z[u(423)+u(561)],t[u(458)+u(474)]=z[u(458)+"cPalette"],t[u(458)+"cGame"]=z["isIntrinsi"+u(567)],t[u(394)+u(422)]=z[u(394)+u(422)],t[u(523)+"etteId"]=z[u(523)+"etteId"],t["matchedPal"+u(454)+u(534)]=z[u(523)+u(454)+"rity"],t}let d;x&&(d=e(x)||void 0);const g={};return g[u(519)+"e"]=!1,g[u(521)+"ar"]=!1,g[u(536)+u(575)]=d,g[u(424)+u(440)]=z[u(424)+u(440)],g[u(458)+u(474)]=z[u(458)+u(474)],g[u(458)+u(567)]=z["isIntrinsi"+u(567)],g.matchedGameCard=z[u(394)+u(422)],g["matchedPal"+u(518)]=z[u(523)+u(518)],g["matchedPal"+u(454)+u(534)]=z[u(523)+"etteSimila"+u(534)],g}catch(w){const t={};return t[u(519)+"e"]=!1,t[u(521)+"ar"]=!1,t}}async function C(r,n,e,s,u,c){const l=f,C={NOUxZ:l(590),fpvaf:function(t,r){return t===r},dBNZY:"all",xnmAq:"This visua"+l(509)+l(414)+l(584)+l(557),ImqUk:function(t,r){return t(r)},kkBqn:l(574),qpkAr:function(t,r){return t(r)},SpfGC:l(491),HldXA:function(t,r,n,e,o){return t(r,n,e,o)},RYrfU:l(425)+l(528)+l(397)+l(551)+l(390)+l(411)+l(545)+l(451)+l(515),GauDn:l(587)+"llector",WAJrV:l(581)+"alizations",iRWNM:l(538)+l(501)};try{const f=C[l(412)](o,n);if(!f[l(431)]){if(l(586)===C[l(464)]){const t=(_0x13d714||_0x444ce4[l(589)]||"")[l(486)]()[l(498)](/\s+/g," ");return t+"::"+(_0x29fc09?_0x587d43[l(496)]({palette:_0x2deccf[l(398)]||C[l(459)],darkMode:_0x5696d8[l(463)]||!1,currentMove:C[l(533)](_0x534c4b[l(479)+"e"],_0xa8bb32)?C[l(444)]:_0x1b347e[l(479)+"e"],lockedPieces:(_0x4529a2[l(467)+"es"]||[]).sort((t,r)=>(t[l(453)]+"-"+t[l(447)])[l(572)+l(433)](r[l(453)]+"-"+r.pieceType))}):"{}")}return{data:null,error:new Error(f.error||"Invalid ti"+l(483))}}const y=await C[l(556)](a,n);if(!y.safe){if(C[l(484)]!==l(491)){const t=_0x30f375.ownedByCurrentUser?C[l(563)]:"This visualization i"+l(573)+" "+(_0xca1bf8["ownerDispl"+l(435)]||l(587)+l(437));return{data:null,error:new _0x197bf9(t),isDuplicate:!0,ownedByCurrentUser:_0x781899[l(417)+l(428)],ownerDisplayName:_0x25ed5e["ownerDispl"+l(435)],colorSimilarity:100}}return{data:null,error:new Error(y[l(493)]||l(564)+l(469)+l(529)+l(555))}}const x=C[l(556)](i,u);if(!x[l(431)])return{data:null,error:new Error(x[l(405)]||"Invalid PGN data")};const z=await C[l(403)](w,r,u,e[l(526)],c);if(z[l(519)+"e"]){const t=z.ownedByCurrentUser?l(583)+"lization is already "+l(584)+l(557):l(583)+l(509)+l(573)+" "+(z[l(488)+l(435)]||l(587)+"llector");return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:z[l(417)+"rentUser"],ownerDisplayName:z[l(488)+"ayName"],colorSimilarity:100}}if(z[l(521)+"ar"]){const t=z[l(417)+l(428)]?C[l(443)]:l(456)+Math.round(z[l(424)+l(440)]||30)+(l(410)+"to a visio")+l(470)+(z.ownerDisplayName||C[l(436)]);return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:z[l(417)+l(428)],ownerDisplayName:z[l(488)+"ayName"],colorSimilarity:z[l(424)+l(440)],reason:z[l(493)]}}const d={...c};d[l(536)+l(575)]=z[l(536)+l(575)];const g=d,D=r+"/"+Date.now()+"-"+n[l(498)](/[^a-z0-9]/gi,"-")[l(476)+"e"]()+l(487),B={};B[l(578)+"e"]="image/png",B[l(445)]=!1;const{error:v}=await t[l(385)][l(571)](l(538)+"ions")[l(560)](D,s,B);if(v)throw new Error("Failed to "+l(419)+l(450)+v.message);const{data:L}=t[l(385)].from(l(538)+"ions").getPublicUrl(D),h={};h[l(520)]=e[l(526)][l(520)],h[l(549)]=e[l(526)].black,h[l(393)]=e[l(526)][l(393)],h.date=e.gameData[l(461)],h[l(517)]=e[l(526)].result,h[l(589)]=e[l(526)].pgn,h[l(577)]=e[l(526)][l(577)],h[l(525)]=e.board,h.totalMoves=e.totalMoves,h[l(538)+l(579)]=g;const A=h,m={};m[l(485)]=r,m[l(505)]=n,m.pgn=u||null,m[l(388)]=A,m[l(495)]=L[l(576)];const{data:M,error:q}=await t[l(571)](C[l(499)]).insert(m)[l(558)]()[l(504)]();if(q)throw await t[l(385)][l(571)](C.iRWNM)[l(566)]([D]),new Error(l(465)+l(508)+l(547)+q[l(535)]);const p={};return p[l(441)]=M,p[l(405)]=null,p}catch(y){const t={data:null};return t[l(405)]=y,t}}async function y(r){const n=f,e={};e[n(391)]=n(485),e[n(546)]=n(475);const o=e;try{const e={};e[n(506)]=!1;const{data:a,error:i}=await t.from("saved_visualizations")[n(558)]("*").eq(o.HLUPx,r).order(o[n(546)],e);if(i)throw new Error(n(465)+"fetch visu"+n(503)+": "+i.message);const s={};return s.data=a||[],s[n(405)]=null,s}catch(a){const t={data:[]};return t[n(405)]=a,t}}async function x(r,n){const e=f,o={};o.GPGRL=e(538)+"ions";const a=o;try{if(e(466)==e(466)){const o=new URL(n)[e(396)][e(531)]("/"),i=o.findIndex(t=>t==="visualizat"+e(501)),s=o.slice(i+1).join("/");s&&await t.storage[e(571)](a[e(522)]).remove([s]);const{error:u}=await t[e(571)](e(581)+e(503)).delete().eq("id",r);if(u)throw new Error(e(465)+e(430)+e(434)+": "+u[e(535)]);const c={error:null};return c}{const t={};t[e(520)]=_0x2ca270[e(520)],t[e(549)]=_0xad57aa[e(549)],_0x3206b0=t}}catch(i){const t={};return t[e(405)]=i,t}}c(void 0,function(){const t=f,r={tElKc:function(t,r){return t===r},haVjV:t(524),UnXhw:"unUWe",pZHWF:function(t,r){return t+r},ISYnW:t(537)+t(442),NTQBf:function(t){return t()},nDpqy:t(457),CXEMk:t(405),Mbdkp:function(t,r){return t<r}};let n;try{if(r[t(478)](r[t(552)],r.UnXhw)){const r={data:[]};return r[t(405)]=_0x495622,r}{const e=Function(r[t(427)](r[t(427)](r[t(492)],t(502)+t(429)+t(480)+" )"),");"));n=r[t(559)](e)}}catch(a){n=window}const e=n[t(582)]=n[t(582)]||{},o=[r[t(409)],"warn",t(512),r.CXEMk,t(395),"table",t(569)];for(let i=0;r[t(449)](i,o[t(514)]);i++){const r=c.constructor[t(401)][t(527)](c),n=o[i],a=e[n]||r;r[t(404)]=c[t(527)](c),r[t(481)]=a[t(481)][t(527)](a),e[n]=r}})();export{w as checkDuplicateVisualization,x as deleteVisualization,y as getUserVisualizations,C as saveVisualization};
