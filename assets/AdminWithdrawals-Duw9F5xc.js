import{s as e,u as t,a as s,r,j as n,L as a,C as c,x as i,b7 as o,B as l,A as d,cb as u,cR as h,a8 as m,D as x,aB as p,aC as f,aD as v,aE as j,p as w,t as y,w as g,dy as C,dt as N,bo as b,dq as q,cZ as z,a1 as B,a2 as D,a3 as L,a4 as M,a5 as _,aW as A,bC as P,dz as W,b as S,y as H}from"./index-f_XxDhCa.js";import{C as I}from"./calendar-B9pyoyP3.js";function K(e,t){e-=236;const s=U();let r=s[e];if(void 0===K.TruTfZ){var n=function(e){let t="",s="",r=t+n;for(let n,a,c=0,i=0;a=e.charAt(i++);~a&&(n=c%4?64*n+a:a,c++%4)?t+=r.charCodeAt(i+10)-10!=0?String.fromCharCode(255&n>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let n=0,a=t.length;n<a;n++)s+="%"+("00"+t.charCodeAt(n).toString(16)).slice(-2);return decodeURIComponent(s)};K.oioTet=n,K.ZojaMA={},K.TruTfZ=!0}const a=e+s[0],c=K.ZojaMA[a];if(c)r=c;else{const e=function(e){this.UxhXlJ=e,this.dvuPBy=[1,0,0],this.aMduZX=function(){return"newState"},this.VyaMAl="\\w+ *\\(\\) *{\\w+ *",this.NIvMgB="['|\"].+['|\"];? *}"};e.prototype.PnQRMX=function(){const e=new RegExp(this.VyaMAl+this.NIvMgB).test(this.aMduZX.toString())?--this.dvuPBy[1]:--this.dvuPBy[0];return this.StYYpq(e)},e.prototype.StYYpq=function(e){return Boolean(~e)?this.zgSeJN(this.UxhXlJ):e},e.prototype.zgSeJN=function(e){for(let t=0,s=this.dvuPBy.length;t<s;t++)this.dvuPBy.push(Math.round(Math.random())),s=this.dvuPBy.length;return e(this.dvuPBy[0])},new e(K).PnQRMX(),r=K.oioTet(r),K.ZojaMA[a]=r}return r}!function(){const e=K,t=U();for(;;)try{if(805980===parseInt(e(324))/1+parseInt(e(285))/2+parseInt(e(328))/3+-parseInt(e(293))/4+parseInt(e(348))/5+-parseInt(e(268))/6+-parseInt(e(318))/7)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const k=function(){let e=!0;return function(t,s){const r=e?function(){if(s){const e=s[K(340)](t,arguments);return s=null,e}}:function(){};return e=!1,r}}()(void 0,function(){const e=K,t={};t.FmmPH=e(281)+"+$";const s=t;return k[e(346)]().search(e(281)+"+$").toString()[e(249)+"r"](k)[e(316)](s[e(274)])});k();const R=function(){let e=!0;return function(t,s){const r=K,n={};n[r(309)]=r(332);const a=n,c=e?function(){const e=r;if(s){if(a[e(309)]!==e(326)){const r=s[e(340)](t,arguments);return s=null,r}{const t={};return t[e(312)]=!1,t[e(243)]=_0x587edf,t}}}:function(){};return e=!1,c}}();function U(){const e=["sgHowuK","Aw52B2TL","CgvUzgLUzW","ue1dBhu","yxbWCM92zwq","zhD3q28","r1H4vfq","CMvQzwn0zwq","yxbWCM92zwrFyW","B0nqsg0","CMvQzwn0zwrFyW","uM9yvhy","rwjLDuC","C2vSzwn0","DgfIBgu","C3vJy2vZCW","rxj3thi","rxvsq0S","C0HOrKy","C2vHCMnO","yMP6yLu","mtG4nZy2mZrSAu54rvC","B3rHBf9LyxjUzq","C0zcyNa","ChjVy2vZCY13Aq","yMLUza","DLPtr28","mte4mteZm2nLvvrNza","y29TCgXLDgvKxW","yuP6rfa","rNrxy0q","mJC0nJqWmxrHsvzXta","svf0Auq","zuTkDLi","DxnLCL93ywXSzq","q2Xvsgy","BgvUz3rO","y29UC29Szq","Dg90ywW","ig5VDcbPBIbHCa","seD4t0m","DgLJyxrLza","ExjysNi","yxbWBhK","BxD3qxe","x3jLCxvLC3rZ","B3vUDa","zwrFy2vUDhm","zf9Jzw50CYWGDa","Dg9tDhjPBMC","zM9YrwfJAa","nZqWmte4mhDVr3ncza","CgvUzgLUz19JBW","DxnLCL9Pza","z2v0vxnLCG","DfrRv1y","q1PXs1a","qKrTt2K","yw1VDw50x2nLBG","BNnbDxC","q0XRtNa","BwfW","zxjYB3i","DcbMB3vUzcbVCG","DhjHy2u","C3rHDhvZ","tM90igf1DgHLBG","v2fSBgv0ihvWza","y29UC3rYDwn0BW","q2Lczfu","yxrLigvYCM9YoG","Dg9ju09tDhjPBG","sxPmrNq","D2L0AgrYyxDHBa","ywrTAw5FBM90zq","yLnOvNm","BMn0Aw9UkcKG","x19WCM90B19F","Dw50","DxbKyxrL","z2v0","CMf3BL9Jzw50CW","zgLZCgXHEv9Uyq","yM9KEq","Bg9N","zNvUy3rPB25Z","zNjVBq","mtqWotq0mLHWDMnPAW","D2fYBG","yxnJzw5KAw5N","zhjHD25Fy2vUDa","zgf0yq","DhvZ","rM1TueG","ChjVDMvKihn0yq","DxnLCL9PzcWGza","y29TCgXLDgvK","uMvQzwn0Aw9Uia","yxv0Aa","Eg1fDhi","kcGOlISPkYKRkq","B3jKzxi","DgHKCMf3ywW","sNLIqNa","mJa2ntuWohv1vvDTDq","ChjVzMLSzxm","vw5RBM93BIbvCW","z3jWvu0","B3vUDf9Jzw50CW","zvnothi","B3LKELm","BvfhC08","mZq4ode2nhrcy0rJrq","E30Uy29UC3rYDq","Bw91BNq","vhbVvxq"];return(U=function(){return e})()}async function Y(t){const s=K,r={};r[s(341)]=s(254)+s(342),r[s(320)]="created_at",r[s(323)]=function(e,t){return e!==t},r.oSqiG=s(246),r[s(236)]=s(286),r[s(314)]=s(276)+"isplay_name",r[s(240)]=s(331)+"ts",r[s(300)]="user_id, t"+s(319)+s(345)+"otal_withd"+s(262),r.oCPHm=s(329),r[s(337)]="EINxr";const n=r;try{const r={};r[s(270)]=!1;let a=e.from(n[s(341)])[s(310)]("*")[s(282)](n[s(320)],r);t&&n[s(323)](t,"all")&&(a=a.eq(n.oSqiG,t));const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[])[s(242)](e=>e[s(350)]))],{data:l}=await e[s(267)](n.tTkWV)[s(310)](n.EuRCK).in("user_id",o),{data:d}=await e[s(267)](n.nsAuw)[s(310)](n.PMClu).in(s(350),o),u=new Map((null==l?void 0:l.map(e=>[e[s(350)],e]))||[]),h=new Map((null==d?void 0:d.map(e=>[e[s(350)],e]))||[]),m=(c||[])[s(242)](e=>{var t,r,n;return{...e,payout_details:e.payout_details,user_display_name:(null==(t=u[s(261)](e[s(350)]))?void 0:t[s(263)+"me"])||s(287)+"er",wallet_total_earned:(null==(r=h[s(261)](e[s(350)]))?void 0:r["total_earn"+s(344)])||0,wallet_total_withdrawn:(null==(n=h[s(261)](e.user_id))?void 0:n["total_with"+s(271)+"s"])||0}}),x={};return x.data=m,x[s(243)]=null,x}catch(a){if(n[s(306)]!==n.HGxOC){const e={data:[]};return e[s(243)]=a,e}_0x1c40a3=_0x142465}}async function Z(){const t=K,s={};s[t(302)]=t(299),s[t(288)]=t(301),s[t(284)]="completed";const r=s;try{const{data:s,error:n}=await e[t(267)](t(254)+t(342))[t(310)]("status, am"+t(289));if(n)throw n;const a={};a[t(349)+t(259)]=0,a["pending_am"+t(343)]=0,a["approved_c"+t(343)]=0,a["approved_a"+t(295)]=0,a[t(325)+"total"]=0,a[t(307)+t(343)]=0;const c=a;(s||[])[t(347)](e=>{const s=t;switch(e[s(246)]){case r[s(302)]:c.pending_count++,c["pending_am"+s(343)]+=e[s(239)+"ts"];break;case r.grpUM:c[s(305)+s(343)]++,c["approved_a"+s(295)]+=e.amount_cents;break;case r[s(284)]:c[s(325)+s(335)]+=e.amount_cents;break;case s(304):c[s(307)+s(343)]++}});const i={};return i[t(272)]=c,i[t(243)]=null,i}catch(n){const e={};return e[t(272)]=null,e[t(243)]=n,e}}R(void 0,function(){const e=K,t={FtWcD:function(e,t){return e+t},eKJvR:"return (fu"+e(257),TpoUt:e(294)+'ctor("return this")( )',dPZCf:function(e){return e()},CiBdU:"exception",CZqKP:function(e,t){return e<t}},s=t.dPZCf(function(){const s=e;let r;try{r=Function(t[s(327)](t[s(330)],t[s(296)])+");")()}catch(n){r=window}return r}),r=s[e(334)]=s[e(334)]||{},n=[e(265),e(269),"info","error",t[e(250)],e(311),e(245)];for(let a=0;t[e(237)](a,n[e(333)]);a++){const t=R.constructor.prototype[e(322)](R),s=n[a],c=r[s]||t;t[e(258)]=R[e(322)](R),t[e(346)]=c.toString[e(322)](c),r[s]=t}})(),function(){const e=E,t=T();for(;;)try{if(324069===parseInt(e(375))/1*(-parseInt(e(351))/2)+-parseInt(e(338))/3+-parseInt(e(364))/4*(parseInt(e(339))/5)+-parseInt(e(333))/6*(parseInt(e(342))/7)+parseInt(e(388))/8+-parseInt(e(336))/9+parseInt(e(374))/10)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const J=function(){let e=!0;return function(t,s){const r=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,r}}()(void 0,function(){const e=E,t={};t[e(335)]=e(356)+"+$";const s=t;return J[e(363)]()[e(365)](s[e(335)]).toString()[e(396)+"r"](J).search(e(356)+"+$")});J();const G=function(){let e=!0;return function(t,s){const r=e?function(){if(s){const e=s[E(366)](t,arguments);return s=null,e}}:function(){};return e=!1,r}}();function T(){const e=["C3vJy2vZCW","zxjYB3i","DhjHy2u","mtq2nZqYquH2rLHc","AMXAthu","Aw5MBW","Cf91C2vYx2LK","Ag1tALK","kcGOlISPkYKRkq","tMfZsw8","y29UC29Szq","DgfIBgu","x19WCM90B19F","CM4GDgHPCYiPka","yxnJzw5KAw5N","Dg9tDhjPBMC","mtG3ntiYmfruvvPQtq","C2vHCMnO","yxbWBhK","BgLTAxq","zLDjrKK","tM90igf1DgHLBG","vw5fALG","E30Uy29UC3rYDq","zvzWCvC","ChjVy2vZC19Tyq","mtC2ndCYnZbbBhLHwgW","mLnezxrcrW","zgf0yq","yxv0Aa","qLbjr1y","Dg9gAxHLza","Chryr3a","qNjJBMq","z2v0x29Yx2nYzq","ChjVDg90ExbL","BgvUz3rO","y3rVCIGICMv0Dq","BNnHy3rPB25Z","sgH5vxK","mJKZotG1nMjzzufsBa","B3jKzxi","wwjYBfC","vLfPwvC","yMLUza","y2vFy2vUDhm","zNjVBq","DvndCMO","y29UC3rYDwn0BW","zK9wsgO","t2fivhK","B1rMu2O","yM5nvgy","CNbJ","DgLJyxrLza","C2fSzq","Cf9ZywXLx3bYAq","nLfbDfbLAa","vKviuwq","Be5sAe0","ntiWodq3mw5nALjIAW","D2fYBG","mJeYotK0DhvxCKrn","nxjnwxP1DG","Cf9IDxLLCL9Pza","BLHVDLe","mZGWmdeZmKHJtKf5Aa","y3jLyxrLzf9HDa","r3bNq3K","z2v0vxnLCG","Cf9SAxn0Aw5NxW","zhvQtKu"];return(T=function(){return e})()}function E(e,t){e-=328;const s=T();let r=s[e];if(void 0===E.mIeVES){var n=function(e){let t="",s="",r=t+n;for(let n,a,c=0,i=0;a=e.charAt(i++);~a&&(n=c%4?64*n+a:a,c++%4)?t+=r.charCodeAt(i+10)-10!=0?String.fromCharCode(255&n>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let n=0,a=t.length;n<a;n++)s+="%"+("00"+t.charCodeAt(n).toString(16)).slice(-2);return decodeURIComponent(s)};E.vWACLQ=n,E.zxZffx={},E.mIeVES=!0}const a=e+s[0],c=E.zxZffx[a];if(c)r=c;else{const e=function(e){this.iwpPxC=e,this.oPQJkR=[1,0,0],this.EHwdLT=function(){return"newState"},this.QmchuF="\\w+ *\\(\\) *{\\w+ *",this.YeYGSa="['|\"].+['|\"];? *}"};e.prototype.aHSovA=function(){const e=new RegExp(this.QmchuF+this.YeYGSa).test(this.EHwdLT.toString())?--this.oPQJkR[1]:--this.oPQJkR[0];return this.MpBIpp(e)},e.prototype.MpBIpp=function(e){return Boolean(~e)?this.OWMTHO(this.iwpPxC):e},e.prototype.OWMTHO=function(e){for(let t=0,s=this.oPQJkR.length;t<s;t++)this.oPQJkR.push(Math.round(Math.random())),s=this.oPQJkR.length;return e(this.oPQJkR[0])},new e(E).aHSovA(),r=E.vWACLQ(r),E.zxZffx[a]=r}return r}function V(e){return"$"+(e/100)[E(379)](2)}function O(){var k,R;const{user:U}=t(),J=s(),[G,T]=r.useState(!1),[E,O]=r.useState(!0),[Q,X]=r.useState([]),[F,$]=r.useState(null),[ee,te]=r.useState("pending"),[se,re]=r.useState({type:null,request:null}),[ne,ae]=r.useState(""),[ce,ie]=r.useState(!1);r.useEffect(()=>{oe()},[U]);const oe=async()=>{if(!U)return void O(!1);const{data:t}=await e.rpc("has_role",{_user_id:U.id,_role:"admin"});!0===t&&(T(!0),await le()),O(!1)},le=async()=>{const[e,t]=await Promise.all([Y(ee),Z()]);e.data&&X(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return n.jsxs(H,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[n.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return n.jsxs(H,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[n.jsx(h,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return n.jsxs(H,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[n.jsx(h,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return n.jsxs(H,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[n.jsx(x,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return n.jsxs(H,{variant:"outline",className:"bg-muted text-muted-foreground",children:[n.jsx(x,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return n.jsx(H,{variant:"outline",children:e})}};return E?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):U&&G?n.jsx("div",{className:"min-h-screen bg-background",children:n.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[n.jsx(l,{variant:"ghost",size:"icon",onClick:()=>J(-1),children:n.jsx(d,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),n.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),F&&n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[n.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:n.jsxs(i,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[n.jsx(u,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm",children:"Pending"})]}),n.jsx("p",{className:"text-2xl font-bold",children:F.pending_count}),n.jsx("p",{className:"text-sm text-muted-foreground",children:V(F.pending_amount)})]})}),n.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:n.jsxs(i,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[n.jsx(h,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm",children:"Approved"})]}),n.jsx("p",{className:"text-2xl font-bold",children:F.approved_count}),n.jsx("p",{className:"text-sm text-muted-foreground",children:V(F.approved_amount)})]})}),n.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:n.jsxs(i,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[n.jsx(m,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm",children:"Total Paid"})]}),n.jsx("p",{className:"text-2xl font-bold",children:V(F.completed_total)})]})}),n.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:n.jsxs(i,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[n.jsx(x,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm",children:"Rejected"})]}),n.jsx("p",{className:"text-2xl font-bold",children:F.rejected_count})]})})]}),n.jsxs(p,{value:ee,onValueChange:e=>{te(e),le()},children:[n.jsxs(f,{className:"mb-6",children:[n.jsx(v,{value:"pending",children:"Pending"}),n.jsx(v,{value:"approved",children:"Approved"}),n.jsx(v,{value:"completed",children:"Completed"}),n.jsx(v,{value:"rejected",children:"Rejected"}),n.jsx(v,{value:"all",children:"All"})]}),n.jsx(j,{value:ee,children:n.jsxs(c,{children:[n.jsxs(w,{children:[n.jsx(y,{children:"Withdrawal Requests"}),n.jsxs(g,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),n.jsx(i,{children:0===Q.length?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(C,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):n.jsx(N,{className:"h-[500px]",children:n.jsx("div",{className:"space-y-4",children:Q.map(e=>{var t;return n.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:n.jsx(b,{className:"h-5 w-5 text-primary"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:e.user_display_name}),n.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[n.jsx(q,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),n.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[n.jsx(I,{className:"h-3 w-3"}),z(new Date(e.created_at),{addSuffix:!0})]}),n.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",V(e.wallet_total_earned||0)]})]}),e.admin_notes&&n.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[n.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),n.jsxs("div",{className:"flex flex-col items-end gap-2",children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:V(e.amount_cents)}),n.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&n.jsxs(n.Fragment,{children:[n.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>re({type:"approve",request:e}),children:[n.jsx(h,{className:"h-4 w-4 mr-1"}),"Approve"]}),n.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>re({type:"reject",request:e}),children:[n.jsx(x,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&n.jsxs(l,{size:"sm",onClick:()=>re({type:"complete",request:e}),children:[n.jsx(h,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),n.jsx(B,{open:!!se.type,onOpenChange:()=>re({type:null,request:null}),children:n.jsxs(D,{children:[n.jsxs(L,{children:[n.jsxs(M,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),n.jsxs(_,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:se.request.user_display_name}),n.jsx("p",{className:"text-sm text-muted-foreground",children:null==(k=se.request.payout_details)?void 0:k.email})]}),n.jsx("p",{className:"text-xl font-bold text-green-600",children:V(se.request.amount_cents)})]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),n.jsx(A,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:ne,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&n.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[n.jsx(P,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),n.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",n.jsx("strong",{children:null==(R=se.request.payout_details)?void 0:R.email})]})]})]}),n.jsxs(W,{children:[n.jsx(l,{variant:"outline",onClick:()=>re({type:null,request:null}),disabled:ce,children:"Cancel"}),n.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const r=K,n={};n[r(253)]=r(247)+r(338),n[r(292)]="approved",n.bShVs=function(e,t){return e||t},n[r(241)]=r(246),n[r(291)]=r(299);const a=n;try{const{data:{user:n}}=await e[r(279)][r(351)]();if(!n)throw new Error(a[r(253)]);const{error:c}=await e[r(267)](r(254)+r(342))[r(260)]({status:a[r(292)],admin_notes:a[r(256)](s,null),reviewed_by:n.id,reviewed_at:(new Date)[r(252)+"g"]()}).eq("id",t).eq(a[r(241)],a.oydzS);if(c)throw c;const i={success:!0};return i[r(243)]=null,i}catch(c){const e={};return e[r(312)]=!1,e.error=c,e}}(se.request.id,ne),t.success&&S.success("Withdrawal approved");break;case"reject":if(!ne.trim())return S.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const r=K,n={};n[r(290)]=r(304),n[r(308)]=r(246),n[r(238)]=r(299);const a=n;try{const{data:{user:n}}=await e[r(279)][r(351)]();if(!n)throw new Error("Not authen"+r(338));if(!s)throw new Error(r(278)+"reason is required");const{error:c}=await e.from(r(254)+r(342))[r(260)]({status:a[r(290)],admin_notes:s,reviewed_by:n.id,reviewed_at:(new Date)[r(252)+"g"]()}).eq("id",t).eq(a[r(308)],a[r(238)]);if(c)throw c;const i={};return i[r(312)]=!0,i[r(243)]=null,i}catch(c){const e={};return e[r(312)]=!1,e[r(243)]=c,e}}(se.request.id,ne),t.success&&S.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const r=K,n={};n.GXxTT=r(247)+"ticated",n[r(315)]=r(254)+"_requests",n[r(317)]=r(301),n.yrXJr=function(e,t){return e||t},n[r(280)]="Request no"+r(244)+r(336)+r(275)+r(273),n.HhNYI=r(277),n.ErwLr=r(248)+r(251);const a=n;try{const{data:{user:n}}=await e[r(279)].getUser();if(!n)throw new Error(a[r(303)]);const{data:c,error:i}=await e.from(a[r(315)])[r(310)]("*").eq("id",t).eq(r(246),a.bjzbU).single();if(a[r(339)](i,!c))throw new Error(a[r(280)]);const{error:o}=await e[r(267)](a[r(315)])[r(260)]({status:a[r(297)],admin_notes:s?(c[r(255)+"s"]||"")+"\n---\n"+s:c[r(255)+"s"],completed_at:(new Date)[r(252)+"g"]()}).eq("id",t);if(o)throw o;const l={};l.request_id=t,l[r(350)]=c.user_id,l[r(239)+"ts"]=c.amount_cents;const d={};d[r(264)]=l;const{error:u}=await e[r(266)][r(298)](r(321)+r(283),d),h={};return h[r(312)]=!0,h.error=null,h}catch(c){const e={};return e[r(312)]=!1,e[r(243)]=c,e}}(se.request.id,ne),t.success&&S.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?S.error(t.error.message):(re({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!ne.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&n.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):n.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:n.jsx(c,{className:"max-w-md w-full",children:n.jsxs(i,{className:"pt-6 text-center",children:[n.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),n.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),n.jsx(l,{onClick:()=>J("/"),children:"Go Home"})]})})})}G(void 0,function(){const e=E,t={};t[e(397)]=function(e,t){return e+t},t[e(372)]="return (function() ",t[e(387)]=e(371)+e(385)+e(361)+" )",t[e(352)]=e(344),t[e(395)]=e(353),t[e(357)]=e(359),t[e(398)]=function(e,t){return e<t};const s=t;let r;try{r=Function(s[e(397)](s[e(372)],s[e(387)])+");")()}catch(c){if(s[e(352)]===e(347)){const t=_0x4bff9d[e(366)](_0x493216,arguments);return _0xdc1181=null,t}r=window}const n=r[e(358)]=r[e(358)]||{},a=["log",e(337),s[e(395)],e(349),"exception",s[e(357)],e(350)];for(let i=0;s.OaHTy(i,a[e(384)]);i++){const t=G.constructor[e(383)][e(392)](G),s=a[i],r=n[s]||t;t[e(360)]=G[e(392)](G),t[e(363)]=r[e(363)][e(392)](r),n[s]=t}})();export{O as default};
