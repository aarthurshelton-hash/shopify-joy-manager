import{s as t,ca as r,dG as n,dH as e}from"./index-Ddz_gr3U.js";import{v as o,a as i,b as a}from"./visualizationSchemas-B4757bXq.js";import"./flagContent-BSICJ548.js";function c(t,r){t-=227;const n=f();let e=n[t];if(void 0===c.LcrZmN){var o=function(t){let r="",n="",e=r+o;for(let o,i,a=0,c=0;i=t.charAt(c++);~i&&(o=a%4?64*o+i:i,a++%4)?r+=e.charCodeAt(c+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=r.length;o<i;o++)n+="%"+("00"+r.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(n)};c.ErGDda=o,c.jbWtSs={},c.LcrZmN=!0}const i=t+n[0],a=c.jbWtSs[i];if(a)e=a;else{const t=function(t){this.bGieoQ=t,this.iWSBlZ=[1,0,0],this.RaUWol=function(){return"newState"},this.tboups="\\w+ *\\(\\) *{\\w+ *",this.oKmCQj="['|\"].+['|\"];? *}"};t.prototype.EEKkXR=function(){const t=new RegExp(this.tboups+this.oKmCQj).test(this.RaUWol.toString())?--this.iWSBlZ[1]:--this.iWSBlZ[0];return this.ZdvKvI(t)},t.prototype.ZdvKvI=function(t){return Boolean(~t)?this.HdulYN(this.bGieoQ):t},t.prototype.HdulYN=function(t){for(let r=0,n=this.iWSBlZ.length;r<n;r++)this.iWSBlZ.push(Math.round(Math.random())),n=this.iWSBlZ.length;return t(this.iWSBlZ[0])},new t(c).EEKkXR(),e=c.ErGDda(e),c.jbWtSs[i]=e}return e}!function(){const t=c,r=f();for(;;)try{if(420787===parseInt(t(420))/1+parseInt(t(236))/2*(parseInt(t(312))/3)+parseInt(t(370))/4+parseInt(t(363))/5+-parseInt(t(337))/6+parseInt(t(396))/7*(-parseInt(t(361))/8)+parseInt(t(313))/9)break;r.push(r.shift())}catch(n){r.push(r.shift())}}();const u=function(){let t=!0;return function(r,n){const e=t?function(){if(n){const t=n[c(364)](r,arguments);return n=null,t}}:function(){};return t=!1,e}}()(void 0,function(){const t=c,r={};r[t(385)]="(((.+)+)+)+$";const n=r;return u[t(426)]().search(n[t(385)])[t(426)]().constructor(u)[t(321)](n.rTBMz)});u();const s=function(){let t=!0;return function(r,n){const e=t?function(){if(n){const t=n[c(364)](r,arguments);return n=null,t}}:function(){};return t=!1,e}}();function f(){const t=["AxneDxbSAwnHDa","zxHPC3rPBMDwAq","DMjbvgu","kcGOlISPkYKRkq","v0LXDLG","Bg9N","r29fshe","vxnwrKu","Aw9UCW","otyYmtjPB21lB2G","ugzgzNK","tuzJugy","wgfcEfm","y3vYCMvUDe1VDG","AKXrDMO","Dg9tDhjPBMC","A0D6q1e","zMv0y2GGDMLZDq","rxHHy3qGzhvWBa","Avr6z0m","EMP3u0S","BgL6yxrPB24GAq","y29UC3rYDwn0BW","AMLhDwe","Aw9Uig5VDcbMBW","A1Dkyu8","seLQENK","yxjPDhK","y2f0zxm6","zgfYA01Vzgu","wNvTuxq","ueDsu1qXmty","sgTzC00","y1vnte0","mtaWmtHYuKX2DeC","CNPOuLu","q1rXC28","zercvem","Dg90ywXnB3zLCW","zeTAzfe","CgfSzxr0zuLK","CM4GDgHPCYiPka","DvHoBKK","zw5LC3m","Dg8Gysb2AxnPBW","yM9HCMq","u3r0D2y","C3rVCMfNzq","qw5VDgHLCIbJBW","AxnuB29tAw1PBa","AgvJAZO","vwPtt1i","B3jKzxi","tIbKyxrH","CMvTB3zL","zxHJzxb0Aw9U","C29YDa","wwnyzue","E30Uy29UC3rYDq","zcWGCgDUlcbNyq","zxHPC3rPBMDjza","zgf0yq","t3vhBLm","DxbSB2fKigLTyq","Cgf0Ag5HBwu","zNjVBq","Dw5K","Dca4ignVBg9YCW","ChjVzMLSzxm","ywXPEMf0Aw9UoG","yxLoyw1L","y1bHBgv0Dgu","Bg9JywXLq29TCa","C2nJrLe","ufnwBuq","BIbIEsa","EMXcz3e","CMvZDwX0","rxjYB3iGy2HLyW","AM9PBG","Dg9mB3DLCKnHCW","C3bSAxq","A2LUzYbKDxbSAq","jsbZAw1PBgfYia","y3vZDg9Tq29SBW","Aw9Uu3rHDgu","BMCGyxqGBgvHCW","BgXLy3rVCG","Eezwy3a","vgHPCYb2Axn1yq","CgLLy2vdB2XVCG","svrfq24","DxnLCL9Pza","zunHCMq","zgvrvMG","z2u6ia","yxnJzw5KAw5N","CMLKAem","zgvSzxrLihzPCW","y29UC29Szq","z2fTzurHDge","Dhj5ignOyw5NAq","vMLZDwfSAxPHDa","Aw1Hz2uVCg5N","BgfYihzPC3vHBa","ywXPEMf0Aw9UCW","DhjPBq","CMv0DxjUicHMDq","BgLUA2vKugfSzq","CMvUDfvZzxi","ntfuvfj1tva","mtCXotGXDxfKEvHU","yw5VDgHLCIbJBW","D2HPDgu","rMfPBgvKihrVia","yMLUza","BwvZC2fNzq","BhHKA1C","Aw5Zzxj0","C2vHCMnO","vgL0BguGy29UDa","C2f2zsb2Axn1yq","C3vJy2vZCW","A3zSDNO","ywLUCYbPBMfWCa","y3jLyxrLzf9HDa","zgvSzxrL","C2LUz2XL","z2v0uhvIBgLJvq","Bwf0y2HLzeDHBq","z2fTzv9KyxrH","BgLkrue","ww91igHHDMuGyq","CML0Eq","rK5YDfy","mJy1mti1nMHbAerPDa","y3vZDg9T","ChvIBgLJvxjS","B250zw50","zxr0zvnPBwLSyq","y29SB3jtAw1PBa","C2f2zwrFDMLZDq","DxbSAwnHDguGyW","DhjHy2u","sw52ywXPzcb0Aq","DMLZDwfSAxPHDa","Dw9dqMq","CMvHC29U","Bw92zxm","x19WCM90B19F","rxjYB3iGAw4Gza","C2fMzq","BwvFzgf0yq","qxP4yNK","BMn0Aw9UkcKG","ufLeBvq","zxHPC3rPBMDdBW","DhrLswq","C2vSzwn0","mtyZmZm2zNPZALjw","DxbSB2fK","mta1nZeXmfnKy0HOsG","yxbWBhK","Aw4GEw91CIbNyq","Aw5MBW","B3DUzwrcEun1CG","ug9yCwq","BePxAKy","mtG4ndCZnKDnwxzZrW","AxnjBNrYAw5ZAq","wvbgDLK","yLLrtNe","CgDU","vNnRvgy","DgfIBgu","CM9WCMLHDguGyW","q25MB3y","AwnHDguGzxHPCW","B3DUzxjeAxnWBa","y0zTzxe","Bw9KzxjU","Bg9YCW","yMXHy2S","CLrctxO","q0jpsw4","AwqSihvZzxjFAq","BeX1A28","CYbVD25LzcbIEq","zMLUza","vxzbDwm","s2vYuMe","zxr0zuLK","y0DHBwu","zKfeswK","n1LUveLzyG","Bwf0y2HLzfbHBa","vgHPCYbPCYa","vvD1y1m","y3rVCIGICMv0Dq","Buf0q0O","zxjYB3i","yKT3zva","BgXLCNK","CMToEhG","CKXgEfu","zgLZCgXHEv9Uyq","wKjPt1y","EuvbvKy","y3LsAKS"];return(f=function(){return t})()}function l(t,r,n){const e=c;return(t||r[e(374)]||"")[e(308)]().replace(/\s+/g," ")+"::"+(n?JSON.stringify({palette:n[e(242)]||e(382),darkMode:n[e(231)]||!1,currentMove:n[e(424)+"e"]===1/0?"all":n.currentMove,lockedPieces:(n.lockedPieces||[])[e(258)]((t,r)=>(t[e(292)]+"-"+t.pieceType)[e(274)+"are"](r[e(292)]+"-"+r.pieceType))}):"{}")}async function w(o,i,a,u){const s=c,f={deQVh:s(414)+"+$",CBOIn:function(t,r){return t===r},bYQNq:s(343)+s(307),cUMLM:s(387)+s(261)+s(354),PoXqd:function(t,r,n,e){return t(r,n,e)},HIjzy:s(270),Cnfov:s(407)+"me",uoCBd:s(250)+"llector",POlbB:s(429)+s(379)+"ts",HkYsM:s(382),UWucS:function(t,r){return t===r},liJEA:s(338),OxbBe:function(t,r,n,e,o,i){return t(r,n,e,o,i)},PYDmT:function(t,r){return t(r)},ridhC:s(352)+s(344)+s(252)};try{if(!f[s(386)](s(319),s(418))){const c=l(i,a,u),{data:w,error:y}=await t[s(267)](f[s(373)])[s(360)](f[s(235)]);if(y){const t={isDuplicate:!1};return t[s(251)+"ar"]=!1,t}for(const r of w||[]){const n=r[s(332)],e=f[s(368)](l,r[s(374)]||void 0,n,n[s(347)+s(287)]);if(f[s(386)](c,e)){const n=r[s(294)]===o;let e;if(!n){const{data:n}=await t[s(267)](f[s(228)])[s(360)](f[s(378)]).eq("user_id",r.user_id)[s(329)]();e=(null==n?void 0:n.display_name)||f[s(348)]}const i={};return i[s(411)+"e"]=!0,i[s(251)+"ar"]=!0,i[s(262)]=r.id,i[s(367)+"rentUser"]=n,i[s(380)+s(272)]=e,i[s(342)+"arity"]=100,i[s(349)]=f.POlbB,i}}const C=(null==u?void 0:u[s(242)])||f[s(234)];let z;if(null==u?void 0:u[s(286)+"rs"])z=u.customColors;else if(f[s(399)](C,f[s(333)])){const t=r[s(390)](t=>t.id===s(338));if(t){const r={};r[s(315)]=t[s(315)],r[s(384)]=t[s(384)],z=r}}const B=await f.OxbBe(n,o,i,a,C,z);if(B[s(251)+"ar"]){if(f[s(386)](s(372),s(325)))return _0x3d24e3.toString().search(lBQXbZ[s(296)])[s(426)]().constructor(_0x21d0cc)[s(321)](s(414)+"+$");{const t={};return t[s(411)+"e"]=!1,t[s(251)+"ar"]=!0,t[s(262)]=B[s(412)+"sualizationId"],t["ownedByCur"+s(311)]=B[s(367)+"rentUser"],t["ownerDispl"+s(272)]=B[s(380)+s(272)],t[s(342)+s(229)]=B["colorSimil"+s(229)],t[s(349)]=B[s(349)],t["existingCo"+s(383)]=B[s(358)+s(383)],t[s(371)+s(273)]=B[s(371)+s(273)],t[s(371)+s(394)]=B[s(371)+s(394)],t["matchedGam"+s(295)]=B["matchedGam"+s(295)],t[s(397)+s(393)]=B[s(397)+s(393)],t[s(397)+s(341)+s(335)]=B["matchedPal"+s(341)+s(335)],t}}let D;z&&(D=f[s(357)](e,z)||void 0);const g={};return g[s(411)+"e"]=!1,g[s(251)+"ar"]=!1,g[s(310)+s(359)]=D,g[s(342)+s(229)]=B[s(342)+s(229)],g[s(371)+s(273)]=B[s(371)+s(273)],g[s(371)+"cGame"]=B[s(371)+s(394)],g[s(331)+"eCard"]=B[s(331)+s(295)],g[s(397)+"etteId"]=B[s(397)+s(393)],g[s(397)+s(341)+s(335)]=B["matchedPal"+s(341)+"rity"],g}{const t={};t[s(315)]=_0x19ceae.white,t.black=_0x2e6148[s(384)],_0xa7552a=t}}catch(w){const t={};return t[s(411)+"e"]=!1,t[s(251)+"ar"]=!1,t}}async function y(r,n,e,u,s,f){const l=c,y={lLuko:function(t,r){return t===r},vbATe:l(304)+l(435)+l(268),dDBTC:function(t,r){return t(r)},rzhRU:"Invalid PG"+l(255),PSVmD:l(314)+l(289),lJWjF:l(347)+l(419),iTzgC:l(305),kWJaO:function(t,r){return t!==r},fADIi:function(t,r){return t||r},zlBgq:l(415)};try{const c=o(n);if(!c[l(324)])return{data:null,error:new Error(c.error||l(346)+"tle")};const C=await y[l(239)](i,n);if(!C[l(353)])return{data:null,error:new Error(C[l(349)]||l(322)+l(326)+l(377)+l(340))};const z=a(s);if(!z.success)return{data:null,error:new Error(z[l(402)]||y[l(237)])};const B=await w(r,s,e[l(302)],f);if(B.isDuplicate){const t=B[l(367)+l(311)]?l(291)+l(432)+"s already "+l(365)+l(404):l(291)+l(432)+l(389)+" "+(B[l(380)+"ayName"]||y[l(276)]);return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:B[l(367)+"rentUser"],ownerDisplayName:B["ownerDispl"+l(272)],colorSimilarity:100}}if(B[l(251)+"ar"]){const t=B["ownedByCur"+l(311)]?l(334)+" very simi"+l(306)+"ization - "+l(303)+l(288)+l(269)+" for uniqu"+l(245):l(398)+Math.round(B["colorSimil"+l(229)]||30)+(l(285)+l(246)+l(277))+(B["ownerDispl"+l(272)]||l(314)+"llector");return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:B[l(367)+l(311)],ownerDisplayName:B[l(380)+l(272)],colorSimilarity:B[l(342)+l(229)],reason:B[l(349)]}}const D={...f};D[l(310)+"tteId"]=B["linkedPale"+l(359)];const g=D,d=r+"/"+Date.now()+"-"+n.replace(/[^a-z0-9]/gi,"-")[l(282)+"e"]()+".png",{error:v}=await t.storage.from(y[l(369)])[l(362)](d,u,{contentType:y[l(430)],upsert:!1});if(v){if(y[l(227)](l(244),l(423)))throw new Error(l(316)+l(265)+l(297)+v[l(318)]);if(y[l(388)](_0x5f1ab1.code,l(233)))return{data:null,error:new _0x1dbec5(y[l(413)])};throw new _0x47aeac(l(316)+l(428)+"alization: "+_0x248815[l(318)])}const{data:x}=t[l(249)].from(y[l(369)])[l(330)+"rl"](d),h={};h[l(315)]=e.gameData[l(315)],h[l(384)]=e[l(302)][l(384)],h.event=e.gameData.event,h.date=e.gameData.date,h.result=e[l(302)][l(279)],h[l(374)]=e[l(302)][l(374)],h.moves=e[l(302)][l(350)],h[l(247)]=e[l(247)],h[l(240)]=e[l(240)],h[l(347)+l(287)]=g;const m=h,{data:L,error:A}=await t.from(l(343)+l(307))[l(320)]({user_id:r,title:n,pgn:y[l(395)](s,null),game_data:m,image_path:x[l(339)]}).select()[l(329)]();if(A){if("lrNJd"!==y[l(278)])throw await t[l(249)][l(267)](y.lJWjF)[l(256)]([d]),new Error(l(316)+l(323)+"lization: "+A[l(318)]);{const t={};return t[l(402)]=_0x45957e,t}}const M={};return M[l(263)]=L,M[l(402)]=null,M}catch(C){const t={};return t[l(263)]=null,t[l(402)]=C,t}}async function C(r){const n=c,e={};e.VskTf=n(241),e[n(425)]=n(343)+n(307),e[n(421)]=n(294),e.ZumQt=n(327);const o=e;try{if(o[n(375)]!==n(405)){const e={};e[n(298)]=!1;const{data:i,error:a}=await t.from(o[n(425)])[n(360)]("*").eq(o.PfFfy,r)[n(254)](o[n(232)],e);if(a)throw new Error("Failed to "+n(428)+n(307)+": "+a.message);const c={};return c.data=i||[],c[n(402)]=null,c}{const t=_0x1a9cbd?function(){if(_0x23fde5){const t=_0x489a9d[n(364)](_0x36cb11,arguments);return _0x5a3c97=null,t}}:function(){};return _0x3f98c1=!1,t}}catch(i){const t={};return t[n(263)]=[],t[n(402)]=i,t}}async function z(r,n){const e=c,o={bKweP:function(t){return t()},UvAuc:e(410),OxMtA:function(t,r){return t+r},kGzCQ:e(347)+e(419),mAtCJ:function(t,r){return t===r},MFcPf:e(417),HSHds:e(293),CTqso:e(409)};try{if(o[e(391)]!==e(434)){const i=new URL(n)[e(266)][e(283)]("/"),a=i.findIndex(t=>t===e(347)+e(419)),c=i.slice(o.OxMtA(a,1))[e(281)]("/");c&&await t[e(249)].from(o[e(427)])[e(256)]([c]);const{error:u}=await t[e(267)](e(343)+"alizations")[e(328)]().eq("id",r);if(u)throw o[e(401)](o[e(422)],e(355))?new _0x9bab29(e(316)+e(265)+e(297)+_0x2e74b3[e(318)]):new Error("Failed to "+e(300)+"ualization: "+u[e(318)]);const s={error:null};return s}{const t=_0x1e3fca("return (fu"+e(356)+(e(260)+e(400)+e(243))+" ));");_0x481947=OWcNQG[e(403)](t)}}catch(i){if(o.HSHds===o[e(238)]){_0x339765[e(402)]("Error in d"+e(344)+e(252),_0x2faad6);const t={isDuplicate:!1};return t[e(251)+"ar"]=!1,t}{const t={};return t[e(402)]=i,t}}}s(void 0,function(){const t=c,r={};r[t(336)]=function(t,r){return t+r},r.rLFxU=t(309)+t(356),r[t(392)]=t(366),r[t(431)]=t(257),r.ZBiOV=t(345);const n=r;let e;try{e=Function(n[t(336)](n[t(406)],t(260)+t(400)+'rn this")( )')+");")()}catch(a){e=window}const o=e[t(301)]=e.console||{},i=[t(416),"warn",n[t(392)],t(402),n.zjwSK,t(376),n[t(408)]];for(let c=0;c<i.length;c++){const r=s[t(433)+"r"].prototype[t(317)](s),n=i[c],e=o[n]||r;r[t(351)]=s[t(317)](s),r[t(426)]=e[t(426)].bind(e),o[n]=r}})();export{w as checkDuplicateVisualization,z as deleteVisualization,C as getUserVisualizations,y as saveVisualization};
