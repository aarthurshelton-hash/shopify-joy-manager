import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b7 as o,B as l,A as d,cb as u,cR as m,a8 as x,D as h,aB as p,aC as f,aD as w,aE as j,p as v,t as g,w as y,dy as b,dt as C,bo as N,dq as z,cZ as q,a1 as D,a2 as L,a3 as B,a4 as M,a5 as A,aW as _,bC as W,dz as S,b as k,y as I}from"./index-C_PxF1MG.js";import{C as K}from"./calendar-Cg9ziekI.js";!function(){const e=H,t=P();for(;;)try{if(816658===-parseInt(e(532))/1*(-parseInt(e(567))/2)+-parseInt(e(506))/3+-parseInt(e(515))/4*(-parseInt(e(514))/5)+-parseInt(e(526))/6*(-parseInt(e(575))/7)+parseInt(e(512))/8*(-parseInt(e(566))/9)+-parseInt(e(523))/10*(-parseInt(e(616))/11)+-parseInt(e(518))/12*(parseInt(e(615))/13))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const G=function(){const e=H,t={};t[e(528)]=function(e,t){return e===t},t[e(547)]="oQGTi";const s=t;let n=!0;return function(e,t){{const r=n?function(){const n=H;if(!s[n(528)](s.KnhhS,s.KnhhS)){const e={};return e[n(558)]=[],e.error=_0x1c09b4,e}if(t){const s=t.apply(e,arguments);return t=null,s}}:function(){};return n=!1,r}}}()(void 0,function(){const e=H,t={};t[e(573)]=e(498)+"+$";const s=t;return G.toString()[e(602)](s[e(573)]).toString()[e(550)+"r"](G).search(s[e(573)])});function H(e,t){e-=489;const s=P();let n=s[e];if(void 0===H.cIRALm){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};H.hONbVa=r,H.JlKUJm={},H.cIRALm=!0}const a=e+s[0],c=H.JlKUJm[a];if(c)n=c;else{const e=function(e){this.jMzsdI=e,this.eqzFPk=[1,0,0],this.YXFMGw=function(){return"newState"},this.HtpWnK="\\w+ *\\(\\) *{\\w+ *",this.WKBHwS="['|\"].+['|\"];? *}"};e.prototype.UUqGtz=function(){const e=new RegExp(this.HtpWnK+this.WKBHwS).test(this.YXFMGw.toString())?--this.eqzFPk[1]:--this.eqzFPk[0];return this.okhqdy(e)},e.prototype.okhqdy=function(e){return Boolean(~e)?this.EuDTRb(this.jMzsdI):e},e.prototype.EuDTRb=function(e){for(let t=0,s=this.eqzFPk.length;t<s;t++)this.eqzFPk.push(Math.round(Math.random())),s=this.eqzFPk.length;return e(this.eqzFPk[0])},new e(H).UUqGtz(),n=H.hONbVa(n),H.JlKUJm[a]=n}return n}G();const U=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}();function P(){const e=["mJm2nJm2t0rNDfjt","wfbHB04","AuzwAfq","ntmWnJmXnKvKy3LZDW","Dg9tDhjPBMC","rLLTrgO","Cgf5B3v0x2rLDa","yxbWCM92zwq","nZy1mZb2v0ryBfy","D2fYBG","y3rVCIGICMv0Dq","nJq3ndm2tvbjvujc","wLf1sKi","zKXuwNi","ChjVDg90ExbL","zffowNu","CMv0DxjUicHMDq","mtm5C0DYB1DX","DhjHy2u","tw9JCxu","zhnTzgi","yxbWCM92zwrFyq","DcbMB3vUzcbVCG","ywrTAw5FBM90zq","ChjVDMvKihn0yq","zM9YrwfJAa","CgvUzgLUz19JBW","DgfIBgu","yKvqv3e","Dw50","wvLZqwG","cI0TlqO","s25OAfm","C3rHDhvZ","C3rHDhvZlcbHBq","y29UC3rYDwn0BW","CM4GDgHPCYiPka","ENjUqxy","y3jLyxrLzf9HDa","ChffzeC","ywXS","B3vUDa","AxnWBgf5x25HBq","zgf0yq","D2L0AgrYyxDHBa","DhrftvG","ChjVzMLSzxm","CMvXDwLYzwq","CgvUzgLUzW","Bg9N","yuntwxG","owDbrfLgsa","mJmXmZHfwvbctum","x19WCM90B19F","vw5RBM93BIbvCW","BwfW","x3jLCxvLC3rZ","z2v0vxnLCG","zfflDwi","wK5tq2C","ntzbrvnvyvm","ywHYrvC","B3rHBf93AxrOza","Aw5MBW","DxbKyxrL","Dg90ywW","D2vcEMG","qK1ny0y","y29UC29Szq","BMn0Aw9UkcKG","vNDQA1C","yMLUza","zgLZCgXHEv9Uyq","zf9Jzw50CYWGDa","zLPXCgy","AxnKwMG","y29TCgXLDgvKxW","y3v0EfC","CMvQzwn0zwq","z2v0","Dg90ywXFD2L0Aa","tezszwG","vM5PwLa","D0zrB2u","zhjHD25Fy2vUDa","DxnLCL9Pza","zhnAywq","C2vHCMnO","yxbWCM92zwrFyW","zxjYB3i","BgvUz3rO","vwrRzMm","vvjJveS","yLDwEfC","uvLPB3y","z3H1zfq","CgvUzgLUz19HBq","CMvXDwvZDf9Pza","tM90igf1DgHLBG","ywLSCW","otfnDe5Zy0y","otu3AK5xs0L6","tKP6BNK","v2fSBgv0ihvWza","DgLJyxrLza","DxnLCL9PzcWGza","tLvqDfi","wuPWBNe","y2zRs3i","tLjMz3i","wxrqDxe","CMvQzwn0zwrFyW","yw1VDw50x2nLBG","rxHiuKq","Dg90ywXFzwfYBG","E30Uy29UC3rYDq","y29TCgXLDgvK","qKv6twi","ChjVy2vZCY13Aq","zwrFy2vUDhm","kcGOlISPkYKRkq","BLLfz2W","C3vJy2vZCW","zxHJzxb0Aw9U","yxv0Aa","q2fICMW","Dg9ju09tDhjPBG","CMvHC29UigLZia","mZKYndyZAwzoB1b4","B2fIDva","zNjVBq","C2vSzwn0","DgHKCMf3ywW","DxnLCL93ywXSzq","ndu4nJm2mezNDwrYsG","tLDLuxq","mti1Efjit2TU"];return(P=function(){return e})()}async function Y(t){const s=H,n={};n[s(623)]=s(559)+s(571),n[s(545)]=s(553),n[s(543)]=s(548),n[s(596)]=s(561),n.zFqJw=s(620)+s(557)+"e",n[s(499)]=s(600),n[s(624)]=s(511)+"ts",n.dQNZu="user_id, total_earne"+s(588)+s(577)+"rawn_cents";const r=n;try{const n={ascending:!1};let a=e[s(508)](r[s(623)]).select("*").order(r[s(545)],n);t&&t!==s(555)&&(a=a.eq(r[s(543)],t));const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[])[s(570)](e=>e[s(600)]))],{data:l}=await e[s(508)](r.LFReh).select(r.zFqJw).in(r[s(499)],o),{data:d}=await e.from(r[s(624)])[s(509)](r[s(530)]).in(s(600),o),u=new Map((null==l?void 0:l[s(570)](e=>[e[s(600)],e]))||[]),m=new Map((null==d?void 0:d[s(570)](e=>[e[s(600)],e]))||[]),x=(c||[]).map(e=>{var t,n,r;return{...e,payout_details:e[s(521)+s(614)],user_display_name:(null==(t=u[s(594)](e[s(600)]))?void 0:t[s(587)+"me"])||s(569)+"er",wallet_total_earned:(null==(n=m.get(e[s(600)]))?void 0:n[s(492)+s(497)])||0,wallet_total_withdrawn:(null==(r=m[s(594)](e[s(600)]))?void 0:r[s(595)+s(599)+"s"])||0}}),h={};return h[s(558)]=x,h[s(604)]=null,h}catch(a){const e={};return e[s(558)]=[],e[s(604)]=a,e}}async function R(){const t=H,s={};s[t(560)]="pending",s[t(601)]="rejected",s.Nvbqh=t(549)+"ount_cents";const n=s;try{const{data:s,error:r}=await e[t(508)]("withdrawal"+t(571))[t(509)](n.Nvbqh);if(r)throw r;const a={};a[t(541)+"unt"]=0,a[t(611)+"ount"]=0,a[t(603)+t(556)]=0,a[t(536)+"mount"]=0,a["completed_"+t(580)]=0,a[t(489)+"ount"]=0;const c=a;(s||[])[t(540)](e=>{const s=t;switch(e[s(548)]){case n[s(560)]:c["pending_co"+s(544)]++,c.pending_amount+=e[s(490)+"ts"];break;case s(522):c[s(603)+s(556)]++,c[s(536)+"mount"]+=e[s(490)+"ts"];break;case"completed":c[s(591)+s(580)]+=e[s(490)+"ts"];break;case n[s(601)]:c[s(489)+s(556)]++}});const i={};return i[t(558)]=c,i.error=null,i}catch(r){const e={};return e[t(558)]=null,e[t(604)]=r,e}}U(void 0,function(){const e=H,t={VniZP:function(e,t){return e(t)},UgllA:function(e,t){return e+t},zrnAv:function(e,t){return e+t},YJpnq:e(531)+e(584),ahrEW:e(564),VwjkW:e(524),YtPuq:e(542),aCSYx:e(533),gxudT:e(503),mMBbx:e(607)},s=function(){const s=e;let n;try{n=t[s(597)](Function,t.UgllA(t[s(552)](t[s(622)],s(493)+s(525)+s(551)+" )"),");"))()}catch(r){n=window}return n}(),n=s.console=s[e(583)]||{},r=[t[e(576)],t[e(585)],e(578),e(604),e(501),t[e(625)],t[e(565)]];for(let a=0;a<r[e(605)];a++)if(t[e(610)]!==t.mMBbx){const t=U[e(550)+"r"][e(529)].bind(U),s=r[a],c=n[s]||t;t[e(568)]=U[e(586)](U),t[e(519)]=c[e(519)].bind(c),n[s]=t}else _0x412366=_0x196cf7.eq(e(548),_0x6523b1)})(),function(){const e=Z,t=F();for(;;)try{if(538604===-parseInt(e(463))/1+-parseInt(e(436))/2+parseInt(e(469))/3+-parseInt(e(435))/4+-parseInt(e(437))/5*(-parseInt(e(456))/6)+parseInt(e(451))/7*(parseInt(e(444))/8)+parseInt(e(467))/9*(parseInt(e(424))/10))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const J=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=Z;return J[e(439)]().search(e(481)+"+$")[e(439)]().constructor(J)[e(459)]("(((.+)+)+)+$")});J();const E=function(){let e=!0;return function(t,s){const n=Z,r={};r[n(482)]="taVGO";const a=r,c=e?function(){const e=n;if(e(486)===a[e(482)]){if(_0x1d8967){const t=_0x2b9d63[e(464)](_0x2456bd,arguments);return _0x27fda0=null,t}}else if(s){const n=s[e(464)](t,arguments);return s=null,n}}:function(){};return e=!1,c}}();function Z(e,t){e-=424;const s=F();let n=s[e];if(void 0===Z.dwlWdE){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};Z.cyTGSA=r,Z.SXGyJZ={},Z.dwlWdE=!0}const a=e+s[0],c=Z.SXGyJZ[a];if(c)n=c;else{const e=function(e){this.TMIjgb=e,this.mkjAag=[1,0,0],this.CAHsiz=function(){return"newState"},this.oABYbM="\\w+ *\\(\\) *{\\w+ *",this.Bpmwvg="['|\"].+['|\"];? *}"};e.prototype.OFKjLx=function(){const e=new RegExp(this.oABYbM+this.Bpmwvg).test(this.CAHsiz.toString())?--this.mkjAag[1]:--this.mkjAag[0];return this.WuXMVE(e)},e.prototype.WuXMVE=function(e){return Boolean(~e)?this.dbMimK(this.TMIjgb):e},e.prototype.dbMimK=function(e){for(let t=0,s=this.mkjAag.length;t<s;t++)this.mkjAag.push(Math.round(Math.random())),s=this.mkjAag.length;return e(this.mkjAag[0])},new e(Z).OFKjLx(),n=Z.cyTGSA(n),Z.SXGyJZ[a]=n}return n}function F(){const e=["ruLRCgS","ChjVy2vZC19Tyq","D2fSBgv0x3rYyq","C2vSzwn0","mJmZmZeZnNfQuK1uCW","otqYodGWrvPHCuXg","mta0nZy1A1LoAwzx","A3vNCum","Dg9tDhjPBMC","qwHHu3C","ChjVDg90ExbL","z2v0x29Yx2nYzq","y29UC3rYDwn0BW","mtu3mJHjueHTuMW","C2fSzq","Bg9N","CM4GDgHPCYiPka","DhjHy2u","tM90igf1DgHLBG","DxnLCL9Pza","mty3m2XNwe9csG","yxnJzw5KAw5N","BgLTAxq","DgfIBgu","BufjCxO","mJu4wujdre5X","z2v0vxnLCG","D2fYBG","C2vHCMnO","yMLUza","yw5pr3e","CNbJ","mZe3nZa5wLHzDLbh","yxbWBhK","zNjVBq","B3jKzxi","mtmZmMzKCuv4rW","A0zcrLK","otq3odKYBunoq2XV","tfr2uLe","CMv0DxjUicHMDq","C3vJy2vZCW","y3jLyxrLzf9HDa","yxrLx3DHBgXLDa","BgvUz3rO","y29UC29Szq","zgf0yq","q1fOuNu","Cf9ZywXLx3bYAq","q2jmzNm","kcGOlISPkYKRkq","vfjlvxi","EfbQvuS","Cf9IDxLLCL9Pza","E30Uy29UC3rYDq","vNnNEwG","yxv0Aa","D0TIzem","mtuXntblyvfqC0G","zxjYB3i","zxHJzxb0Aw9U","EfDsBeS","DgLJyxrLza","Cf9SAxn0Aw5NxW","y3rVCIGICMv0Dq"];return(F=function(){return e})()}function X(e){const t=Z,s={};s[t(438)]=function(e,t){return e/t};return"$"+s[t(438)](e,100).toFixed(2)}function V(){var G,U;const{user:P}=t(),J=s(),[E,Z]=n.useState(!1),[F,V]=n.useState(!0),[O,T]=n.useState([]),[Q,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{oe()},[P]);const oe=async()=>{if(!P)return void V(!1);const{data:t}=await e.rpc("has_role",{_user_id:P.id,_role:"admin"});!0===t&&(Z(!0),await le()),V(!1)},le=async()=>{const[e,t]=await Promise.all([Y(ee),R()]);e.data&&T(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(I,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(I,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(I,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(I,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(I,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(I,{variant:"outline",children:e})}};return F?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):P&&E?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(l,{variant:"ghost",size:"icon",onClick:()=>J(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),Q&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:X(Q.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:X(Q.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:X(Q.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),le()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(w,{value:"pending",children:"Pending"}),r.jsx(w,{value:"approved",children:"Approved"}),r.jsx(w,{value:"completed",children:"Completed"}),r.jsx(w,{value:"rejected",children:"Rejected"}),r.jsx(w,{value:"all",children:"All"})]}),r.jsx(j,{value:ee,children:r.jsxs(c,{children:[r.jsxs(v,{children:[r.jsx(g,{children:"Withdrawal Requests"}),r.jsxs(y,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===O.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(b,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(C,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:O.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(N,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(z,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(K,{className:"h-3 w-3"}),q(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",X(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:X(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(m,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(l,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(m,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(D,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(L,{children:[r.jsxs(B,{children:[r.jsxs(M,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(A,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(G=se.request.payout_details)?void 0:G.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:X(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(_,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(W,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(U=se.request.payout_details)?void 0:U.email})]})]})]}),r.jsxs(S,{children:[r.jsx(l,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=H,r={};r.XPaoN=n(613)+"ticated",r[n(581)]="withdrawal"+n(571),r[n(554)]=function(e,t){return e||t},r.BMMcF="status";const a=r;try{const{data:{user:r}}=await e.auth[n(572)]();if(!r)throw new Error(a[n(516)]);const{error:c}=await e[n(508)](a[n(581)])[n(579)]({status:"approved",admin_notes:a.pqEdG(s,null),reviewed_by:r.id,reviewed_at:(new Date)[n(504)+"g"]()}).eq("id",t).eq(a[n(582)],n(563));if(c)throw c;const i={};return i[n(500)]=!0,i.error=null,i}catch(c){const e={};return e[n(500)]=!1,e[n(604)]=c,e}}(se.request.id,re),t.success&&k.success("Withdrawal approved");break;case"reject":if(!re.trim())return k.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=H,r={};r[n(617)]=function(e,t){return e!==t},r.isdZh="irKjB",r[n(535)]=n(613)+n(619),r[n(517)]="Rejection "+n(505)+n(562),r.Mocqu=n(593),r[n(491)]=n(548);const a=r;try{if(a[n(617)]("FouKj",a[n(590)])){const{data:{user:r}}=await e[n(502)][n(572)]();if(!r)throw new Error(a.dsmdb);if(!s)throw new Error(a[n(517)]);const{error:c}=await e.from(n(559)+n(571))[n(579)]({status:a[n(534)],admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date).toISOString()}).eq("id",t).eq(a[n(491)],n(563));if(c)throw c;const i={};return i[n(500)]=!0,i[n(604)]=null,i}{const e={};return e[n(500)]=!1,e[n(604)]=_0x19d6cd,e}}catch(c){const e={success:!1};return e.error=c,e}}(se.request.id,re),t.success&&k.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=H,r={};r[n(527)]=function(e,t){return e===t},r[n(598)]=n(608),r[n(606)]=n(574),r[n(592)]="Request no"+n(537)+" not in ap"+n(539)+"tus",r.NWeQt=n(559)+"_requests",r[n(609)]=n(494),r[n(495)]=n(496)+n(510),r[n(520)]=n(621),r[n(507)]=n(589);const a=r;try{const{data:{user:r}}=await e.auth[n(572)]();if(!r)throw new Error(n(613)+"ticated");const{data:c,error:i}=await e[n(508)](n(559)+n(571))[n(509)]("*").eq("id",t).eq(n(548),n(522)).single();if(i||!c){if(a[n(527)](a[n(598)],a[n(606)])){const e={};return e[n(500)]=!1,e.error=_0xd14a58,e}throw new Error(a[n(592)])}const{error:o}=await e[n(508)](a[n(513)]).update({status:a.QYiov,admin_notes:s?(c[n(538)+"s"]||"")+n(546)+s:c[n(538)+"s"],completed_at:(new Date)[n(504)+"g"]()}).eq("id",t);if(o)throw o;const l={};l[n(612)]=t,l[n(600)]=c[n(600)],l[n(490)+"ts"]=c.amount_cents;const d={};d.body=l;const{error:u}=await e.functions.invoke(a[n(495)],d),m={};return m[n(500)]=!0,m[n(604)]=null,m}catch(c){if(a[n(520)]!==a.oabuP){const e={};return e[n(500)]=!1,e.error=c,e}{const e={};return e[n(558)]=null,e[n(604)]=_0x54ca64,e}}}(se.request.id,re),t.success&&k.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?k.error(t.error.message):(ne({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(l,{onClick:()=>J("/"),children:"Go Home"})]})})})}E(void 0,function(){const e=Z,t={LTvRQ:e(478),wKbdC:function(e,t){return e(t)},anOGq:function(e,t){return e+t},xWRlK:e(471)+"nction() ",xrCVw:function(e){return e()},xPjUK:e(425),LMAzz:e(426),EIkpk:function(e,t){return e<t},kFBFY:"RqVvU"};let s;try{if(t[e(470)]!=t[e(470)]){const t={};return t[e(477)]=null,t.error=_0x19756e,t}{const n=t[e(488)](Function,t[e(461)](t[e(427)],e(485)+e(430)+e(447)+" )")+");");s=t.xrCVw(n)}}catch(a){s=window}const n=s[e(476)]=s[e(476)]||{},r=[e(446),e(458),"info",t[e(483)],t.LMAzz,e(454),e(448)];for(let c=0;t[e(431)](c,r[e(475)]);c++){if(t[e(468)]===e(480)){const e=_0x3c9a33.apply(_0x47137f,arguments);return _0x208f6a=null,e}{const t=E[e(443)+"r"][e(441)][e(460)](E),s=r[c],a=n[s]||t;t.__proto__=E.bind(E),t[e(439)]=a.toString[e(460)](a),n[s]=t}}})();export{V as default};
