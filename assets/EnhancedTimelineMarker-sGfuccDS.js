const n="/**\n * Enhanced Timeline Marker Component\n * \n * Provides rich hover tooltips for tactics, special moves, move quality, and phases.\n * Integrates with the timeline context to update board state on click.\n * Enhanced with En Pensent pattern visualization.\n */\n\nimport React, { useMemo } from 'react';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from '@/components/ui/tooltip';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Crown,\n  Zap,\n  Target,\n  Castle,\n  Star,\n  AlertTriangle,\n  TrendingUp,\n  Sparkles,\n  Crosshair,\n  ArrowUpRight,\n  Swords,\n  Shield,\n  Trophy,\n  Flag,\n  Sword,\n  BookOpen,\n} from 'lucide-react';\nimport { MoveQuality, MOVE_QUALITY_INFO } from '@/lib/chess/moveQuality';\nimport { TacticalMotif, SpecialMove, GamePhase } from '@/lib/chess/chessAnalysis';\nimport { useEnPensentPatterns } from '@/hooks/useEnPensentPatterns';\nimport type { TemporalSignature } from '@/lib/pensent-core/types/core';\n\n// ===================== MOMENT TYPES =====================\n\nexport type MomentType = \n  | 'capture' | 'check' | 'checkmate' | 'castling' \n  | 'brilliant' | 'great' | 'blunder' | 'mistake' | 'inaccuracy'\n  | 'fork' | 'pin' | 'skewer' | 'discovery' | 'sacrifice'\n  | 'en_passant' | 'promotion' | 'underpromotion';\n\nexport interface TimelineMoment {\n  moveNumber: number;\n  type: MomentType;\n  move: string;\n  player: 'white' | 'black';\n  quality?: MoveQuality;\n  tactic?: TacticalMotif;\n  specialMove?: SpecialMove;\n  description?: string;\n}\n\n// ===================== CONFIGURATION =====================\n\nexport const momentConfig: Record<MomentType, { \n  icon: React.ComponentType<{ className?: string }>; \n  color: string; \n  bgColor: string;\n  label: string;\n  description: string;\n  category: 'tactical' | 'quality' | 'special' | 'event';\n}> = {\n  // Tactical events\n  capture: { \n    icon: Target, \n    color: 'text-orange-400', \n    bgColor: 'bg-orange-500',\n    label: 'Capture',\n    description: 'A piece was captured, shifting the material balance.',\n    category: 'event'\n  },\n  check: { \n    icon: Zap, \n    color: 'text-yellow-400', \n    bgColor: 'bg-yellow-500',\n    label: 'Check',\n    description: 'The king is under attack and must escape.',\n    category: 'event'\n  },\n  checkmate: { \n    icon: Crown, \n    color: 'text-red-400', \n    bgColor: 'bg-red-500',\n    label: 'Checkmate',\n    description: 'Game over! The king cannot escape.',\n    category: 'event'\n  },\n  castling: { \n    icon: Castle, \n    color: 'text-blue-400', \n    bgColor: 'bg-blue-500',\n    label: 'Castle',\n    description: 'King moves to safety while activating the rook.',\n    category: 'special'\n  },\n  \n  // Move quality\n  brilliant: { \n    icon: Sparkles, \n    color: 'text-cyan-400', \n    bgColor: 'bg-cyan-500',\n    label: 'Brilliant',\n    description: 'An exceptional move, often a sacrifice that dramatically improves position.',\n    category: 'quality'\n  },\n  great: { \n    icon: TrendingUp, \n    color: 'text-green-400', \n    bgColor: 'bg-green-500',\n    label: 'Great Move',\n    description: 'A strong move that significantly improves the position.',\n    category: 'quality'\n  },\n  blunder: { \n    icon: AlertTriangle, \n    color: 'text-red-400', \n    bgColor: 'bg-red-600',\n    label: 'Blunder',\n    description: 'A severe error that often loses the game.',\n    category: 'quality'\n  },\n  mistake: { \n    icon: AlertTriangle, \n    color: 'text-orange-400', \n    bgColor: 'bg-orange-600',\n    label: 'Mistake',\n    description: 'A clear error that loses material or advantage.',\n    category: 'quality'\n  },\n  inaccuracy: { \n    icon: Target, \n    color: 'text-yellow-400', \n    bgColor: 'bg-yellow-600',\n    label: 'Inaccuracy',\n    description: 'Slightly imprecise, giving up some advantage.',\n    category: 'quality'\n  },\n  \n  // Tactical motifs\n  fork: { \n    icon: Crosshair, \n    color: 'text-purple-400', \n    bgColor: 'bg-purple-500',\n    label: 'Fork',\n    description: 'One piece attacks two or more enemy pieces simultaneously.',\n    category: 'tactical'\n  },\n  pin: { \n    icon: Shield, \n    color: 'text-indigo-400', \n    bgColor: 'bg-indigo-500',\n    label: 'Pin',\n    description: 'A piece cannot move without exposing a more valuable piece behind it.',\n    category: 'tactical'\n  },\n  skewer: { \n    icon: ArrowUpRight, \n    color: 'text-pink-400', \n    bgColor: 'bg-pink-500',\n    label: 'Skewer',\n    description: 'Attacking a piece through another, forcing it to move and expose the one behind.',\n    category: 'tactical'\n  },\n  discovery: { \n    icon: Zap, \n    color: 'text-amber-400', \n    bgColor: 'bg-amber-500',\n    label: 'Discovery',\n    description: 'Moving one piece to reveal an attack from another.',\n    category: 'tactical'\n  },\n  sacrifice: { \n    icon: Star, \n    color: 'text-cyan-400', \n    bgColor: 'bg-cyan-600',\n    label: 'Sacrifice',\n    description: 'Intentionally giving up material for positional or tactical advantage.',\n    category: 'tactical'\n  },\n  \n  // Special moves\n  en_passant: { \n    icon: Swords, \n    color: 'text-emerald-400', \n    bgColor: 'bg-emerald-500',\n    label: 'En Passant',\n    description: 'Special pawn capture immediately after opponent\\'s two-square pawn move.',\n    category: 'special'\n  },\n  promotion: { \n    icon: Crown, \n    color: 'text-gold-400', \n    bgColor: 'bg-amber-500',\n    label: 'Promotion',\n    description: 'Pawn reaches the eighth rank and transforms into a more powerful piece.',\n    category: 'special'\n  },\n  underpromotion: { \n    icon: Trophy, \n    color: 'text-violet-400', \n    bgColor: 'bg-violet-500',\n    label: 'Underpromotion',\n    description: 'Strategic promotion to knight, bishop, or rook instead of queen.',\n    category: 'special'\n  },\n};\n\nexport const phaseConfig: Record<string, { \n  label: string; \n  icon: React.ComponentType<{ className?: string }>; \n  color: string;\n  bgColor: string;\n  description: string;\n}> = {\n  all: { \n    label: 'All Moves', \n    icon: BookOpen, \n    color: 'text-muted-foreground',\n    bgColor: 'bg-muted hover:bg-muted/80',\n    description: 'View the entire game from start to finish.'\n  },\n  opening: { \n    label: 'Opening', \n    icon: Flag, \n    color: 'text-emerald-400',\n    bgColor: 'bg-emerald-500/20 hover:bg-emerald-500/30 border-emerald-500/30',\n    description: 'The first phase where pieces are developed and kings castled. Focus on controlling the center and piece activity.'\n  },\n  middlegame: { \n    label: 'Middlegame', \n    icon: Sword, \n    color: 'text-amber-400',\n    bgColor: 'bg-amber-500/20 hover:bg-amber-500/30 border-amber-500/30',\n    description: 'The heart of the battle. Tactics, attacks, and strategic maneuvering dominate this phase.'\n  },\n  endgame: { \n    label: 'Endgame', \n    icon: Crown, \n    color: 'text-rose-400',\n    bgColor: 'bg-rose-500/20 hover:bg-rose-500/30 border-rose-500/30',\n    description: 'With fewer pieces, king activity and pawn promotion become decisive factors.'\n  },\n};\n\n// ===================== MARKER COMPONENT =====================\n\ninterface TimelineMarkerProps {\n  moment: TimelineMoment;\n  position: number; // Percentage position\n  orientation: 'horizontal' | 'vertical';\n  onClick: () => void;\n  size?: 'sm' | 'md' | 'lg';\n  signature?: TemporalSignature | null;\n}\n\nexport const TimelineMarker: React.FC<TimelineMarkerProps> = ({\n  moment,\n  position,\n  orientation,\n  onClick,\n  size = 'md',\n  signature = null,\n}) => {\n  // En Pensent pattern integration\n  const pattern = useEnPensentPatterns(signature);\n  \n  const config = momentConfig[moment.type];\n  const Icon = config.icon;\n  \n  // Enhanced styling based on pattern intensity\n  const intensityGlow = useMemo(() => {\n    if (!signature || pattern.intensity < 0.3) return '';\n    return `shadow-[0_0_${Math.round(pattern.intensity * 8)}px_${pattern.dominantColor}40]`;\n  }, [signature, pattern.intensity, pattern.dominantColor]);\n  \n  const sizeClasses = {\n    sm: 'w-3 h-3',\n    md: 'w-4 h-4',\n    lg: 'w-5 h-5',\n  };\n  \n  const iconSizes = {\n    sm: 'w-2 h-2',\n    md: 'w-2.5 h-2.5',\n    lg: 'w-3 h-3',\n  };\n\n  const moveIndex = moment.moveNumber - 1;\n  const moveNum = Math.floor(moveIndex / 2) + 1;\n  const isWhiteMove = moveIndex % 2 === 0;\n  \n  const positionStyle = orientation === 'horizontal'\n    ? { left: `${position}%` }\n    : { top: `${position}%` };\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>\n        <button\n          onClick={onClick}\n          className={`absolute ${orientation === 'horizontal' ? '-translate-x-1/2 -top-1' : '-translate-y-1/2 left-0'} \n            ${sizeClasses[size]} rounded-full ${config.bgColor} \n            flex items-center justify-center cursor-pointer\n            hover:scale-125 transition-all duration-200 shadow-lg ring-1 ring-black/20\n            ${moment.player === 'white' ? 'ring-white/30' : 'ring-black/50'}\n            hover:ring-2 hover:ring-primary/50 ${intensityGlow}`}\n          style={positionStyle}\n        >\n          <Icon className={`${iconSizes[size]} text-white`} />\n        </button>\n      </TooltipTrigger>\n      <TooltipContent \n        side={orientation === 'horizontal' ? 'top' : 'right'} \n        className=\"max-w-[280px] p-3 space-y-2\"\n      >\n        {/* Header with icon and label */}\n        <div className=\"flex items-center gap-2\">\n          <div className={`p-1.5 rounded ${config.bgColor}`}>\n            <Icon className=\"w-3.5 h-3.5 text-white\" />\n          </div>\n          <div>\n            <div className=\"font-semibold text-sm\">{config.label}</div>\n            <div className=\"text-xs text-muted-foreground\">\n              {moveNum}.{isWhiteMove ? '' : '..'} {moment.move}\n            </div>\n          </div>\n          <Badge \n            variant=\"outline\" \n            className={`ml-auto text-[9px] ${moment.player === 'white' ? 'border-sky-500/50 text-sky-400' : 'border-rose-500/50 text-rose-400'}`}\n          >\n            {moment.player === 'white' ? 'White' : 'Black'}\n          </Badge>\n        </div>\n        \n        {/* Description */}\n        <p className=\"text-xs text-muted-foreground leading-relaxed\">\n          {moment.description || config.description}\n        </p>\n        \n        {/* Tactical details */}\n        {moment.tactic && (\n          <div className=\"pt-2 border-t border-border/50\">\n            <div className=\"text-[10px] font-medium text-muted-foreground mb-1\">Tactical Details</div>\n            <div className=\"grid grid-cols-2 gap-x-3 gap-y-1 text-xs\">\n              <div className=\"text-muted-foreground\">Piece:</div>\n              <div className=\"font-mono\">{moment.tactic.attacker.piece.toUpperCase()} @ {moment.tactic.attacker.square}</div>\n              <div className=\"text-muted-foreground\">Targets:</div>\n              <div className=\"font-mono\">\n                {moment.tactic.targets.map(t => `${t.piece.toUpperCase()}@${t.square}`).join(', ')}\n              </div>\n              <div className=\"text-muted-foreground\">Value:</div>\n              <div className=\"text-primary font-medium\">{moment.tactic.value} centipawns</div>\n            </div>\n          </div>\n        )}\n        \n        {/* Move quality badge */}\n        {moment.quality && (\n          <div className=\"pt-2 border-t border-border/50\">\n            <div className=\"flex items-center gap-2\">\n              <Badge \n                style={{ backgroundColor: MOVE_QUALITY_INFO[moment.quality].color }}\n                className=\"text-white text-[10px]\"\n              >\n                {MOVE_QUALITY_INFO[moment.quality].symbol} {MOVE_QUALITY_INFO[moment.quality].label}\n              </Badge>\n            </div>\n          </div>\n        )}\n        \n        {/* Click hint */}\n        <div className=\"text-[9px] text-muted-foreground/60 pt-1\">\n          Click to jump to this move\n        </div>\n      </TooltipContent>\n    </Tooltip>\n  );\n};\n\n// ===================== PHASE BUTTON COMPONENT =====================\n\ninterface PhaseButtonProps {\n  phase: string;\n  isActive: boolean;\n  moveCount: number;\n  onClick: () => void;\n  phaseInfo?: GamePhase;\n  compact?: boolean;\n}\n\nexport const PhaseButton: React.FC<PhaseButtonProps> = ({\n  phase,\n  isActive,\n  moveCount,\n  onClick,\n  phaseInfo,\n  compact = false\n}) => {\n  const config = phaseConfig[phase];\n  const Icon = config.icon;\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>\n        <button\n          onClick={onClick}\n          className={`flex items-center gap-1.5 ${compact ? 'h-6 px-2' : 'h-7 px-3'} rounded-md text-xs font-medium\n            border transition-all duration-200\n            ${isActive \n              ? `${config.bgColor} ${config.color} border-current shadow-sm` \n              : 'border-transparent bg-muted/30 text-muted-foreground hover:bg-muted/50 hover:text-foreground'\n            }`}\n        >\n          <Icon className={compact ? 'w-3 h-3' : 'w-3.5 h-3.5'} />\n          <span className={compact ? 'text-[10px]' : ''}>{config.label}</span>\n          <span className={`${compact ? 'text-[8px]' : 'text-[10px]'} opacity-70`}>({moveCount})</span>\n        </button>\n      </TooltipTrigger>\n      <TooltipContent side=\"bottom\" className=\"max-w-[260px] p-3 space-y-2\">\n        <div className=\"flex items-center gap-2\">\n          <div className={`p-1.5 rounded ${isActive ? config.bgColor : 'bg-muted'}`}>\n            <Icon className={`w-3.5 h-3.5 ${isActive ? 'text-white' : 'text-muted-foreground'}`} />\n          </div>\n          <div className=\"font-semibold\">{config.label}</div>\n        </div>\n        <p className=\"text-xs text-muted-foreground leading-relaxed\">\n          {config.description}\n        </p>\n        {phaseInfo && phaseInfo.keyEvents.length > 0 && (\n          <div className=\"pt-2 border-t border-border/50\">\n            <div className=\"text-[10px] font-medium text-muted-foreground mb-1\">Key Events</div>\n            <ul className=\"text-xs space-y-0.5\">\n              {phaseInfo.keyEvents.slice(0, 3).map((event, i) => (\n                <li key={i} className=\"flex items-center gap-1.5\">\n                  <span className=\"w-1 h-1 rounded-full bg-primary/60\" />\n                  {event}\n                </li>\n              ))}\n            </ul>\n          </div>\n        )}\n        <div className=\"text-[9px] text-muted-foreground/60 pt-1\">\n          Click to view only {config.label.toLowerCase()} moves and update the board\n        </div>\n      </TooltipContent>\n    </Tooltip>\n  );\n};\n\nexport default TimelineMarker;\n";export{n as default};
