import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as m,P as h,w as f,B as p,bM as j,cj as v,a9 as w,am as g,a1 as y,a2 as N,a3 as b,a4 as z,bC as C,a5 as D,cu as k,b as A}from"./index-DqGlL_-P.js";function q(){const e=["ywXPEMf0Aw9UCW","CxL2DuK","AwqSigDHBwvFza","rLzey2S","u3zsrNC","C1jIte0","x19WCM90B19F","x3jVBgu","zMLUza","B3jKzxi","y09OBxm","ChjVDg90ExbL","mJa1nJi3meTLAKTcuq","mtm1ANb0ANnJ","E30Uy29UC3rYDq","C2vSzwn0","Aw5MBW","BMn0Aw9UkcKG","zxPuAgu","uxDpuKi","ode5mZztyNb4Deq","yxbWBhK","DMPtueW","yMXHy2TFy29SBW","yxrPB25ZoG","Bw9KAwzPzwrFyG","sfPAzuy","D2HPDgvFy29SBW","rhbHC2O","ihjVBgu6","C1vMrfy","kcGOlISPkYKRkq","mtGZnKnbExbYAG","neL1DvjetW","zvbnEvO","rNHjEKG","DwPVuLm","Dg9tDhjPBMC","DwfXyu4","rxjYB3iGAw4Gyq","zg1PBIbJAgvJAW","y29Kzq","CgfSzxr0zv9Pza","sxfMEMC","Bxfjsw8","DhnHAM8","DhrLswq","rerjAgm","C2f2zwrFDMLZDq","DgfIBgu","mJmYndjoExPMu2K","Eu1lv0O","r3DLsuS","tMX2uw8","svLKs24","yMXHy2S","B1jwvNq","mtzVtfjAEfK","rhfRrLu","BgLUA2vKugfSzq","C2LUz2XL","y29UC3rYDwn0BW","y3rVCIGICMv0Dq","Aw9Uu3rHDgu","quXTzM0","A2LUzYbHzg1PBG","CNbJ","AgfZx3jVBgu","CgfSzxr0zuLK","ndm2mJGYmMT5z2vLua","mtL1v2zUqvu","z2fTzv9KyxrH","rxjYB3iGy2HLyW","ueDsu1qXmty","mtiXntu4mLDOD3Liwq","r3buree","rxjYB3iGy291BG","wuHWq3i","zNjVBq","C2vHCMnO","zgf0yq","DMLZDwfSAxPHDa","DhjHy2u","mtaYoda5DhPHDhb3","CgfSzxr0zv9VDG","zxHJzxb0Aw9U","v1btA0O","DgLUzYbSAw5Rzq","vKDcAhO","CM4GDgHPCYiPka","D2HPDgu","zxjYB3i","DMvYC2LVBG","zxjYAwrLCW","x3vZzxjFAwq","uePRuu8","Aw5Zzxj0","BgvUz3rO","mtqYmJa3qu9eA3Dz","mJj6DNDZzLm","yxrH","wNPtAfu","zcb2Axn1ywXPEG","sxfluKS","yMLUza","zgvSzxrL","y29UC29Szq","rxrWugO"];return(q=function(){return e})()}function B(e,s){e-=377;const t=q();let n=t[e];if(void 0===B.YqqhjK){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};B.jdOuZk=r,B.GrvDJW={},B.YqqhjK=!0}const a=e+t[0],i=B.GrvDJW[a];if(i)n=i;else{const e=function(e){this.upLCcO=e,this.XvNyzv=[1,0,0],this.seWMIh=function(){return"newState"},this.Vjbzzy="\\w+ *\\(\\) *{\\w+ *",this.fNmPsc="['|\"].+['|\"];? *}"};e.prototype.oAEsHC=function(){const e=new RegExp(this.Vjbzzy+this.fNmPsc).test(this.seWMIh.toString())?--this.XvNyzv[1]:--this.XvNyzv[0];return this.URNiwD(e)},e.prototype.URNiwD=function(e){return Boolean(~e)?this.iKyWhC(this.upLCcO):e},e.prototype.iKyWhC=function(e){for(let s=0,t=this.XvNyzv.length;s<t;s++)this.XvNyzv.push(Math.round(Math.random())),t=this.XvNyzv.length;return e(this.XvNyzv[0])},new e(B).oAEsHC(),n=B.jdOuZk(n),B.GrvDJW[a]=n}return n}!function(){const e=B,s=q();for(;;)try{if(246424===parseInt(e(405))/1*(parseInt(e(385))/2)+parseInt(e(409))/3*(parseInt(e(476))/4)+-parseInt(e(456))/5*(-parseInt(e(463))/6)+parseInt(e(418))/7*(parseInt(e(392))/8)+parseInt(e(404))/9+parseInt(e(455))/10*(parseInt(e(434))/11)+-parseInt(e(475))/12*(parseInt(e(433))/13))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const P=function(){const e={cOhms:function(e,s){return e===s}},s=e;let t=!0;return function(e,n){const r={DqkFU:function(e,t){return s[B(453)](e,t)}},a=t?function(){if(r[B(393)]("KGRsV","WnygR"))_0x42aa23++;else if(n){const s=n.apply(e,arguments);return n=null,s}}:function(){};return t=!1,a}}()(void 0,function(){const e=B,s={};s[e(462)]=e(474)+"+$";const t=s;return P[e(480)]()[e(414)](t[e(462)])[e(480)]().constructor(P)[e(414)](t[e(462)])});P();const S=function(){const e={};e[B(444)]=function(e,s){return e===s};const s=e;let t=!0;return function(e,n){const r=t?function(){const t=B;if(s[t(444)](t(465),t(465))){if(n){const s=n[t(464)](e,arguments);return n=null,s}}else{const e=_0x1b086a[t(396)+"r"][t(454)].bind(_0x116bda),s=_0x32a577[_0xad9995],n=_0x21743f[s]||e;e[t(449)]=_0x642b84[t(439)](_0x158ad2),e[t(480)]=n.toString[t(439)](n),_0x3f9b65[s]=e}}:function(){};return t=!1,r}}();async function L(s,t,n,r){const a=B,i={NhmNa:function(e,s){return e===s}};i.Dpasj=a(477),i[a(481)]=function(e,s){return e+s},i[a(389)]=a(377);const c=i;try{const{data:i}=await async function(s){const t=B,n={};n.EtpPj="palette_ov"+t(428),n[t(391)]=t(377),n[t(399)]=t(408);const r=n;try{const{data:n,error:a}=await e.from(r[t(442)])[t(458)]("*").eq(r[t(391)],s)[t(395)]();if(a&&a[t(484)]!==r[t(399)])throw a;const i={};return i.data=n,i[t(426)]=null,i}catch(a){const e={};return e[t(415)]=null,e[t(426)]=a,e}}(s);if(i){if(c.NhmNa(c[a(471)],a(477))){const{error:o}=await e.from("palette_overrides").update({white_colors:t,black_colors:n,modified_by:r,version:c[a(481)](i[a(427)],1)}).eq(c[a(389)],s);if(o)throw o;const l={};return l[a(426)]=null,l.version=i.version+1,l}{const e={};return e[a(426)]=_0x373e1b,e}}{const i={};i[a(377)]=s,i[a(470)+"rs"]=t,i[a(466)+"rs"]=n,i[a(468)+"y"]=r,i[a(427)]=1;const{error:c}=await e[a(413)]("palette_ov"+a(428))[a(431)](i);if(c)throw c;const o={};return o[a(426)]=null,o[a(427)]=1,o}}catch(o){const e={};return e[a(426)]=o,e[a(427)]=0,e}}async function M(s){const t=B,n={};n[t(382)]=t(383)+t(443),n.GweIK=t(445)+t(435),n[t(430)]=function(e,s){return e===s},n[t(446)]=function(e,s){return e===s},n[t(410)]=t(438),n.pkzzg=t(411)+t(422)+t(437)+t(467);const r=n;try{const{data:n,error:a}=await e[t(413)](r[t(382)]).select(r[t(387)]);if(a)throw a;let i=0;for(const e of n||[]){const n=e[t(406)][t(416)+t(398)];(r[t(430)](null==n?void 0:n[t(403)],s)||r[t(446)](null==n?void 0:n[t(394)+t(381)],s))&&i++}return i}catch(a){if(t(438)!==r[t(410)]){const e={};return e[t(415)]=null,e[t(426)]=_0x9a95ac,e}return 0}}S(void 0,function(){const e=B,s={};s[e(461)]="log",s[e(473)]="warn",s[e(436)]=e(384),s[e(388)]=e(417),s[e(412)]=function(e,s){return e<s};const t=s,n=function(){const s=e;let t;try{t=Function("return (fu"+s(460)+(s(457)+s(397)+s(424))+" ));")()}catch(n){t=window}return t}(),r=n[e(441)]=n[e(441)]||{},a=[t.ezThe,t.sUfDV,e(459),"error",e(420),t.ZzShU,t[e(388)]];for(let i=0;t.YHpCr(i,a[e(432)]);i++){const s=S[e(396)+"r"].prototype[e(439)](S),t=a[i],n=r[t]||s;s[e(449)]=S[e(439)](S),s.toString=n[e(480)][e(439)](n),r[t]=s}})();const _=["k","q","r","b","n","p"],K={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},G=()=>{var q,P,S,G;const{user:H}=s(),I=t(),[U,W]=n.useState(!1),[Y,E]=n.useState(!0),[O,X]=n.useState([]),[V,R]=n.useState(null),[J,F]=n.useState(null),[Z,T]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!H)return void I("/");if(!(await async function(s){const t=B,n={};n[t(380)]=t(482)+"dmin check:",n[t(379)]=function(e,s){return e===s},n[t(386)]=t(407)+t(400)+t(472),n.pQxHj=t(421);const r=n;try{if(r[t(379)](t(447),t(447))){const n={};n[t(429)]=s,n[t(450)]="admin";const{data:a,error:i}=await e[t(401)](t(402),n);return!i&&r.mqIIo(a,!0)}return _0x377d5d[t(426)](r.tsajo,_0x212b3a),!1}catch(a){if(r.pQxHj!==t(479))return!1;if(_0x4054ef){const e=_0x4c9edd[t(464)](_0x172b6d,arguments);return _0x1f298a=null,e}}}(H.id)))return A.error("Access denied",{description:"Admin privileges required"}),void I("/");W(!0),await te(),E(!1)})()},[H,I]);const te=async()=>{const{data:s}=await async function(){const s=B,t={};t.sRbLM=s(377);const n=t;try{const{data:t,error:r}=await e.from(s(419)+s(428))[s(458)]("*")[s(452)](n[s(448)]);if(r)throw r;const a={};return a[s(415)]=t||[],a[s(426)]=null,a}catch(r){const e={};return e[s(415)]=[],e[s(426)]=r,e}}();X(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await M(e.id);T(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=O.find(s=>s.palette_id===e);R(e),F({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{J&&F({...J,[e]:{...J[e],[s]:t}})},ae=async()=>{if(!V||!J||!H)return;Q(!0),se(!1);const{error:e,version:s}=await L(V,J.white,J.black,H.id);e?A.error("Failed to save",{description:e.message}):(A.success("Palette updated!",{description:`Version ${s} saved. ${Z[V]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>O.some(s=>s.palette_id===e);return Y?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):U?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(V===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),Z[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),Z[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[_.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),_.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:V&&J?r.jsxs(o,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(m,{className:"flex items-center gap-2",children:[r.jsx(h,{className:"h-5 w-5"}),null==(q=ie(V))?void 0:q.name]}),r.jsx(f,{children:null==(P=ie(V))?void 0:P.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(V)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!V)return;Q(!0);const{error:s}=await async function(s){const t=B,n={VGBhz:function(e,s){return e!==s}};n[t(469)]="LAtQR",n[t(478)]=t(419)+"errides";const r=n;try{if(r[t(423)](t(378),r[t(469)])){const{error:n}=await e[t(413)](r[t(478)])[t(440)]().eq(t(377),s);if(n)throw n;const a={};return a[t(426)]=null,a}return _0x5cf2ff[t(426)](t(411)+t(422)+t(437)+t(467),_0x205840),0}catch(a){const e={};return e[t(426)]=a,e}}(V);s?A.error("Failed to revert",{description:s.message}):(A.success("Reverted to defaults"),ne(V),await te()),Q(!1)},disabled:$,children:[r.jsx(j,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!V||!J||!H)return;(Z[V]||0)>0?se(!0):await ae()},disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(v,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(S=ie(V))?void 0:S.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:_.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:K[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(w,{type:"color",value:J.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(w,{type:"text",value:J.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(G=ie(V))?void 0:G.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:_.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:K[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(w,{type:"color",value:J.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(w,{type:"text",value:J.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:_.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:J.white[e]},title:K[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:_.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:J.black[e]},title:K[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(z,{className:"flex items-center gap-2",children:[r.jsx(C,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(D,{children:["This palette is linked to ",r.jsx("strong",{children:Z[V||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(k,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{G as default};
