const e='import React, { useState } from \'react\';\nimport { useQuery, useMutation, useQueryClient } from \'@tanstack/react-query\';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \'@/components/ui/card\';\nimport { Button } from \'@/components/ui/button\';\nimport { Badge } from \'@/components/ui/badge\';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \'@/components/ui/tabs\';\nimport { \n  TrendingUp, \n  BarChart3, \n  Briefcase, \n  Loader2, \n  Lock, \n  Sparkles,\n  LineChart,\n  PieChart,\n  Activity\n} from \'lucide-react\';\nimport { generatePremiumAnalytics, getPremiumAnalyticsHistory } from \'@/lib/analytics/financialTrends\';\nimport { useAuth } from \'@/hooks/useAuth\';\nimport { toast } from \'sonner\';\n\nexport function PremiumAnalyticsDashboard() {\n  const { user, isPremium, isLoading: authLoading } = useAuth();\n  const queryClient = useQueryClient();\n  const [selectedType, setSelectedType] = useState<\'market_trends\' | \'engagement_insights\' | \'portfolio_analysis\'>(\'market_trends\');\n  const [isAdmin, setIsAdmin] = React.useState(false);\n  const [adminLoading, setAdminLoading] = React.useState(true);\n\n  // Check admin status\n  React.useEffect(() => {\n    const checkAdmin = async () => {\n      if (!user) {\n        setIsAdmin(false);\n        setAdminLoading(false);\n        return;\n      }\n      try {\n        const { supabase } = await import(\'@/integrations/supabase/client\');\n        const { data } = await supabase\n          .from(\'user_roles\')\n          .select(\'role\')\n          .eq(\'user_id\', user.id)\n          .eq(\'role\', \'admin\')\n          .maybeSingle();\n        setIsAdmin(!!data);\n      } catch {\n        setIsAdmin(false);\n      }\n      setAdminLoading(false);\n    };\n    checkAdmin();\n  }, [user]);\n\n  const { data: analyticsHistory, isLoading: historyLoading } = useQuery({\n    queryKey: [\'premium-analytics-history\'],\n    queryFn: getPremiumAnalyticsHistory,\n    enabled: !!user && isAdmin,\n  });\n\n  const generateMutation = useMutation({\n    mutationFn: (type: \'market_trends\' | \'engagement_insights\' | \'portfolio_analysis\') => \n      generatePremiumAnalytics(type),\n    onSuccess: (data) => {\n      if (data) {\n        toast.success(\'Analytics generated successfully!\');\n        queryClient.invalidateQueries({ queryKey: [\'premium-analytics-history\'] });\n      }\n    },\n    onError: (error) => {\n      toast.error(\'Failed to generate analytics\');\n      console.error(error);\n    },\n  });\n\n  if (authLoading || adminLoading) {\n    return (\n      <div className="flex items-center justify-center py-12">\n        <Loader2 className="h-8 w-8 animate-spin text-primary" />\n      </div>\n    );\n  }\n\n  if (!isAdmin) {\n    return (\n      <Card className="border-destructive/20 bg-gradient-to-br from-destructive/5 to-muted">\n        <CardHeader className="text-center">\n          <div className="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-destructive/10">\n            <Lock className="h-8 w-8 text-destructive" />\n          </div>\n          <CardTitle className="text-2xl">Admin Access Required</CardTitle>\n          <CardDescription>\n            Premium Analytics is restricted to administrators only\n          </CardDescription>\n        </CardHeader>\n      </Card>\n    );\n  }\n\n  return (\n    <div className="space-y-6">\n      <div className="flex items-center justify-between">\n        <div>\n          <h2 className="text-2xl font-bold flex items-center gap-2">\n            <Sparkles className="h-6 w-6 text-primary" />\n            Premium Analytics\n          </h2>\n          <p className="text-muted-foreground">\n            Exclusive market data and insights for Visionary members\n          </p>\n        </div>\n        <Badge variant="secondary" className="bg-primary/10 text-primary">\n          Premium Access\n        </Badge>\n      </div>\n\n      <Tabs value={selectedType} onValueChange={(v) => setSelectedType(v as typeof selectedType)}>\n        <TabsList className="grid w-full grid-cols-3">\n          <TabsTrigger value="market_trends" className="gap-2">\n            <LineChart className="h-4 w-4" />\n            Market Trends\n          </TabsTrigger>\n          <TabsTrigger value="engagement_insights" className="gap-2">\n            <Activity className="h-4 w-4" />\n            Engagement\n          </TabsTrigger>\n          <TabsTrigger value="portfolio_analysis" className="gap-2">\n            <PieChart className="h-4 w-4" />\n            Portfolio\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value="market_trends" className="mt-6">\n          <Card>\n            <CardHeader>\n              <CardTitle>Market Trends Report</CardTitle>\n              <CardDescription>\n                Performance data for palettes, gamecards, and overall market activity\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className="space-y-4">\n                <div className="grid gap-4 md:grid-cols-2">\n                  <div className="p-4 rounded-lg border bg-muted/30">\n                    <h4 className="font-semibold mb-2">Palette Performance</h4>\n                    <p className="text-sm text-muted-foreground">\n                      See which color palettes are driving the most engagement and value\n                    </p>\n                  </div>\n                  <div className="p-4 rounded-lg border bg-muted/30">\n                    <h4 className="font-semibold mb-2">Gamecard Rankings</h4>\n                    <p className="text-sm text-muted-foreground">\n                      Track legendary game value appreciation and usage trends\n                    </p>\n                  </div>\n                </div>\n                <Button \n                  onClick={() => generateMutation.mutate(\'market_trends\')}\n                  disabled={generateMutation.isPending}\n                  className="w-full gap-2"\n                >\n                  {generateMutation.isPending ? (\n                    <Loader2 className="h-4 w-4 animate-spin" />\n                  ) : (\n                    <TrendingUp className="h-4 w-4" />\n                  )}\n                  Generate Market Report\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value="engagement_insights" className="mt-6">\n          <Card>\n            <CardHeader>\n              <CardTitle>Engagement Insights</CardTitle>\n              <CardDescription>\n                Discover top-performing visions and optimal activity times\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className="space-y-4">\n                <div className="grid gap-4 md:grid-cols-2">\n                  <div className="p-4 rounded-lg border bg-muted/30">\n                    <h4 className="font-semibold mb-2">Top Visions</h4>\n                    <p className="text-sm text-muted-foreground">\n                      Ranked by total score, views, downloads, and trades\n                    </p>\n                  </div>\n                  <div className="p-4 rounded-lg border bg-muted/30">\n                    <h4 className="font-semibold mb-2">Activity Patterns</h4>\n                    <p className="text-sm text-muted-foreground">\n                      Best times to list and engage for maximum visibility\n                    </p>\n                  </div>\n                </div>\n                <Button \n                  onClick={() => generateMutation.mutate(\'engagement_insights\')}\n                  disabled={generateMutation.isPending}\n                  className="w-full gap-2"\n                >\n                  {generateMutation.isPending ? (\n                    <Loader2 className="h-4 w-4 animate-spin" />\n                  ) : (\n                    <BarChart3 className="h-4 w-4" />\n                  )}\n                  Generate Engagement Report\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value="portfolio_analysis" className="mt-6">\n          <Card>\n            <CardHeader>\n              <CardTitle>Portfolio Analysis</CardTitle>\n              <CardDescription>\n                Detailed breakdown of your vision holdings and earnings\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className="space-y-4">\n                <div className="grid gap-4 md:grid-cols-2">\n                  <div className="p-4 rounded-lg border bg-muted/30">\n                    <h4 className="font-semibold mb-2">Holdings Breakdown</h4>\n                    <p className="text-sm text-muted-foreground">\n                      Each vision with score, royalties earned, and estimated value\n                    </p>\n                  </div>\n                  <div className="p-4 rounded-lg border bg-muted/30">\n                    <h4 className="font-semibold mb-2">Total Portfolio Value</h4>\n                    <p className="text-sm text-muted-foreground">\n                      Combined value of all your digital vision assets\n                    </p>\n                  </div>\n                </div>\n                <Button \n                  onClick={() => generateMutation.mutate(\'portfolio_analysis\')}\n                  disabled={generateMutation.isPending}\n                  className="w-full gap-2"\n                >\n                  {generateMutation.isPending ? (\n                    <Loader2 className="h-4 w-4 animate-spin" />\n                  ) : (\n                    <Briefcase className="h-4 w-4" />\n                  )}\n                  Generate Portfolio Report\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n\n      {/* Analytics History */}\n      {analyticsHistory && analyticsHistory.length > 0 && (\n        <Card>\n          <CardHeader>\n            <CardTitle className="text-lg">Recent Reports</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className="space-y-2">\n              {analyticsHistory.map((report) => (\n                <div \n                  key={report.id}\n                  className="flex items-center justify-between p-3 rounded-lg bg-muted/30"\n                >\n                  <div className="flex items-center gap-3">\n                    {report.analyticsType === \'market_trends\' && <LineChart className="h-4 w-4 text-primary" />}\n                    {report.analyticsType === \'engagement_insights\' && <Activity className="h-4 w-4 text-accent" />}\n                    {report.analyticsType === \'portfolio_analysis\' && <PieChart className="h-4 w-4 text-primary" />}\n                    <div>\n                      <p className="font-medium capitalize">\n                        {report.analyticsType.replace(\'_\', \' \')}\n                      </p>\n                      <p className="text-xs text-muted-foreground">\n                        Generated {new Date(report.generatedAt).toLocaleDateString()}\n                      </p>\n                    </div>\n                  </div>\n                  <Badge variant="outline" className="text-xs">\n                    Expires {new Date(report.expiresAt).toLocaleDateString()}\n                  </Badge>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n';export{e as default};
