const n="import { Chess } from 'chess.js';\n\nexport interface PgnValidationResult {\n  isValid: boolean;\n  error?: string;\n  moveCount?: number;\n  invalidMove?: string;\n  invalidMoveNumber?: number;\n}\n\n/**\n * Validates a PGN string - now PERMISSIVE.\n * We count moves that can be parsed but don't reject PGNs with some invalid moves.\n * The simulator will handle whatever it can.\n */\nexport function validatePgn(pgn: string): PgnValidationResult {\n  if (!pgn || !pgn.trim()) {\n    return {\n      isValid: false,\n      error: 'PGN is empty. Please provide a valid chess game notation.',\n    };\n  }\n\n  const chess = new Chess();\n  \n  // Try to load the PGN directly first\n  try {\n    chess.loadPgn(pgn);\n    const history = chess.history();\n    \n    return {\n      isValid: true,\n      moveCount: history.length,\n    };\n  } catch (e) {\n    // If direct loading fails, try manual parsing to count playable moves\n    chess.reset();\n    \n    const movesSection = pgn.replace(/\\[[^\\]]*\\]/g, '').trim();\n    \n    const moveTokens = movesSection\n      .replace(/\\{[^}]*\\}/g, '')\n      .replace(/\\([^)]*\\)/g, '')\n      .replace(/\\$\\d+/g, '')\n      .replace(/1-0|0-1|1\\/2-1\\/2|\\*/g, '')\n      .split(/\\s+/)\n      .filter(token => token && !token.match(/^\\d+\\.+$/) && token !== '...');\n\n    let validMoves = 0;\n    \n    for (const moveToken of moveTokens) {\n      try {\n        const fixedMove = moveToken\n          .replace(/0-0-0/gi, 'O-O-O')\n          .replace(/0-0/gi, 'O-O')\n          .replace(/[+#!?]+$/, '');\n        \n        const result = chess.move(fixedMove);\n        if (result) {\n          validMoves++;\n        }\n      } catch {\n        // Skip invalid moves - continue parsing\n      }\n    }\n    \n    // Be permissive: if we got ANY moves, consider it valid\n    if (validMoves > 0) {\n      return {\n        isValid: true,\n        moveCount: validMoves,\n      };\n    }\n    \n    // Only fail if we couldn't parse ANY moves at all\n    return {\n      isValid: false,\n      error: 'Could not parse any moves from the PGN. Please check the notation format.',\n    };\n  }\n}\n\n/**\n * Cleans and normalizes PGN text for better parsing compatibility\n */\nexport function cleanPgn(pgn: string): string {\n  return pgn\n    .replace(/\\r\\n/g, '\\n')\n    .replace(/\\r/g, '\\n')\n    .replace(/\\t/g, ' ')\n    .replace(/\\s+/g, ' ')\n    .trim();\n}\n";export{n as default};
