import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as m,P as h,w as f,B as p,bM as v,cj as w,a9 as j,am as g,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as D,cu as q,b as _}from"./index-CDYK3n_t.js";!function(){const e=P,s=B();for(;;)try{if(321502===-parseInt(e(400))/1*(parseInt(e(465))/2)+-parseInt(e(386))/3*(parseInt(e(372))/4)+-parseInt(e(367))/5*(-parseInt(e(413))/6)+-parseInt(e(402))/7*(parseInt(e(440))/8)+parseInt(e(439))/9*(parseInt(e(398))/10)+parseInt(e(406))/11*(parseInt(e(477))/12)+-parseInt(e(408))/13*(-parseInt(e(414))/14))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const k=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[P(388)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=P,s={};s[e(363)]=e(432)+"+$";const t=s;return k[e(454)]().search(e(432)+"+$")[e(454)]().constructor(k)[e(411)](t.CkryT)});k();const A=function(){const e=P,s={};s[e(472)]=e(371);const t=s;let n=!0;return function(s,r){const a=e,i={};i[a(390)]=function(e,s){return e===s},i[a(463)]=t[a(472)];const c=i,o=n?function(){const e=a;if(r){if(c[e(390)](c[e(463)],e(371))){const t=r[e(388)](s,arguments);return r=null,t}{const s=_0x57649b[e(435)][e(464)+"ionState"];((null==s?void 0:s.paletteId)===_0x5b3078||c.lVYeZ(null==s?void 0:s["linkedPale"+e(391)],_0x5bd236))&&_0x6c9415++}}}:function(){};return n=!1,o}}();function B(){const e=["Bw9KAwzPzwrFyG","t3n6A1y","B3jKzxi","Aw5MBW","zxjYAwrLCW","Dg9tDhjPBMC","D2HPDgu","E30Uy29UC3rYDq","ihjVBgu6","rxjYB3iGy291BG","Aw9Uu3rHDgu","zMLUza","weD2txe","qunLyNe","uuj0DLi","DMLZDwfSAxPHDa","nJiXnZryA2XKu0S","DgLUzYbSAw5Rzq","DgfIBgu","C2vSzwn0","sK5Jqwe","DMvYC2LVBG","BgvUz3rO","B2DNs24","tgn3BNe","D2fYBG","rwDxq1e","DhjHy2u","mJrZu2HwEwq","BMn0Aw9UkcKG","q2TYEvq","BgLUA2vKugfSzq","z2T2CeC","zxHJzxb0Aw9U","mtv6wKr2rNC","EhfNq3q","r0ncwxK","CM4GDgHPCYiPka","wM9uDNe","mty3ode2ognrsfjsDq","ChjVDg90ExbL","zNjVBq","y3rVCIGICMv0Dq","x19WCM90B19F","tNros2K","rxjYB3iGy2HLyW","CMv0DxjUicHMDq","A2LUzYbHzg1PBG","AgfZx3jVBgu","zg1PBIbJAgvJAW","vgDgB2i","z0X4u3q","BeP2BLO","m3vrzgnRta","y0nfsLi","yxbWBhK","tLHKDee","BfzzzvO","DhrLswq","y29UC3rYDwn0BW","C2f2zwrFDMLZDq","wK12DwK","yxrPB25ZoG","CwjjCw4","AfLxzKG","odi3ntmWu1rorK5T","qK1At24","mtfWyNfqrKq","sxryteS","mJG0mty5owDyv1D0wa","ueDsu1qXmty","ywrjyvy","CePYzvq","mJi3mte0oeXTsMrdrW","vKLetu0","ntjNDgjXDMW","zxjYB3i","BxHyu3C","C2vHCMnO","yxrH","mtG3otyYBLD5v3fQ","mtK4odK2nKvtse12qW","Eu1nueS","Bg9N","yxHABNu","C2LUz2XL","uu1tyM4","uMXKEMK","uLnxCM4","D2HPDgvFy29SBW","yMXHy2TFy29SBW","ywrTAw4","EufLCNC","rgLtsLy","rfzgrgq","AMfxCfq","rxjYB3iGAw4Gyq","tMr5twK","CgfSzxr0zv9VDG","kcGOlISPkYKRkq","vePSqu0","yMXHy2S","z2fTzv9KyxrH","y29UC29Szq","yMLUza","y29Kzq","ndvkAerYC2W","ofPzEerOyq","Aw5Zzxj0","B1nIrKu","teXvsNC","vg9ssNG","zgf0yq","AwqSigDHBwvFza","r1zwEgK","CgfSzxr0zv9Pza"];return(B=function(){return e})()}async function M(s,t,n,r){const a=P,i={};i[a(461)]=function(e,s){return e===s},i.GVVxi=a(368),i[a(443)]=a(431)+a(453),i[a(396)]=function(e,s){return e+s},i.NXdtA=a(448);const c=i;try{if(c[a(461)](c.GVVxi,c[a(447)])){const{data:i}=await async function(s){const t=P,n={};n[t(450)]=function(e,s){return e===s},n[t(401)]=t(444),n[t(394)]=function(e,s){return e!==s};const r=n;try{if(r.OszkV("nxJGv",r.ItXLK)){const e={};return e[t(455)]=_0x148c62[t(422)+"rs"],e[t(434)]=_0x758412[t(423)+"rs"],e}{const{data:n,error:a}=await e[t(374)](t(431)+"errides")[t(468)]("*").eq(t(448),s)[t(418)]();if(a&&r[t(394)](a[t(438)],t(403)))throw a;const i={};return i[t(445)]=n,i.error=null,i}}catch(a){const e={};return e[t(445)]=null,e[t(409)]=a,e}}(s);if(i){const{error:o}=await e[a(374)](c[a(443)]).update({white_colors:t,black_colors:n,modified_by:r,version:c[a(396)](i.version,1)}).eq(c[a(389)],s);if(o)throw o;return{error:null,version:c.qbIqn(i[a(470)],1)}}{const i={};i[a(448)]=s,i.white_colors=t,i[a(423)+"rs"]=n,i[a(449)+"y"]=r,i.version=1;const{error:o}=await e.from(c[a(443)])[a(441)](i);if(o)throw o;const l={};return l[a(409)]=null,l[a(470)]=1,l}}{const e=_0x5e079a[a(388)](_0x1cff77,arguments);return _0x73c34a=null,e}}catch(o){const e={};return e[a(409)]=o,e[a(470)]=0,e}}function P(e,s){e-=362;const t=B();let n=t[e];if(void 0===P.FcPVeU){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};P.CPOKzE=r,P.lVqBDd={},P.FcPVeU=!0}const a=e+t[0],i=P.lVqBDd[a];if(i)n=i;else{const e=function(e){this.YTPpYo=e,this.ZlRPAA=[1,0,0],this.phNJDV=function(){return"newState"},this.WIzQrJ="\\w+ *\\(\\) *{\\w+ *",this.eItzjr="['|\"].+['|\"];? *}"};e.prototype.yysCvM=function(){const e=new RegExp(this.WIzQrJ+this.eItzjr).test(this.phNJDV.toString())?--this.ZlRPAA[1]:--this.ZlRPAA[0];return this.MxDHgw(e)},e.prototype.MxDHgw=function(e){return Boolean(~e)?this.eqrDHN(this.YTPpYo):e},e.prototype.eqrDHN=function(e){for(let s=0,t=this.ZlRPAA.length;s<t;s++)this.ZlRPAA.push(Math.round(Math.random())),t=this.ZlRPAA.length;return e(this.ZlRPAA[0])},new e(P).yysCvM(),n=P.CPOKzE(n),P.lVqBDd[a]=n}return n}async function K(s){const t=P,n={};n[t(405)]="VflpL",n[t(427)]=t(446)+t(412),n.EgWCQ=function(e,s){return e!==s},n.VIDMM="kTkqy";const r=n;try{if("VflpL"===r[t(405)]){const{data:n,error:a}=await e.from(t(393)+"alizations")[t(468)](r[t(427)]);if(a)throw a;let i=0;for(const e of n||[]){const n=e.game_data[t(464)+t(459)];((null==n?void 0:n.paletteId)===s||(null==n?void 0:n[t(364)+"tteId"])===s)&&i++}return i}{const e={data:[]};return e.error=_0x53525c,e}}catch(a){if(r[t(475)](r[t(407)],r[t(407)])){const e=_0x56e0c7?function(){if(_0x51d6bb){const e=_0x279506[t(388)](_0x4252eb,arguments);return _0x224386=null,e}}:function(){};return _0x16f751=!1,e}return 0}}A(void 0,function(){const e=P,s={kGryX:function(e,s){return e!==s},BMZOn:e(426),RSWrn:function(e){return e()},axZnu:e(416),yMMPK:e(452),QMSbn:e(366),ACebq:function(e,s){return e!==s},jaWpT:e(473),oSbFE:e(369)},t=s[e(421)](function(){const t=e;if("JpYkU"!==t(387)){let e;try{if(s.kGryX(t(426),s[t(399)]))return _0x5c0a0e[t(409)](t(378)+t(380)+" role:",_0x2444a8),!1;e=Function(t(379)+t(362)+(t(456)+t(375)+t(370)+" ));"))()}catch(n){e=window}return e}if(_0x1b9e1f){const e=_0x358bb0[t(388)](_0x1df8a1,arguments);return _0x41bf07=null,e}}),n=t[e(436)]=t[e(436)]||{},r=[s[e(417)],e(474),s[e(415)],e(409),s[e(419)],e(467),e(476)];for(let a=0;a<r[e(471)];a++){if(!s[e(462)](s[e(428)],s[e(442)])){const e={};return e.error=_0x337ef3,e.version=0,e}{const s=A[e(392)+"r"][e(373)][e(437)](A),t=r[a],i=n[t]||s;s.__proto__=A.bind(A),s[e(454)]=i[e(454)].bind(i),n[t]=s}}})();const S=["k","q","r","b","n","p"],I={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},L=()=>{var k,A,B,L;const{user:H}=s(),V=t(),[G,U]=n.useState(!1),[W,Y]=n.useState(!0),[E,R]=n.useState([]),[Z,X]=n.useState(null),[T,J]=n.useState(null),[F,O]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!H)return void V("/");if(!(await async function(s){const t=P,n={};n[t(425)]=t(381),n[t(384)]=function(e,s){return e===s},n.Rldzi=t(429)+t(382)+":";const r=n;try{const n={};n._user_id=s,n._role=t(424);const{data:a,error:i}=await e.rpc(r.yAerw,n);return!i&&r[t(384)](a,!0)}catch(a){return t(383)===t(377)&&(_0x24f5d1[t(409)](t(458)+t(466)+"d visualiz"+t(395),_0x5b599f),0)}}(H.id)))return _.error("Access denied",{description:"Admin privileges required"}),void V("/");U(!0),await te(),Y(!1)})()},[H,V]);const te=async()=>{const{data:s}=await async function(){const s=P,t={};t[s(469)]="Error in admin check:",t.hUHRq=s(431)+s(453),t[s(433)]=function(e,s){return e===s},t[s(365)]="pWqOc";const n=t;try{const{data:t,error:r}=await e[s(374)](n.hUHRq)[s(468)]("*")[s(451)](s(448));if(r)throw r;const a={};return a.data=t||[],a[s(409)]=null,a}catch(r){if(n[s(433)](n[s(365)],s(385)))return _0x308f23[s(409)](n[s(469)],_0x3780b1),!1;{const e={data:[]};return e[s(409)]=r,e}}}();R(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await K(e.id);O(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=E.find(s=>s.palette_id===e);X(e),J({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{T&&J({...T,[e]:{...T[e],[s]:t}})},ae=async()=>{if(!Z||!T||!H)return;Q(!0),se(!1);const{error:e,version:s}=await M(Z,T.white,T.black,H.id);e?_.error("Failed to save",{description:e.message}):(_.success("Palette updated!",{description:`Version ${s} saved. ${F[Z]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>E.some(s=>s.palette_id===e);return W?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):G?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(Z===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),F[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),F[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[S.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),S.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:Z&&T?r.jsxs(o,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(m,{className:"flex items-center gap-2",children:[r.jsx(h,{className:"h-5 w-5"}),null==(k=ie(Z))?void 0:k.name]}),r.jsx(f,{children:null==(A=ie(Z))?void 0:A.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(Z)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!Z)return;Q(!0);const{error:s}=await async function(s){const t=P,n={};n.vtDpM=t(431)+t(453),n[t(404)]="BrXAM",n[t(430)]=t(410);const r=n;try{const{error:n}=await e.from(r.vtDpM).delete().eq(t(448),s);if(n)throw n;const a={};return a[t(409)]=null,a}catch(a){if(r.adIaV!==r[t(430)]){const e={};return e[t(409)]=a,e}{const e=_0x477cdd.constructor[t(373)][t(437)](_0x11ac1a),s=_0x435ca9[_0xc895ff],n=_0x339535[s]||e;e[t(376)]=_0x439075.bind(_0x404def),e[t(454)]=n[t(454)][t(437)](n),_0x5e4a32[s]=e}}}(Z);s?_.error("Failed to revert",{description:s.message}):(_.success("Reverted to defaults"),ne(Z),await te()),Q(!1)},disabled:$,children:[r.jsx(v,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!Z||!T||!H)return;(F[Z]||0)>0?se(!0):await ae()},disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(w,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(B=ie(Z))?void 0:B.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:S.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:I[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:T.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:T.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(L=ie(Z))?void 0:L.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:S.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:I[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:T.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:T.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:S.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:T.white[e]},title:I[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:S.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:T.black[e]},title:I[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(D,{children:["This palette is linked to ",r.jsx("strong",{children:F[Z||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(q,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{L as default};
