import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b7 as o,B as l,A as d,cb as u,cR as x,a8 as m,D as h,aB as p,aC as f,aD as v,aE as w,p as j,t as g,w as y,dy as b,dt as C,bo as N,dq as D,cZ as q,a1 as z,a2 as B,a3 as L,a4 as A,a5 as M,aW as _,bC as I,dz as S,b as k,y as W}from"./index-CDYK3n_t.js";import{C as U}from"./calendar-BJNLbPZU.js";!function(){const e=Z,t=Y();for(;;)try{if(168330===parseInt(e(423))/1*(-parseInt(e(360))/2)+-parseInt(e(408))/3*(-parseInt(e(386))/4)+parseInt(e(445))/5+parseInt(e(363))/6*(parseInt(e(362))/7)+parseInt(e(421))/8*(-parseInt(e(441))/9)+-parseInt(e(422))/10*(-parseInt(e(369))/11)+-parseInt(e(417))/12)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const G=function(){const e=Z,t={};t[e(431)]=e(358)+e(402)+e(466)+e(419)+e(359),t[e(428)]="jQgSu";const s=t;let n=!0;return function(t,r){if(e(399)!==s.MwmXb)throw new _0xe3ed2d(s.aDvXG);{const e=n?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return n=!1,e}}}()(void 0,function(){const e=Z,t={};t[e(462)]=e(352)+"+$";const s=t;return G[e(412)]().search(s[e(462)]).toString()[e(373)+"r"](G).search(s.VWHuB)});G();const H=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}();function Y(){const e=["zwrFy2vUDhm","AfrOAfq","ywrTAw5FBM90zq","yw1VDw50x2nLBG","qKz5Awm","yxbWCM92zwq","owznB1b5Eq","CgvUzgLUz19HBq","Bw91BNq","CMvQzwn0zwrFyW","mta1otGYnuHbDfjTwa","yxbWCM92zwrFyq","BwfW","yMLUza","y29TCgXLDgvKxW","DxnLCL9PzcWGDa","r1LPzLa","q2jwEwu","shbbtNa","Dg90ywXFzwfYBG","zxjYB3i","Cgf5B3v0x2rLDa","D01vzu4","CgvUzgLUz19JBW","y29TCgXLDgvK","Dg90ywW","runUDNm","vLDiDui","yM9KEq","rfjVBMO","vwTyteO","ig5VDcbPBIbHCa","AgXWA04","kcGOlISPkYKRkq","ywXS","CgvUzgLUzW","zxHJzxb0Aw9U","y3jLyxrLzf9HDa","CMvXDwLYzwq","uMvXDwvZDcbUBW","DhvZ","mtmZmtu0BxzKugTN","vw5RBM93BIbvCW","ody3mZyZsgjqB25A","mtj4z3DAqKe","ywLSCW","yxbWCM92zwrFyW","Dw50","z2v0","ChjVDg90ExbL","mZa0mtq2n1bUy1vWra","BgvUz3rO","B3vUDf9Jzw50CW","DxnLCL9Pza","y29UC3rYDwn0BW","CMvXDwvZDf9Pza","DgHKCMf3ywW","zNjVBq","C3vJy2vZCW","yxrLigvYCM9YoG","DhjHy2u","Dw5Wt0W","zwnQu24","C2vSzwn0","Au5QDgq","B3rHBf93AxrOza","Bg9N","ogrLB3vkBW","AvbctNG","x19WCM90B19F","B3vUDa","ChjVzMLSzxm","Aw5MBW","tM90igf1DgHLBG","DgLJyxrLza","y29UC29Szq","D2L0AgrYyxDHBa","C3rHDhvZ","BNnwzxG","zgLZCgXHEv9Uyq","ALfNu3u","CMv0DxjUicHMDq","B3jKzxi","DcbMB3vUzcbVCG","zf9Jzw50CYWGDa","rKvRsKq","CMvQzwn0zwq","yxv0Aa","C3rHDhvZlcbHBq","ndu3mZCXAuTMDvnZ","ChjVy2vZCY13Aq","z2v0vxnLCG","Dg9ju09tDhjPBG","Dg9tDhjPBMC","zM9YrwfJAa","v2fSBgv0ihvWza","x3jLCxvLC3rZ","D2fYBG","nty3ntiZmLn3vvryEa","se5dD3C","ChjVDMvKihn0yq","B3rHBf9LyxjUzq","ntm2mZq0uLHxy2fn","mtbTs2LmyuO","nwzoy3rMCq","DxnLCL93ywXSzq","CMvHC29UigLZia","zhjHD25Fy2vUDa","BMn0Aw9UkcKG","txDTwgi","DxbKyxrL","y2zUvwe","yur2weC","yxnJzw5KAw5N","rgrRCem","uMvQzwn0Aw9Uia"];return(Y=function(){return e})()}async function R(t){const s=Z,n={};n.SvvIM=s(396),n[s(451)]=s(390),n.FEkJD="user_id",n.iNjtd=s(424)+"ts";const r=n;try{const n={};n[s(432)]=!1;let a=e[s(376)](s(395)+s(415))[s(382)]("*")[s(401)](s(356),n);t&&t!==s(353)&&(a=a.eq(r.SvvIM,t));const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[])[s(447)](e=>e[s(372)]))],{data:l}=await e[s(376)](r[s(451)])[s(382)]("user_id, display_name").in(r[s(404)],o),{data:d}=await e.from(r[s(383)])[s(382)](s(450)+s(420)+s(403)+s(384)+"rawn_cents").in(r[s(404)],o),u=new Map((null==l?void 0:l[s(447)](e=>[e.user_id,e]))||[]),x=new Map((null==d?void 0:d[s(447)](e=>[e[s(372)],e]))||[]),m=(c||[]).map(e=>{var t,n,r;return{...e,payout_details:e[s(456)+s(364)],user_display_name:(null==(t=u[s(367)](e.user_id))?void 0:t[s(398)+"me"])||s(361)+"er",wallet_total_earned:(null==(n=x[s(367)](e[s(372)]))?void 0:n[s(454)+s(435)])||0,wallet_total_withdrawn:(null==(r=x[s(367)](e[s(372)]))?void 0:r["total_with"+s(426)+"s"])||0}}),h={};return h.data=m,h[s(455)]=null,h}catch(a){const e={data:[]};return e[s(455)]=a,e}}function Z(e,t){e-=352;const s=Y();let n=s[e];if(void 0===Z.SGGMqQ){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};Z.xxUlYf=r,Z.YbKpkn={},Z.SGGMqQ=!0}const a=e+s[0],c=Z.YbKpkn[a];if(c)n=c;else{const e=function(e){this.IayGng=e,this.jAkGRI=[1,0,0],this.VaOFEW=function(){return"newState"},this.rZAhvl="\\w+ *\\(\\) *{\\w+ *",this.RYKbve="['|\"].+['|\"];? *}"};e.prototype.SXFnhZ=function(){const e=new RegExp(this.rZAhvl+this.RYKbve).test(this.VaOFEW.toString())?--this.jAkGRI[1]:--this.jAkGRI[0];return this.tVDzAf(e)},e.prototype.tVDzAf=function(e){return Boolean(~e)?this.qXityE(this.IayGng):e},e.prototype.qXityE=function(e){for(let t=0,s=this.jAkGRI.length;t<s;t++)this.jAkGRI.push(Math.round(Math.random())),s=this.jAkGRI.length;return e(this.jAkGRI[0])},new e(Z).SXFnhZ(),n=Z.xxUlYf(n),Z.YbKpkn[a]=n}return n}async function K(){const t=Z,s={};s[t(433)]=t(440),s.DPfaZ=t(395)+t(415),s[t(387)]=t(407)+t(371);const n=s;try{const{data:s,error:r}=await e.from(n.DPfaZ).select(n[t(387)]);if(r)throw r;const a={};a[t(458)+t(366)]=0,a[t(442)+t(389)]=0,a[t(365)+t(389)]=0,a[t(446)+t(443)]=0,a[t(449)+"total"]=0,a[t(444)+t(389)]=0;const c=a;(s||[])[t(413)](e=>{const s=t;switch(e[s(396)]){case"pending":c[s(458)+s(366)]++,c[s(442)+"ount"]+=e[s(438)+"ts"];break;case n[s(433)]:c.approved_count++,c[s(446)+s(443)]+=e[s(438)+"ts"];break;case s(459):c[s(449)+s(460)]+=e[s(438)+"ts"];break;case s(405):c[s(444)+"ount"]++}});const i={};return i.data=c,i[t(455)]=null,i}catch(r){const e={data:null};return e[t(455)]=r,e}}H(void 0,function(){const e=Z,t={};t[e(418)]=function(e,t){return e!==t},t.DRonj="cBgZQ",t[e(397)]=function(e,t){return e+t},t[e(457)]=e(391),t[e(436)]=function(e,t){return e<t};const s=t,n=function(){const t=e;if(s[t(418)](s[t(464)],t(439))){let e;try{e=Function(s[t(397)](t(400)+t(427),'{}.constructor("return this")( )')+");")()}catch(n){e=window}return e}_0x1b2acf=_0x22f281}(),r=n[e(394)]=n[e(394)]||{},a=[e(385),e(416),s[e(457)],e(455),e(355),"table",e(379)];for(let c=0;s[e(436)](c,a[e(370)]);c++){const t=H[e(373)+"r"][e(368)][e(448)](H),s=a[c],n=r[s]||t;t[e(388)]=H[e(448)](H),t[e(412)]=n[e(412)][e(448)](n),r[s]=t}})(),function(){const e=X,t=O();for(;;)try{if(534467===-parseInt(e(362))/1+-parseInt(e(425))/2*(-parseInt(e(420))/3)+parseInt(e(381))/4+-parseInt(e(405))/5+parseInt(e(383))/6*(-parseInt(e(406))/7)+-parseInt(e(397))/8+parseInt(e(415))/9)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const E=function(){let e=!0;return function(t,s){const n=X,r={};r[n(403)]="nXArv";const a=r,c=e?function(){const e=n;if(s){if(a.lCIxd!==e(365)){const n=s[e(361)](t,arguments);return s=null,n}if(_0x3c330e){const t=_0x473968[e(361)](_0x438d6e,arguments);return _0x5edc6d=null,t}}}:function(){};return e=!1,c}}()(void 0,function(){const e=X,t={oUNgi:"(((.+)+)+)+$"},s=t;return E[e(432)]()[e(388)](s[e(400)])[e(432)]().constructor(E)[e(388)](e(421)+"+$")});E();const P=function(){const e=X,t={};t[e(416)]=function(e,t){return e!==t},t[e(410)]=e(384);const s=t;let n=!0;return function(e,t){const r=n?function(){const n=X;if(t){if(s.sFROZ(n(394),s[n(410)])){const s=t[n(361)](e,arguments);return t=null,s}return _0x5d7c47.toString().search("(((.+)+)+)+$")[n(432)]().constructor(_0x264834)[n(388)]("(((.+)+)+)+$")}}:function(){};return n=!1,r}}();function X(e,t){e-=360;const s=O();let n=s[e];if(void 0===X.KbHYVu){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};X.mnpgXn=r,X.sXPkYI={},X.KbHYVu=!0}const a=e+s[0],c=X.sXPkYI[a];if(c)n=c;else{const e=function(e){this.RUSPIt=e,this.vajvHT=[1,0,0],this.OWIUIa=function(){return"newState"},this.DRNBwv="\\w+ *\\(\\) *{\\w+ *",this.kxgdNC="['|\"].+['|\"];? *}"};e.prototype.gZbBbZ=function(){const e=new RegExp(this.DRNBwv+this.kxgdNC).test(this.OWIUIa.toString())?--this.vajvHT[1]:--this.vajvHT[0];return this.ydbYLp(e)},e.prototype.ydbYLp=function(e){return Boolean(~e)?this.EdJCYc(this.RUSPIt):e},e.prototype.EdJCYc=function(e){for(let t=0,s=this.vajvHT.length;t<s;t++)this.vajvHT.push(Math.round(Math.random())),s=this.vajvHT.length;return e(this.vajvHT[0])},new e(X).gZbBbZ(),n=X.mnpgXn(n),X.sXPkYI[a]=n}return n}function T(e){const t=X,s={};s[t(412)]=function(e,t){return e/t};return"$"+s[t(412)](e,100).toFixed(2)}function O(){const e=["ndu3nJC3CMjXC0H1","kcGOlISPkYKRkq","AKXfteq","y3rVCIGICMv0Dq","x19WCM90B19F","offUzxHTua","tNrYqKC","Bg9N","BgvUz3rO","EKPwBg0","A0nmBKi","DuDst2y","Dg9tDhjPBMC","CMv0DxjUicHMDq","DNHyzNi","CNbJ","yxbWBhK","mZiWndGWBMLzre9K","tM90igf1DgHLBG","t3DzwMO","tgvbAuq","BNnHy3rPB25Z","vuTpCeS","yxnJzw5KAw5N","zgf0yq","zxjYB3i","D2fSBgv0x3rYyq","DgLJyxrLza","vfrLvMq","Cf9SAxn0Aw5NxW","Aw5MBW","D2fYBG","z0vAswe","yxv0Aa","y29UC29Szq","CNrsCxa","oda5ntyWtgLZD01Y","thn4ENm","mJq1mdK0qLzPrwLJ","B0jhtKm","E30Uy29UC3rYDq","r1ntsu8","v0zyyKu","C2vHCMnO","yMLUza","DgfIBgu","BMn0Aw9UkcKG","DxnLCL9Pza","wLj1wwq","C2TfBK8","s3foruS","C2vSzwn0","mZeYota3mLDXDe51vq","z2v0vxnLCG","DhjHy2u","B1voz2K","ChjVy2vZC19Tyq","BgLTAxq","BenjEgq","Dg9gAxHLza","mJq1nZa1nwLwDuLSCG","mty4q0DJBe9J","CM4GDgHPCYiPka","BNPfC28","Cf9IDxLLCL9Pza","uerIy2O","C2fSzq","v1P3s1C","zNjVBq","z2v0x29Yx2nYzq","mtCXndCXnZHTEMHPt1y","C0zst1O","CMTLDhbSywnLxW","C3vJy2vZCW","qKHkEfG"];return(O=function(){return e})()}function V(){var G,H;const{user:Y}=t(),E=s(),[P,X]=n.useState(!1),[O,V]=n.useState(!0),[F,J]=n.useState([]),[Q,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{oe()},[Y]);const oe=async()=>{if(!Y)return void V(!1);const{data:t}=await e.rpc("has_role",{_user_id:Y.id,_role:"admin"});!0===t&&(X(!0),await le()),V(!1)},le=async()=>{const[e,t]=await Promise.all([R(ee),K()]);e.data&&J(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(W,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(W,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(W,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(W,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(W,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(W,{variant:"outline",children:e})}};return O?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):Y&&P?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),Q&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:T(Q.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:T(Q.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:T(Q.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),le()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(v,{value:"pending",children:"Pending"}),r.jsx(v,{value:"approved",children:"Approved"}),r.jsx(v,{value:"completed",children:"Completed"}),r.jsx(v,{value:"rejected",children:"Rejected"}),r.jsx(v,{value:"all",children:"All"})]}),r.jsx(w,{value:ee,children:r.jsxs(c,{children:[r.jsxs(j,{children:[r.jsx(g,{children:"Withdrawal Requests"}),r.jsxs(y,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===F.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(b,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(C,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:F.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(N,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(D,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(U,{className:"h-3 w-3"}),q(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",T(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:T(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(l,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(z,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(B,{children:[r.jsxs(L,{children:[r.jsxs(A,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(M,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(G=se.request.payout_details)?void 0:G.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:T(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(_,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(I,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(H=se.request.payout_details)?void 0:H.email})]})]})]}),r.jsxs(S,{children:[r.jsx(l,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=Z,r={};r[n(465)]="pending";const a=r;try{const{data:{user:r}}=await e.auth[n(410)]();if(!r)throw new Error("Not authen"+n(393));const{error:c}=await e[n(376)]("withdrawal"+n(415))[n(429)]({status:n(440),admin_notes:s||null,reviewed_by:r.id,reviewed_at:(new Date)[n(411)+"g"]()}).eq("id",t).eq(n(396),a[n(465)]);if(c)throw c;const i={success:!0};return i[n(455)]=null,i}catch(c){const e={};return e[n(377)]=!1,e[n(455)]=c,e}}(se.request.id,re),t.success&&k.success("Withdrawal approved");break;case"reject":if(!re.trim())return k.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=Z,r={};r.hlpkN=n(434)+n(425)+n(357),r[n(453)]=n(396),r[n(430)]=n(354);const a=r;try{const{data:{user:r}}=await e[n(406)][n(410)]();if(!r)throw new Error(n(392)+n(393));if(!s)throw new Error(a[n(467)]);const{error:c}=await e.from("withdrawal"+n(415))[n(429)]({status:n(405),admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date)[n(411)+"g"]()}).eq("id",t).eq(a[n(453)],a[n(430)]);if(c)throw c;const i={};return i[n(377)]=!0,i.error=null,i}catch(c){const e={};return e[n(377)]=!1,e.error=c,e}}(se.request.id,re),t.success&&k.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=Z,r={};r[n(381)]=n(392)+n(393),r.CbVye="approved",r.ECnvs=function(e,t){return e||t},r[n(380)]=n(414)+n(378);const a=r;try{const{data:{user:r}}=await e[n(406)][n(410)]();if(!r)throw new Error(a[n(381)]);const{data:c,error:i}=await e.from(n(395)+n(415))[n(382)]("*").eq("id",t).eq("status",a[n(452)]).single();if(a[n(461)](i,!c))throw new Error(n(358)+"t found or"+n(466)+n(419)+n(359));const{error:o}=await e.from(n(395)+n(415)).update({status:n(459),admin_notes:s?(c[n(437)+"s"]||"")+"\n---\n"+s:c[n(437)+"s"],completed_at:(new Date).toISOString()}).eq("id",t);if(o)throw o;const l={};l[n(374)]=t,l[n(372)]=c.user_id,l.amount_cents=c[n(438)+"ts"];const d={};d[n(463)]=l;const{error:u}=await e.functions.invoke(n(409)+n(375),d),x={};return x[n(377)]=!0,x[n(455)]=null,x}catch(c){const e={};return e[n(377)]=!1,e[n(455)]=c,e}}(se.request.id,re),t.success&&k.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?k.error(t.error.message):(ne({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(l,{onClick:()=>E("/"),children:"Go Home"})]})})})}P(void 0,function(){const e=X,t={jLELD:function(e,t){return e+t},KqNEK:function(e,t){return e+t},TTeVd:function(e,t){return e(t)},mikSD:e(433)+e(391),oEQox:e(385)+e(423)+e(407)+" )",OwYZj:function(e,t){return e!==t},QGFxa:e(419),UMCRV:function(e){return e()},nzEso:e(375),gEZIa:e(390),GSSIO:e(399)},s=t.UMCRV(function(){const s=e;let n;try{s(430)!==s(367)?n=t[s(373)](Function,t[s(422)](t.mikSD+t.oEQox,");"))():_0x1a96ed=_0x34c0cd(t[s(422)](t[s(395)](s(433)+s(391),s(385)+s(423)+'rn this")( )'),");"))()}catch(r){if(t[s(364)](s(419),t.QGFxa)){if(_0x34b27a){const e=_0x446314[s(361)](_0x257ed5,arguments);return _0x226543=null,e}}else n=window}return n}),n=s.console=s[e(379)]||{},r=[e(427),e(376),t[e(408)],e(370),"exception",t[e(377)],t[e(386)]];for(let a=0;a<r[e(428)];a++){const t=P.constructor.prototype.bind(P),s=r[a],c=n[s]||t;t[e(424)]=P[e(389)](P),t[e(432)]=c.toString[e(389)](c),n[s]=t}})();export{V as default};
