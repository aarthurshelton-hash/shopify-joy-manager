import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as m,P as h,w as f,B as j,bM as w,cj as p,a9 as v,am as g,a1 as y,a2 as N,a3 as C,a4 as b,bC as z,a5 as B,cu as S,b as A}from"./index-f_XxDhCa.js";!function(){const e=M,s=k();for(;;)try{if(385794===-parseInt(e(447))/1+-parseInt(e(373))/2+parseInt(e(437))/3+parseInt(e(420))/4+-parseInt(e(348))/5+parseInt(e(444))/6*(parseInt(e(410))/7)+parseInt(e(355))/8)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const D=function(){const e=M,s={};s[e(372)]=e(364)+e(346)+" role:",s[e(353)]=e(425);const t=s;let n=!0;return function(s,a){const r=e,i={};i[r(457)]=t[r(372)];const c=i;if(t.qLbxY!==r(426)){const e=n?function(){if(a){const e=a[r(366)](s,arguments);return a=null,e}}:function(){};return n=!1,e}return _0x4e939a[r(399)](c[r(457)],_0x543695),!1}}()(void 0,function(){const e=M,s={};s[e(409)]="(((.+)+)+)+$";const t=s;return D[e(453)]()[e(440)](t[e(409)])[e(453)]()[e(411)+"r"](D)[e(440)](e(405)+"+$")});D();const K=function(){const e=M,s={edfKW:e(423),rkLnr:function(e,s){return e(s)},zDKVC:function(e){return e()},GTZvl:function(e,s){return e===s}};let t=!0;return function(n,a){const r=e,i={RxHCL:function(e,t){return s[M(404)](e,t)},kbxUX:function(e,s){return e+s},lzluR:r(451)+r(358)+r(418)+" )",rtFEo:function(e){return s.zDKVC(e)}};if(s[r(381)]("CJeLN",r(406))){const e=t?function(){const e=r;if(s[e(393)]!=s[e(393)]){const s=i.RxHCL(_0x4b1237,i[e(432)](e(428)+e(374)+i[e(443)],");"));_0x494618=i[e(419)](s)}else if(a){const s=a[e(366)](n,arguments);return a=null,s}}:function(){};return t=!1,e}{const e=_0x6cb86b[r(411)+"r"][r(422)][r(349)](_0x4769d1),s=_0x16a4d7[_0xf9e477],t=_0xcd0278[s]||e;e.__proto__=_0x5ca5d5[r(349)](_0x238d89),e[r(453)]=t[r(453)].bind(t),_0x2c5247[s]=e}}}();function k(){const e=["DhjHy2u","zxjYB3i","uvzoyuS","CgfSzxr0zv9Pza","s0PNqwS","D2fls00","CMTmBNi","kcGOlISPkYKRkq","q0PLte4","B3jKzxi","z2XsuKy","A3bcChG","mta0ntf5Ee9yCKi","y29UC3rYDwn0BW","CgfSzxr0zv9VDG","Bg9N","EKTzBKS","EMDysgS","rxjYB3iGy291BG","Bxjbyvm","CM4GDgHPCYiPka","CNrgrw8","mte1ndm3mKjMB0L1yG","DMvYC2LVBG","ChjVDg90ExbL","rwjiyKK","zMTZAKu","r2f5sxq","u1zMyKC","B1z2vfi","CMv0DxjUicHMDq","D2HPDgvFy29SBW","D2HPDgu","Aw9Uu3rHDgu","A2j4vvG","ExrvDxq","x3vZzxjFAwq","ywrTAw4","CuTjDeu","mJm0nZm1B0PADgHx","zMLUza","Eg1cAeS","C2vHCMnO","ve1xBxu","rfDlzLq","BhPSDvi","mJyZngH0uuffvW","t0zLww0","C2vSzwn0","mtiYntmXELvnCMjZ","y0nUvuG","u21UCK8","C2nOBeG","E30Uy29UC3rYDq","CfDuDKC","Dg9tDhjPBMC","AgjxBxe","x3jVBgu","DhrLswq","tuDdzvO","DgLUzYbSAw5Rzq","A2LUzYbHzg1PBG","Aw5Zzxj0","mJKWndi1nuXJwMzIuq","yMLUza","zxHJzxb0Aw9U","yxrH","sMf4Cfy","CuXIEfK","zxjYAwrLCW","mZq3oty3mMrfzvP3sG","zNjVBq","DMLZDwfSAxPHDa","y3rVCIGICMv0Dq","DgfIBgu","zcb2Axn1ywXPEG","x19WCM90B19F","DvbMre4","AwqSigDHBwvFza","rxjYB3iGy2HLyW","C2LUz2XL","yxbWBhK","C0LqBNm","Bw9KAwzPzwrFyG","AvbLtgK","CgfSzxr0zuLK","CNbJ","zLnmBM8","nZm2mdK2BKXjtfHs","BMn0Aw9UkcKG","q3bbywK","BgHfCNm","ueDsu1qXmty","z2fTzv9KyxrH","zg1PBIbJAgvJAW","CKXXrfm","r1rADMW","wK5xy0e","B2TKBvq","zgvSzxrL","y29Kzq","yMXHy2S","zgf0yq","y29UC29Szq","BwLPtvG","sMTSzu0","ywXPEMf0Aw9UCW","Aw5MBW","zwrMs1C","rxjYB3iGAw4Gyq","AgfZx3jVBgu","D2fYBG","yMXHy2TFy29SBW"];return(k=function(){return e})()}function M(e,s){e-=345;const t=k();let n=t[e];if(void 0===M.cnrINU){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};M.YmjawO=a,M.GaXZES={},M.cnrINU=!0}const r=e+t[0],i=M.GaXZES[r];if(i)n=i;else{const e=function(e){this.QaKGcA=e,this.acAHaT=[1,0,0],this.DOsKjd=function(){return"newState"},this.krfdOJ="\\w+ *\\(\\) *{\\w+ *",this.CwQxSj="['|\"].+['|\"];? *}"};e.prototype.jCaPac=function(){const e=new RegExp(this.krfdOJ+this.CwQxSj).test(this.DOsKjd.toString())?--this.acAHaT[1]:--this.acAHaT[0];return this.eYAHDq(e)},e.prototype.eYAHDq=function(e){return Boolean(~e)?this.BniiCS(this.QaKGcA):e},e.prototype.BniiCS=function(e){for(let s=0,t=this.acAHaT.length;s<t;s++)this.acAHaT.push(Math.round(Math.random())),t=this.acAHaT.length;return e(this.acAHaT[0])},new e(M).jCaPac(),n=M.YmjawO(n),M.GaXZES[r]=n}return n}async function H(s,t,n,a){const r=M,i={};i[r(367)]=function(e,s){return e!==s},i[r(442)]=r(369),i[r(402)]=r(412)+"errides";const c=i;try{const{data:i}=await async function(s){const t=M,n={};n.cCnUH=t(401),n[t(380)]=function(e,s){return e!==s},n.CpAai=t(377);const a=n;try{const{data:n,error:r}=await e[t(356)](t(412)+t(354))[t(446)]("*").eq(a[t(448)],s)[t(365)]();if(r&&a.rLqDS(r[t(385)],a[t(375)]))throw r;const i={};return i.data=n,i[t(399)]=null,i}catch(r){if(a[t(380)](t(427),t(452))){const e={};return e[t(387)]=null,e[t(399)]=r,e}{const e={data:[]};return e.error=_0x11d9ae,e}}}(s);if(i){const c={};c[r(429)+"rs"]=t,c[r(397)+"rs"]=n,c[r(368)+"y"]=a,c[r(421)]=i.version+1;const{error:o}=await e.from(r(412)+"errides").update(c).eq(r(401),s);if(o)throw o;const l={};return l[r(399)]=null,l[r(421)]=i[r(421)]+1,l}if(c[r(367)](c[r(442)],"iPeLi")){const e={};return e[r(399)]=_0x314933,e}{const i={};i[r(401)]=s,i[r(429)+"rs"]=t,i[r(397)+"rs"]=n,i[r(368)+"y"]=a,i[r(421)]=1;const{error:o}=await e.from(c[r(402)])[r(347)](i);if(o)throw o;const l={};return l[r(399)]=null,l[r(421)]=1,l}}catch(o){const e={};return e[r(399)]=o,e[r(421)]=0,e}}async function q(s){const t=M,n={schlH:function(e,s){return e!==s}};n.JkleM=t(436),n[t(439)]=t(363)+t(351),n.ZNWcA=function(e,s){return e===s};const a=n;try{if(a[t(450)]("qKItE",a[t(390)])){const e=_0xa887ef[t(366)](_0x374f1c,arguments);return _0x4e314e=null,e}{const{data:n,error:r}=await e[t(356)]("saved_visu"+t(391))[t(446)](a[t(439)]);if(r)throw r;let i=0;for(const e of n||[]){const n=e[t(378)][t(357)+t(431)];((null==n?void 0:n[t(370)])===s||a[t(382)](null==n?void 0:n["linkedPale"+t(456)],s))&&i++}return i}}catch(r){return 0}}K(void 0,function(){const e=M,s={miiMX:function(e,s){return e(s)},SPrcv:function(e,s){return e+s},glRRF:function(e,s){return e+s},JaxpV:e(428)+e(374),mrAaS:function(e){return e()},rBNwV:e(376),okdmT:e(413),SmnrO:e(396),zgXHk:e(399),uPfDN:e(350),IyOVH:e(359),waKKM:function(e,s){return e<s}};let t;try{const n=s[e(389)](Function,s.SPrcv(s[e(408)](s[e(352)],e(451)+e(358)+e(418)+" )"),");"));t=s[e(417)](n)}catch(r){if(s.rBNwV!==e(376)){const s=_0x2b1873[e(366)](_0x32e3c5,arguments);return _0x441000=null,s}t=window}const n=t[e(388)]=t[e(388)]||{},a=[s[e(383)],s[e(449)],e(392),s[e(415)],s[e(362)],s.IyOVH,e(398)];for(let i=0;s[e(403)](i,a.length);i++){const s=K[e(411)+"r"].prototype[e(349)](K),t=a[i],r=n[t]||s;s[e(361)]=K[e(349)](K),s[e(453)]=r.toString.bind(r),n[t]=s}})();const P=["k","q","r","b","n","p"],_={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},L=()=>{var D,K,k,L;const{user:G}=s(),U=t(),[I,E]=n.useState(!1),[T,X]=n.useState(!0),[Y,W]=n.useState([]),[V,J]=n.useState(null),[O,Z]=n.useState(null),[R,F]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!G)return void U("/");if(!(await async function(s){const t=M,n={};n.RIKUw=t(405)+"+$",n.zKYnK=t(441),n[t(400)]=t(445),n[t(433)]=function(e,s){return e===s};const a=n;try{if("HtiXm"===a[t(414)])return _0x24a013[t(399)](t(394)+t(379)+":",_0x3845b3),!1;{const n={};n[t(434)]=s,n[t(455)]=t(435);const{data:r,error:i}=await e[t(371)](t(395),n);return i?a.QVNaK!=a.QVNaK&&_0x13186f[t(453)]().search(bgvHuM.RIKUw)[t(453)]()[t(411)+"r"](_0x59da1b)[t(440)](t(405)+"+$"):a.ytUut(r,!0)}}catch(r){return!1}}(G.id)))return A.error("Access denied",{description:"Admin privileges required"}),void U("/");E(!0),await te(),X(!1)})()},[G,U]);const te=async()=>{const{data:s}=await async function(){const s=M,t={};t.JEwsy=s(412)+s(354),t.hbWmq=s(401);const n=t;try{const{data:t,error:a}=await e[s(356)](n.JEwsy)[s(446)]("*")[s(407)](n[s(454)]);if(a)throw a;const r={};return r.data=t||[],r[s(399)]=null,r}catch(a){const e={data:[]};return e.error=a,e}}();W(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await q(e.id);F(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=Y.find(s=>s.palette_id===e);J(e),Z({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{O&&Z({...O,[e]:{...O[e],[s]:t}})},re=async()=>{if(!V||!O||!G)return;Q(!0),se(!1);const{error:e,version:s}=await H(V,O.white,O.black,G.id);e?A.error("Failed to save",{description:e.message}):(A.success("Palette updated!",{description:`Version ${s} saved. ${R[V]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>Y.some(s=>s.palette_id===e);return T?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):I?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(V===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(l,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),R[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),R[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[P.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),P.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:V&&O?a.jsxs(o,{children:[a.jsx(x,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(m,{className:"flex items-center gap-2",children:[a.jsx(h,{className:"h-5 w-5"}),null==(D=ie(V))?void 0:D.name]}),a.jsx(f,{children:null==(K=ie(V))?void 0:K.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(V)&&a.jsxs(j,{variant:"outline",size:"sm",onClick:async()=>{if(!V)return;Q(!0);const{error:s}=await async function(s){const t=M,n={};n[t(424)]="palette_id";const a=n;try{const{error:n}=await e[t(356)](t(412)+t(354))[t(384)]().eq(a[t(424)],s);if(n)throw n;const r={};return r[t(399)]=null,r}catch(r){const e={};return e[t(399)]=r,e}}(V);s?A.error("Failed to revert",{description:s.message}):(A.success("Reverted to defaults"),ne(V),await te()),Q(!1)},disabled:$,children:[a.jsx(w,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(j,{size:"sm",onClick:async()=>{if(!V||!O||!G)return;(R[V]||0)>0?se(!0):await re()},disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(p,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(l,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(k=ie(V))?void 0:k.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:P.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:_[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(v,{type:"color",value:O.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(v,{type:"text",value:O.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(L=ie(V))?void 0:L.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:P.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:_[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(v,{type:"color",value:O.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(v,{type:"text",value:O.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:P.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.white[e]},title:_[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:P.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.black[e]},title:_[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(o,{className:"h-full flex items-center justify-center",children:a.jsxs(l,{className:"text-center py-12",children:[a.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(C,{children:[a.jsxs(b,{className:"flex items-center gap-2",children:[a.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(B,{children:["This palette is linked to ",a.jsx("strong",{children:R[V||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(j,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(j,{onClick:re,disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(S,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{L as default};
