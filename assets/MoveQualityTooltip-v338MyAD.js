const n='/**\n * Move Quality Tooltip Component\n * \n * Displays detailed hover information about move quality,\n * including book moves and opening/variant details.\n */\n\nimport React from \'react\';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \'@/components/ui/tooltip\';\nimport { BookOpen, Info, Target, Zap } from \'lucide-react\';\nimport { ClassifiedMove, MOVE_QUALITY_INFO } from \'@/lib/chess/moveQuality\';\nimport { ChessOpening, detectOpening } from \'@/lib/chess/chessAnalysis\';\nimport { Chess } from \'chess.js\';\n\ninterface BookMoveDetails {\n  moveNumber: number;\n  san: string;\n  color: \'w\' | \'b\';\n}\n\ninterface OpeningInfo {\n  opening: ChessOpening | undefined;\n  bookMoves: BookMoveDetails[];\n  lastBookMoveNumber: number;\n}\n\n/**\n * Extract opening and book move information from classified moves\n */\nexport function extractOpeningInfo(pgn: string, classifiedMoves: ClassifiedMove[]): OpeningInfo {\n  // Get opening from PGN\n  const chess = new Chess();\n  let moves: string[] = [];\n  \n  try {\n    chess.loadPgn(pgn);\n    moves = chess.history();\n  } catch {\n    // If PGN fails, extract from classified moves\n    moves = classifiedMoves.map(m => m.san);\n  }\n  \n  const opening = detectOpening(moves);\n  \n  // Extract book moves from classified moves\n  const bookMoves: BookMoveDetails[] = classifiedMoves\n    .filter(m => m.quality === \'book\')\n    .map(m => ({\n      moveNumber: m.moveNumber,\n      san: m.san,\n      color: m.color,\n    }));\n  \n  const lastBookMoveNumber = bookMoves.length > 0 \n    ? Math.max(...bookMoves.map(m => m.moveNumber))\n    : 0;\n  \n  return {\n    opening,\n    bookMoves,\n    lastBookMoveNumber,\n  };\n}\n\ninterface MoveQualityTooltipProps {\n  children: React.ReactNode;\n  quality: keyof typeof MOVE_QUALITY_INFO;\n  count: number;\n  openingInfo?: OpeningInfo;\n  classifiedMoves?: ClassifiedMove[];\n}\n\n/**\n * Individual move quality stat with tooltip\n */\nexport function MoveQualityTooltip({ \n  children, \n  quality, \n  count,\n  openingInfo,\n  classifiedMoves,\n}: MoveQualityTooltipProps) {\n  const info = MOVE_QUALITY_INFO[quality];\n  \n  // Get specific moves of this quality\n  const movesOfQuality = classifiedMoves?.filter(m => m.quality === quality) || [];\n  \n  return (\n    <Tooltip delayDuration={200}>\n      <TooltipTrigger asChild>\n        {children}\n      </TooltipTrigger>\n      <TooltipContent \n        side="top" \n        className="max-w-xs p-3 space-y-2"\n        sideOffset={8}\n      >\n        <div className="flex items-center gap-2 border-b border-border/30 pb-2">\n          <span \n            className="text-lg font-bold"\n            style={{ color: info.color }}\n          >\n            {info.symbol}\n          </span>\n          <div>\n            <p className="font-semibold" style={{ color: info.color }}>\n              {info.label}\n            </p>\n            <p className="text-xs text-muted-foreground">\n              {count} move{count !== 1 ? \'s\' : \'\'}\n            </p>\n          </div>\n        </div>\n        \n        <p className="text-xs text-muted-foreground">\n          {info.description}\n        </p>\n        \n        {quality === \'book\' && openingInfo && (\n          <div className="space-y-2 pt-1">\n            {openingInfo.opening && (\n              <div className="bg-emerald-500/10 rounded p-2 border border-emerald-500/20">\n                <div className="flex items-center gap-1.5 mb-1">\n                  <BookOpen className="h-3 w-3 text-emerald-400" />\n                  <span className="text-xs font-medium text-emerald-400">\n                    Opening Detected\n                  </span>\n                </div>\n                <p className="text-sm font-semibold text-foreground">\n                  {openingInfo.opening.name}\n                </p>\n                <p className="text-[10px] text-muted-foreground">\n                  ECO: {openingInfo.opening.eco} â€¢ {openingInfo.opening.category}\n                </p>\n                <p className="text-xs text-muted-foreground mt-1">\n                  {openingInfo.opening.description}\n                </p>\n              </div>\n            )}\n            \n            {openingInfo.bookMoves.length > 0 && (\n              <div className="space-y-1">\n                <p className="text-[10px] uppercase tracking-wider text-muted-foreground">\n                  Book Moves Played\n                </p>\n                <div className="flex flex-wrap gap-1">\n                  {openingInfo.bookMoves.slice(0, 10).map((m, i) => (\n                    <span \n                      key={i}\n                      className="text-xs px-1.5 py-0.5 rounded bg-emerald-500/10 text-emerald-400 border border-emerald-500/20"\n                    >\n                      {m.moveNumber}.{m.color === \'b\' ? \'..\' : \'\'}{m.san}\n                    </span>\n                  ))}\n                  {openingInfo.bookMoves.length > 10 && (\n                    <span className="text-xs text-muted-foreground">\n                      +{openingInfo.bookMoves.length - 10} more\n                    </span>\n                  )}\n                </div>\n                <p className="text-[10px] text-muted-foreground">\n                  Theory followed through move {openingInfo.lastBookMoveNumber}\n                </p>\n              </div>\n            )}\n          </div>\n        )}\n        \n        {quality !== \'book\' && movesOfQuality.length > 0 && movesOfQuality.length <= 8 && (\n          <div className="pt-1">\n            <p className="text-[10px] uppercase tracking-wider text-muted-foreground mb-1">\n              Moves\n            </p>\n            <div className="flex flex-wrap gap-1">\n              {movesOfQuality.map((m, i) => (\n                <span \n                  key={i}\n                  className="text-xs px-1.5 py-0.5 rounded"\n                  style={{ \n                    backgroundColor: `${info.color}15`,\n                    color: info.color,\n                    border: `1px solid ${info.color}30`\n                  }}\n                >\n                  {m.moveNumber}.{m.color === \'b\' ? \'..\' : \'\'}{m.san}\n                </span>\n              ))}\n            </div>\n          </div>\n        )}\n        \n        {info.cpLossRange && (\n          <p className="text-[10px] text-muted-foreground pt-1 border-t border-border/30">\n            <Target className="h-3 w-3 inline mr-1" />\n            {info.cpLossRange}\n          </p>\n        )}\n      </TooltipContent>\n    </Tooltip>\n  );\n}\n\ninterface BookMovesCardProps {\n  count: number;\n  openingInfo: OpeningInfo;\n}\n\n/**\n * Dedicated Book Moves display card with hover details\n */\nexport function BookMovesCard({ count, openingInfo }: BookMovesCardProps) {\n  return (\n    <Tooltip delayDuration={200}>\n      <TooltipTrigger asChild>\n        <div className="mb-3 p-2 rounded bg-emerald-500/10 border border-emerald-500/20 text-center cursor-help transition-all hover:bg-emerald-500/15 hover:border-emerald-500/30">\n          <span className="text-xs text-emerald-400">\n            ðŸ“– {count} Opening Book Moves\n          </span>\n        </div>\n      </TooltipTrigger>\n      <TooltipContent \n        side="top" \n        className="max-w-sm p-4 space-y-3"\n        sideOffset={8}\n      >\n        <div className="flex items-center gap-2 border-b border-border/30 pb-2">\n          <BookOpen className="h-5 w-5 text-emerald-400" />\n          <div>\n            <p className="font-semibold text-emerald-400">Opening Theory</p>\n            <p className="text-xs text-muted-foreground">\n              {count} move{count !== 1 ? \'s\' : \'\'} from established theory\n            </p>\n          </div>\n        </div>\n        \n        {openingInfo.opening ? (\n          <div className="space-y-2">\n            <div className="bg-emerald-500/10 rounded-lg p-3 border border-emerald-500/20">\n              <p className="text-sm font-bold text-foreground">\n                {openingInfo.opening.name}\n              </p>\n              <div className="flex items-center gap-2 mt-1">\n                <span className="text-[10px] px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400">\n                  ECO: {openingInfo.opening.eco}\n                </span>\n                <span className="text-[10px] px-1.5 py-0.5 rounded bg-muted text-muted-foreground capitalize">\n                  {openingInfo.opening.category}\n                </span>\n              </div>\n              <p className="text-xs text-muted-foreground mt-2">\n                {openingInfo.opening.description}\n              </p>\n            </div>\n            \n            <div className="text-xs text-muted-foreground">\n              <span className="font-medium">Main Line: </span>\n              <span className="font-mono text-[10px]">{openingInfo.opening.moves}</span>\n            </div>\n          </div>\n        ) : (\n          <p className="text-xs text-muted-foreground">\n            Moves follow general opening principles\n          </p>\n        )}\n        \n        {openingInfo.bookMoves.length > 0 && (\n          <div className="space-y-1.5">\n            <p className="text-[10px] uppercase tracking-wider text-muted-foreground flex items-center gap-1">\n              <Zap className="h-3 w-3" />\n              Book Moves in This Game\n            </p>\n            <div className="flex flex-wrap gap-1">\n              {openingInfo.bookMoves.map((m, i) => (\n                <span \n                  key={i}\n                  className="text-xs px-1.5 py-0.5 rounded bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 font-mono"\n                >\n                  {m.moveNumber}.{m.color === \'b\' ? \'..\' : \'\'}{m.san}\n                </span>\n              ))}\n            </div>\n          </div>\n        )}\n        \n        <div className="text-[10px] text-muted-foreground pt-2 border-t border-border/30 flex items-start gap-1.5">\n          <Info className="h-3 w-3 mt-0.5 shrink-0" />\n          <span>\n            Book moves are recognized moves from chess opening databases, \n            indicating adherence to established theory and best practices.\n          </span>\n        </div>\n      </TooltipContent>\n    </Tooltip>\n  );\n}\n\nexport default MoveQualityTooltip;\n';export{n as default};
