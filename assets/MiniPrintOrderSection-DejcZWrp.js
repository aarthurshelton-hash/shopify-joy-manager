const e='import React, { useState, useMemo } from \'react\';\nimport { motion } from \'framer-motion\';\nimport { Printer, ChevronRight, Frame, Package } from \'lucide-react\';\nimport { Button } from \'@/components/ui/button\';\nimport { Badge } from \'@/components/ui/badge\';\nimport { WallMockup, RoomSetting, FrameStyleOption } from \'@/components/shop/WallMockup\';\nimport PrintReadyVisualization from \'./PrintReadyVisualization\';\nimport { SquareData, GameData } from \'@/lib/chess/gameSimulator\';\nimport { FRAME_STYLES, getBaseFramePrice } from \'@/lib/shop/framePricing\';\nimport { useTimeline } from \'@/contexts/TimelineContext\';\nimport { useLegendHighlight } from \'@/contexts/LegendHighlightContext\';\n\ninterface ExportState {\n  currentMove: number;\n  lockedPieces: Array<{ pieceType: string; pieceColor: string }>;\n  lockedSquares: Array<{ square: string; pieces: Array<{ pieceType: string; pieceColor: string }> }>;\n  compareMode: boolean;\n  darkMode: boolean;\n  showPieces: boolean;\n  pieceOpacity: number;\n  fen?: string; // Optional FEN for the current position\n}\n\ninterface MiniPrintOrderSectionProps {\n  board: SquareData[][];\n  gameData: GameData;\n  totalMoves: number;\n  darkMode?: boolean;\n  showPieces?: boolean;\n  pieceOpacity?: number;\n  onOrderPrint?: (exportState: ExportState) => void;\n  className?: string;\n}\n\nconst MINI_FRAME_OPTIONS: FrameStyleOption[] = FRAME_STYLES.slice(0, 4).map(f => ({\n  id: f.id,\n  colorHex: f.color,\n}));\n\n// 3 most popular print sizes\nconst POPULAR_SIZES: { label: string; value: string; price: number; scale: number }[] = [\n  { label: \'8×10"\', value: \'8x10\', price: 29.99, scale: 0.7 },\n  { label: \'16×20"\', value: \'16x20\', price: 49.99, scale: 1.0 },\n  { label: \'24×36"\', value: \'24x36\', price: 79.99, scale: 1.3 },\n];\n\nexport const MiniPrintOrderSection: React.FC<MiniPrintOrderSectionProps> = ({\n  board,\n  gameData,\n  totalMoves,\n  darkMode = false,\n  showPieces = false,\n  pieceOpacity = 0.7,\n  onOrderPrint,\n  className = \'\',\n}) => {\n  const { currentMove } = useTimeline();\n  const { lockedPieces, lockedSquares, compareMode } = useLegendHighlight();\n  const [selectedFrame, setSelectedFrame] = useState<FrameStyleOption | null>(MINI_FRAME_OPTIONS[0]);\n  const [selectedSize, setSelectedSize] = useState(POPULAR_SIZES[0]);\n  const [roomSetting] = useState<RoomSetting>(\'living\');\n\n  const handleOrderPrint = () => {\n    const exportState: ExportState = {\n      currentMove: currentMove >= totalMoves ? totalMoves : currentMove,\n      lockedPieces: lockedPieces.map(p => ({\n        pieceType: p.pieceType,\n        pieceColor: p.pieceColor,\n      })),\n      lockedSquares: lockedSquares.map(sq => ({\n        square: sq.square,\n        pieces: sq.pieces.map(p => ({\n          pieceType: p.pieceType,\n          pieceColor: p.pieceColor,\n        })),\n      })),\n      compareMode,\n      darkMode,\n      showPieces,\n      pieceOpacity,\n    };\n    onOrderPrint?.(exportState);\n  };\n\n  // Filter board to current move\n  const filteredBoard = useMemo(() => {\n    if (currentMove >= totalMoves) return board;\n    return board.map(rank =>\n      rank.map(square => ({\n        ...square,\n        visits: square.visits.filter(visit => visit.moveNumber <= currentMove)\n      }))\n    );\n  }, [board, currentMove, totalMoves]);\n\n  // Mini visualization for the mockup - captures exact current state including highlights and pieces\n  const miniVisualization = useMemo(() => {\n    // Build highlight state from current locked pieces and squares\n    const highlightState = (lockedPieces.length > 0 || lockedSquares.length > 0) ? {\n      lockedPieces: lockedPieces.map(p => ({\n        pieceType: p.pieceType,\n        pieceColor: p.pieceColor,\n      })),\n      lockedSquares: lockedSquares.map(sq => ({\n        square: sq.square,\n        pieces: sq.pieces.map(p => ({\n          pieceType: p.pieceType,\n          pieceColor: p.pieceColor,\n        })),\n      })),\n      compareMode,\n    } : undefined;\n\n    // Build pieces state if pieces are shown\n    const piecesState = showPieces ? {\n      showPieces: true,\n      pieceOpacity,\n      currentMoveNumber: currentMove >= totalMoves ? undefined : currentMove,\n    } : undefined;\n\n    return (\n      <PrintReadyVisualization\n        board={filteredBoard}\n        gameData={gameData}\n        size={100}\n        darkMode={darkMode}\n        compact\n        highlightState={highlightState}\n        piecesState={piecesState}\n        pgn={gameData.pgn}\n      />\n    );\n  }, [filteredBoard, gameData, darkMode, lockedPieces, lockedSquares, compareMode, showPieces, pieceOpacity, currentMove, totalMoves]);\n\n  const framePrice = selectedFrame ? getBaseFramePrice(selectedSize.value as \'8x10\' | \'11x14\' | \'16x20\' | \'18x24\' | \'24x36\') : 0;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 10 }}\n      animate={{ opacity: 1, y: 0 }}\n      className={`rounded-xl border border-primary/20 bg-gradient-to-br from-primary/5 via-amber-500/5 to-orange-500/5 p-4 ${className}`}\n    >\n      {/* Header */}\n      <div className="flex items-center justify-between mb-3">\n        <div className="flex items-center gap-2">\n          <div className="h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center">\n            <Printer className="h-4 w-4 text-primary" />\n          </div>\n          <div>\n            <h4 className="font-display text-sm font-medium">Premium Print</h4>\n            <p className="text-xs text-muted-foreground">Museum-quality canvas</p>\n          </div>\n        </div>\n        <Badge variant="outline" className="bg-primary/10 text-primary border-primary/30 text-xs">\n          ${selectedSize.price.toFixed(0)}{selectedFrame ? `+` : \'\'}\n        </Badge>\n      </div>\n\n      {/* Size Quick Select */}\n      <div className="mb-3">\n        <p className="text-xs text-muted-foreground mb-1.5 flex items-center gap-1">\n          <Package className="h-3 w-3" />\n          Size\n        </p>\n        <div className="flex gap-2">\n          {POPULAR_SIZES.map((size) => (\n            <button\n              key={size.value}\n              onClick={() => setSelectedSize(size)}\n              className={`flex-1 py-1.5 px-2 rounded-md border text-xs font-medium transition-all ${\n                selectedSize.value === size.value\n                  ? \'border-primary bg-primary/10 text-primary\'\n                  : \'border-border bg-background/50 text-muted-foreground hover:border-primary/50 hover:text-foreground\'\n              }`}\n            >\n              <span className="block">{size.label}</span>\n              <span className="block text-[10px] opacity-70">${size.price}</span>\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className="flex gap-4 items-center">\n        {/* Wall Mockup */}\n        <motion.div \n          key={selectedSize.value}\n          initial={{ scale: 0.9, opacity: 0.5 }}\n          animate={{ scale: 1, opacity: 1 }}\n          transition={{ duration: 0.2 }}\n          className="shrink-0 origin-left -ml-2"\n          style={{ transform: `scale(${0.85 * selectedSize.scale})` }}\n        >\n          <WallMockup\n            sizeLabel={selectedSize.value}\n            roomSetting={roomSetting}\n            visualizationElement={miniVisualization}\n            selectedFrame={selectedFrame}\n          />\n        </motion.div>\n\n        {/* Right Side */}\n        <div className="flex-1 min-w-0 space-y-3">\n          {/* Frame Quick Select */}\n          <div>\n            <p className="text-xs text-muted-foreground mb-1.5 flex items-center gap-1">\n              <Frame className="h-3 w-3" />\n              Frame Style\n            </p>\n            <div className="flex gap-1.5">\n              {MINI_FRAME_OPTIONS.map((frame) => (\n                <button\n                  key={frame.id}\n                  onClick={() => setSelectedFrame(frame)}\n                  className={`w-6 h-6 rounded-full border-2 transition-all ${\n                    selectedFrame?.id === frame.id\n                      ? \'border-primary ring-2 ring-primary/30 scale-110\'\n                      : \'border-border hover:border-primary/50\'\n                  }`}\n                  style={{ backgroundColor: frame.colorHex }}\n                  title={frame.id.charAt(0).toUpperCase() + frame.id.slice(1)}\n                />\n              ))}\n              <button\n                onClick={() => setSelectedFrame(null)}\n                className={`w-6 h-6 rounded-full border-2 transition-all flex items-center justify-center text-[8px] font-medium ${\n                  !selectedFrame\n                    ? \'border-primary ring-2 ring-primary/30 scale-110 bg-background\'\n                    : \'border-border hover:border-primary/50 bg-muted\'\n                }`}\n                title="No frame"\n              >\n                ✕\n              </button>\n            </div>\n          </div>\n\n          {/* Features */}\n          <div className="flex flex-wrap gap-1.5">\n            <Badge variant="secondary" className="text-[10px] px-1.5 py-0.5">\n              <Package className="h-2.5 w-2.5 mr-1" />\n              Free US Shipping\n            </Badge>\n            <Badge variant="secondary" className="text-[10px] px-1.5 py-0.5">\n              6 Sizes Available\n            </Badge>\n          </div>\n\n          {/* CTA */}\n          <Button \n            size="sm" \n            className="w-full gap-2 bg-gradient-to-r from-primary to-amber-500 hover:from-primary/90 hover:to-amber-500/90"\n            onClick={handleOrderPrint}\n          >\n            <Printer className="h-4 w-4" />\n            Order Print\n            <ChevronRight className="h-4 w-4" />\n          </Button>\n        </div>\n      </div>\n    </motion.div>\n  );\n};\n\nexport default MiniPrintOrderSection;\n';export{e as default};
