import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as h,P as m,w as f,B as v,bM as p,cj as j,a9 as g,am as w,a1 as y,a2 as N,a3 as b,a4 as z,bC as C,a5 as k,cu as B,b as S}from"./index-0PGTc9H0.js";function q(e,s){e-=221;const t=M();let n=t[e];if(void 0===q.mNyzqI){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};q.KFedBU=a,q.Gkmdxe={},q.mNyzqI=!0}const r=e+t[0],i=q.Gkmdxe[r];if(i)n=i;else{const e=function(e){this.MRSkvh=e,this.ahZHIa=[1,0,0],this.Sudcdt=function(){return"newState"},this.lycGvU="\\w+ *\\(\\) *{\\w+ *",this.pzKXAA="['|\"].+['|\"];? *}"};e.prototype.EVtSWo=function(){const e=new RegExp(this.lycGvU+this.pzKXAA).test(this.Sudcdt.toString())?--this.ahZHIa[1]:--this.ahZHIa[0];return this.QPPlGF(e)},e.prototype.QPPlGF=function(e){return Boolean(~e)?this.uNVvMY(this.MRSkvh):e},e.prototype.uNVvMY=function(e){for(let s=0,t=this.ahZHIa.length;s<t;s++)this.ahZHIa.push(Math.round(Math.random())),t=this.ahZHIa.length;return e(this.ahZHIa[0])},new e(q).EVtSWo(),n=q.KFedBU(n),q.Gkmdxe[r]=n}return n}!function(){const e=q,s=M();for(;;)try{if(646320===-parseInt(e(256))/1+parseInt(e(286))/2*(-parseInt(e(291))/3)+-parseInt(e(255))/4*(-parseInt(e(231))/5)+-parseInt(e(306))/6+parseInt(e(290))/7*(parseInt(e(241))/8)+-parseInt(e(282))/9+parseInt(e(273))/10)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const A=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[q(229)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=q,s={};s.gNaKf=e(265)+"+$";const t=s;return A.toString()[e(232)](t[e(224)]).toString()[e(236)+"r"](A).search("(((.+)+)+)+$")});A();const D=function(){const e=q,s={};s[e(267)]=e(276),s.yaYHt="aJyMs";const t=s;let n=!0;return function(s,a){const r=e,i={};i[r(239)]=t[r(267)],i[r(311)]="kuueA",i[r(300)]=t[r(221)];const c=i;if("KHNqi"===r(295)){const e=n?function(){const e=r;if(c[e(239)]!==c.gpJBr){if(a){if(c.UfVvO===e(274))return _0x566d6e[e(266)]("Error chec"+e(254)+e(275),_0x490dab),!1;{const t=a[e(229)](s,arguments);return a=null,t}}}else if(_0x2d4324){const s=_0x10bec8[e(229)](_0x41510a,arguments);return _0x4d2544=null,s}}:function(){};return n=!1,e}{const e=_0x1c13eb[r(236)+"r"][r(240)][r(251)](_0x206fd8),s=_0x55dc40[_0x56ebb3],t=_0x4db003[s]||e;e[r(292)]=_0x3c68f3[r(251)](_0x50080d),e.toString=t[r(315)].bind(t),_0x14e497[s]=e}}}();async function H(s,t,n,a){const r=q,i={};i.Vkqel=r(260)+"dmin check:",i[r(289)]=r(265)+"+$",i.xlXLH=function(e,s){return e===s},i[r(237)]=function(e,s){return e===s},i.FrjXW=function(e,s){return e+s};const c=i;try{if(c.xlXLH(r(288),r(263)))return _0x1cee45[r(266)](c[r(234)],_0x8a98ed),!1;{const{data:i}=await async function(s){const t=q,n={};n.qWCAx=t(242)+"errides";const a=n;try{const{data:n,error:r}=await e[t(317)](a[t(259)])[t(314)]("*").eq("palette_id",s).single();if(r&&r[t(301)]!==t(248))throw r;const i={};return i[t(222)]=n,i[t(266)]=null,i}catch(r){const e={};return e[t(222)]=null,e.error=r,e}}(s);if(i){if(c[r(237)](r(247),"suRnz"))return _0x297322[r(315)]()[r(232)](lHBVBX[r(289)]).toString().constructor(_0x4f6945).search(lHBVBX[r(289)]);{const o={};o[r(284)+"rs"]=t,o[r(281)+"rs"]=n,o[r(302)+"y"]=a,o[r(258)]=i.version+1;const{error:l}=await e[r(317)]("palette_ov"+r(293))[r(228)](o).eq(r(245),s);if(l)throw l;return{error:null,version:c[r(299)](i.version,1)}}}{const i={};i[r(245)]=s,i[r(284)+"rs"]=t,i[r(281)+"rs"]=n,i[r(302)+"y"]=a,i.version=1;const{error:c}=await e[r(317)](r(242)+r(293))[r(294)](i);if(c)throw c;const o={error:null};return o[r(258)]=1,o}}}catch(o){const e={};return e[r(266)]=o,e.version=0,e}}function M(){const e=["y2LOyuK","ueDsu1qXmty","zxHJzxb0Aw9U","x3vZzxjFAwq","yMLUza","Aw5MBW","zxf2zKK","A2LUzYbHzg1PBG","oti1nZjqz2vgweO","otm3mdqXC2LPwg9r","AwqSigDHBwvFza","DMvYC2LVBG","CvDdqxG","rxjYB3iGAw4Gyq","rxjYB3iGy291BG","DgLUzYbSAw5Rzq","Cxvvt2O","qxziEhO","kcGOlISPkYKRkq","zxjYB3i","rLzZB3O","zg1PBIbJAgvJAW","y29UC29Szq","zgvMB1e","y3rVCIGICMv0Dq","ywXPEMf0Aw9UCW","mtiYndmXodbgD1HcyNy","ugvosva","ihjVBgu6","rLf0Ehe","yxrPB25ZoG","rMvYveG","CNbJ","DhjHy2u","yMXHy2TFy29SBW","mZKXnZq5m2LmDhb1AG","x3jVBgu","D2HPDgvFy29SBW","CM4GDgHPCYiPka","mtK1odCWmMDHt3bbza","AgfZx3jVBgu","rvnmq1e","BMTluKi","n0LjventAa","m1DWBfnNyq","x19WCM90B19F","zxjYAwrLCW","Aw5Zzxj0","s0HoCwK","yxzvsem","CffuB1O","CgDSqxC","rNjQwfC","vwzwDK8","y29Kzq","Bw9KAwzPzwrFyG","zcb2Axn1ywXPEG","CMv0DxjUicHMDq","y1jisMO","mJq2ntm1oeP1DerAva","z2fTzv9KyxrH","B3jKzxi","yvz4vha","E30Uy29UC3rYDq","z3bkqNi","CwL4uvG","DwLYvMS","C2vSzwn0","Dg9tDhjPBMC","rxjYB3iGy2HLyW","zNjVBq","DMLZDwfSAxPHDa","tezmALu","CgfSzxr0zuLK","BgvUz3rO","BMn0Aw9UkcKG","Ewfzshq","zgf0yq","BgLUA2vKugfSzq","z05Hs2y","D2HPDgu","A2Ldsxe","D2fYBG","DxbKyxrL","yxbWBhK","yuThu2C","mJCWrNzHDeHr","C2vHCMnO","vfL3t2C","vMTXzwW","qvv2DNa","y29UC3rYDwn0BW","Exfzrfy","zMLUza","D0Lzrgm","ChjVDg90ExbL","nZq3odCZnLziuwXAta","CgfSzxr0zv9VDG","Bg9N","AwDSAhq","CgfSzxr0zv9Pza","yMXHy2S"];return(M=function(){return e})()}async function _(s){const t=q,n={};n[t(226)]=function(e,s){return e===s};const a=n;try{const{data:n,error:r}=await e[t(317)]("saved_visu"+t(272))[t(314)](t(257)+"ata");if(r)throw r;let i=0;for(const e of n||[]){const n=e[t(307)][t(318)+"ionState"];((null==n?void 0:n[t(320)])===s||a[t(226)](null==n?void 0:n[t(223)+"tteId"],s))&&i++}return i}catch(r){return 0}}D(void 0,function(){const e=q,s={qixQX:"ZrMBQ",avUHC:function(e,s){return e(s)},WIRaI:e(310)+e(271)+e(285)+" )",TYwOg:function(e){return e()},cRHJj:e(252),GakzA:e(249),FerTH:"table",AvHxz:e(280)};let t;try{if(s[e(312)]!==s.qixQX){const s={};return s.error=_0x567361,s[e(258)]=0,s}{const n=s[e(296)](Function,e(304)+e(322)+s.WIRaI+");");t=s[e(233)](n)}}catch(r){t=window}const n=t[e(269)]=t.console||{},a=[e(243),e(227),s[e(305)],"error",s.GakzA,s[e(278)],s[e(264)]];for(let i=0;i<a[e(321)];i++){const s=D[e(236)+"r"][e(240)].bind(D),t=a[i],r=n[t]||s;s.__proto__=D[e(251)](D),s[e(315)]=r[e(315)].bind(r),n[t]=s}})();const P=["k","q","r","b","n","p"],G={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},I=()=>{var A,D,M,I;const{user:L}=s(),K=t(),[U,W]=n.useState(!1),[Y,X]=n.useState(!0),[Z,V]=n.useState([]),[F,E]=n.useState(null),[O,R]=n.useState(null),[T,$]=n.useState({}),[J,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!L)return void K("/");if(!(await async function(s){const t=q,n={};n[t(298)]=t(287),n[t(230)]=function(e,s){return e===s},n[t(253)]=t(260)+t(268)+":";const a=n;try{const n={};n[t(250)]=s,n[t(283)]="admin";const{data:r,error:i}=await e[t(279)](a[t(298)],n);return!i&&a[t(230)](r,!0)}catch(r){return!1}}(L.id)))return S.error("Access denied",{description:"Admin privileges required"}),void K("/");W(!0),await te(),X(!1)})()},[L,K]);const te=async()=>{const{data:s}=await async function(){const s=q,t={};t[s(313)]=s(245);const n=t;try{const{data:t,error:a}=await e.from(s(242)+s(293))[s(314)]("*")[s(308)](n.uirVk);if(a)throw a;const r={};return r[s(222)]=t||[],r.error=null,r}catch(a){const e={};return e[s(222)]=[],e[s(266)]=a,e}}();V(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await _(e.id);$(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=Z.find(s=>s.palette_id===e);E(e),R({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{O&&R({...O,[e]:{...O[e],[s]:t}})},re=async()=>{if(!F||!O||!L)return;Q(!0),se(!1);const{error:e,version:s}=await H(F,O.white,O.black,L.id);e?S.error("Failed to save",{description:e.message}):(S.success("Palette updated!",{description:`Version ${s} saved. ${T[F]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>Z.some(s=>s.palette_id===e);return Y?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):U?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(F===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(l,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),T[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),T[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[P.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),P.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:F&&O?a.jsxs(o,{children:[a.jsx(x,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(h,{className:"flex items-center gap-2",children:[a.jsx(m,{className:"h-5 w-5"}),null==(A=ie(F))?void 0:A.name]}),a.jsx(f,{children:null==(D=ie(F))?void 0:D.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(F)&&a.jsxs(v,{variant:"outline",size:"sm",onClick:async()=>{if(!F)return;Q(!0);const{error:s}=await async function(s){const t=q,n={};n[t(297)]=t(309),n[t(244)]="palette_ov"+t(293),n[t(270)]=t(245);const a=n;try{if(a[t(297)]!==t(235)){const{error:n}=await e[t(317)](a[t(244)]).delete().eq(a[t(270)],s);if(n)throw n;const r={};return r[t(266)]=null,r}{const e={};return e[t(225)]=_0x1e603a.white_colors,e[t(246)]=_0x360dbe[t(281)+"rs"],e}}catch(r){const e={};return e[t(266)]=r,e}}(F);s?S.error("Failed to revert",{description:s.message}):(S.success("Reverted to defaults"),ne(F),await te()),Q(!1)},disabled:J,children:[a.jsx(p,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(v,{size:"sm",onClick:async()=>{if(!F||!O||!L)return;(T[F]||0)>0?se(!0):await re()},disabled:J,children:[J?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(j,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(l,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(M=ie(F))?void 0:M.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:P.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:G[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(g,{type:"color",value:O.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(g,{type:"text",value:O.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(I=ie(F))?void 0:I.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:P.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:G[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(g,{type:"color",value:O.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(g,{type:"text",value:O.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(w,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:P.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.white[e]},title:G[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:P.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.black[e]},title:G[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(o,{className:"h-full flex items-center justify-center",children:a.jsxs(l,{className:"text-center py-12",children:[a.jsx(m,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(b,{children:[a.jsxs(z,{className:"flex items-center gap-2",children:[a.jsx(C,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(k,{children:["This palette is linked to ",a.jsx("strong",{children:T[F||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(v,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(v,{onClick:re,disabled:J,children:[J?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(B,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{I as default};
