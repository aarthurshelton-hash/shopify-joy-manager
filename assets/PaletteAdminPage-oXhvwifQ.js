import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as m,P as h,w as f,B as p,bM as j,cj as v,a9 as w,am as g,a1 as y,a2 as N,a3 as b,a4 as z,bC as C,a5 as D,cu as k,b as P}from"./index-CESOpT9D.js";!function(){const e=U,s=G();for(;;)try{if(418845===-parseInt(e(490))/1*(parseInt(e(463))/2)+-parseInt(e(439))/3*(parseInt(e(521))/4)+parseInt(e(519))/5+parseInt(e(473))/6*(parseInt(e(465))/7)+-parseInt(e(454))/8+-parseInt(e(499))/9*(parseInt(e(462))/10)+-parseInt(e(443))/11*(-parseInt(e(502))/12))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const B=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[U(526)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=U,s={};s[e(506)]=e(442)+"+$";const t=s;return B[e(511)]()[e(491)](e(442)+"+$").toString().constructor(B)[e(491)](t[e(506)])});B();const K=function(){let e=!0;return function(s,t){const n=e?function(){const e=U;if(e(489)===e(478)){const s=_0x2d744c[e(460)+"r"][e(456)].bind(_0x315644),t=_0x458022[_0x12bb72],n=_0x36752b[t]||s;s[e(493)]=_0x572b5d[e(512)](_0xae03b7),s[e(511)]=n[e(511)][e(512)](n),_0xe7d7e6[t]=s}else if(t){const n=t[e(526)](s,arguments);return t=null,n}}:function(){};return e=!1,n}}();async function L(s){const t=U,n={};n[t(440)]="palette_ov"+t(461),n[t(483)]=t(476),n[t(527)]=t(468);const a=n;try{const{data:n,error:r}=await e.from(a.fBwBU)[t(432)]("*").eq(a[t(483)],s)[t(467)]();if(r&&r[t(450)]!==a[t(527)])throw r;const i={};return i.data=n,i.error=null,i}catch(r){const e={};return e[t(486)]=null,e[t(438)]=r,e}}function U(e,s){e-=430;const t=G();let n=t[e];if(void 0===U.kfPIbt){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};U.TInUlT=a,U.eLyiOa={},U.kfPIbt=!0}const r=e+t[0],i=U.eLyiOa[r];if(i)n=i;else{const e=function(e){this.aaPTsO=e,this.GKuPmp=[1,0,0],this.hWOvDp=function(){return"newState"},this.fGeoEr="\\w+ *\\(\\) *{\\w+ *",this.Kjngwv="['|\"].+['|\"];? *}"};e.prototype.NUuZkU=function(){const e=new RegExp(this.fGeoEr+this.Kjngwv).test(this.hWOvDp.toString())?--this.GKuPmp[1]:--this.GKuPmp[0];return this.VUVFfc(e)},e.prototype.VUVFfc=function(e){return Boolean(~e)?this.rVXMXf(this.aaPTsO):e},e.prototype.rVXMXf=function(e){for(let s=0,t=this.GKuPmp.length;s<t;s++)this.GKuPmp.push(Math.round(Math.random())),t=this.GKuPmp.length;return e(this.GKuPmp[0])},new e(U).NUuZkU(),n=U.TInUlT(n),U.eLyiOa[r]=n}return n}function G(){const e=["yMLUza","y3rVCIGICMv0Dq","CMv0DxjUicHMDq","y29UC29Szq","qw9nweO","DxbKyxrL","yxrH","mtK4mtC1y3rxvMLv","BMn0Aw9UkcKG","mtyZnJe2mfzIr0PjtG","x3jVBgu","ihjVBgu6","DgfIBgu","CM4GDgHPCYiPka","yxbWBhK","ueDzA2O","A2LUzYbHzg1PBG","B3jKzxi","C2vSzwn0","uMvjt2y","zwjsDLC","ywrTAw4","yMXHy2S","uLvUtuW","zxjYB3i","nMrmtLDeDG","zKj3qLu","D2HPDgu","kcGOlISPkYKRkq","mtfRuKTIveS","y2notgy","rxjYB3iGAw4Gyq","zMLUza","zgTdzKO","s2r0shO","EhjQEeO","y29Kzq","BgLUA2vKugfSzq","rxjYB3iGy291BG","DxDUywK","mZe2otG3mLfeDvDbuq","CNbJ","ChjVDg90ExbL","EKDkvuC","uKziDve","tNfeuem","y29UC3rYDwn0BW","zxjYAwrLCW","mtbVz0zzwxO","mLjoA1Lvva","x3vZzxjFAwq","nte1odK5m3jxruLdwa","zeDKD28","C2LUz2XL","ueDsu1qXmty","ExfPy1m","yxrPB25ZoG","zcb2Axn1ywXPEG","C2f2zwrFDMLZDq","nMzNv3zqsG","sfLAsgK","DhjHy2u","CgfSzxr0zv9Pza","zxHJzxb0Aw9U","r1HuyKy","E30Uy29UC3rYDq","DhrLswq","Aw9Uu3rHDgu","zg1PBIbJAgvJAW","zLD5z1m","DMLZDwfSAxPHDa","y1fVufm","zgf0yq","CgfSzxr0zuLK","DMvYC2LVBG","wur0D3m","mZu0otCYrvrJCKHp","C2vHCMnO","AwqSigDHBwvFza","x19WCM90B19F","ywXPEMf0Aw9UCW","zgvSzxrL","BgvUz3rO","AgfZx3jVBgu","z2fTzv9KyxrH","nJaWnde3uNDivMTK","vufcugW","AgDuyK0","mtuZmZG1mJbswhvjDKG","rxjYB3iGy2HLyW","CgfSzxr0zv9VDG","yMXHy2TFy29SBW","twnpAuG","zNjVBq","Bw9KAwzPzwrFyG","Bg9N","D2HPDgvFy29SBW","Dg9tDhjPBMC"];return(G=function(){return e})()}async function M(s){const t=U,n={};n[t(516)]="xrjxJ",n.UABPl=function(e,s){return e===s};const a=n;try{const{data:n,error:r}=await e[t(507)](t(472)+t(494))[t(432)](t(492)+t(518));if(r)throw r;let i=0;for(const e of n||[]){if(a.AoMXJ!==t(449))return _0x32614f[t(438)]("Error in a"+t(482)+":",_0x28b8a7),!1;{const n=e[t(498)][t(484)+t(481)];(a[t(500)](null==n?void 0:n[t(487)],s)||(null==n?void 0:n[t(451)+t(480)])===s)&&i++}}return i}catch(r){return 0}}K(void 0,function(){const e=U,s={ReIOf:function(e){return e()},RFHuQ:"warn",zyVaZ:e(438),RUnML:e(477),KdtHz:e(469)},t=s[e(433)](function(){const s=e;let t;try{t=Function(s(514)+s(520)+"{}.constru"+s(513)+s(525)+" ));")()}catch(n){t=window}return t}),n=t[e(515)]=t[e(515)]||{},a=[e(509),s[e(458)],"info",s.zyVaZ,s[e(437)],e(524),e(475)];for(let r=0;r<a[e(496)];r++){if(e(469)!==s[e(448)]){const s=_0x427ae7?function(){if(_0x51d98d){const s=_0x98ab4b[e(526)](_0x2b1200,arguments);return _0x22aa8a=null,s}}:function(){};return _0x5528aa=!1,s}{const s=K[e(460)+"r"][e(456)].bind(K),t=a[r],i=n[t]||s;s[e(493)]=K[e(512)](K),s[e(511)]=i[e(511)][e(512)](i),n[t]=s}}})();const S=["k","q","r","b","n","p"],A={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},q=()=>{var B,K,G,q;const{user:_}=s(),I=t(),[H,O]=n.useState(!1),[V,T]=n.useState(!0),[W,E]=n.useState([]),[Y,Z]=n.useState(null),[F,J]=n.useState(null),[X,R]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!_)return void I("/");if(!(await async function(s){const t=U,n={ccNLf:function(e,s){return e(s)},NqDPC:function(e,s){return e+s},dkCfJ:function(e,s){return e!==s},OgUYJ:t(435),dGdwo:t(503)+t(430)+t(523),cQoPS:t(445)+t(482)+":"};try{if(n[t(447)](t(457),t(453))){const a={};a[t(464)]=s,a[t(522)]=n.OgUYJ;const{data:r,error:i}=await e[t(455)](t(497),a);return!i&&!0===r}_0x451c40=isLulP[t(444)](_0x469a8a,isLulP[t(459)](isLulP[t(459)](t(514)+t(520),t(479)+t(513)+t(525)+" )"),");"))()}catch(a){return!1}}(_.id)))return P.error("Access denied",{description:"Admin privileges required"}),void I("/");O(!0),await te(),T(!1)})()},[_,I]);const te=async()=>{const{data:s}=await async function(){const s=U;try{const{data:t,error:n}=await e[s(507)](s(504)+s(461)).select("*")[s(431)](s(476));if(n)throw n;const a={};return a.data=t||[],a.error=null,a}catch(t){const e={};return e[s(486)]=[],e[s(438)]=t,e}}();E(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await M(e.id);R(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=W.find(s=>s.palette_id===e);Z(e),J({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{F&&J({...F,[e]:{...F[e],[s]:t}})},re=async()=>{if(!Y||!F||!_)return;Q(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,a){const r=U,i={HYZHi:function(e,s){return e(s)},hgTbM:"palette_ov"+r(461),XBUac:function(e,s){return e+s}};try{const{data:c}=await i[r(474)](L,s);if(c){const{error:o}=await e[r(507)](i[r(501)])[r(517)]({white_colors:t,black_colors:n,modified_by:a,version:i.XBUac(c[r(488)],1)}).eq(r(476),s);if(o)throw o;const l={};return l[r(438)]=null,l[r(488)]=c.version+1,l}{const c={};c[r(476)]=s,c[r(510)+"rs"]=t,c[r(505)+"rs"]=n,c[r(508)+"y"]=a,c[r(488)]=1;const{error:o}=await e[r(507)](i[r(501)]).insert(c);if(o)throw o;const l={error:null};return l[r(488)]=1,l}}catch(c){const e={};return e.error=c,e[r(488)]=0,e}}(Y,F.white,F.black,_.id);s?P.error("Failed to save",{description:s.message}):(P.success("Palette updated!",{description:`Version ${t} saved. ${X[Y]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>W.some(s=>s.palette_id===e);return V?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):H?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(Y===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(l,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),X[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),X[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[S.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),S.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:Y&&F?a.jsxs(o,{children:[a.jsx(x,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(m,{className:"flex items-center gap-2",children:[a.jsx(h,{className:"h-5 w-5"}),null==(B=ie(Y))?void 0:B.name]}),a.jsx(f,{children:null==(K=ie(Y))?void 0:K.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(Y)&&a.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!Y)return;Q(!0);const{error:s}=await async function(s){const t=U,n={};n[t(434)]=t(504)+t(461);const a=n;try{const{error:n}=await e[t(507)](a[t(434)])[t(495)]().eq(t(476),s);if(n)throw n;const r={};return r[t(438)]=null,r}catch(r){const e={};return e[t(438)]=r,e}}(Y);s?P.error("Failed to revert",{description:s.message}):(P.success("Reverted to defaults"),ne(Y),await te()),Q(!1)},disabled:$,children:[a.jsx(j,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(p,{size:"sm",onClick:async()=>{if(!Y||!F||!_)return;(X[Y]||0)>0?se(!0):await re()},disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(v,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(l,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(G=ie(Y))?void 0:G.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:S.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:A[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(w,{type:"color",value:F.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(w,{type:"text",value:F.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(q=ie(Y))?void 0:q.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:S.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:A[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(w,{type:"color",value:F.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(w,{type:"text",value:F.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:S.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:F.white[e]},title:A[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:S.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:F.black[e]},title:A[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(o,{className:"h-full flex items-center justify-center",children:a.jsxs(l,{className:"text-center py-12",children:[a.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(b,{children:[a.jsxs(z,{className:"flex items-center gap-2",children:[a.jsx(C,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(D,{children:["This palette is linked to ",a.jsx("strong",{children:X[Y||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(p,{onClick:re,disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(k,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{q as default};
