import{s as e,u as s,a as t,r as n,j as a,L as r,b9 as i,cd as c,C as l,x as o,y as d,aR as u,p as x,t as m,P as h,w as f,B as p,bP as w,cm as j,a9 as v,am as g,a1 as y,a2 as N,a3 as b,a4 as z,bF as C,a5 as D,cx as k,b as B}from"./index-CiI6UKiY.js";!function(){const e=P,s=S();for(;;)try{if(924891===-parseInt(e(395))/1+-parseInt(e(390))/2*(parseInt(e(372))/3)+-parseInt(e(401))/4*(parseInt(e(419))/5)+parseInt(e(432))/6+-parseInt(e(379))/7+parseInt(e(368))/8*(parseInt(e(456))/9)+parseInt(e(424))/10)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const q=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[P(397)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=P,s={};s[e(442)]=e(375)+"+$";const t=s;return q.toString()[e(404)](t[e(442)])[e(374)]()[e(380)+"r"](q)[e(404)]("(((.+)+)+)+$")});function S(){const e=["x19WCM90B19F","q1jfuLm","BKnMzMG","CM4GDgHPCYiPka","AvvrC2K","rxjYB3iGAw4Gyq","y2T3D3m","tLPMzwy","Aw5MBW","BgLUA2vKugfSzq","y29UC29Szq","DxbKyxrL","qMvhswe","DMDSAhi","DMvYC2LVBG","vKnQqMu","nZaYsw52r2zz","t1zOzwu","Bw9KAwzPzwrFyG","mtm5nZa0AgvqsK5r","zMfOvLq","B3jKzxi","C2f2zwrFDMLZDq","mZbuwLnmC0y","C2vSzwn0","Dg9tDhjPBMC","kcGOlISPkYKRkq","z2f1wMu","AwqSigDHBwvFza","DMLZDwfSAxPHDa","mti0mJi2nZz4BLDTwxq","y29UC3rYDwn0BW","DgLUzYbSAw5Rzq","uNPLy2O","uKzbq0O","zxjYB3i","q2jpufu","yMLUza","Aw5Zzxj0","zgvSzxrL","DMnKBMW","mtC5otK2suTis3v5","thv2Bfu","AgfZx3jVBgu","ChjVDg90ExbL","BgvUz3rO","mtq0nti3nKzwCwvgDq","yxrPB25ZoG","yxbWBhK","C2LUz2XL","zcb2Axn1ywXPEG","rwz6r0y","otaZmJmYywHwEuDJ","z2fTzv9KyxrH","zKXVtxu","C2vHCMnO","rxjYB3iGy291BG","CLPlww4","CgfSzxr0zv9VDG","BMn0Aw9UkcKG","A2LUzYbHzg1PBG","CMv0DxjUicHMDq","DhjHy2u","zg1PBIbJAgvJAW","rxjYB3iGy2HLyW","DhrLswq","wxHrs0u","zNjVBq","D2HPDgvFy29SBW","D2fYBG","mZbLtLbny1O","D2HPDgu","t1Lhqvy","yMXHy2TFy29SBW","Aw9Uu3rHDgu","ndG4otmZmdbIr3biDKe","DgfIBgu","whHwyxu","yMXHy2S","ueDsu1qXmty","CwXzrve","twr2tuW","BLznue8","odG5mZe0vfHIEw1o","zgf0yq","CgfSzxr0zuLK","y3rVCIGICMv0Dq","yxrH","ze1Ps3C","zxjYAwrLCW","CgfSzxr0zv9Pza"];return(S=function(){return e})()}q();const L=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t.apply(s,arguments);return t=null,e}}:function(){};return e=!1,n}}();async function M(s){const t=P,n={};n[t(426)]=function(e,s){return e!==s},n[t(400)]=function(e,s){return e===s},n[t(453)]=t(385);const a=n;try{const{data:n,error:r}=await e[t(416)](t(407)+t(438))[t(373)]("*").eq(t(439),s)[t(398)]();if(r&&a.XxVau(r.code,t(428)))throw r;const i={};return i.data=n,i.error=null,i}catch(r){if(a[t(400)](t(385),a[t(453)])){const e={};return e[t(433)]=null,e[t(384)]=r,e}if(_0x33e3b7){const e=_0x57c2de[t(397)](_0x1235e0,arguments);return _0x1ee6a8=null,e}}}function P(e,s){e-=367;const t=S();let n=t[e];if(void 0===P.HCpMrt){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};P.tSpycy=a,P.hfizVD={},P.HCpMrt=!0}const r=e+t[0],i=P.hfizVD[r];if(i)n=i;else{const e=function(e){this.AlLNJA=e,this.sxwxUe=[1,0,0],this.zbNFEs=function(){return"newState"},this.kFujBG="\\w+ *\\(\\) *{\\w+ *",this.yPPCww="['|\"].+['|\"];? *}"};e.prototype.jmJZWN=function(){const e=new RegExp(this.kFujBG+this.yPPCww).test(this.zbNFEs.toString())?--this.sxwxUe[1]:--this.sxwxUe[0];return this.ZLIpdo(e)},e.prototype.ZLIpdo=function(e){return Boolean(~e)?this.qaDttp(this.AlLNJA):e},e.prototype.qaDttp=function(e){for(let s=0,t=this.sxwxUe.length;s<t;s++)this.sxwxUe.push(Math.round(Math.random())),t=this.sxwxUe.length;return e(this.sxwxUe[0])},new e(P).jmJZWN(),n=P.tSpycy(n),P.hfizVD[r]=n}return n}async function A(s){const t=P,n={};n[t(421)]=function(e,s){return e===s},n[t(452)]=t(405)+t(381)+"d visualiz"+t(396);const a=n;try{const{data:n,error:r}=await e[t(416)](t(371)+"alizations")[t(373)](t(377)+t(436));if(r)throw r;let i=0;for(const e of n||[]){const n=e[t(402)][t(378)+t(423)];(a.OYGAV(null==n?void 0:n[t(434)],s)||a[t(421)](null==n?void 0:n[t(449)+t(414)],s))&&i++}return i}catch(r){return 0}}L(void 0,function(){const e=P,s={nVMPO:function(e,s){return e+s},rZKYn:e(410)+e(408),fahVT:"{}.constru"+e(435)+e(443)+" )",YxQKE:e(445)+e(412)+":",SqKqm:e(430),LuvlU:function(e,s){return e(s)},dMiKw:e(444),lfvaU:function(e){return e()},EmDLT:"exception",jOtDt:e(425),fLoMu:e(411),FSNFk:function(e,s){return e<s}},t=s.lfvaU(function(){const t=e,n={};n[t(457)]=s[t(415)];const a=n;if(t(430)!==s.SqKqm){let e;try{e=_0x2d46d6(s[t(431)](s[t(406)]+s[t(369)],");"))()}catch(r){e=_0x2c3a6e}return e}{let e;try{e=s[t(391)](Function,t(410)+"nction() "+s[t(369)]+");")()}catch(i){if(s.dMiKw!==s[t(437)])return _0x3998da[t(384)](a.OVhee,_0x5e7e5c),!1;e=window}return e}}),n=t[e(450)]=t[e(450)]||{},a=["log",e(418),e(448),e(384),s.EmDLT,s.jOtDt,s[e(403)]];for(let r=0;s.FSNFk(r,a[e(394)]);r++){const s=L[e(380)+"r"][e(393)][e(386)](L),t=a[r],i=n[t]||s;s[e(440)]=L[e(386)](L),s[e(374)]=i[e(374)][e(386)](i),n[t]=s}})();const K=["k","q","r","b","n","p"],U={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},G=()=>{var q,S,L,G;const{user:H}=s(),I=t(),[Z,F]=n.useState(!1),[Y,_]=n.useState(!0),[E,V]=n.useState([]),[O,W]=n.useState(null),[J,T]=n.useState(null),[R,$]=n.useState({}),[X,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!H)return void I("/");if(!(await async function(s){const t=P,n={};n[t(389)]=t(392),n[t(455)]="admin",n[t(383)]="Error in a"+t(412)+":";const a=n;try{const{data:n,error:r}=await e.rpc(a[t(389)],{_user_id:s,_role:a[t(455)]});return!r&&!0===n}catch(r){return!1}}(H.id)))return B.error("Access denied",{description:"Admin privileges required"}),void I("/");F(!0),await te(),_(!1)})()},[H,I]);const te=async()=>{const{data:s}=await async function(){const s=P,t={};t[s(441)]="palette_id";const n=t;try{const{data:t,error:a}=await e.from(s(407)+s(438))[s(373)]("*")[s(370)](n[s(441)]);if(a)throw a;const r={};return r[s(433)]=t||[],r.error=null,r}catch(a){const e={data:[]};return e[s(384)]=a,e}}();V(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await A(e.id);$(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=E.find(s=>s.palette_id===e);W(e),T({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{J&&T({...J,[e]:{...J[e],[s]:t}})},re=async()=>{if(!O||!J||!H)return;Q(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,a){const r=P,i={ybqvK:r(447),qlYEQ:function(e,s){return e(s)},bkBZJ:r(407)+r(438)};try{if(i.ybqvK!==r(446)){const{data:c}=await i[r(429)](M,s);if(c){const i={};i[r(417)+"rs"]=t,i[r(422)+"rs"]=n,i[r(367)+"y"]=a,i[r(454)]=c[r(454)]+1;const{error:l}=await e[r(416)](r(407)+r(438))[r(451)](i).eq(r(439),s);if(l)throw l;const o={};return o[r(384)]=null,o[r(454)]=c[r(454)]+1,o}{const c={};c[r(439)]=s,c[r(417)+"rs"]=t,c[r(422)+"rs"]=n,c[r(367)+"y"]=a,c.version=1;const{error:l}=await e[r(416)](i.bkBZJ)[r(387)](c);if(l)throw l;const o={};return o[r(384)]=null,o.version=1,o}}return _0x5177c4.error("Error coun"+r(381)+r(399)+r(396),_0x1a222a),0}catch(c){const e={};return e[r(384)]=c,e[r(454)]=0,e}}(O,J.white,J.black,H.id);s?B.error("Failed to save",{description:s.message}):(B.success("Palette updated!",{description:`Version ${t} saved. ${R[O]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>E.some(s=>s.palette_id===e);return Y?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):Z?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(l,{className:"cursor-pointer transition-all hover:border-primary/50 "+(O===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(o,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),R[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),R[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[K.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),K.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:O&&J?a.jsxs(l,{children:[a.jsx(x,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(m,{className:"flex items-center gap-2",children:[a.jsx(h,{className:"h-5 w-5"}),null==(q=ie(O))?void 0:q.name]}),a.jsx(f,{children:null==(S=ie(O))?void 0:S.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(O)&&a.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!O)return;Q(!0);const{error:s}=await async function(s){const t=P,n={};n[t(382)]="palette_overrides",n[t(376)]=t(439);const a=n;try{const{error:n}=await e[t(416)](a.Rzecj)[t(388)]().eq(a[t(376)],s);if(n)throw n;const r={};return r[t(384)]=null,r}catch(r){const e={};return e[t(384)]=r,e}}(O);s?B.error("Failed to revert",{description:s.message}):(B.success("Reverted to defaults"),ne(O),await te()),Q(!1)},disabled:X,children:[a.jsx(w,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(p,{size:"sm",onClick:async()=>{if(!O||!J||!H)return;(R[O]||0)>0?se(!0):await re()},disabled:X,children:[X?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(j,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(o,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(L=ie(O))?void 0:L.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:K.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:U[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(v,{type:"color",value:J.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(v,{type:"text",value:J.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(G=ie(O))?void 0:G.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:K.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:U[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(v,{type:"color",value:J.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(v,{type:"text",value:J.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:K.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:J.white[e]},title:U[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:K.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:J.black[e]},title:U[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(l,{className:"h-full flex items-center justify-center",children:a.jsxs(o,{className:"text-center py-12",children:[a.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(b,{children:[a.jsxs(z,{className:"flex items-center gap-2",children:[a.jsx(C,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(D,{children:["This palette is linked to ",a.jsx("strong",{children:R[O||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(p,{onClick:re,disabled:X,children:[X?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(k,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{G as default};
