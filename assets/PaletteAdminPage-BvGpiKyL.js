import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as l,x as o,y as d,aP as u,p as h,t as m,P as x,w as f,B as w,bM as p,cj as v,a9 as j,am as g,a1 as y,a2 as N,a3 as C,a4 as b,bC as z,a5 as S,cu as k,b as B}from"./index-DMpRWcyL.js";!function(){const e=q,s=P();for(;;)try{if(736729===parseInt(e(428))/1*(parseInt(e(400))/2)+parseInt(e(348))/3+-parseInt(e(397))/4+parseInt(e(398))/5*(-parseInt(e(338))/6)+-parseInt(e(413))/7*(parseInt(e(359))/8)+parseInt(e(346))/9*(-parseInt(e(390))/10)+parseInt(e(375))/11*(parseInt(e(389))/12))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const D=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[q(340)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=q,s={};s[e(391)]="(((.+)+)+)+$";const t=s;return D[e(349)]().search(t.igRff)[e(349)]()[e(352)+"r"](D).search(t.igRff)});D();const A=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[q(340)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();function q(e,s){e-=336;const t=P();let n=t[e];if(void 0===q.fECjxh){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};q.ByzaXD=a,q.jSDKoT={},q.fECjxh=!0}const r=e+t[0],i=q.jSDKoT[r];if(i)n=i;else{const e=function(e){this.LSvEZw=e,this.WHwhzS=[1,0,0],this.LGmPOp=function(){return"newState"},this.YuGCPv="\\w+ *\\(\\) *{\\w+ *",this.wQIdOB="['|\"].+['|\"];? *}"};e.prototype.UhZAuF=function(){const e=new RegExp(this.YuGCPv+this.wQIdOB).test(this.LGmPOp.toString())?--this.WHwhzS[1]:--this.WHwhzS[0];return this.DUBcWY(e)},e.prototype.DUBcWY=function(e){return Boolean(~e)?this.lkMCTR(this.LSvEZw):e},e.prototype.lkMCTR=function(e){for(let s=0,t=this.WHwhzS.length;s<t;s++)this.WHwhzS.push(Math.round(Math.random())),t=this.WHwhzS.length;return e(this.WHwhzS[0])},new e(q).UhZAuF(),n=q.ByzaXD(n),q.jSDKoT[r]=n}return n}function P(){const e=["mu5SwwPsAG","AgfZx3jVBgu","AMrVAMe","zgf0yq","yxrPB25ZoG","wwnxq2S","mtG0mtrYvhfWB3i","D2fYBG","yxbWBhK","AwqSigDHBwvFza","DgLUzYbSAw5Rzq","DhjHy2u","zcb2Axn1ywXPEG","DMLZDwfSAxPHDa","mtaXnJGXmJHWqxnqAeu","C3riCxq","mtu3nZaZmu5is0nPEG","Dg9tDhjPBMC","vM9Pq2e","Aw5MBW","y29UC3rYDwn0BW","y29UC29Szq","Dw5WrNC","CLLfyu0","rxjYB3iGy2HLyW","ChjVDg90ExbL","qwjXvMK","ndHMqvnZze4","ywrTAw4","x19WCM90B19F","D2HPDgvFy29SBW","r01OrNC","vhvRDhK","uKXNthG","DMvYC2LVBG","vfrkvK8","z2fTzv9KyxrH","txnby2K","CfL5zhu","D2HPDgu","CvfmqKS","zgvSzxrL","y3rVCIGICMv0Dq","mtuWmtvRqwror04","CLzmCw0","CgfSzxr0zv9Pza","zxjYAwrLCW","C0DcsfO","zKHYs1i","CNPeree","Afzzvxy","CgfSzxr0zv9VDG","ihjVBgu6","rxjYB3iGAw4Gyq","zxjYB3i","q0nhree","svzuyuS","mJi1mdb0wefOwgW","mtb5seLJu2W","AwDszMy","ueDsu1qXmty","CM4GDgHPCYiPka","yMXHy2S","Bw9KAwzPzwrFyG","C25yz0G","mJaXnZzNwej0B2W","mta4nxjyv2DuCW","Aw1Zz2y","nti5mJu2q01nt3DV","v2LOEKe","Bg9N","CgfSzxr0zuLK","EKfct3u","uvvtAfK","B3jKzxi","zNjVBq","AuLnz04","ywXPEMf0Aw9UCW","DxbKyxrL","sKzXuhO","yMLUza","otq3ndK5CenPAg5Z","BgLUA2vKugfSzq","BwXfqwe","DwHRvfG","rxjYB3iGy291BG","uNnzyKS","Aw5Zzxj0","shrICfC","E30Uy29UC3rYDq","C2vSzwn0","CwnevKu","y29Kzq","CNbJ","zhntEMG","yMXHy2TFy29SBW"];return(P=function(){return e})()}async function W(s,t,n,a){const r=q,i={};i[r(405)]=function(e,s){return e!==s},i[r(382)]=function(e,s){return e+s},i[r(401)]=function(e,s){return e+s},i.mvLBq=function(e,s){return e===s},i[r(418)]=r(358),i[r(416)]=r(426),i[r(404)]=function(e,s){return e===s},i.HtbpW=r(379),i.snXgH=r(423);const c=i;try{const{data:i}=await async function(s){const t=q,n={};n[t(347)]=t(383)+t(378),n.CCGDA=t(377),n[t(376)]=t(392);const a=n;try{const{data:n,error:r}=await e[t(407)](a[t(347)])[t(422)]("*").eq(a[t(387)],s).single();if(r&&r[t(424)]!==a[t(376)])throw r;const i={};return i[t(431)]=n,i[t(386)]=null,i}catch(r){const e={};return e[t(431)]=null,e.error=r,e}}(s);if(i){if(c[r(405)](r(399),r(399))){const e=_0x3b03b7?function(){if(_0x58902c){const e=_0x4840da[r(340)](_0x33655c,arguments);return _0xf0ba3=null,e}}:function(){};return _0x4b4e26=!1,e}{const{error:l}=await e[r(407)](r(383)+r(378))[r(410)]({white_colors:t,black_colors:n,modified_by:a,version:c[r(382)](i[r(366)],1)}).eq(r(377),s);if(l)throw l;return{error:null,version:c.WihzA(i[r(366)],1)}}}if(c.mvLBq(c[r(418)],c.uhkTX)){const e={};return e[r(431)]=[],e[r(386)]=_0x526453,e}{const i={};i.palette_id=s,i[r(362)+"rs"]=t,i[r(427)+"rs"]=n,i[r(395)+"y"]=a,i[r(366)]=1;const{error:c}=await e[r(407)](r(383)+r(378))[r(419)](i);if(c)throw c;const l={};return l[r(386)]=null,l[r(366)]=1,l}}catch(l){if(!c[r(404)](c[r(420)],c[r(396)])){const e={};return e[r(386)]=l,e[r(366)]=0,e}_0x367ea5++}}async function G(s){const t=q,n={};n[t(408)]="saved_visu"+t(409),n.IVTaK=function(e,s){return e===s},n[t(369)]=t(417)+t(342)+t(344)+t(336);const a=n;try{const{data:n,error:r}=await e[t(407)](a[t(408)])[t(422)](t(341)+"ata");if(r)throw r;let i=0;for(const e of n||[]){const n=e[t(368)][t(345)+"ionState"];(a[t(388)](null==n?void 0:n[t(403)],s)||a[t(388)](null==n?void 0:n[t(414)+"tteId"],s))&&i++}return i}catch(r){return 0}}A(void 0,function(){const e=q,s={GMhFw:function(e,s){return e(s)},RLgLx:"return (function() ",Tukty:e(421)+e(374)+e(393)+" )",hnRhB:function(e,s){return e!==s},miYJh:e(415),pYydu:function(e){return e()},fHrKR:e(339),unpFw:e(351),JFqPz:"table",VoiCa:e(343),YcWCk:function(e,s){return e<s}},t=s[e(370)](function(){const t=e;let n;try{n=s[t(363)](Function,s[t(365)]+s[t(364)]+");")()}catch(a){if(s.hnRhB(s.miYJh,"mlEAa")){if(_0x5f389b){const e=_0x53610f[t(340)](_0x4c4cdf,arguments);return _0x2910a4=null,e}}else n=window}return n}),n=t[e(353)]=t[e(353)]||{},a=[e(402),s[e(380)],s[e(354)],e(386),"exception",s[e(411)],s[e(350)]];for(let r=0;s[e(337)](r,a.length);r++){const s=A[e(352)+"r"][e(357)][e(412)](A),t=a[r],i=n[t]||s;s[e(361)]=A.bind(A),s[e(349)]=i.toString[e(412)](i),n[t]=s}})();const K=["k","q","r","b","n","p"],L={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},M=()=>{var D,A,P,M;const{user:H}=s(),_=t(),[Y,I]=n.useState(!1),[E,R]=n.useState(!0),[T,X]=n.useState([]),[Z,U]=n.useState(null),[F,O]=n.useState(null),[V,J]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!H)return void _("/");if(!(await async function(s){const t=q,n={};n[t(381)]=t(429),n.LGZOT=t(360),n[t(367)]=t(356)+"king admin"+t(384),n[t(372)]=t(385)+"dmin check:";const a=n;try{const{data:n,error:r}=await e[t(425)](a[t(381)],{_user_id:s,_role:a.LGZOT});return!r&&!0===n}catch(r){return!1}}(H.id)))return B.error("Access denied",{description:"Admin privileges required"}),void _("/");I(!0),await te(),R(!1)})()},[H,_]);const te=async()=>{const{data:s}=await async function(){const s=q,t={};t[s(430)]=s(383)+s(378),t[s(355)]="palette_id";const n=t;try{const{data:t,error:a}=await e[s(407)](n[s(430)])[s(422)]("*")[s(406)](n[s(355)]);if(a)throw a;const r={};return r[s(431)]=t||[],r[s(386)]=null,r}catch(a){const e={};return e[s(431)]=[],e[s(386)]=a,e}}();X(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await G(e.id);J(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=T.find(s=>s.palette_id===e);U(e),O({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{F&&O({...F,[e]:{...F[e],[s]:t}})},re=async()=>{if(!Z||!F||!H)return;Q(!0),se(!1);const{error:e,version:s}=await W(Z,F.white,F.black,H.id);e?B.error("Failed to save",{description:e.message}):(B.success("Palette updated!",{description:`Version ${s} saved. ${V[Z]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>T.some(s=>s.palette_id===e);return E?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):Y?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(l,{className:"cursor-pointer transition-all hover:border-primary/50 "+(Z===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(o,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),V[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),V[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[K.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),K.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:Z&&F?a.jsxs(l,{children:[a.jsx(h,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(m,{className:"flex items-center gap-2",children:[a.jsx(x,{className:"h-5 w-5"}),null==(D=ie(Z))?void 0:D.name]}),a.jsx(f,{children:null==(A=ie(Z))?void 0:A.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(Z)&&a.jsxs(w,{variant:"outline",size:"sm",onClick:async()=>{if(!Z)return;Q(!0);const{error:s}=await async function(s){const t=q;try{const{error:n}=await e[t(407)](t(383)+t(378))[t(373)]().eq(t(377),s);if(n)throw n;const a={};return a[t(386)]=null,a}catch(n){const e={};return e[t(386)]=n,e}}(Z);s?B.error("Failed to revert",{description:s.message}):(B.success("Reverted to defaults"),ne(Z),await te()),Q(!1)},disabled:$,children:[a.jsx(p,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(w,{size:"sm",onClick:async()=>{if(!Z||!F||!H)return;(V[Z]||0)>0?se(!0):await re()},disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(v,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(o,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(P=ie(Z))?void 0:P.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:K.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(j,{type:"color",value:F.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(j,{type:"text",value:F.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(M=ie(Z))?void 0:M.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:K.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(j,{type:"color",value:F.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(j,{type:"text",value:F.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:K.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:F.white[e]},title:L[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:K.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:F.black[e]},title:L[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(l,{className:"h-full flex items-center justify-center",children:a.jsxs(o,{className:"text-center py-12",children:[a.jsx(x,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(C,{children:[a.jsxs(b,{className:"flex items-center gap-2",children:[a.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(S,{children:["This palette is linked to ",a.jsx("strong",{children:V[Z||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(w,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(w,{onClick:re,disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(k,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{M as default};
