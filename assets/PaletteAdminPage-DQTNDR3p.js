import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as l,x as o,y as d,aP as u,p as x,t as m,P as h,w as f,B as p,bM as j,cj as v,a9 as w,am as g,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as B,cu as k,b as q}from"./index-Dq7M-Dd_.js";!function(){const e=S,s=_();for(;;)try{if(568939===-parseInt(e(557))/1*(-parseInt(e(580))/2)+parseInt(e(544))/3*(parseInt(e(562))/4)+-parseInt(e(524))/5+-parseInt(e(486))/6+parseInt(e(583))/7*(parseInt(e(551))/8)+parseInt(e(579))/9*(parseInt(e(578))/10)+parseInt(e(534))/11)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const D=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[S(576)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=S;return D[e(519)]()[e(489)](e(495)+"+$")[e(519)]()[e(508)+"r"](D)[e(489)](e(495)+"+$")});function S(e,s){e-=483;const t=_();let n=t[e];if(void 0===S.rxWUTs){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};S.zrUzrd=a,S.KlwfNR={},S.rxWUTs=!0}const r=e+t[0],i=S.KlwfNR[r];if(i)n=i;else{const e=function(e){this.KmIyRS=e,this.Riqjda=[1,0,0],this.JAhRFB=function(){return"newState"},this.tazINf="\\w+ *\\(\\) *{\\w+ *",this.ImimWt="['|\"].+['|\"];? *}"};e.prototype.jRiOGJ=function(){const e=new RegExp(this.tazINf+this.ImimWt).test(this.JAhRFB.toString())?--this.Riqjda[1]:--this.Riqjda[0];return this.BMxWyT(e)},e.prototype.BMxWyT=function(e){return Boolean(~e)?this.pSytQq(this.KmIyRS):e},e.prototype.pSytQq=function(e){for(let s=0,t=this.Riqjda.length;s<t;s++)this.Riqjda.push(Math.round(Math.random())),t=this.Riqjda.length;return e(this.Riqjda[0])},new e(S).jRiOGJ(),n=S.zrUzrd(n),S.KlwfNR[r]=n}return n}D();const A=function(){const e={jNUdX:"ViSDd"},s=e;let t=!0;return function(e,n){const a=S;if(s[a(507)]!==a(502)){const s=t?function(){if(n){const s=n[a(576)](e,arguments);return n=null,s}}:function(){};return t=!1,s}{const e=_0x4a60d1.constructor[a(521)][a(531)](_0x1c2ef1),s=_0x35d718[_0x5cf0a5],t=_0x8a896f[s]||e;e[a(493)]=_0x2e0beb[a(531)](_0x18c561),e[a(519)]=t[a(519)][a(531)](t),_0x29f67f[s]=e}}}();function _(){const e=["ntaXmJb0D1jIB3i","y29Kzq","BMn0Aw9UkcKG","z1v2CuS","yMXHy2TFy29SBW","ntG5nZi4meHQqunMAW","zxjYB3i","CgfSzxr0zv9Pza","C2vHCMnO","zMLUza","yMXHy2S","CgfSzxr0zv9VDG","x19WCM90B19F","zwPLELi","kcGOlISPkYKRkq","ywXPEMf0Aw9UCW","B3jKzxi","zxjYAwrLCW","EeHpugy","Aw5MBW","EwrJseW","rNbswuS","vMXSu0q","C2f2zwrFDMLZDq","Bw9KAwzPzwrFyG","ru94tuO","AK5vzfG","y29UC3rYDwn0BW","rxjYB3iGy291BG","B2TgEhm","D2HPDgvFy29SBW","BKXrDfC","zcb2Axn1ywXPEG","DKTozfy","AwqSigDHBwvFza","yNHJvuC","ueDsu1qXmty","uNvUuxO","Dg9tDhjPBMC","zNjVBq","ChjVDg90ExbL","A2LUzYbHzg1PBG","x3vZzxjFAwq","mteZndi1nw9nv1fIrG","qxfXvuC","AwHpqNG","ywrTAw4","DuzMvLa","t0rfrvm","B0fOzvK","yMLUza","CgfSzxr0zuLK","shLUtuK","mtqXnZi3m0POs2vlwG","BgvUz3rO","E30Uy29UC3rYDq","uwLJtfC","rxjYB3iGAw4Gyq","ALLtyvG","vw9tANu","DMvYC2LVBG","Aw9Uu3rHDgu","DgfIBgu","mte3owvrCfzQtG","DxbKyxrL","zMnprfa","twrvs28","Bg9N","BgLUA2vKugfSzq","DhjHy2u","nde2BejtBLz4","yKjkqMm","zxHJzxb0Aw9U","zgf0yq","D2HPDgu","AujsD2G","mZe5nhfUzKjntq","C2LUz2XL","qLDbvgm","C2vSzwn0","uMfdq0O","nZG2mhrPAhLiAa","rxjYB3iGy2HLyW","Dhv6D1G","yxrPB25ZoG","D2XPEeK","q21lwNq","D2fYBG","ALzPBum","z2fTzv9KyxrH","Bwzqu28","q0HcuwO","CM4GDgHPCYiPka","zgvSzxrL","Bu1Ovhq","yxbWBhK","AgfZx3jVBgu","nZbzsNfes2O","otKZndjvCNHYu0i","mJy4sLjoCvrl","DMLZDwfSAxPHDa","y29UC29Szq"];return(_=function(){return e})()}async function P(s){const t=S,n={};n.IaORC=t(492)+t(498),n[t(499)]=t(488),n[t(494)]=function(e,s){return e!==s},n.DmPfC=t(552),n.okFxs=t(566);const a=n;try{const{data:n,error:r}=await e[t(520)](a.IaORC)[t(560)]("*").eq(a[t(499)],s)[t(558)]();if(r&&a[t(494)](r[t(584)],t(517)))throw r;const i={};return i[t(554)]=n,i[t(487)]=null,i}catch(r){if(a.DmPfC!==a[t(510)]){const e={};return e[t(554)]=null,e[t(487)]=r,e}{const e={};return e[t(554)]=null,e.error=_0x382485,e}}}async function I(s){const t=S,n={};n[t(539)]=t(504)+t(496),n[t(537)]=t(515)+"ata",n[t(525)]=function(e,s){return e!==s},n[t(530)]=t(501),n[t(540)]=function(e,s){return e===s};const a=n;try{const{data:n,error:r}=await e[t(520)](a[t(539)])[t(560)](a[t(537)]);if(r)throw r;let i=0;for(const e of n||[]){if(a[t(525)](a[t(530)],a[t(530)])){const e={};return e[t(554)]=[],e[t(487)]=_0x271626,e}{const n=e[t(570)][t(581)+t(542)];if(a[t(540)](null==n?void 0:n.paletteId,s)||(null==n?void 0:n[t(549)+"tteId"])===s){if(t(559)===t(571))return _0x5aab7b[t(487)](t(538)+"dmin check:",_0x4fbba2),!1;i++}}}return i}catch(r){return 0}}A(void 0,function(){const e=S,s={MdUKo:function(e,s){return e(s)},jVimC:function(e,s){return e+s},KAWAr:"return (fu"+e(483),CHBQj:function(e){return e()},qOhxI:e(548),nLQtW:e(487),tuzwX:e(553),ihOBx:e(543),lCcEf:e(550)};let t;try{const n=s[e(547)](Function,s[e(569)](s[e(569)](s.KAWAr,e(536)+'ctor("retu'+e(573)+" )"),");"));t=s[e(572)](n)}catch(r){t=window}const n=t[e(582)]=t[e(582)]||{},a=[s.qOhxI,e(568),e(500),s[e(512)],s[e(564)],s[e(526)],s.lCcEf];for(let i=0;i<a[e(535)];i++){const s=A[e(508)+"r"][e(521)][e(531)](A),t=a[i],r=n[t]||s;s[e(493)]=A[e(531)](A),s.toString=r[e(519)][e(531)](r),n[t]=s}})();const K=["k","q","r","b","n","p"],L={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},M=()=>{var D,A,_,M;const{user:G}=s(),U=t(),[R,O]=n.useState(!1),[H,W]=n.useState(!0),[E,F]=n.useState([]),[X,T]=n.useState(null),[Y,Z]=n.useState(null),[J,V]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!G)return void U("/");if(!(await async function(s){const t=S,n={};n[t(528)]=t(563)+t(522)+" role:",n.HynMI=t(538)+"dmin check:";try{const n={};n[t(523)]=s,n._role=t(527);const{data:a,error:r}=await e.rpc(t(577),n);return!r&&!0===a}catch(a){return!1}}(G.id)))return q.error("Access denied",{description:"Admin privileges required"}),void U("/");O(!0),await te(),W(!1)})()},[G,U]);const te=async()=>{const{data:s}=await async function(){const s=S,t={};t[s(575)]=s(492)+s(498),t[s(556)]=s(488);const n=t;try{const{data:t,error:a}=await e[s(520)](n[s(575)])[s(560)]("*")[s(497)](n[s(556)]);if(a)throw a;const r={};return r[s(554)]=t||[],r[s(487)]=null,r}catch(a){const e={};return e[s(554)]=[],e[s(487)]=a,e}}();F(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await I(e.id);V(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=E.find(s=>s.palette_id===e);T(e),Z({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{Y&&Z({...Y,[e]:{...Y[e],[s]:t}})},re=async()=>{if(!X||!Y||!G)return;Q(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,a){const r=S,i={ODEES:function(e,s){return e===s},VllSD:function(e,s){return e(s)},CmKZt:function(e,s){return e!==s},RaCCJ:"LTNbu",EOxMJ:"palette_overrides",fcODP:function(e,s){return e+s},RunQz:"UNkcp"};try{const{data:c}=await i[r(503)](P,s);if(c){if(i[r(567)](r(484),i[r(561)])){const{error:l}=await e[r(520)](i[r(506)])[r(545)]({white_colors:t,black_colors:n,modified_by:a,version:i[r(546)](c[r(541)],1)}).eq("palette_id",s);if(l)throw l;const o={};return o[r(487)]=null,o[r(541)]=c.version+1,o}{const e=_0x467f41?function(){if(_0x521207){const e=_0x158267[r(576)](_0x21df7d,arguments);return _0x46a786=null,e}}:function(){};return _0x33cf8b=!1,e}}if(r(516)!==i[r(518)]){const c={};c[r(488)]=s,c[r(511)+"rs"]=t,c.black_colors=n,c[r(505)+"y"]=a,c.version=1;const{error:l}=await e[r(520)](i[r(506)]).insert(c);if(l)throw l;const o={};return o[r(487)]=null,o[r(541)]=1,o}{const e=_0x5e9554[r(570)][r(581)+r(542)];(i[r(529)](null==e?void 0:e[r(532)],_0x4c2de9)||(null==e?void 0:e[r(549)+"tteId"])===_0x489874)&&_0x1a33f8++}}catch(c){const e={};return e[r(487)]=c,e.version=0,e}}(X,Y.white,Y.black,G.id);s?q.error("Failed to save",{description:s.message}):(q.success("Palette updated!",{description:`Version ${t} saved. ${J[X]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>E.some(s=>s.palette_id===e);return H?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):R?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(l,{className:"cursor-pointer transition-all hover:border-primary/50 "+(X===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(o,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),J[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),J[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[K.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),K.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:X&&Y?a.jsxs(l,{children:[a.jsx(x,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(m,{className:"flex items-center gap-2",children:[a.jsx(h,{className:"h-5 w-5"}),null==(D=ie(X))?void 0:D.name]}),a.jsx(f,{children:null==(A=ie(X))?void 0:A.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(X)&&a.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!X)return;Q(!0);const{error:s}=await async function(s){const t=S,n={};n[t(514)]="palette_id";const a=n;try{const{error:n}=await e[t(520)](t(492)+t(498))[t(574)]().eq(a[t(514)],s);if(n)throw n;const r={};return r[t(487)]=null,r}catch(r){const e={};return e[t(487)]=r,e}}(X);s?q.error("Failed to revert",{description:s.message}):(q.success("Reverted to defaults"),ne(X),await te()),Q(!1)},disabled:$,children:[a.jsx(j,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(p,{size:"sm",onClick:async()=>{if(!X||!Y||!G)return;(J[X]||0)>0?se(!0):await re()},disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(v,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(o,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(_=ie(X))?void 0:_.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:K.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(w,{type:"color",value:Y.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(w,{type:"text",value:Y.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(M=ie(X))?void 0:M.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:K.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(w,{type:"color",value:Y.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(w,{type:"text",value:Y.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:K.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:Y.white[e]},title:L[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:K.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:Y.black[e]},title:L[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(l,{className:"h-full flex items-center justify-center",children:a.jsxs(o,{className:"text-center py-12",children:[a.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(b,{children:[a.jsxs(C,{className:"flex items-center gap-2",children:[a.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(B,{children:["This palette is linked to ",a.jsx("strong",{children:J[X||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(p,{onClick:re,disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(k,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{M as default};
