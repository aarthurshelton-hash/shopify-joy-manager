import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b7 as o,B as l,A as d,cb as u,cR as x,a8 as h,D as m,aB as f,aC as p,aD as w,aE as v,p as j,t as y,w as g,dy as C,dt as b,bo as N,dq as q,cZ as L,a1 as D,a2 as B,a3 as z,a4 as _,a5 as A,aW as M,bC as U,dz as S,b as P,y as W}from"./index-SRT_aHEt.js";import{C as K}from"./calendar-DmpwAEvp.js";!function(){const e=Y,t=E();for(;;)try{if(826552===-parseInt(e(380))/1+parseInt(e(423))/2+-parseInt(e(454))/3+parseInt(e(345))/4+parseInt(e(360))/5+-parseInt(e(426))/6+parseInt(e(389))/7*(-parseInt(e(371))/8))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const k=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=Y;return k[e(356)]()[e(433)](e(348)+"+$")[e(356)]()[e(400)+"r"](k)[e(433)](e(348)+"+$")});function Y(e,t){e-=344;const s=E();let n=s[e];if(void 0===Y.PZLiUN){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};Y.Euqocr=r,Y.gKuCPb={},Y.PZLiUN=!0}const a=e+s[0],c=Y.gKuCPb[a];if(c)n=c;else{const e=function(e){this.YpLrnd=e,this.LykolN=[1,0,0],this.laGTVe=function(){return"newState"},this.zfZcwa="\\w+ *\\(\\) *{\\w+ *",this.UKVPqD="['|\"].+['|\"];? *}"};e.prototype.odCnju=function(){const e=new RegExp(this.zfZcwa+this.UKVPqD).test(this.laGTVe.toString())?--this.LykolN[1]:--this.LykolN[0];return this.iYJyas(e)},e.prototype.iYJyas=function(e){return Boolean(~e)?this.olUBNC(this.YpLrnd):e},e.prototype.olUBNC=function(e){for(let t=0,s=this.LykolN.length;t<s;t++)this.LykolN.push(Math.round(Math.random())),s=this.LykolN.length;return e(this.LykolN[0])},new e(Y).odCnju(),n=Y.Euqocr(n),Y.gKuCPb[a]=n}return n}k();const I=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[Y(447)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}();async function H(t){const s=Y,n={};n.EUWFT=s(415),n.UMEKW=s(351),n[s(459)]="withdrawal"+s(367),n.CDfXI="created_at",n[s(456)]=function(e,t){return e!==t},n[s(370)]=s(383),n[s(402)]=s(355)+"ts",n.iwVjT=s(353)+s(357)+"d_cents, t"+s(399)+s(422),n[s(417)]=s(427);const r=n;try{if(r[s(354)]!==r[s(414)]){const n={};n[s(382)]=!1;let a=e.from(r[s(459)]).select("*")[s(432)](r.CDfXI,n);t&&r[s(456)](t,s(366))&&(a=a.eq(r[s(370)],t));const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[]).map(e=>e.user_id))],{data:l}=await e.from("profiles")[s(365)]("user_id, d"+s(393)+"e").in(s(427),o),{data:d}=await e[s(428)](r.AMryV)[s(365)](r[s(419)]).in(r[s(417)],o),u=new Map((null==l?void 0:l[s(412)](e=>[e[s(427)],e]))||[]),x=new Map((null==d?void 0:d[s(412)](e=>[e[s(427)],e]))||[]),h=(c||[])[s(412)](e=>{var t,n,r;return{...e,payout_details:e[s(438)+s(363)],user_display_name:(null==(t=u.get(e.user_id))?void 0:t[s(373)+"me"])||s(386)+"er",wallet_total_earned:(null==(n=x[s(406)](e[s(427)]))?void 0:n[s(368)+"ed_cents"])||0,wallet_total_withdrawn:(null==(r=x[s(406)](e[s(427)]))?void 0:r.total_withdrawn_cents)||0}}),m={};return m[s(369)]=h,m.error=null,m}_0x1055da=_0x2946c0}catch(a){const e={};return e[s(369)]=[],e.error=a,e}}function E(){const e=["rvvxrLq","DxnLCL93ywXSzq","Dg9tDhjPBMC","B3rHBf9LyxjUzq","CgvUzgLUz19HBq","CM4GDgHPCYiPka","nJi5ndq1mhbUD2HHsa","BMn0Aw9UkcKG","DgTQBhm","ywLSCW","y29UC29Szq","C2vSzwn0","ywXS","x3jLCxvLC3rZ","Dg90ywXFzwfYBG","zgf0yq","zw5UrgS","mtzAr3vTzg0","Dw50","zgLZCgXHEv9Uyq","yxbWCM92zwq","B1nRr0G","tMjJsfO","C3rHDhvZlcbHBq","tgv1C0O","y3rVCIGICMv0Dq","ndy5nduZBg9qv3np","Bw91BNq","yxnJzw5KAw5N","C3rHDhvZ","zM9RExm","ywrTAw5FBM90zq","vw5RBM93BIbvCW","BgT5rxC","E30Uy29UC3rYDq","ndC1ndi2mfnusffJtG","yxv0Aa","DxbKyxrL","B3vUDf9Jzw50CW","AxnWBgf5x25HBq","yMLUza","C2LUz2XL","CgvUzgLUz19JBW","t1nJBLa","uwPJt1y","B3rHBf93AxrOza","y29UC3rYDwn0BW","CMv0DxjUicHMDq","qu1YEvy","CMvQzwn0zwq","Ahv4A24","ALLUD1C","z2v0","yxbWCM92zwrFyq","ChjVDg90ExbL","x19WCM90B19F","Dg9ju09tDhjPBG","yw1VDw50x2nLBG","BwfW","Aw52B2TL","vu1fs1C","uunLBhK","DcbMB3vUzcbVCG","rhvutNC","CgvUzgLUzW","AxDwALq","z2v0vxnLCG","D2L0AgrYyxDHBa","CMf3BL9Jzw50CW","mZiXnZeXmhvAr051sW","CMvXDwvZDf9Pza","AhLIsfm","nZeWotqWBwjsBgLX","DxnLCL9Pza","zNjVBq","BLfpB24","zNHbu1e","zxjYB3i","B3jKzxi","C2vHCMnO","ig5VDcbPBIbHCa","v2fSBgv0ihvWza","vMr2Bge","yxrLigvYCM9YoG","Cgf5B3v0x2rLDa","CMvQzwn0zwrFyW","C3vJy2vZCW","BgvUz3rO","yxbWCM92zwrFyW","DhHHCfi","CMvHC29UigLZia","BxbAruO","zwPnAKu","yxbWBhK","uMvXDwvZDcbUBW","yM9KEq","cI0TlqO","B3vUDa","y29TCgXLDgvKxW","zM9YrwfJAa","otq1nZa4A1PoAK1u","DhvZ","CLzHsK8","u1zYue4","rerKC0O","ENf1EeK","BeXVwwq","Cu9UAK8","Cw5uvLm","Bg9N","sKTmCNu","odGYntG0AgzswuDx","ChjVDMvKihn0yq","DgLJyxrLza","kcGOlISPkYKRkq","txbVwwe","Beffq3e","v2nXwwS","tM90igf1DgHLBG","DxnLCL9PzcWGDa"];return(E=function(){return e})()}async function G(){const t=Y,s={};s[t(376)]=t(418),s[t(384)]="completed",s[t(443)]=t(421)+t(367),s.tkjls=t(377)+t(392);const n=s;try{const{data:s,error:r}=await e[t(428)](n[t(443)]).select(n[t(362)]);if(r)throw r;const a={};a[t(396)+t(372)]=0,a[t(358)+"ount"]=0,a[t(442)+t(451)]=0,a[t(407)+t(381)]=0,a.completed_total=0,a[t(439)+t(451)]=0;const c=a;(s||[])[t(453)](e=>{const s=t;switch(e[s(383)]){case n[s(376)]:c[s(396)+"unt"]++,c[s(358)+s(451)]+=e[s(411)+"ts"];break;case s(374):c[s(442)+s(451)]++,c[s(407)+s(381)]+=e[s(411)+"ts"];break;case n[s(384)]:c[s(452)+"total"]+=e[s(411)+"ts"];break;case"rejected":c["rejected_c"+s(451)]++}});const i={};return i[t(369)]=c,i.error=null,i}catch(r){const e={};return e[t(369)]=null,e[t(431)]=r,e}}function J(e,t){e-=383;const s=V();let n=s[e];if(void 0===J.kbivDv){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};J.WhyhrA=r,J.rLIaQb={},J.kbivDv=!0}const a=e+s[0],c=J.rLIaQb[a];if(c)n=c;else{const e=function(e){this.iPLRSy=e,this.fvVABY=[1,0,0],this.OCRiiQ=function(){return"newState"},this.kJLGnP="\\w+ *\\(\\) *{\\w+ *",this.QuXgJL="['|\"].+['|\"];? *}"};e.prototype.GNfNwC=function(){const e=new RegExp(this.kJLGnP+this.QuXgJL).test(this.OCRiiQ.toString())?--this.fvVABY[1]:--this.fvVABY[0];return this.lozANF(e)},e.prototype.lozANF=function(e){return Boolean(~e)?this.fdjuqF(this.iPLRSy):e},e.prototype.fdjuqF=function(e){for(let t=0,s=this.fvVABY.length;t<s;t++)this.fvVABY.push(Math.round(Math.random())),s=this.fvVABY.length;return e(this.fvVABY[0])},new e(J).GNfNwC(),n=J.WhyhrA(n),J.rLIaQb[a]=n}return n}I(void 0,function(){const e=Y,t={SVrPN:function(e,t){return e+t},Vdvla:e(388)+e(379)+e(359)+" )",fxASQ:function(e){return e()},JOjCy:e(463),xyOcU:"warn",qOnjO:"table",qnTVS:function(e,t){return e===t},OScnP:e(405)},s=t[e(430)](function(){const s=e;let n;try{n=Function(t[s(457)](s(401)+s(361)+t[s(436)],");"))()}catch(r){n=window}return n}),n=s[e(364)]=s.console||{},r=[t.JOjCy,t.xyOcU,"info",e(431),"exception",t[e(461)],"trace"];for(let a=0;a<r[e(441)];a++){if(!t[e(462)](t[e(397)],t.OScnP)){const t=_0x3812a7?function(){if(_0x727ed8){const t=_0x82112d[e(447)](_0x3aa820,arguments);return _0x25d3ed=null,t}}:function(){};return _0x1a00a8=!1,t}{const t=I[e(400)+"r"][e(408)][e(394)](I),s=r[a],c=n[s]||t;t[e(409)]=I[e(394)](I),t[e(356)]=c[e(356)][e(394)](c),n[s]=t}}})(),function(){const e=J,t=V();for(;;)try{if(837233===-parseInt(e(392))/1+parseInt(e(435))/2+parseInt(e(403))/3*(parseInt(e(395))/4)+-parseInt(e(389))/5*(parseInt(e(428))/6)+parseInt(e(399))/7*(-parseInt(e(445))/8)+-parseInt(e(385))/9+-parseInt(e(431))/10*(-parseInt(e(394))/11))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const R=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[J(450)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=J,t={};t[e(440)]=e(413)+"+$";const s=t;return R[e(429)]()[e(444)](s[e(440)])[e(429)]().constructor(R).search(s.jfXLu)});R();const O=function(){const e=J,t={};t[e(422)]=e(406)+"nction() ",t.tddhM=function(e,t){return e!==t},t[e(425)]=e(408);const s=t;let n=!0;return function(t,r){const a=e;if("mVmET"!==a(438)){const e=n?function(){const e=a,n={FJHdQ:function(e,t){return e(t)},qKHoR:function(e,t){return e+t},XrNZV:s[e(422)]};if(s.tddhM(e(442),"xIkMK")){let t;try{t=n[e(411)](_0x540f75,n.qKHoR(n[e(398)]+(e(427)+e(432)+e(397)+" )"),");"))()}catch(c){t=_0x369f58}return t}if(r){if(e(418)!==s.QsrYm){const s=r[e(450)](t,arguments);return r=null,s}if(_0x2bbef2){const t=_0x493ea1[e(450)](_0x9a81eb,arguments);return _0x40f2d5=null,t}}}:function(){};return n=!1,e}{const e=_0x5585c9[a(424)+"r"].prototype[a(437)](_0x532b54),t=_0x1de7b9[_0x36d3ab],s=_0x3444c6[t]||e;e[a(423)]=_0x223632[a(437)](_0x3ef3ac),e.toString=s[a(429)][a(437)](s),_0xdbcc9d[t]=e}}}();function V(){const e=["BgvUz3rO","y3jLyxrLzf9HDa","CMv0DxjUicHMDq","EfngAKi","ELD6v0y","yxv0Aa","z2v0x29Yx2nYzq","rKPizfe","vKXoAxm","kcGOlISPkYKRkq","D2fSBgv0x3rYyq","tM90igf1DgHLBG","DhjHy2u","zxHJzxb0Aw9U","CLbyyxu","qvjtBwu","y2vFy2vUDhm","ChjVy2vZC19Tyq","ChzpuwK","x19WCM90B19F","y29UC3rYDwn0BW","uxnYww0","B3jKzxi","E30Uy29UC3rYDq","mtK5nJjAu3P3uKy","Dg9tDhjPBMC","C2vSzwn0","mtiZmdCWrfPNyxPS","y3rVCIGICMv0Dq","DKjRwfu","Cf91C2vYx2LK","mti3mdKYmMvnEw10wG","yxnJzw5KAw5N","yMLUza","DLLPzvu","C3vJy2vZCW","AMzythu","Cf9SAxn0Aw5NxW","EeLRtuS","Cf9ZywXLx3bYAq","C2vHCMnO","odGYndC5mKXdthHYCq","DgfIBgu","ALHSr0i","C2fSzq","t2DIvfm","yxbWBhK","DgLJyxrLza","DxnLCL9Pza","zgf0yq","mZK0ntm0ohbWsvb4Cq","sNnMDhe","D2fYBG","Dg9gAxHLza","nta1qxvhDNPT","BMn0Aw9UkcKG","Aw5MBW","mJy5mdu5DxvfEwPX","CNbJ","mtyWnKLdBNbHsG","mtiXodHAB214uMC","zxjYB3i","CM4GDgHPCYiPka","whjowLy","n0DtEfjZAa","z0vqB3y","y29UC29Szq","z2v0vxnLCG","ntqZy2Twsufj"];return(V=function(){return e})()}function Z(e){const t=J,s={oLjsO:function(e,t){return e/t}};return"$"+s.oLjsO(e,100)[t(388)](2)}function X(){var k,I;const{user:E}=t(),J=s(),[R,O]=n.useState(!1),[V,X]=n.useState(!0),[T,F]=n.useState([]),[Q,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{oe()},[E]);const oe=async()=>{if(!E)return void X(!1);const{data:t}=await e.rpc("has_role",{_user_id:E.id,_role:"admin"});!0===t&&(O(!0),await le()),X(!1)},le=async()=>{const[e,t]=await Promise.all([H(ee),G()]);e.data&&F(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(W,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(W,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(W,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(W,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(W,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(W,{variant:"outline",children:e})}};return V?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):E&&R?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(l,{variant:"ghost",size:"icon",onClick:()=>J(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),Q&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:Z(Q.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:Z(Q.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Z(Q.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.rejected_count})]})})]}),r.jsxs(f,{value:ee,onValueChange:e=>{te(e),le()},children:[r.jsxs(p,{className:"mb-6",children:[r.jsx(w,{value:"pending",children:"Pending"}),r.jsx(w,{value:"approved",children:"Approved"}),r.jsx(w,{value:"completed",children:"Completed"}),r.jsx(w,{value:"rejected",children:"Rejected"}),r.jsx(w,{value:"all",children:"All"})]}),r.jsx(v,{value:ee,children:r.jsxs(c,{children:[r.jsxs(j,{children:[r.jsx(y,{children:"Withdrawal Requests"}),r.jsxs(g,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===T.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(C,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(b,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:T.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(N,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(q,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(K,{className:"h-3 w-3"}),L(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",Z(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:Z(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(m,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(l,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(D,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(B,{children:[r.jsxs(z,{children:[r.jsxs(_,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(A,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(k=se.request.payout_details)?void 0:k.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:Z(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(M,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(U,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(I=se.request.payout_details)?void 0:I.email})]})]})]}),r.jsxs(S,{children:[r.jsx(l,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=Y,r={};r[n(445)]=n(352)+n(347),r[n(349)]=n(374),r.lAECq=function(e,t){return e||t},r.ZivbJ=n(383);const a=r;try{const{data:{user:r}}=await e[n(390)][n(420)]();if(!r)throw new Error(a.mpZEJ);const{error:c}=await e[n(428)](n(421)+n(367))[n(391)]({status:a.MpoYa,admin_notes:a[n(350)](s,null),reviewed_by:r.id,reviewed_at:(new Date).toISOString()}).eq("id",t).eq(a.ZivbJ,n(418));if(c)throw c;const i={success:!0};return i[n(431)]=null,i}catch(c){const e={};return e[n(440)]=!1,e[n(431)]=c,e}}(se.request.id,re),t.success&&P.success("Withdrawal approved");break;case"reject":if(!re.trim())return P.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=Y,r={};r.JKLru=n(352)+n(347),r[n(425)]=n(403);const a=r;try{const{data:{user:r}}=await e[n(390)][n(420)]();if(!r)throw new Error(a[n(344)]);if(!s)throw new Error("Rejection "+n(444)+"required");const{error:c}=await e[n(428)](n(421)+n(367))[n(391)]({status:a[n(425)],admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date)[n(410)+"g"]()}).eq("id",t).eq(n(383),n(418));if(c)throw c;const i={success:!0};return i[n(431)]=null,i}catch(c){const e={success:!1};return e[n(431)]=c,e}}(se.request.id,re),t.success&&P.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=Y,r={};r[n(398)]=n(460),r[n(404)]="Not authenticated",r.DDdsJ=n(421)+n(367),r[n(446)]=n(374),r[n(378)]=n(448)+n(416)+n(434)+n(346)+n(455),r[n(387)]="completed",r[n(375)]="process-withdrawal",r[n(429)]=n(435)+n(437);const a=r;try{if(n(460)!==a[n(398)]){const e={};return e[n(440)]=!1,e[n(431)]=_0x227c92,e}{const{data:{user:r}}=await e[n(390)][n(420)]();if(!r)throw new Error(a[n(404)]);const{data:c,error:i}=await e[n(428)](a[n(458)])[n(365)]("*").eq("id",t).eq("status",a[n(446)])[n(395)]();if(i||!c)throw new Error(a[n(378)]);const{error:o}=await e.from(a[n(458)])[n(391)]({status:a[n(387)],admin_notes:s?(c[n(385)+"s"]||"")+n(450)+s:c[n(385)+"s"],completed_at:(new Date)[n(410)+"g"]()}).eq("id",t);if(o)throw o;const l={};l[n(424)]=t,l.user_id=c[n(427)],l[n(411)+"ts"]=c[n(411)+"ts"];const d={};d[n(449)]=l;const{error:u}=await e.functions[n(413)](a.oSkGH,d),x={success:!0};return x[n(431)]=null,x}}catch(c){const e={};return e[n(440)]=!1,e[n(431)]=c,e}}(se.request.id,re),t.success&&P.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?P.error(t.error.message):(ne({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(l,{onClick:()=>J("/"),children:"Go Home"})]})})})}O(void 0,function(){const e=J,t={Jsftq:function(e,t){return e!==t},qbLEO:"gUYbD",ARSme:function(e,t){return e(t)},gEPov:function(e,t){return e+t},KnLTp:function(e){return e()},xSFjB:e(416)},s=t.KnLTp(function(){const s=e;if(t[s(386)]("gUYbD",t.qbLEO)){const e=_0x2aa30d?function(){if(_0x473671){const e=_0x2fc023.apply(_0x5d075f,arguments);return _0x80c105=null,e}}:function(){};return _0xecfd36=!1,e}{let e;try{e=t[s(419)](Function,t[s(400)](s(406)+s(390)+(s(427)+s(432)+s(397)+" )"),");"))()}catch(n){e=window}return e}}),n=s[e(401)]=s[e(401)]||{},r=["log",e(387),e(391),e(396),e(417),e(446),t[e(407)]];for(let a=0;a<r[e(404)];a++){const t=O[e(424)+"r"].prototype.bind(O),s=r[a],c=n[s]||t;t[e(423)]=O[e(437)](O),t[e(429)]=c[e(429)][e(437)](c),n[s]=t}})();export{X as default};
