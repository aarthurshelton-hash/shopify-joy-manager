const e="import { supabase } from '@/integrations/supabase/client';\n\ninterface PremiumValidationResult {\n  allowed: boolean;\n  reason: 'visionary' | 'subscription' | 'no_subscription' | 'error';\n  message?: string;\n  subscriptionEnd?: string;\n}\n\n/**\n * Validates premium download access via server-side edge function.\n * This ensures that premium features are validated on the server,\n * not just client-side.\n */\nexport async function validatePremiumDownload(): Promise<PremiumValidationResult> {\n  try {\n    const { data: { session } } = await supabase.auth.getSession();\n    \n    if (!session?.access_token) {\n      return {\n        allowed: false,\n        reason: 'no_subscription',\n        message: 'Please sign in to download HD images',\n      };\n    }\n\n    const { data, error } = await supabase.functions.invoke('validate-premium-download', {\n      headers: {\n        Authorization: `Bearer ${session.access_token}`,\n      },\n    });\n\n    if (error) {\n      console.error('Premium validation error:', error);\n      return {\n        allowed: false,\n        reason: 'error',\n        message: 'Failed to validate premium status. Please try again.',\n      };\n    }\n\n    return {\n      allowed: data.allowed,\n      reason: data.reason,\n      message: data.message,\n      subscriptionEnd: data.subscription_end,\n    };\n  } catch (error) {\n    console.error('Premium validation error:', error);\n    return {\n      allowed: false,\n      reason: 'error',\n      message: 'An unexpected error occurred. Please try again.',\n    };\n  }\n}\n\n/**\n * Checks if the user has premium access and returns a user-friendly message\n * if they don't.\n */\nexport async function checkPremiumAccess(): Promise<{\n  hasPremium: boolean;\n  message?: string;\n}> {\n  const result = await validatePremiumDownload();\n  \n  if (result.allowed) {\n    return { hasPremium: true };\n  }\n\n  let message = 'Premium subscription required for HD downloads';\n  \n  if (result.reason === 'no_subscription') {\n    message = result.message || 'Upgrade to Premium for unlimited HD downloads';\n  } else if (result.reason === 'error') {\n    message = result.message || 'Unable to verify premium status';\n  }\n\n  return { hasPremium: false, message };\n}\n";export{e as default};
