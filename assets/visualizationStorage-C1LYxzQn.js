import{s as t,ca as n,dG as r,dH as e}from"./index-ckGSTu6A.js";import{v as i,a as o,b as a}from"./visualizationSchemas-BAZwVT06.js";import"./flagContent-ChJxp5uM.js";function s(){const t=["CMvTB3zL","vKHeC2e","Aw4GEw91CIbNyq","BgfYihzPC3vHBa","C2XPy2u","BgXLCNK","Bg9YCW","ndGYnerUshDeBa","rMfPBgvKihrVia","zxHPC3rPBMDjza","DxjTDey","Dw5K","CMvUDfvZzxi","zxjYB3i","ueHTzNO","Bg9N","CMvZDwX0","AxPHDgLVBIaTia","AwnHDguGzxHPCW","ww91igHHDMuGyq","ywXPEMf0Aw9UCW","BM93","B3DUzwrcEun1CG","CgDU","sw52ywXPzcbqrW","q2vfq1e","Bg9JywXLq29TCa","vgHPCYbPCYa","Cg5ethe","DhrLswq","vgHPCYb2Axn1yq","BwvZC2fNzq","z2v0uhvIBgLJvq","wMX0EMy","suX4vwS","ChjVzMLSzxm","quXfDNK","zgvSzxrLihzPCW","CgfSzxr0zuLK","vgL0BguGy29UDa","y1bHBgv0Dgu","DgfIBgu","AwqSihvZzxjFAq","C3vHBgL6yxrPBW","CM4GDgHPCYiPka","BxrAzuy","Aw9Uu3rHDgu","qw5VDgHLCIbJBW","CeLyrvu","C2f2zwrFDMLZDq","yMXHy2S","z2fTzurHDge","CMvHC29U","u29QtuO","zxr0zuLK","vMLZDwfSAxPHDa","y2f0zxm6","AgvJAZO","AxnjBNrYAw5ZAq","uw55ChO","DgL0Bgu","ueDsu1qXmty","y3vYCMvUDe1VDG","zvvrq2i","r0nUELe","vK9tr2W","CYbHBhjLywr5ia","ywLUCYbPBMfWCa","mty4nZGWn0vtqLjuza","AxnuB29tAw1PBa","y3jLyxrLzf9HDa","BIbIEsa","AxneDxbSAwnHDa","y29SB3jtAw1PBa","mtK4Ce9TzwXM","yK5WA0S","zgvSzxrL","yw5VDgHLCIbJBW","Dg9mB3DLCKnHCW","CYbVD25LzcbIEq","zgfYA01Vzgu","D2fYBG","zgLZCgXHEv9Uyq","rgDQD3i","yxbWBhK","DxnLCL9Pza","mtaWnZyXDeXmt21Q","yMLUza","rxjYB3iGAw4Gza","C2f2zsb2Axn1yq","B250zw50","C2LUz2XL","zNjVBq","ntiXmdmWuwzYrNDI","CgL3tKi","nJCZotbxyvzmu2i","nZK1mZG0Dwz2EMzJ","yxnJzw5KAw5N","Dg9tDhjPBMC","y0DHBwu","BMCGyxqGBgvHCW","igzVCIb1BMLXDq","CgLLy2vuExbL","C3bSAxq","r3HkwNG","B3DUzxjeAxnWBa","kcGOlISPkYKRkq","vvfPD2S","BKLK","EuD0sgi","uwjhBwS","CM9WCMLHDguGyW","ChjVDg90ExbL","rxjYB3iGy2HLyW","yxjPDhK","BgLUA2vKugfSzq","C29YDa","BgvUz3rO","BgXLy3rVCG","z2fTzv9KyxrH","BgL6yxrPB24GAq","y29UC3rYDwn0BW","zxHmweO","weH6ugy","lNbUzW","mJy0nZG2uLvPzwft","DxbSAwnHDguGyW","zxHPC3rPBMDwAq","BgL6yxrPB246ia","C0DqweG","nfzpDwHpwG","Bwf0y2HLzfbHBa","zMLUzeLUzgv4","wgfPtgO","C2vHCMnO","C3fHDuO","Aw9Uig5VDcbMBW","C2vSzwn0","BhnJB0O","zw5LC3m","y29Kzq","y3vZDg9T","y3rVCIGICMv0Dq","AM9PBG","r0HiAhG","vKjzzum","yxLoyw1L","twnUB3q","CgLLy2vdB2XVCG","D2HPDgu","zgf0yq","zxzLBNq","Dca4ignVBg9YCW","ywXPEMf0Aw9UoG","ihzLCNKGC2LTAq","DgXL","thHHtxy","zunHCMq","Dg90ywXnB3zLCW","CM91BMq","AuPLDLK","DxbZzxj0","DxbSB2fK","Aw9UCW","y29UDgvUDfr5Ca","Dg8Gysb2AxnPBW","C3rVCMfNzq","txbrq1K","x19WCM90B19F","B3jKzxi","CML0Eq","zxHPC3rPBMDdBW","jsbZAw1PBgfYia","zhLRwfa","Bw9KzxjU","Bg9JA2vKugLLyW","CMvWBgfJzq","zgf0zq","wunkvNO","DMLZDwfSAxPHDa","nda2zLfuDevA","Bw92zxm","C01zyMW","y3vZDg9Tq29SBW","BeX3Bei","Aw5MBW","mtzbzwX2Auy","sMDYyuy","zxr0zvnPBwLSyq","DwfSAxPHDgLVBG","yNzUDwe","zMv0y2GGDMLZDq","CMv0DxjUicHMDq","D25Ku2W","E30Uy29UC3rYDq","Bwf0y2HLzeDHBq","BMn0Aw9UkcKG","zMLUza","ChvIBgLJvxjS","yM9HCMq","tIbKyxrH"];return(s=function(){return t})()}!function(){const t=l,n=s();for(;;)try{if(288005===parseInt(t(640))/1*(parseInt(t(684))/2)+-parseInt(t(679))/3*(-parseInt(t(539))/4)+-parseInt(t(647))/5+-parseInt(t(650))/6+parseInt(t(533))/7*(-parseInt(t(561))/8)+-parseInt(t(628))/9*(parseInt(t(649))/10)+parseInt(t(622))/11)break;n.push(n.shift())}catch(r){n.push(n.shift())}}();const u=function(){let t=!0;return function(n,r){const e=t?function(){if(r){const t=r[l(638)](n,arguments);return r=null,t}}:function(){};return t=!1,e}}()(void 0,function(){const t=l,n={};n[t(579)]=t(660)+"+$";const r=n;return u[t(652)]().search(t(660)+"+$")[t(652)]().constructor(u)[t(688)](r[t(579)])});u();const c=function(){let t=!0;return function(n,r){const e=t?function(){if(r){const t=r[l(638)](n,arguments);return r=null,t}}:function(){};return t=!1,e}}();function f(t,n,r){const e=l;return(t||n.pgn||"").trim()[e(529)](/\s+/g," ")+"::"+(r?JSON.stringify({palette:r[e(592)]||e(527),darkMode:r[e(634)]||!1,currentMove:r[e(616)+"e"]===1/0?"all":r[e(616)+"e"],lockedPieces:(r[e(528)+"es"]||[])[e(670)]((t,n)=>(t[e(501)]+"-"+t[e(656)])[e(580)+"are"](n[e(501)]+"-"+n[e(656)]))}):"{}")}async function w(i,o,a,s){const u=l,c={BBsbP:u(593)+"ains inappropriate c"+u(644),zVBzL:"saved_visualizations",PLfQl:function(t,n,r,e){return t(n,r,e)},pmTXo:function(t,n){return t===n},eUQCb:function(t,n){return t!==n},buefK:"SSaEa",YCJVz:u(589),AQNaw:"Exact dupl"+u(572)+"ts",piwNB:u(527),bNpkK:u(555),exLXJ:"IfuCk",uvAJX:u(509),sbran:u(526),GHHhx:u(602),lhhbN:function(t,n){return t(n)}};try{const w=f(o,a,s),{data:l,error:C}=await t.from(c.zVBzL)[u(691)](u(596)+"d, pgn, game_data");if(C){const t={isDuplicate:!1};return t[u(623)+"ar"]=!1,t}for(const n of l||[]){const r=n[u(673)],e=c.PLfQl(f,n[u(577)]||void 0,r,r[u(532)+"ionState"]);if(c.pmTXo(w,e)){const r=c.pmTXo(n.user_id,i);let e;if(!r){if(!c[u(617)]("nhguq",c.buefK))return{data:null,error:new _0xbf451(u(609)+u(690)+u(565))};{const{data:r}=await t[u(646)](c[u(531)]).select(u(636)+"me").eq(u(639),n[u(639)]).single();e=(null==r?void 0:r[u(636)+"me"])||u(601)+u(672)}}const o={};return o[u(626)+"e"]=!0,o[u(623)+"ar"]=!0,o.existingId=n.id,o.ownedByCurrentUser=r,o["ownerDispl"+u(700)]=e,o["colorSimil"+u(668)]=100,o[u(606)]=c.AQNaw,o}}const D=(null==s?void 0:s[u(592)])||c[u(648)];let y;if(null==s?void 0:s[u(536)+"rs"]){if("VHDsa"!==c[u(629)]){const t=_0xe07466[u(638)](_0x2eecce,arguments);return _0x13de91=null,t}y=s[u(536)+"rs"]}else if(D===u(695)){const t=n[u(550)](t=>"custom"===t.id);if(t){if(c.pmTXo(c[u(676)],c.uvAJX))return{data:null,error:new _0x3ad5a0(_0x1ff775[u(606)]||c.BBsbP)};{const n={};n[u(502)]=t[u(502)],n[u(604)]=t[u(604)],y=n}}}const z=await r(i,o,a,D,y);if(z.isTooSimilar){const t={};return t[u(626)+"e"]=!1,t.isTooSimilar=!0,t[u(563)]=z[u(681)+u(597)+u(662)],t[u(576)+u(566)]=z["ownedByCur"+u(566)],t[u(659)+u(700)]=z[u(659)+"ayName"],t[u(627)+u(668)]=z[u(627)+u(668)],t[u(606)]=z[u(606)],t[u(524)+u(560)]=z.existingColors,t[u(612)+u(594)]=z[u(612)+u(594)],t[u(612)+u(653)]=z["isIntrinsi"+u(653)],t[u(548)+u(510)]=z[u(548)+"eCard"],t[u(685)+u(608)]=z[u(685)+u(608)],t[u(685)+u(541)+u(523)]=z["matchedPal"+u(541)+"rity"],t}let B;if(y){if(c.sbran===c[u(698)]){const t={};return t[u(503)]=null,t[u(567)]=_0x2875fe,t}B=c.lhhbN(e,y)||void 0}const g={};return g[u(626)+"e"]=!1,g[u(623)+"ar"]=!1,g["linkedPale"+u(583)]=B,g.colorSimilarity=z["colorSimil"+u(668)],g["isIntrinsi"+u(594)]=z["isIntrinsi"+u(594)],g[u(612)+u(653)]=z[u(612)+u(653)],g[u(548)+"eCard"]=z["matchedGam"+u(510)],g[u(685)+u(608)]=z["matchedPal"+u(608)],g[u(685)+"etteSimilarity"]=z[u(685)+"etteSimila"+u(523)],g}catch(w){const t={isDuplicate:!1};return t[u(623)+"ar"]=!1,t}}function l(t,n){t-=500;const r=s();let e=r[t];if(void 0===l.UYqSDO){var i=function(t){let n="",r="",e=n+i;for(let i,o,a=0,s=0;o=t.charAt(s++);~o&&(i=a%4?64*i+o:o,a++%4)?n+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&i>>(-2*a&6)):a:0)o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(let i=0,o=n.length;i<o;i++)r+="%"+("00"+n.charCodeAt(i).toString(16)).slice(-2);return decodeURIComponent(r)};l.cToAnx=i,l.ZUiRQN={},l.UYqSDO=!0}const o=t+r[0],a=l.ZUiRQN[o];if(a)e=a;else{const t=function(t){this.ChAQfn=t,this.spQtvA=[1,0,0],this.iUsKke=function(){return"newState"},this.RfhNam="\\w+ *\\(\\) *{\\w+ *",this.nXgVpp="['|\"].+['|\"];? *}"};t.prototype.vjeJaM=function(){const t=new RegExp(this.RfhNam+this.nXgVpp).test(this.iUsKke.toString())?--this.spQtvA[1]:--this.spQtvA[0];return this.NRiebe(t)},t.prototype.NRiebe=function(t){return Boolean(~t)?this.ZikKaF(this.ChAQfn):t},t.prototype.ZikKaF=function(t){for(let n=0,r=this.spQtvA.length;n<r;n++)this.spQtvA.push(Math.round(Math.random())),r=this.spQtvA.length;return t(this.spQtvA[0])},new t(l).vjeJaM(),e=l.cToAnx(e),l.ZUiRQN[o]=e}return e}async function C(n,r,e,s,u,c){const f=l,C={bvnua:"(((.+)+)+)+$",mtZeF:function(t,n){return t!==n},DbqfD:"bkBIk",MpQCY:function(t,n){return t!==n},GxJZx:"tNHWS",wnxyD:function(t,n){return t(n)},ALEvy:"Title cont"+f(621)+f(665)+f(644),PHmfz:function(t,n,r,e,i){return t(n,r,e,i)},sqauJ:f(500),VBYeC:f(584)+"lization i"+f(620)+f(556)+f(559),lLwlB:f(631)+f(672),iJevY:"image/png",bpTVN:f(661),SojMJ:f(532)+f(516)};try{if(C.mtZeF(f(564),C.DbqfD)){const l=i(r);if(!l.success){if(!C[f(520)](C[f(658)],C.GxJZx))return{data:null,error:new Error(l.error||"Invalid ti"+f(508))};_0x391bca=_0x11091b.customColors}const D=await C.wnxyD(o,r);if(!D.safe)return{data:null,error:new Error(D[f(606)]||C[f(590)])};const y=a(u);if(!y.success)return{data:null,error:new Error(y[f(567)]||f(578)+f(553))};const z=await C[f(568)](w,n,u,e[f(605)],c);if(z[f(626)+"e"]){if(C.MpQCY(f(500),C[f(689)]))return _0x45ca22[f(652)]()[f(688)](ROUtXf[f(543)])[f(652)]()[f(675)+"r"](_0x2e80af)[f(688)]("(((.+)+)+)+$");{const t=z["ownedByCur"+f(566)]?C[f(699)]:f(584)+f(674)+f(633)+" "+(z.ownerDisplayName||C[f(537)]);return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:z[f(576)+f(566)],ownerDisplayName:z["ownerDispl"+f(700)],colorSimilarity:100}}}if(z[f(623)+"ar"]){const t=z[f(576)+f(566)]?f(573)+f(507)+f(557)+f(571)+"try changi"+f(654)+f(505)+f(655)+f(693):f(581)+Math[f(512)](z[f(627)+f(668)]||30)+(f(525)+f(518)+f(625))+(z["ownerDispl"+f(700)]||C.lLwlB);return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:z[f(576)+f(566)],ownerDisplayName:z[f(659)+f(700)],colorSimilarity:z[f(627)+"arity"],reason:z[f(606)]}}const B={...c};B[f(669)+f(583)]=z[f(669)+"tteId"];const g=B,v=n+"/"+Date[f(575)]()+"-"+r[f(529)](/[^a-z0-9]/gi,"-")[f(632)+"e"]()+f(678),x={};x[f(517)+"e"]=C[f(513)],x[f(514)]=!1;const{error:h}=await t[f(519)][f(646)]("visualizations")[f(515)](v,s,x);if(h)throw C[f(599)](f(661),C.bpTVN)?new _0x2b19fc(f(562)+"delete vis"+f(542)+": "+_0x2e1ded[f(585)]):new Error(f(562)+"upload image: "+h[f(585)]);const{data:L}=t[f(519)][f(646)]("visualizat"+f(516))[f(586)+"rl"](v),d={};d[f(502)]=e[f(605)][f(502)],d.black=e[f(605)][f(604)],d[f(504)]=e[f(605)].event,d[f(530)]=e[f(605)].date,d[f(570)]=e.gameData[f(570)],d.pgn=e.gameData[f(577)],d[f(534)]=e[f(605)].moves,d[f(552)]=e[f(552)],d.totalMoves=e[f(511)],d[f(532)+f(600)]=g;const m=d,p={};p[f(639)]=n,p[f(614)]=r,p[f(577)]=u||null,p[f(673)]=m,p.image_path=L[f(551)];const{data:A,error:M}=await t[f(646)]("saved_visualizations").insert(p)[f(691)]()[f(645)]();if(M)throw await t[f(519)][f(646)](C[f(607)])[f(554)]([v]),new Error(f(562)+f(643)+f(682)+M.message);const q={};return q[f(503)]=A,q[f(567)]=null,q}{const t=_0x1e51b8[f(550)](t=>t.id===f(695));if(t){const n={};n.white=t[f(502)],n[f(604)]=t[f(604)],_0x388d41=n}}}catch(D){const t={};return t[f(503)]=null,t[f(567)]=D,t}}async function D(n){const r=l,e={};e[r(663)]=r(639),e.lscoJ=function(t,n){return t!==n},e[r(677)]="acmby",e[r(637)]=r(546);const i=e;try{const e={};e[r(651)]=!1;const{data:o,error:a}=await t[r(646)]("saved_visu"+r(574))[r(691)]("*").eq(i.yGtHb,n)[r(522)](r(624),e);if(a){if(i[r(692)](i[r(677)],i[r(637)]))throw new Error(r(562)+"fetch visu"+r(574)+": "+a.message);_0x16ce35=_0xfae5f6}const s={};return s[r(503)]=o||[],s[r(567)]=null,s}catch(o){const t={};return t[r(503)]=[],t[r(567)]=o,t}}async function y(n,r){const e=l,i={};i[e(664)]=e(532)+e(516),i[e(540)]=e(603)+e(574);const o=i;try{const i=new URL(r).pathname[e(657)]("/"),a=i[e(686)](t=>t===e(532)+"ions"),s=i[e(558)](a+1)[e(697)]("/");s&&await t.storage[e(646)](o.QbGmk)[e(554)]([s]);const{error:u}=await t[e(646)](o[e(540)])[e(630)]().eq("id",n);if(u)throw new Error(e(562)+e(591)+e(542)+": "+u[e(585)]);const c={};return c[e(567)]=null,c}catch(a){if(e(582)==e(582)){const t={};return t[e(567)]=a,t}throw new _0x48a300(e(562)+e(544)+e(574)+": "+_0x5e0c9a[e(585)])}}c(void 0,function(){const t=l,n={ILxUk:function(t,n){return t(n)},TrEJN:function(t,n){return t+n},Qnypz:t(547)+t(696)+t(598)+" )",AxaXw:function(t){return t()},sGPXH:t(635),GCnzQ:t(567),BVkvq:"trace",VOSGl:function(t,n){return t<n}};let r;try{const e=n[t(588)](Function,n.TrEJN(t(545)+t(549),n[t(613)])+");");r=n.AxaXw(e)}catch(o){r=window}const e=r.console=r.console||{},i=[t(569),n[t(683)],t(538),n[t(618)],"exception",t(595),n.BVkvq];for(let a=0;n[t(619)](a,i[t(671)]);a++){const n=c.constructor[t(666)].bind(c),r=i[a],o=e[r]||n;n[t(521)]=c[t(641)](c),n[t(652)]=o[t(652)][t(641)](o),e[r]=n}})();export{w as checkDuplicateVisualization,y as deleteVisualization,D as getUserVisualizations,C as saveVisualization};
