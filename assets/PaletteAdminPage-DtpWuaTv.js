import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as m,P as h,w as f,B as v,bM as w,cj as p,a9 as j,am as g,a1 as y,a2 as N,a3 as b,a4 as k,bC as C,a5 as z,cu as B,b as q}from"./index-Cppn2aUX.js";!function(){const e=S,s=I();for(;;)try{if(975024===parseInt(e(220))/1+parseInt(e(159))/2*(-parseInt(e(175))/3)+-parseInt(e(197))/4+-parseInt(e(158))/5+parseInt(e(178))/6+-parseInt(e(219))/7*(parseInt(e(153))/8)+parseInt(e(160))/9)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const D=function(){const e=S,s={wREEW:function(e,s){return e!==s}};s.yjdwD=e(152);const t=s;let n=!0;return function(s,r){const a=e,i={};i.TYKqR=a(201)+a(194)+":";const c=i;if(t[a(183)](t.yjdwD,t[a(151)]))return _0x9f12a3[a(157)](c.TYKqR,_0x305e88),!1;{const e=n?function(){if(r){const e=r.apply(s,arguments);return r=null,e}}:function(){};return n=!1,e}}}()(void 0,function(){const e=S;return D.toString()[e(169)](e(189)+"+$")[e(217)]().constructor(D)[e(169)](e(189)+"+$")});function S(e,s){e-=142;const t=I();let n=t[e];if(void 0===S.fNnVKu){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};S.eaJZUE=r,S.vLRvBr={},S.fNnVKu=!0}const a=e+t[0],i=S.vLRvBr[a];if(i)n=i;else{const e=function(e){this.HtECDx=e,this.kIftxB=[1,0,0],this.LfanzG=function(){return"newState"},this.hqWPrI="\\w+ *\\(\\) *{\\w+ *",this.biktkq="['|\"].+['|\"];? *}"};e.prototype.JbflNe=function(){const e=new RegExp(this.hqWPrI+this.biktkq).test(this.LfanzG.toString())?--this.kIftxB[1]:--this.kIftxB[0];return this.ScgUJP(e)},e.prototype.ScgUJP=function(e){return Boolean(~e)?this.ALqUws(this.HtECDx):e},e.prototype.ALqUws=function(e){for(let s=0,t=this.kIftxB.length;s<t;s++)this.kIftxB.push(Math.round(Math.random())),t=this.kIftxB.length;return e(this.kIftxB[0])},new e(S).JbflNe(),n=S.eaJZUE(n),S.vLRvBr[a]=n}return n}D();const K=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[S(163)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();async function A(s,t,n,r){const a=S,i={tVrJj:function(e,s){return e(s)},svHgz:function(e,s){return e+s},jATYu:a(199)+"nction() ",UmbDs:a(173),yTXyI:function(e,s){return e!==s},bykJC:"hmUcF",YgIns:a(154),zcOJI:function(e,s){return e===s},ZHlNv:a(230)+a(226)};try{if("AYAWo"!==i[a(236)]){let e;try{e=oKeoho[a(221)](_0xce7b16,oKeoho.svHgz(oKeoho[a(168)],"{}.constru"+a(218)+a(204)+" )")+");")()}catch(c){e=_0x238ad7}return e}{const{data:c}=await async function(s){const t=S,n={};n[t(143)]="JkkyQ",n[t(182)]=t(193);const r=n;try{if(r[t(143)]===t(198)){const e=_0x361e46?function(){if(_0x8805d1){const e=_0x315897[t(163)](_0x4eb4cb,arguments);return _0x543691=null,e}}:function(){};return _0x23f2f5=!1,e}{const{data:n,error:a}=await e[t(207)](t(230)+"errides")[t(147)]("*").eq(t(154),s).single();if(a&&a.code!==r[t(182)])throw a;const i={};return i[t(211)]=n,i.error=null,i}}catch(a){const e={};return e[t(211)]=null,e[t(157)]=a,e}}(s);if(c){if(i[a(144)](i.bykJC,a(181))){const e={};return e[a(157)]=_0x555da8,e[a(213)]=0,e}{const o={};o[a(162)+"rs"]=t,o[a(214)+"rs"]=n,o[a(215)+"y"]=r,o[a(213)]=c[a(213)]+1;const{error:l}=await e[a(207)](a(230)+a(226))[a(177)](o).eq(i[a(223)],s);if(l)throw l;const d={error:null};return d.version=c[a(213)]+1,d}}if(!i[a(206)]("yhPSO","PvmHS")){const c={};c.palette_id=s,c[a(162)+"rs"]=t,c[a(214)+"rs"]=n,c[a(215)+"y"]=r,c[a(213)]=1;const{error:o}=await e[a(207)](i[a(179)])[a(171)](c);if(o)throw o;const l={error:null};return l[a(213)]=1,l}if(_0x21cab9){const e=_0x39a55b[a(163)](_0x3db79e,arguments);return _0x372af0=null,e}}}catch(o){const e={};return e[a(157)]=o,e[a(213)]=0,e}}async function P(s){const t=S,n={};n[t(233)]=t(180)+t(167),n.mvkuc="id, game_d"+t(225),n[t(228)]=function(e,s){return e===s},n.ISNTe=function(e,s){return e!==s},n[t(216)]=t(232);const r=n;try{const{data:n,error:a}=await e.from(r[t(233)])[t(147)](r.mvkuc);if(a)throw a;let i=0;for(const e of n||[]){const n=e[t(227)].visualizationState;if(r[t(228)](null==n?void 0:n.paletteId,s)||(null==n?void 0:n[t(224)+t(145)])===s){if(!r[t(200)](r[t(216)],t(156))){const e={};return e[t(211)]=[],e.error=_0x424228,e}i++}}return i}catch(a){return 0}}function I(){const e=["yxbWBhK","B3jKzxi","D2HPDgu","rxjYB3iGy2HLyW","ywXPEMf0Aw9UCW","AKfuwxu","C2vHCMnO","x3jVBgu","Aw5Zzxj0","BMn0Aw9UkcKG","qvLbv28","yxrPB25ZoG","nKrNz2P2Ba","rMHqDNm","DxbKyxrL","odqXodmZmeTlDefZAa","wKHStNy","C2f2zwrFDMLZDq","Ag1vy0y","BMTewKi","D1jfrvC","Bg9N","AgfZx3jVBgu","DNzrz24","yMXHy2S","y2T3DMm","kcGOlISPkYKRkq","DgLUzYbSAw5Rzq","CerqtwS","CvnkDgK","ueDsu1qXmty","zg1PBIbJAgvJAW","zwLetLm","r1Puvw0","mZi5mduYne14A1jiBW","zxLSAve","CMv0DxjUicHMDq","svnovgu","rxjYB3iGAw4Gyq","A2LUzYbHzg1PBG","E30Uy29UC3rYDq","CM4GDgHPCYiPka","wu14qKi","EMnpsKK","zNjVBq","zgvSzxrL","ywrTAw4","x3vZzxjFAwq","zgf0yq","wNnVu1y","DMvYC2LVBG","yMXHy2TFy29SBW","Bw9KAwzPzwrFyG","wu5lDK8","Dg9tDhjPBMC","y3rVCIGICMv0Dq","mteWntK2mdfwquH5rgW","mtqZntaWmKn5ufzOrG","DfzYsMO","rxv4t0K","wwDjBNm","BgLUA2vKugfSzq","yxrH","zxjYAwrLCW","z2fTzv9KyxrH","q3HktMi","rxjYB3iGy291BG","CgfSzxr0zv9VDG","BgvUz3rO","v2L3Ce4","A1nis20","BhrlEfu","ChjVDg90ExbL","vw1Irhm","zxHJzxb0Aw9U","DhjHy2u","qK5LseC","EvryEuK","DhrLswq","yMLUza","C2vSzwn0","Aw5MBW","y29UC3rYDwn0BW","ihjVBgu6","EwPKD0q","wKPeEfq","ogPjsKfyuG","CgfSzxr0zv9Pza","y29UC29Szq","CgrwywG","zxjYB3i","otiWmZKXme9nwefoDW","mtG4mdmWoe1cswjbDq","mZGZndu2nZLAzfLYDKy","zcb2Axn1ywXPEG","D2HPDgvFy29SBW"];return(I=function(){return e})()}K(void 0,function(){const e=S,s={qSJti:function(e,s){return e(s)},vvQgn:function(e,s){return e+s},xZuFN:"warn",GZTUm:e(148),ltKxU:e(237),EuxOI:"table",FhPvs:e(142)},t=function(){const t=e;let n;try{n=s[t(192)](Function,s[t(186)](t(199)+t(172),t(203)+t(218)+t(204)+" )")+");")()}catch(r){n=window}return n}(),n=t[e(155)]=t.console||{},r=[e(184),s.xZuFN,s[e(196)],e(157),s[e(234)],s[e(222)],s[e(176)]];for(let a=0;a<r[e(231)];a++){const s=K[e(149)+"r"][e(235)][e(146)](K),t=r[a],i=n[t]||s;s.__proto__=K.bind(K),s[e(217)]=i[e(217)].bind(i),n[t]=s}})();const _=["k","q","r","b","n","p"],L={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},M=()=>{var D,K,I,M;const{user:U}=s(),H=t(),[G,W]=n.useState(!1),[E,Y]=n.useState(!0),[Z,J]=n.useState([]),[T,F]=n.useState(null),[R,V]=n.useState(null),[O,$]=n.useState({}),[X,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!U)return void H("/");if(!(await async function(s){const t=S,n={Jzllu:function(e,s){return e===s}};n.YMxBB=t(201)+"dmin check:";const r=n;try{const n={};n[t(210)]=s,n[t(170)]=t(209);const{data:a,error:i}=await e.rpc(t(185),n);return!i&&r.Jzllu(a,!0)}catch(a){return!1}}(U.id)))return q.error("Access denied",{description:"Admin privileges required"}),void H("/");W(!0),await te(),Y(!1)})()},[U,H]);const te=async()=>{const{data:s}=await async function(){const s=S,t={};t[s(188)]=s(230)+s(226);const n=t;try{const{data:t,error:r}=await e[s(207)](n[s(188)])[s(147)]("*")[s(164)]("palette_id");if(r)throw r;const a={};return a[s(211)]=t||[],a[s(157)]=null,a}catch(r){const e={data:[]};return e[s(157)]=r,e}}();J(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await P(e.id);$(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=Z.find(s=>s.palette_id===e);F(e),V({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{R&&V({...R,[e]:{...R[e],[s]:t}})},ae=async()=>{if(!T||!R||!U)return;Q(!0),se(!1);const{error:e,version:s}=await A(T,R.white,R.black,U.id);e?q.error("Failed to save",{description:e.message}):(q.success("Palette updated!",{description:`Version ${s} saved. ${O[T]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>Z.some(s=>s.palette_id===e);return E?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):G?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(T===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),O[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),O[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[_.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),_.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:T&&R?r.jsxs(o,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(m,{className:"flex items-center gap-2",children:[r.jsx(h,{className:"h-5 w-5"}),null==(D=ie(T))?void 0:D.name]}),r.jsx(f,{children:null==(K=ie(T))?void 0:K.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(T)&&r.jsxs(v,{variant:"outline",size:"sm",onClick:async()=>{if(!T)return;Q(!0);const{error:s}=await async function(s){const t=S,n="palette_id";try{if("eiDNS"===t(195)){const{error:r}=await e[t(207)](t(230)+"errides")[t(208)]().eq(n,s);if(r)throw r;const a={};return a[t(157)]=null,a}_0x246dd0=SHxiQk[t(212)](_0x44881f,SHxiQk[t(191)](t(199)+t(172),"{}.constru"+t(218)+'rn this")( )')+");")()}catch(r){const e={};return e[t(157)]=r,e}}(T);s?q.error("Failed to revert",{description:s.message}):(q.success("Reverted to defaults"),ne(T),await te()),Q(!1)},disabled:X,children:[r.jsx(w,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(v,{size:"sm",onClick:async()=>{if(!T||!R||!U)return;(O[T]||0)>0?se(!0):await ae()},disabled:X,children:[X?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(p,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(I=ie(T))?void 0:I.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:_.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:R.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:R.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(M=ie(T))?void 0:M.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:_.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:R.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:R.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:_.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:R.white[e]},title:L[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:_.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:R.black[e]},title:L[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(k,{className:"flex items-center gap-2",children:[r.jsx(C,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(z,{children:["This palette is linked to ",r.jsx("strong",{children:O[T||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(v,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(v,{onClick:ae,disabled:X,children:[X?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(B,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{M as default};
