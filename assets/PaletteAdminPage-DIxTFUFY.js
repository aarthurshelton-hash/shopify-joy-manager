import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as h,P as m,w as f,B as p,bM as w,cj as j,a9 as g,am as v,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as P,cu as k,b as L}from"./index-UWVR9Dcc.js";!function(){const e=_,s=q();for(;;)try{if(781231===-parseInt(e(424))/1*(parseInt(e(438))/2)+-parseInt(e(427))/3*(parseInt(e(384))/4)+-parseInt(e(443))/5+parseInt(e(380))/6+-parseInt(e(423))/7+parseInt(e(450))/8*(-parseInt(e(421))/9)+parseInt(e(376))/10*(parseInt(e(414))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const B=function(){const e=_,s={nENYB:function(e,s){return e===s}};s[e(378)]="MOvPn",s.XGRxC=function(e,s){return e!==s},s[e(459)]="CWnCY";const t=s;let n=!0;return function(s,r){const a=e;if(t.XGRxC(t[a(459)],a(455))){const e=_0x2004d4?function(){if(_0x2ddf73){const e=_0x24de63[a(418)](_0x48d2fc,arguments);return _0x1aa717=null,e}}:function(){};return _0x82c7d8=!1,e}{const e=n?function(){const e=a;if(r){if(!t[e(454)](e(385),t[e(378)])){const t=r[e(418)](s,arguments);return r=null,t}{const s=_0x527096[e(386)+"r"][e(406)][e(430)](_0x282848),t=_0x49c444[_0x1448d7],n=_0x3011b4[t]||s;s[e(467)]=_0xf9d444[e(430)](_0x21a754),s[e(479)]=n.toString[e(430)](n),_0x2af0ac[t]=s}}}:function(){};return n=!1,e}}}()(void 0,function(){const e=_,s={};s[e(377)]=e(473)+"+$";const t=s;return B.toString().search(t.rpqaG)[e(479)]()[e(386)+"r"](B).search("(((.+)+)+)+$")});B();const D=function(){let e=!0;return function(s,t){const n=_;if(n(446)!=n(446)){const e={};return e[n(437)]=null,e[n(381)]=_0x4e614a,e}{const r=e?function(){if(t){const e=t[n(418)](s,arguments);return t=null,e}}:function(){};return e=!1,r}}}();async function A(s){const t=_,n={};n[t(375)]=t(484);const r=n;try{const{data:n,error:a}=await e[t(417)](t(407)+t(434))[t(461)]("*").eq(r[t(375)],s).single();if(a&&"PGRST116"!==a[t(471)])throw a;const i={};return i[t(437)]=n,i[t(381)]=null,i}catch(a){const e={};return e[t(437)]=null,e.error=a,e}}function q(){const e=["AgfZx3jVBgu","yMXHy2TFy29SBW","ALHfAMm","DMvYC2LVBG","ihjVBgu6","sKvLz0S","nde1ndCWnfHcCuXPBG","twjezu8","v1bZqNK","D2fYBG","BKvowui","q1DUq1K","sKvxvwe","rxjYB3iGy291BG","BNPTEg4","D0XYywW","u0fpsvi","C2vSzwn0","AwqSigDHBwvFza","y29UC29Szq","x3vZzxjFAwq","CNbJ","Aw5MBW","x19WCM90B19F","yxrH","A0Pzuha","zg1PBIbJAgvJAW","y29Kzq","tLbhy08","kcGOlISPkYKRkq","DxbKyxrL","BMjqv1G","AKfhy2C","yxz6De4","ywXPEMf0Aw9UCW","Dg9tDhjPBMC","rKH4Aha","tLj3Bg0","A3fHu2S","CMv0DxjUicHMDq","CgfSzxr0zv9Pza","y3rVCIGICMv0Dq","rxjYB3iGAw4Gyq","B3jKzxi","zgvSzxrL","zxvLCK4","CgfSzxr0zuLK","q2TkzKO","mtbbqwnXsw0","CNbXyuC","Bfr6teu","zcb2Axn1ywXPEG","mJaZmJi1ngHtuxLeqq","zxjYB3i","Bw9KAwzPzwrFyG","z2fTzv9KyxrH","otjQwhLjq1y","DhzfrMK","y29UC3rYDwn0BW","D2HPDgvFy29SBW","vLfVDgW","D2HPDgu","vvvIwgm","CM4GDgHPCYiPka","z2DoBgu","x3jVBgu","Aw5Zzxj0","q2Tetgm","DMLZDwfSAxPHDa","DhrLswq","wxbzEhi","ExHTEee","zuPAr0G","s1b4t0W","yMXHy2S","DgfIBgu","rxjYB3iGy2HLyW","D3DRz1y","ChjVDg90ExbL","CgfSzxr0zv9VDG","DgLUzYbSAw5Rzq","ywrTAw4","wNzSufu","A2LUzYbHzg1PBG","BMn0Aw9UkcKG","A0Tpwxm","nJa4ndm0mZf4CfnyBe0","rxb0CgC","zxHJzxb0Aw9U","zNjVBq","yxbWBhK","wuPuzwW","twXgrKK","mtHYtuLYs28","t0PQthC","mtaYnJqYntrcqML4se0","m1nRyxrfrG","C2f2zwrFDMLZDq","v05gC1u","mtK1mZu3zLbRuhfu","E30Uy29UC3rYDq","Bg9N","yMLUza","q2vfuuW","DhjHy2u","BgLUA2vKugfSzq","zxjYAwrLCW","ENfsr08","yxrPB25ZoG","zgf0yq","ndG1nJqYAMngywXX","rLL5z20","vNPYzLK","Aw9Uu3rHDgu","t0z3DxC","mtC4nZuWnxbbyxHczq"];return(q=function(){return e})()}function _(e,s){e-=371;const t=q();let n=t[e];if(void 0===_.hOuakP){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};_.PrCkGW=r,_.FdxZav={},_.hOuakP=!0}const a=e+t[0],i=_.FdxZav[a];if(i)n=i;else{const e=function(e){this.cVHKcb=e,this.RLPxQc=[1,0,0],this.ibnRNe=function(){return"newState"},this.WKatfa="\\w+ *\\(\\) *{\\w+ *",this.FrVuYI="['|\"].+['|\"];? *}"};e.prototype.FsYvTG=function(){const e=new RegExp(this.WKatfa+this.FrVuYI).test(this.ibnRNe.toString())?--this.RLPxQc[1]:--this.RLPxQc[0];return this.vvHLun(e)},e.prototype.vvHLun=function(e){return Boolean(~e)?this.LmJUVw(this.cVHKcb):e},e.prototype.LmJUVw=function(e){for(let s=0,t=this.RLPxQc.length;s<t;s++)this.RLPxQc.push(Math.round(Math.random())),t=this.RLPxQc.length;return e(this.RLPxQc[0])},new e(_).FsYvTG(),n=_.PrCkGW(n),_.FdxZav[a]=n}return n}async function S(s){const t=_,n={ldZBO:function(e,s){return e(s)},DINuH:function(e,s){return e+s},kJYPp:t(428)+t(485)+t(391)+" )",GMWnV:t(425)+t(478),VzrfY:t(462)+t(468),FYygm:function(e,s){return e===s},JEWUa:t(419),tiCsV:function(e,s){return e!==s},FlLUm:t(457)+t(408)+t(379)+t(436)};try{const{data:r,error:a}=await e.from(n.GMWnV)[t(461)](n[t(440)]);if(a)throw a;let i=0;for(const e of r||[]){const r=e[t(383)][t(396)+t(441)];if(n[t(439)](null==r?void 0:r[t(374)],s)||(null==r?void 0:r[t(433)+t(397)])===s){if("ProKd"===n[t(456)]){const e={};return e[t(437)]=[],e[t(381)]=_0x296490,e}i++}}return i}catch(r){if(n.tiCsV(t(480),t(398)))return 0;{const e=AMjhYa.ldZBO(_0x33376e,AMjhYa.DINuH(t(483)+t(412)+AMjhYa[t(469)],");"));_0x3041a1=e()}}}D(void 0,function(){const e=_,s={NRwlm:function(e,s){return e(s)},NPGcO:e(483)+e(412),WPsBy:"{}.constru"+e(485)+e(391)+" )",OJjLw:function(e,s){return e!==s},euerN:e(453),wwkgV:"info",kqaSk:e(416),SAOIR:function(e,s){return e<s}};let t;try{t=s[e(481)](Function,s[e(472)]+s[e(452)]+");")()}catch(a){if(!s[e(422)](e(475),"dLpKj")){const s=_0x20a9a5[e(418)](_0x5f3863,arguments);return _0x21faec=null,s}t=window}const n=t[e(463)]=t.console||{},r=[e(429),s[e(373)],s[e(405)],e(381),s[e(482)],"table","trace"];for(let i=0;s[e(460)](i,r.length);i++){const s=D[e(386)+"r"].prototype[e(430)](D),t=r[i],a=n[t]||s;s[e(467)]=D[e(430)](D),s[e(479)]=a.toString[e(430)](a),n[t]=s}})();const G=["k","q","r","b","n","p"],K={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},Y=()=>{var B,D,q,Y;const{user:M}=s(),H=t(),[R,W]=n.useState(!1),[U,V]=n.useState(!0),[I,F]=n.useState([]),[E,O]=n.useState(null),[Z,J]=n.useState(null),[Q,T]=n.useState({}),[X,$]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!M)return void H("/");if(!(await async function(s){const t=_,n={ggNle:"return (function() ",DlLyR:function(e){return e()},dlRQB:t(429),OFwuw:t(403),ZvlPU:t(432),UUbXc:function(e,s){return e!==s},VQotl:"DPDos",KPxOL:t(444),CkDLc:function(e,s){return e!==s},yxmxA:t(476)};try{if(n[t(390)](n[t(388)],n.VQotl)){const e={};return e[t(381)]=_0x12fa01,e.version=0,e}{const r={};r[t(464)]=s,r[t(393)]=t(409);const{data:a,error:i}=await e[t(465)](n[t(401)],r);return!i&&!0===a}}catch(r){if(!n[t(395)](n[t(399)],t(476)))return!1;{let e;try{const s=_0x26d92d(NpwjlP[t(392)]+'{}.constructor("retu'+t(391)+" ));");e=NpwjlP.DlLyR(s)}catch(a){e=_0x5b086c}const s=e.console=e.console||{},n=[NpwjlP.dlRQB,t(453),t(466),"error","exception",NpwjlP[t(442)],NpwjlP[t(410)]];for(let r=0;r<n.length;r++){const e=_0x1b8915[t(386)+"r"][t(406)].bind(_0x158b17),a=n[r],i=s[a]||e;e[t(467)]=_0x4c3808[t(430)](_0x41b2f8),e[t(479)]=i[t(479)].bind(i),s[a]=e}}}}(M.id)))return L.error("Access denied",{description:"Admin privileges required"}),void H("/");W(!0),await te(),V(!1)})()},[M,H]);const te=async()=>{const{data:s}=await async function(){const s=_,t={};t.zqRGO=s(484);const n=t;try{const{data:t,error:r}=await e[s(417)](s(407)+s(434))[s(461)]("*")[s(371)](n[s(435)]);if(r)throw r;const a={};return a[s(437)]=t||[],a[s(381)]=null,a}catch(r){const e={};return e[s(437)]=[],e[s(381)]=r,e}}();F(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await S(e.id);T(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=I.find(s=>s.palette_id===e);O(e),J({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{Z&&J({...Z,[e]:{...Z[e],[s]:t}})},ae=async()=>{if(!E||!Z||!M)return;$(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,r){const a=_,i={CeEQL:function(e,s){return e(s)},JEegK:a(407)+"errides",MbDeO:function(e,s){return e+s},kKOYs:"palette_id"};try{const{data:c}=await i[a(431)](A,s);if(c){const{error:o}=await e[a(417)](i[a(449)])[a(474)]({white_colors:t,black_colors:n,modified_by:r,version:i[a(451)](c[a(447)],1)}).eq(i[a(413)],s);if(o)throw o;const l={};return l[a(381)]=null,l.version=c.version+1,l}{const i={};i[a(484)]=s,i[a(387)+"rs"]=t,i.black_colors=n,i[a(382)+"y"]=r,i.version=1;const{error:c}=await e.from(a(407)+a(434))[a(394)](i);if(c)throw c;const o={};return o[a(381)]=null,o[a(447)]=1,o}}catch(c){const e={};return e[a(381)]=c,e[a(447)]=0,e}}(E,Z.white,Z.black,M.id);s?L.error("Failed to save",{description:s.message}):(L.success("Palette updated!",{description:`Version ${t} saved. ${Q[E]||0} visualizations will use the new colors.`}),await te()),$(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>I.some(s=>s.palette_id===e);return U?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):R?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(E===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),Q[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),Q[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[G.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),G.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:E&&Z?r.jsxs(o,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(h,{className:"flex items-center gap-2",children:[r.jsx(m,{className:"h-5 w-5"}),null==(B=ie(E))?void 0:B.name]}),r.jsx(f,{children:null==(D=ie(E))?void 0:D.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(E)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!E)return;$(!0);const{error:s}=await async function(s){const t=_,n={};n[t(477)]=t(407)+"errides",n.zxHsG=t(484),n[t(426)]=function(e,s){return e===s},n[t(415)]=t(420);const r=n;try{const{error:n}=await e[t(417)](r[t(477)])[t(372)]().eq(r.zxHsG,s);if(n)throw n;return{error:null}}catch(a){if(r.WNFsU(r.Eptpg,t(458))){const e=_0x27393a[t(418)](_0x41c1f0,arguments);return _0x220b33=null,e}{const e={};return e.error=a,e}}}(E);s?L.error("Failed to revert",{description:s.message}):(L.success("Reverted to defaults"),ne(E),await te()),$(!1)},disabled:X,children:[r.jsx(w,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!E||!Z||!M)return;(Q[E]||0)>0?se(!0):await ae()},disabled:X,children:[X?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(j,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(q=ie(E))?void 0:q.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:G.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:K[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(g,{type:"color",value:Z.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(g,{type:"text",value:Z.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(Y=ie(E))?void 0:Y.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:G.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:K[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(g,{type:"color",value:Z.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(g,{type:"text",value:Z.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(v,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:G.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:Z.white[e]},title:K[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:G.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:Z.black[e]},title:K[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(m,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(P,{children:["This palette is linked to ",r.jsx("strong",{children:Q[E||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:X,children:[X?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(k,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{Y as default};
