import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as m,t as h,P as x,w as f,B as p,bM as g,cj as w,a9 as j,am as v,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as k,cu as D,b as B}from"./index-D6g_YXgr.js";!function(){const e=q,s=M();for(;;)try{if(295143===parseInt(e(531))/1*(parseInt(e(465))/2)+parseInt(e(540))/3*(-parseInt(e(539))/4)+parseInt(e(492))/5*(parseInt(e(516))/6)+parseInt(e(538))/7+parseInt(e(497))/8+parseInt(e(526))/9*(parseInt(e(482))/10)+-parseInt(e(510))/11)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const S=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[q(483)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=q,s={};s.nHzAh=e(476)+"+$";const t=s;return S[e(548)]().search(e(476)+"+$")[e(548)]()[e(507)+"r"](S)[e(478)](t[e(458)])});function q(e,s){e-=457;const t=M();let n=t[e];if(void 0===q.BrxdEJ){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};q.LNgoBw=r,q.FGtwhb={},q.BrxdEJ=!0}const a=e+t[0],i=q.FGtwhb[a];if(i)n=i;else{const e=function(e){this.Xwbhwh=e,this.meeoSt=[1,0,0],this.oyAgrT=function(){return"newState"},this.okZdto="\\w+ *\\(\\) *{\\w+ *",this.ZswdBr="['|\"].+['|\"];? *}"};e.prototype.dgDEjD=function(){const e=new RegExp(this.okZdto+this.ZswdBr).test(this.oyAgrT.toString())?--this.meeoSt[1]:--this.meeoSt[0];return this.uYlJoq(e)},e.prototype.uYlJoq=function(e){return Boolean(~e)?this.MjLZrj(this.Xwbhwh):e},e.prototype.MjLZrj=function(e){for(let s=0,t=this.meeoSt.length;s<t;s++)this.meeoSt.push(Math.round(Math.random())),t=this.meeoSt.length;return e(this.meeoSt[0])},new e(q).dgDEjD(),n=q.LNgoBw(n),q.FGtwhb[a]=n}return n}S();const L=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[q(483)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();async function A(s,t,n,r){const a=q,i={};i[a(479)]=a(476)+"+$",i[a(467)]=function(e,s){return e!==s},i[a(461)]=a(477),i[a(541)]=a(532)+a(473),i[a(546)]=function(e,s){return e+s},i[a(503)]=function(e,s){return e===s},i[a(527)]=a(514);const c=i;try{const{data:i}=await async function(s){const t=q,n={};n.vHLhu=t(532)+t(473),n[t(500)]=t(488);const r=n;try{const{data:n,error:a}=await e[t(530)](r[t(481)])[t(506)]("*").eq(t(508),s)[t(543)]();if(a&&a[t(464)]!==r[t(500)])throw a;const i={};return i[t(463)]=n,i[t(524)]=null,i}catch(a){const e={};return e[t(463)]=null,e.error=a,e}}(s);if(i){if(c[a(467)](c[a(461)],c[a(461)]))return _0x153239.toString()[a(478)](afpqZC.NyxBT)[a(548)]().constructor(_0x31b521)[a(478)](afpqZC.NyxBT);{const{error:o}=await e[a(530)](c[a(541)])[a(519)]({white_colors:t,black_colors:n,modified_by:r,version:c[a(546)](i[a(535)],1)}).eq("palette_id",s);if(o)throw o;const l={};return l[a(524)]=null,l[a(535)]=i.version+1,l}}{const i={};i[a(508)]=s,i[a(505)+"rs"]=t,i[a(495)+"rs"]=n,i[a(533)+"y"]=r,i[a(535)]=1;const{error:c}=await e[a(530)](a(532)+a(473)).insert(i);if(c)throw c;const o={};return o[a(524)]=null,o[a(535)]=1,o}}catch(o){if(c.KlPmZ(a(489),c[a(527)])){const e=_0x46694d?function(){if(_0x5c1a76){const e=_0x5851dc[a(483)](_0x3e57d8,arguments);return _0x1df13b=null,e}}:function(){};return _0x523723=!1,e}{const e={};return e[a(524)]=o,e[a(535)]=0,e}}}function M(){const e=["CMv0DxjUicHMDq","BKH6qwG","DgfIBgu","D2fYBG","z1rtDNe","rxjYB3iGAw4Gyq","zgf0yq","y29Kzq","mZq3otHSuxzxvfG","z2fTzv9KyxrH","CgXQsuW","yxrH","tMndug8","rxjYB3iGy291BG","y29UC29Szq","ywXPEMf0Aw9UCW","zxjYAwrLCW","CNbJ","zMLUza","kcGOlISPkYKRkq","qMvAww8","C2vHCMnO","tNL4qLq","Cg9Tt2u","DKHmAhu","ndu2ndbxsgX2shK","yxbWBhK","v0zlDxi","AeLfruC","x19WCM90B19F","DhjHy2u","ueDsu1qXmty","yLvREve","D2HPDgu","CgfSzxr0zuLK","oty4nuTQB1butW","ELzfvui","C2f2zwrFDMLZDq","yMXHy2TFy29SBW","y3rVCIGICMv0Dq","mJa5oti2nfnLAuP6DW","A2LUzYbHzg1PBG","sffmCwy","wufqAue","AwqSigDHBwvFza","uK5JrKO","s2XqBvO","yMXHy2S","D2HPDgvFy29SBW","C2vSzwn0","y29UC3rYDwn0BW","CgfSzxr0zv9Pza","CM4GDgHPCYiPka","mta2ntm2mtbKv21pqLu","zxHJzxb0Aw9U","zg1PBIbJAgvJAW","zgvSzxrL","B1bMyu0","DhrLswq","mtC1ogDNrgHWuG","ywrTAw4","CgX2EMO","DxbKyxrL","AgjQvg4","BgvUz3rO","rKXdv0m","DgLUzYbSAw5Rzq","zxjYB3i","DMLZDwfSAxPHDa","mJyXALnLrgLd","zuLYy1u","ihjVBgu6","EgjwzMS","zNjVBq","mtjgvM1SA1K","CgfSzxr0zv9VDG","Bw9KAwzPzwrFyG","E30Uy29UC3rYDq","DMvYC2LVBG","B3jKzxi","yMLUza","mta0mtiWofD3z3zQyq","mtzOzhrlCuW","ndiXmZH1rKrHCge","y3blsNG","ug1eqxG","C2LUz2XL","Aw5MBW","Aw9Uu3rHDgu","uLrrDMO","ELzrvKS","Dg9tDhjPBMC","Bg9N","zcb2Axn1ywXPEG"];return(M=function(){return e})()}async function P(s){const t=q,n={};n.zVQVK=t(501)+t(468),n.slroM=function(e,s){return e===s};const r=n;try{const{data:n,error:a}=await e[t(530)](t(494)+t(472)).select(r[t(547)]);if(a)throw a;let i=0;for(const e of n||[]){const n=e[t(466)][t(525)+t(545)];(r.slroM(null==n?void 0:n[t(491)],s)||(null==n?void 0:n["linkedPale"+t(515)])===s)&&i++}return i}catch(a){return 0}}L(void 0,function(){const e=q,s={zVEUB:function(e,s){return e+s},PmDAx:function(e){return e()},YhkWJ:e(549),hbjTn:e(460),plvzj:e(544),HQLqf:e(524),hIEEG:e(511),DXiQx:e(487)},t=s[e(542)](function(){const t=e;let n;try{n=Function(s[t(493)](t(457)+"nction() "+(t(534)+t(496)+t(509))+" )",");"))()}catch(r){n=window}return n}),n=t[e(471)]=t[e(471)]||{},r=[s.YhkWJ,s[e(520)],s[e(518)],s[e(499)],s[e(485)],e(459),s.DXiQx];for(let a=0;a<r[e(521)];a++){const s=L[e(507)+"r"].prototype[e(537)](L),t=r[a],i=n[t]||s;s[e(486)]=L.bind(L),s[e(548)]=i.toString[e(537)](i),n[t]=s}})();const H=["k","q","r","b","n","p"],K={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},G=()=>{var S,L,M,G;const{user:W}=s(),_=t(),[E,I]=n.useState(!1),[U,X]=n.useState(!0),[Y,F]=n.useState([]),[J,T]=n.useState(null),[Z,O]=n.useState(null),[V,$]=n.useState({}),[Q,R]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!W)return void _("/");if(!(await async function(s){const t=q,n={};n[t(522)]="has_role",n[t(502)]=t(517),n.WFKur=t(462)+t(512)+":";const r=n;try{const{data:n,error:a}=await e[t(474)](r.FLCWC,{_user_id:s,_role:r.RNcFJ});return!a&&!0===n}catch(a){return!1}}(W.id)))return B.error("Access denied",{description:"Admin privileges required"}),void _("/");I(!0),await te(),X(!1)})()},[W,_]);const te=async()=>{const{data:s}=await async function(){const s=q,t={};t[s(469)]="palette_id";const n=t;try{const{data:t,error:r}=await e[s(530)]("palette_overrides")[s(506)]("*")[s(536)](n.NcCPo);if(r)throw r;const a={};return a[s(463)]=t||[],a[s(524)]=null,a}catch(r){const e={data:[]};return e[s(524)]=r,e}}();F(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await P(e.id);$(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=Y.find(s=>s.palette_id===e);T(e),O({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{Z&&O({...Z,[e]:{...Z[e],[s]:t}})},ae=async()=>{if(!J||!Z||!W)return;R(!0),se(!1);const{error:e,version:s}=await A(J,Z.white,Z.black,W.id);e?B.error("Failed to save",{description:e.message}):(B.success("Palette updated!",{description:`Version ${s} saved. ${V[J]||0} visualizations will use the new colors.`}),await te()),R(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>Y.some(s=>s.palette_id===e);return U?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):E?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(J===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),V[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),V[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[H.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),H.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:J&&Z?r.jsxs(o,{children:[r.jsx(m,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(h,{className:"flex items-center gap-2",children:[r.jsx(x,{className:"h-5 w-5"}),null==(S=ie(J))?void 0:S.name]}),r.jsx(f,{children:null==(L=ie(J))?void 0:L.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(J)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!J)return;R(!0);const{error:s}=await async function(s){const t=q,n={};n.xbVfk=t(532)+t(473),n[t(480)]=t(508);const r=n;try{const{error:n}=await e[t(530)](r[t(529)])[t(513)]().eq(r.pomOe,s);if(n)throw n;const a={};return a[t(524)]=null,a}catch(a){const e={};return e[t(524)]=a,e}}(J);s?B.error("Failed to revert",{description:s.message}):(B.success("Reverted to defaults"),ne(J),await te()),R(!1)},disabled:Q,children:[r.jsx(g,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!J||!Z||!W)return;(V[J]||0)>0?se(!0):await ae()},disabled:Q,children:[Q?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(w,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(M=ie(J))?void 0:M.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:H.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:K[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:Z.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:Z.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(G=ie(J))?void 0:G.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:H.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:K[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:Z.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:Z.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(v,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:H.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:Z.white[e]},title:K[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:H.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:Z.black[e]},title:K[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(x,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(k,{children:["This palette is linked to ",r.jsx("strong",{children:V[J||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:Q,children:[Q?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(D,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{G as default};
