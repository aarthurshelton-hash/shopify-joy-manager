import{ap as e,df as t,dg as s,s as r,r as a,de as n,dh as i,j as c,a5 as l,a6 as o,b$ as d,x as m,bE as h,W as x,I as u,p,af as f,ag as g,Z as b,aw as y,d8 as N,K as j,ah as v,di as w,a7 as k,am as _,bH as D,aF as C}from"./index-BRnl98aa.js";import{C as A}from"./calendar-DrZ4Zeja.js";const S=e("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);function T(e,r){const a=function(e){const t={},s=e.split(E.dateTimeDelimiter);let r;if(s.length>2)return t;/:/.test(s[0])?r=s[0]:(t.date=s[0],r=s[1],E.timeZoneDelimiter.test(t.date)&&(t.date=e.split(E.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length)));if(r){const e=E.timezone.exec(r);e?(t.time=r.replace(e[1],""),t.timezone=e[1]):t.time=r}return t}(e);let n;if(a.date){const e=function(e,t){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(s);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,n=r[2]?parseInt(r[2]):null;return{year:null===n?a:100*n,restDateString:e.slice((r[1]||r[2]).length)}}(a.date,2);n=function(e,t){if(null===t)return new Date(NaN);const s=e.match(M);if(!s)return new Date(NaN);const r=!!s[4],a=H(s[1]),n=H(s[2])-1,i=H(s[3]),c=H(s[4]),l=H(s[5])-1;if(r)return function(e,t,s){return t>=1&&t<=53&&s>=0&&s<=6}(0,c,l)?function(e,t,s){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,n=7*(t-1)+s+1-a;return r.setUTCDate(r.getUTCDate()+n),r}(t,c,l):new Date(NaN);{const e=new Date(0);return function(e,t,s){return t>=0&&t<=11&&s>=1&&s<=(U[t]||(I(e)?29:28))}(t,n,i)&&function(e,t){return t>=1&&t<=(I(e)?366:365)}(t,a)?(e.setUTCFullYear(t,n,Math.max(a,i)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!n||isNaN(n.getTime()))return new Date(NaN);const i=n.getTime();let c,l=0;if(a.time&&(l=function(e){const r=e.match(R);if(!r)return NaN;const a=F(r[1]),n=F(r[2]),i=F(r[3]);if(!function(e,t,s){if(24===e)return 0===t&&0===s;return s>=0&&s<60&&t>=0&&t<60&&e>=0&&e<25}(a,n,i))return NaN;return a*t+n*s+1e3*i}(a.time),isNaN(l)))return new Date(NaN);if(!a.timezone){const e=new Date(i+l),t=new Date(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return c=function(e){if("Z"===e)return 0;const r=e.match(W);if(!r)return 0;const a="+"===r[1]?-1:1,n=parseInt(r[2]),i=r[3]&&parseInt(r[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,i))return NaN;return a*(n*t+i*s)}(a.timezone),isNaN(c)?new Date(NaN):new Date(i+l+c)}const E={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},M=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,R=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,W=/^([+-])(\d{2})(?::?(\d{2}))?$/;function H(e){return e?parseInt(e):1}function F(e){return e&&parseFloat(e.replace(",","."))||0}const U=[31,null,31,30,31,30,31,31,30,31,30,31];function I(e){return e%400==0||e%4==0&&e%100!=0}function $(e,t){if(!e&&t){const e=t.match(/\((\d{3,4})\)/g);if(e&&e.length>=1){const t=e.map(e=>parseInt(e.replace(/[()]/g,""))),s=t.reduce((e,t)=>e+t,0)/t.length;if(s>=2800)return{label:"Bullet/Blitz",color:"text-orange-400",icon:"‚ö°"};if(s>=2500)return{label:"Rated",color:"text-blue-400",icon:"üéØ"}}return{label:"Rated",color:"text-muted-foreground",icon:"‚ôüÔ∏è"}}if(!e)return{label:"Unknown",color:"text-muted-foreground",icon:"üéØ"};const s=e.toLowerCase().trim();switch(s){case"bullet":case"ultrabullet":case"hyperbullet":return{label:"Bullet",color:"text-red-400",icon:"‚ö°"};case"blitz":return{label:"Blitz",color:"text-orange-400",icon:"üî•"};case"rapid":return{label:"Rapid",color:"text-blue-400",icon:"‚è±Ô∏è"};case"classical":case"correspondence":case"standard":return{label:"Classical",color:"text-green-400",icon:"‚ôüÔ∏è"};default:if(/^\d+\+?\d*$/.test(s)){const e=parseInt(s.split("+")[0]);return e<=2?{label:"Bullet",color:"text-red-400",icon:"‚ö°"}:e<=5?{label:"Blitz",color:"text-orange-400",icon:"üî•"}:e<=15?{label:"Rapid",color:"text-blue-400",icon:"‚è±Ô∏è"}:{label:"Classical",color:"text-green-400",icon:"‚ôüÔ∏è"}}return{label:e,color:"text-muted-foreground",icon:"üéØ"}}}async function z(e=20){const{data:t,error:s}=await r.from("chess_prediction_attempts").select("*").eq("hybrid_correct",!0).eq("stockfish_correct",!1).neq("stockfish_prediction","unknown").order("created_at",{ascending:!1}).limit(e);return s?[]:(t||[]).map(e=>{const t=function(e){if(!e)return null;const t=e.match(/\[Date\s+"(\d{4}\.\d{2}\.\d{2})"\]/);return t?t[1].replace(/\./g,"-"):null}(e.pgn);return{id:e.id,fen:e.fen,gameName:e.game_name,moveNumber:e.move_number,stockfishEval:e.stockfish_eval||0,stockfishPrediction:e.stockfish_prediction,hybridPrediction:e.hybrid_prediction,actualResult:e.actual_result,hybridCorrect:e.hybrid_correct,stockfishCorrect:e.stockfish_correct,hybridArchetype:e.hybrid_archetype,hybridConfidence:e.hybrid_confidence,createdAt:e.created_at,significance:Math.abs(e.stockfish_eval||0)>200?"breakthrough":"notable",evalMagnitude:Math.abs(e.stockfish_eval||0),timeControl:e.time_control,whiteElo:e.white_elo,blackElo:e.black_elo,pgn:e.pgn,gameDate:t}})}async function q(){const[{count:e},{count:t}]=await Promise.all([r.from("chess_prediction_attempts").select("*",{count:"exact",head:!0}).eq("hybrid_correct",!0).eq("stockfish_correct",!1),r.from("chess_prediction_attempts").select("*",{count:"exact",head:!0}).eq("stockfish_correct",!0).eq("hybrid_correct",!1)]),{data:s}=await r.from("chess_prediction_attempts").select("hybrid_archetype, hybrid_correct, stockfish_correct").neq("hybrid_prediction","stockfish_prediction").limit(1e3),{data:a}=await r.from("chess_prediction_attempts").select("stockfish_eval").eq("hybrid_correct",!0).eq("stockfish_correct",!1).not("stockfish_eval","is",null).limit(1e3),n=(a||[]).map(e=>Math.abs(e.stockfish_eval||0)).filter(e=>e>0),i=n.length>0?n.reduce((e,t)=>e+t,0)/n.length:0,c={};(s||[]).forEach(e=>{const t=e.hybrid_archetype||"unknown";c[t]||(c[t]={total:0,wins:0}),c[t].total++,e.hybrid_correct&&c[t].wins++});return{totalDisagreements:(e||0)+(t||0),hybridWinsDisagreements:e||0,stockfishWinsDisagreements:t||0,breakthroughCases:e||0,averageStockfishConfidenceWhenWrong:i,topArchetypesInDisagreements:Object.entries(c).map(([e,t])=>({archetype:e,count:t.total,winRate:t.total>0?t.wins/t.total*100:0})).sort((e,t)=>t.count-e.count).slice(0,5)}}function B(e){if(Math.abs(e)>1e4)return e>0?"M+":"M-";const t=e/100;return t>=0?`+${t.toFixed(1)}`:t.toFixed(1)}function P(e){return e.hybridCorrect&&!e.stockfishCorrect?e.evalMagnitude>200?`BREAKTHROUGH: Stockfish saw ${B(e.stockfishEval)} but the ${e.hybridArchetype||"pattern"} trajectory correctly predicted ${e.actualResult}`:`Hybrid's ${e.hybridArchetype||"pattern"} analysis correctly overrode Stockfish's ${B(e.stockfishEval)} evaluation`:e.stockfishCorrect&&!e.hybridCorrect?"Stockfish's tactical precision was correct here; hybrid pattern was misleading":"Both systems made the same prediction"}function G(){const[e,t]=a.useState(null),[s,r]=a.useState([]),[E,M]=a.useState(null),[R,W]=a.useState(!0),{chessStats:H,updateCount:F}=n(),U=a.useCallback(async()=>{const[e,s,a]=await Promise.all([q(),z(10),i()]);t(e),r(s),M(a),W(!1)},[]);if(a.useEffect(()=>{U()},[U]),a.useEffect(()=>{F>0&&U()},[F,U]),R)return c.jsx(l,{className:"bg-card/50 backdrop-blur border-primary/20",children:c.jsxs(o,{className:"p-8 text-center",children:[c.jsx(d,{className:"w-8 h-8 mx-auto animate-pulse text-primary"}),c.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading proof data..."})]})});const I=E?E.overallHybridAccuracy-E.overallStockfishAccuracy:0,G=e&&e.totalDisagreements>0?e.hybridWinsDisagreements/e.totalDisagreements*100:0;return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:c.jsx(l,{className:"bg-gradient-to-br from-primary/10 to-primary/5 border-primary/30",children:c.jsx(o,{className:"p-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:c.jsx(h,{className:"w-5 h-5 text-primary"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-muted-foreground",children:"Games Analyzed"}),c.jsx("p",{className:"text-2xl font-bold",children:(null==E?void 0:E.totalGamesAnalyzed)||0})]})]})})})}),c.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:c.jsx(l,{className:"border "+(I>0?"border-green-500/30 bg-green-500/5":"border-destructive/30 bg-destructive/5"),children:c.jsx(o,{className:"p-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 rounded-lg "+(I>0?"bg-green-500/20":"bg-destructive/20"),children:c.jsx(x,{className:"w-5 h-5 "+(I>0?"text-green-500":"text-destructive")})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-muted-foreground",children:"Hybrid Advantage"}),c.jsxs("p",{className:"text-2xl font-bold",children:[I>=0?"+":"",I.toFixed(1),"%"]})]})]})})})}),c.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:c.jsx(l,{className:"bg-gradient-to-br from-yellow-500/10 to-orange-500/5 border-yellow-500/30",children:c.jsx(o,{className:"p-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:c.jsx(u,{className:"w-5 h-5 text-yellow-500"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-muted-foreground",children:"Breakthrough Cases"}),c.jsx("p",{className:"text-2xl font-bold",children:(null==e?void 0:e.breakthroughCases)||0})]})]})})})}),c.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:c.jsx(l,{className:"bg-gradient-to-br from-purple-500/10 to-pink-500/5 border-purple-500/30",children:c.jsx(o,{className:"p-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:c.jsx(p,{className:"w-5 h-5 text-purple-500"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-muted-foreground",children:"Disagreement Win Rate"}),c.jsxs("p",{className:"text-2xl font-bold",children:[G.toFixed(0),"%"]})]})]})})})})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs(l,{className:"bg-card/80 backdrop-blur border-primary/20",children:[c.jsxs(f,{children:[c.jsxs(g,{className:"flex items-center gap-2",children:[c.jsx(b,{className:"w-5 h-5 text-yellow-500"}),"Breakthrough Cases"]}),c.jsx(y,{children:"Where En Pensent was RIGHT and Stockfish was WRONG"})]}),c.jsx(o,{children:c.jsx(N,{className:"h-[400px] pr-4",children:0===s.length?c.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[c.jsx(j,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"No breakthrough cases recorded yet."}),c.jsx("p",{className:"text-sm",children:"Run benchmarks to collect evidence."})]}):c.jsx("div",{className:"space-y-4",children:s.map((e,t)=>{const s=$(e.timeControl,e.gameName),r=e.createdAt?T(e.createdAt):null,a=e.gameDate?T(e.gameDate):null;return c.jsxs(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"p-4 bg-gradient-to-r from-green-500/10 to-transparent rounded-lg border border-green-500/20",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.jsx(v,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500/30",children:"breakthrough"===e.significance?"üåü BREAKTHROUGH":"‚úì Notable"}),c.jsxs(v,{variant:"outline",className:`${s.color} border-current/30 bg-current/10`,children:[s.icon," ",s.label]}),(e.whiteElo||e.blackElo)&&c.jsxs(v,{variant:"outline",className:"text-muted-foreground",children:["~",Math.round(((e.whiteElo||0)+(e.blackElo||0))/2)," ELO"]})]}),c.jsx("p",{className:"text-sm font-medium mt-1",children:e.gameName})]}),c.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:["Move ",e.moveNumber]})]}),c.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-3 flex-wrap",children:[a&&w(a)&&c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(A,{className:"w-3 h-3"}),c.jsxs("span",{children:["Played: ",k(a,"MMM d, yyyy")]})]}),r&&w(r)&&c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(S,{className:"w-3 h-3 text-primary"}),c.jsxs("span",{className:"text-primary",children:["Analyzed: ",k(r,"MMM d, yyyy h:mm a")]})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[c.jsxs("div",{className:"text-center p-2 bg-destructive/10 rounded",children:[c.jsx("p",{className:"text-muted-foreground",children:"Stockfish"}),c.jsx("p",{className:"font-mono font-bold text-destructive",children:B(e.stockfishEval)}),c.jsxs("p",{className:"text-destructive",children:["‚Üí ",e.stockfishPrediction]})]}),c.jsxs("div",{className:"text-center p-2 bg-green-500/10 rounded",children:[c.jsx("p",{className:"text-muted-foreground",children:"Hybrid"}),c.jsx("p",{className:"font-bold text-green-400",children:e.hybridArchetype}),c.jsxs("p",{className:"text-green-400",children:["‚Üí ",e.hybridPrediction]})]}),c.jsxs("div",{className:"text-center p-2 bg-primary/10 rounded",children:[c.jsx("p",{className:"text-muted-foreground",children:"Actual"}),c.jsx("p",{className:"font-bold text-primary",children:e.actualResult}),c.jsx("p",{className:"text-primary",children:"‚úì Hybrid correct"})]})]}),c.jsx("p",{className:"text-xs text-muted-foreground mt-3 italic",children:P(e)})]},e.id)})})})})]}),c.jsxs(l,{className:"bg-card/80 backdrop-blur border-primary/20",children:[c.jsxs(f,{children:[c.jsxs(g,{className:"flex items-center gap-2",children:[c.jsx(_,{className:"w-5 h-5 text-orange-500"}),"Disagreement Analysis"]}),c.jsx(y,{children:"When Hybrid and Stockfish predict different outcomes"})]}),c.jsxs(o,{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[c.jsx("span",{children:"Hybrid wins disagreements"}),c.jsxs("span",{className:"font-bold text-green-400",children:[(null==e?void 0:e.hybridWinsDisagreements)||0," / ",(null==e?void 0:e.totalDisagreements)||0]})]}),c.jsx(D,{value:G,className:"h-3 bg-destructive/20"}),c.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[c.jsxs("span",{children:["Stockfish: ",(null==e?void 0:e.stockfishWinsDisagreements)||0]}),c.jsxs("span",{children:["Hybrid: ",(null==e?void 0:e.hybridWinsDisagreements)||0]})]})]}),c.jsx(C,{}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-medium mb-2",children:"Avg Stockfish Confidence When Wrong"}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"text-3xl font-bold font-mono",children:B((null==e?void 0:e.averageStockfishConfidenceWhenWrong)||0)}),c.jsx("p",{className:"text-xs text-muted-foreground",children:"When hybrid beats Stockfish, Stockfish was typically this confident in the wrong direction"})]})]}),c.jsx(C,{}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-medium mb-3",children:"Top Archetypes in Disagreements"}),c.jsxs("div",{className:"space-y-2",children:[((null==e?void 0:e.topArchetypesInDisagreements)||[]).map((e,t)=>c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("span",{className:"text-xs text-muted-foreground",children:["#",t+1]}),c.jsx(v,{variant:"outline",children:e.archetype})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("span",{className:"text-xs text-muted-foreground",children:[e.count," cases"]}),c.jsxs("span",{className:"text-sm font-bold "+(e.winRate>50?"text-green-400":"text-destructive"),children:[e.winRate.toFixed(0),"%"]})]})]},e.archetype)),(!(null==e?void 0:e.topArchetypesInDisagreements)||0===e.topArchetypesInDisagreements.length)&&c.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Run benchmarks to collect archetype data"})]})]}),c.jsx(C,{}),c.jsxs("div",{className:"p-4 bg-primary/5 rounded-lg border border-primary/20",children:[c.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[c.jsx(h,{className:"w-4 h-4 text-primary"}),"Key Insight"]}),c.jsxs("p",{className:"text-xs text-muted-foreground",children:["When En Pensent and Stockfish disagree, the hybrid system wins"," ",c.jsxs("span",{className:"text-primary font-bold",children:[G.toFixed(0),"%"]})," of the time. This proves that Color Flow pattern recognition adds genuine value beyond pure tactical calculation."]})]})]})]})]}),c.jsx(l,{className:"bg-gradient-to-r from-primary/10 via-purple-500/10 to-pink-500/10 border-primary/30",children:c.jsxs(o,{className:"p-6 text-center",children:[c.jsx("h3",{className:"text-xl font-bold mb-2",children:"The Evidence"}),c.jsxs("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:["Over ",c.jsx("span",{className:"text-primary font-bold",children:(null==E?void 0:E.totalGamesAnalyzed)||0})," real grandmaster games, En Pensent's hybrid prediction system achieves"," ",c.jsxs("span",{className:"text-primary font-bold",children:[((null==E?void 0:E.overallHybridAccuracy)||0).toFixed(1),"%"]})," accuracy vs Stockfish 17 NNUE's"," ",c.jsxs("span",{className:"text-muted-foreground",children:[((null==E?void 0:E.overallStockfishAccuracy)||0).toFixed(1),"%"]}),". In disagreements, pattern recognition wins"," ",c.jsxs("span",{className:"text-green-400 font-bold",children:[G.toFixed(0),"%"]})," of the time."]})]})})]})}export{G as P,S as T,$ as f};
