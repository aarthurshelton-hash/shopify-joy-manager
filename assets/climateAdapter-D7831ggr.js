const e="/**\n * Climate Domain Adapter\n * \n * Temporal pattern recognition for atmospheric and environmental data\n * Weather patterns, climate change, extreme event prediction\n * \n * Applications:\n * - Weather forecasting: Storm prediction, temperature trends\n * - Climate monitoring: Long-term pattern shifts, anomaly detection\n * - Agriculture: Growing season prediction, frost warnings\n * - Disaster preparedness: Hurricane, flood, wildfire prediction\n * - Energy demand: Heating/cooling load forecasting\n * - Air quality: Pollution pattern recognition, health alerts\n * \n * Patent-Pending: En Pensentâ„¢ Climate Temporal Analysis\n */\n\nimport type { DomainSignature } from '../types';\n\n// Climate telemetry point\nexport interface ClimatePoint {\n  timestamp: number;\n  \n  // Temperature\n  temperature: number;         // Celsius normalized (-1 to 1 representing -50C to 50C)\n  tempTrend: number;           // Rate of change per hour\n  heatIndex: number;           // Perceived temperature (normalized)\n  \n  // Pressure and wind\n  barometricPressure: number;  // hPa normalized (980-1050)\n  pressureTrend: number;       // Rising/falling indicator\n  windSpeed: number;           // m/s normalized (0-50)\n  windDirection: number;       // Degrees 0-360\n  gustSpeed: number;           // Peak wind (normalized)\n  \n  // Moisture\n  humidity: number;            // Relative humidity 0-1\n  dewPoint: number;            // Normalized\n  precipitation: number;       // mm/hour (normalized 0-100)\n  cloudCover: number;          // 0-1 (clear to overcast)\n  \n  // Severe weather indicators\n  lightningActivity: number;   // Strikes per hour (normalized)\n  tornadoVorticity: number;    // Rotation strength (normalized)\n  hailProbability: number;     // 0-1\n  uvIndex: number;             // 0-11 normalized\n  \n  // Air quality\n  pm25: number;                // Particulate matter (normalized)\n  ozone: number;               // O3 levels (normalized)\n  aqi: number;                 // Air Quality Index 0-1\n  \n  // Location\n  latitude: number;\n  longitude: number;\n  elevation: number;          // meters normalized\n  region: string;              // Geographic region code\n}\n\n// Weather system cell\nexport interface WeatherCell {\n  x: number;                   // Grid X (0-15)\n  y: number;                   // Grid Y (0-15)\n  pressureCenter: number;      // Low/high pressure intensity\n  windField: {\n    speed: number;\n    direction: number;\n  };\n  precipitationIntensity: number;\n  severity: 'calm' | 'moderate' | 'severe' | 'extreme';\n}\n\n// Climate data input\nexport interface ClimateData {\n  region: string;\n  climateType: 'temperate' | 'tropical' | 'arid' | 'polar' | 'continental' | 'mediterranean';\n  season: 'spring' | 'summer' | 'fall' | 'winter';\n  \n  points: ClimatePoint[];\n  grid: WeatherCell[][];       // 16x16 regional grid\n  \n  timeRange: {\n    start: number;\n    end: number;\n  };\n  \n  metadata?: {\n    stationId?: string;\n    elevation?: number;\n    proximityToWater?: 'coastal' | 'inland' | 'lake';\n    urbanDensity?: 'rural' | 'suburban' | 'urban';\n  };\n}\n\n// Climate archetypes (weather patterns)\nexport type ClimateArchetype =\n  | 'high_pressure_dominance'    // Clear stable weather\n  | 'low_pressure_approach'        // Storm system incoming\n  | 'frontal_passage'            // Sharp transition\n  | 'convective_instability'     // Thunderstorm potential\n  | 'tropical_cyclogenesis'      // Hurricane formation\n  | 'blocking_pattern'           // Stalled weather system\n  | 'jet_stream_perturbation'    // Upper atmosphere disruption\n  | 'diurnal_variation'          // Day-night temperature swing\n  | 'seasonal_transition'        // Spring/fall pattern shift\n  | 'heat_dome'                  // Extreme heat event\n  | 'polar_vortex_disruption'    // Cold air outbreak\n  | 'atmospheric_river'          // Moisture transport corridor\n  | 'drought_intensification'    // Prolonged dry period\n  | 'monsoonal_burst'            // Heavy seasonal rain\n  | 'sand_transport'             // Dust storm pattern\n  | 'thermal_inversion'          // Pollution trapping layer\n  | 'lightning_supercluster'     // Intense electrical activity\n  | 'flash_flood_precursor';     // Rapid rainfall accumulation\n\n// Archetype definitions with alert levels\nexport const CLIMATE_ARCHETYPES: Record<ClimateArchetype, {\n  description: string;\n  color: string;\n  alertLevel: 'clear' | 'watch' | 'advisory' | 'warning' | 'emergency';\n  typicalDuration: number; // hours\n  actionRequired: boolean;\n}> = {\n  high_pressure_dominance: {\n    description: 'Clear stable weather with light winds',\n    color: '#3B82F6', // Blue\n    alertLevel: 'clear',\n    typicalDuration: 72,\n    actionRequired: false\n  },\n  low_pressure_approach: {\n    description: 'Storm system incoming, deteriorating conditions',\n    color: '#F59E0B', // Amber\n    alertLevel: 'watch',\n    typicalDuration: 24,\n    actionRequired: false\n  },\n  frontal_passage: {\n    description: 'Sharp transition between air masses',\n    color: '#6366F1', // Indigo\n    alertLevel: 'advisory',\n    typicalDuration: 6,\n    actionRequired: false\n  },\n  convective_instability: {\n    description: 'Thunderstorm potential with rising CAPE',\n    color: '#8B5CF6', // Purple\n    alertLevel: 'watch',\n    typicalDuration: 12,\n    actionRequired: false\n  },\n  tropical_cyclogenesis: {\n    description: 'Hurricane/tropical storm formation detected',\n    color: '#DC2626', // Red\n    alertLevel: 'emergency',\n    typicalDuration: 168,\n    actionRequired: true\n  },\n  blocking_pattern: {\n    description: 'Stalled weather system causing prolonged conditions',\n    color: '#78716C', // Gray\n    alertLevel: 'advisory',\n    typicalDuration: 336,\n    actionRequired: false\n  },\n  jet_stream_perturbation: {\n    description: 'Upper atmosphere disruption affecting surface weather',\n    color: '#0EA5E9', // Sky blue\n    alertLevel: 'watch',\n    typicalDuration: 48,\n    actionRequired: false\n  },\n  diurnal_variation: {\n    description: 'Normal day-night temperature and wind swing',\n    color: '#22C55E', // Green\n    alertLevel: 'clear',\n    typicalDuration: 24,\n    actionRequired: false\n  },\n  seasonal_transition: {\n    description: 'Spring/fall pattern shift with instability',\n    color: '#84CC16', // Lime\n    alertLevel: 'advisory',\n    typicalDuration: 720,\n    actionRequired: false\n  },\n  heat_dome: {\n    description: 'Extreme heat event with dangerous temperatures',\n    color: '#7C2D12', // Dark red\n    alertLevel: 'emergency',\n    typicalDuration: 72,\n    actionRequired: true\n  },\n  polar_vortex_disruption: {\n    description: 'Cold air outbreak from arctic intrusion',\n    color: '#1E3A8A', // Dark blue\n    alertLevel: 'warning',\n    typicalDuration: 48,\n    actionRequired: true\n  },\n  atmospheric_river: {\n    description: 'Moisture transport corridor bringing heavy rain',\n    color: '#0369A1', // Deep blue\n    alertLevel: 'warning',\n    typicalDuration: 72,\n    actionRequired: true\n  },\n  drought_intensification: {\n    description: 'Prolonged dry period with moisture deficit',\n    color: '#B45309', // Brown\n    alertLevel: 'advisory',\n    typicalDuration: 2160,\n    actionRequired: false\n  },\n  monsoonal_burst: {\n    description: 'Heavy seasonal rainfall pattern',\n    color: '#0C4A6E', // Navy\n    alertLevel: 'warning',\n    typicalDuration: 96,\n    actionRequired: false\n  },\n  sand_transport: {\n    description: 'Dust storm pattern with reduced visibility',\n    color: '#A16207', // Yellow-brown\n    alertLevel: 'advisory',\n    typicalDuration: 12,\n    actionRequired: false\n  },\n  thermal_inversion: {\n    description: 'Pollution trapping layer, poor air quality',\n    color: '#6B7280', // Gray\n    alertLevel: 'advisory',\n    typicalDuration: 48,\n    actionRequired: false\n  },\n  lightning_supercluster: {\n    description: 'Intense electrical activity cluster',\n    color: '#A855F7', // Violet\n    alertLevel: 'warning',\n    typicalDuration: 3,\n    actionRequired: true\n  },\n  flash_flood_precursor: {\n    description: 'Rapid rainfall accumulation, flood risk',\n    color: '#1D4ED8', // Royal blue\n    alertLevel: 'emergency',\n    typicalDuration: 6,\n    actionRequired: true\n  }\n};\n\n/**\n * Build 16x16 weather grid\n */\nfunction buildWeatherGrid(data: ClimateData): WeatherCell[][] {\n  return data.grid || Array(16).fill(null).map((_, x) =>\n    Array(16).fill(null).map((_, y) => ({\n      x, y,\n      pressureCenter: 0.5,\n      windField: { speed: 0.3, direction: 0 },\n      precipitationIntensity: 0,\n      severity: 'calm'\n    }))\n  );\n}\n\n/**\n * Generate climate fingerprint\n */\nfunction generateClimateFingerprint(points: ClimatePoint[]): string {\n  const recent = points.slice(-12); // Last 12 readings (3 hours at 15-min intervals)\n  const avgPressure = recent.reduce((sum, p) => sum + p.barometricPressure, 0) / recent.length;\n  const avgTemp = recent.reduce((sum, p) => sum + p.temperature, 0) / recent.length;\n  const trend = recent[recent.length - 1].pressureTrend - recent[0].pressureTrend;\n  \n  const signature = `${Math.round(avgPressure * 100)}-${Math.round(avgTemp * 100)}-${Math.round(trend * 100)}`;\n  \n  let hash = 0;\n  for (let i = 0; i < signature.length; i++) {\n    const char = signature.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash;\n  }\n  \n  return `clm-${Math.abs(hash).toString(36).substring(0, 8)}`;\n}\n\n/**\n * Calculate climate quadrant profile\n */\nfunction calculateClimateQuadrantProfile(data: ClimateData): {\n  aggressive: number;    // Storm intensity\n  defensive: number;     // Stable/pressure ridge\n  tactical: number;      // Rapid changes\n  strategic: number;     // Long-term trend\n} {\n  const recentPoints = data.points.slice(-20);\n  \n  // Storm intensity (aggressive)\n  const stormIndicators = recentPoints.filter(p => \n    p.windSpeed > 0.6 || \n    p.precipitation > 0.7 || \n    p.lightningActivity > 0.8\n  ).length;\n  const aggressive = stormIndicators / recentPoints.length;\n  \n  // Stable conditions (defensive)\n  const stableConditions = recentPoints.filter(p => \n    Math.abs(p.pressureTrend) < 0.1 && \n    p.windSpeed < 0.3 && \n    p.cloudCover < 0.3\n  ).length;\n  const defensive = stableConditions / recentPoints.length;\n  \n  // Rapid changes (tactical)\n  const rapidChanges = recentPoints.filter(p => \n    Math.abs(p.tempTrend) > 0.5 || \n    Math.abs(p.pressureTrend) > 0.3\n  ).length;\n  const tactical = rapidChanges / recentPoints.length;\n  \n  // Long-term trend (strategic)\n  const earlyPoints = data.points.slice(0, Math.floor(data.points.length * 0.2));\n  const latePoints = data.points.slice(-Math.floor(data.points.length * 0.2));\n  const earlyTemp = earlyPoints.reduce((sum, p) => sum + p.temperature, 0) / earlyPoints.length;\n  const lateTemp = latePoints.reduce((sum, p) => sum + p.temperature, 0) / latePoints.length;\n  const strategic = lateTemp > earlyTemp ? 0.6 : 0.4;\n  \n  return {\n    aggressive: Math.min(1, aggressive),\n    defensive: Math.min(1, defensive),\n    tactical: Math.min(1, tactical),\n    strategic\n  };\n}\n\n/**\n * Calculate temporal flow for climate phases\n */\nfunction calculateClimateTemporalFlow(data: ClimateData): {\n  early: number;   // Pre-event\n  mid: number;     // Active weather\n  late: number;    // Post-event/recovery\n} {\n  const duration = data.timeRange.end - data.timeRange.start;\n  \n  const preEvent = data.points.filter(p => \n    p.precipitation < 0.2 && \n    p.windSpeed < 0.3 && \n    Math.abs(p.pressureTrend) < 0.2\n  ).length;\n  \n  const activeWeather = data.points.filter(p => \n    p.precipitation > 0.3 || \n    p.windSpeed > 0.5 || \n    Math.abs(p.pressureTrend) > 0.3\n  ).length;\n  \n  const postEvent = data.points.filter(p => \n    p.precipitation < 0.2 && \n    (data.points.indexOf(p) > data.points.length * 0.7)\n  ).length;\n  \n  const total = data.points.length || 1;\n  \n  return {\n    early: preEvent / total,\n    mid: activeWeather / total,\n    late: postEvent / total\n  };\n}\n\n/**\n * Find critical climate moments\n */\nfunction findClimateCriticalMoments(data: ClimateData): Array<{\n  timestamp: number;\n  severity: number;\n  type: string;\n  description: string;\n}> {\n  const moments: Array<{\n    timestamp: number;\n    severity: number;\n    type: string;\n    description: string;\n  }> = [];\n  \n  const sortedPoints = [...data.points].sort((a, b) => a.timestamp - b.timestamp);\n  \n  for (let i = 1; i < sortedPoints.length; i++) {\n    const prev = sortedPoints[i - 1];\n    const curr = sortedPoints[i];\n    \n    // Detect rapid pressure drop (storm approach)\n    const pressureDrop = prev.barometricPressure - curr.barometricPressure;\n    if (pressureDrop > 0.15) {\n      moments.push({\n        timestamp: curr.timestamp,\n        severity: Math.min(1, pressureDrop * 3),\n        type: 'pressure_fall',\n        description: 'Rapid barometric pressure drop - storm approaching'\n      });\n    }\n    \n    // Detect temperature spike (heat event)\n    if (curr.temperature > 0.9 && curr.heatIndex > 0.95) {\n      moments.push({\n        timestamp: curr.timestamp,\n        severity: 0.9,\n        type: 'extreme_heat',\n        description: 'Dangerous heat index levels'\n      });\n    }\n    \n    // Detect severe wind\n    if (curr.windSpeed > 0.8 || curr.gustSpeed > 0.9) {\n      moments.push({\n        timestamp: curr.timestamp,\n        severity: Math.max(curr.windSpeed, curr.gustSpeed),\n        type: 'severe_wind',\n        description: 'Damaging wind gusts detected'\n      });\n    }\n    \n    // Detect flash flood conditions\n    if (curr.precipitation > 0.8 && prev.precipitation > 0.6) {\n      moments.push({\n        timestamp: curr.timestamp,\n        severity: 0.85,\n        type: 'flash_flood_risk',\n        description: 'Intense rainfall accumulation'\n      });\n    }\n    \n    // Detect lightning supercluster\n    if (curr.lightningActivity > 0.9) {\n      moments.push({\n        timestamp: curr.timestamp,\n        severity: 0.8,\n        type: 'lightning_burst',\n        description: 'Intense electrical activity'\n      });\n    }\n  }\n  \n  return moments.slice(0, 10);\n}\n\n/**\n * Classify climate archetype\n */\nfunction classifyClimateArchetype(\n  data: ClimateData,\n  quadrant: { aggressive: number; defensive: number; tactical: number; strategic: number },\n  moments: ReturnType<typeof findClimateCriticalMoments>\n): ClimateArchetype {\n  // Check for severe weather first\n  const severeWind = moments.filter(m => m.type === 'severe_wind' && m.severity > 0.8).length;\n  const extremeHeat = moments.filter(m => m.type === 'extreme_heat').length;\n  const flashFlood = moments.filter(m => m.type === 'flash_flood_risk').length;\n  const lightningBurst = moments.filter(m => m.type === 'lightning_burst').length;\n  \n  if (extremeHeat > 2) return 'heat_dome';\n  if (flashFlood > 2) return 'flash_flood_precursor';\n  if (lightningBurst > 3) return 'lightning_supercluster';\n  if (severeWind > 2 && quadrant.aggressive > 0.7) return 'tropical_cyclogenesis';\n  \n  // Check pressure patterns\n  const recentPressure = data.points.slice(-5);\n  const avgPressure = recentPressure.reduce((sum, p) => sum + p.barometricPressure, 0) / 5;\n  const pressureTrend = recentPressure[recentPressure.length - 1].pressureTrend;\n  \n  if (avgPressure < 0.3 && pressureTrend < -0.2) return 'low_pressure_approach';\n  if (avgPressure > 0.7 && Math.abs(pressureTrend) < 0.1) return 'high_pressure_dominance';\n  \n  // Check for blocking\n  const pressureVariance = Math.max(...recentPressure.map(p => p.barometricPressure)) - \n                          Math.min(...recentPressure.map(p => p.barometricPressure));\n  if (pressureVariance < 0.1 && recentPressure.length > 10) return 'blocking_pattern';\n  \n  // Check rapid changes\n  if (quadrant.tactical > 0.6) return 'frontal_passage';\n  \n  // Check instability\n  const instabilityScore = data.points.filter(p => \n    p.temperature > 0.7 && p.humidity > 0.7\n  ).length / data.points.length;\n  if (instabilityScore > 0.5) return 'convective_instability';\n  \n  // Check seasonal patterns\n  const tempRange = Math.max(...data.points.map(p => p.temperature)) - \n                    Math.min(...data.points.map(p => p.temperature));\n  if (tempRange > 0.6 && quadrant.strategic > 0.5) return 'seasonal_transition';\n  \n  // Default to diurnal if calm\n  if (quadrant.defensive > 0.6 && quadrant.tactical < 0.3) {\n    return 'diurnal_variation';\n  }\n  \n  return 'high_pressure_dominance';\n}\n\n/**\n * Extract complete climate signature\n */\nexport function extractClimateSignature(data: ClimateData): DomainSignature & {\n  fingerprint: string;\n  archetype: ClimateArchetype;\n  criticalMoments: Array<{\n    timestamp: number;\n    severity: number;\n    type: string;\n    description: string;\n  }>;\n  weatherGrid: WeatherCell[][];\n  stormSeverity: number;\n}> {\n  const weatherGrid = buildWeatherGrid(data);\n  const quadrantProfile = calculateClimateQuadrantProfile(data);\n  const temporalFlow = calculateClimateTemporalFlow(data);\n  const criticalMoments = findClimateCriticalMoments(data);\n  const archetype = classifyClimateArchetype(data, quadrantProfile, criticalMoments);\n  const fingerprint = generateClimateFingerprint(data.points);\n  \n  // Calculate intensity (overall storminess)\n  const avgStorminess = data.points.reduce((sum, p) => \n    sum + (p.windSpeed + p.precipitation + p.lightningActivity) / 3, 0\n  ) / data.points.length;\n  const intensity = Math.min(1, avgStorminess);\n  \n  // Storm severity\n  const stormSeverity = Math.max(...criticalMoments.map(m => m.severity), 0);\n  \n  return {\n    domain: 'chess', // Using closest available\n    quadrantProfile: {\n      aggressive: quadrantProfile.aggressive,\n      defensive: quadrantProfile.defensive,\n      tactical: quadrantProfile.tactical,\n      strategic: quadrantProfile.strategic\n    },\n    temporalFlow,\n    intensity,\n    momentum: quadrantProfile.tactical > 0.5 ? 0.7 : 0.3,\n    volatility: criticalMoments.length / 5,\n    dominantFrequency: data.points.length / ((data.timeRange.end - data.timeRange.start) / 3600000),\n    harmonicResonance: 1 - Math.abs(quadrantProfile.aggressive - quadrantProfile.defensive),\n    phaseAlignment: quadrantProfile.strategic,\n    extractedAt: Date.now(),\n    fingerprint,\n    archetype,\n    criticalMoments,\n    weatherGrid,\n    stormSeverity\n  };\n}\n\n/**\n * Predict climate outcome\n */\nexport function predictClimateOutcome(\n  signature: ReturnType<typeof extractClimateSignature>\n): {\n  predictedOutcome: 'calm' | 'unsettled' | 'stormy' | 'severe' | 'extreme';\n  confidence: number;\n  timeToEvent: number; // hours\n  recommendations: string[];\n  alertLevel: 'clear' | 'watch' | 'advisory' | 'warning' | 'emergency';\n}> {\n  const archetype = CLIMATE_ARCHETYPES[signature.archetype];\n  \n  let predictedOutcome: 'calm' | 'unsettled' | 'stormy' | 'severe' | 'extreme';\n  let recommendations: string[] = [];\n  \n  switch (signature.archetype) {\n    case 'tropical_cyclogenesis':\n    case 'heat_dome':\n    case 'flash_flood_precursor':\n      predictedOutcome = 'extreme';\n      recommendations = [\n        'EMERGENCY: Issue immediate weather warnings',\n        'Activate emergency operations center',\n        'Prepare for mass evacuation if tropical system',\n        'Set up cooling centers for heat emergencies'\n      ];\n      break;\n      \n    case 'lightning_supercluster':\n    case 'severe_wind':\n    case 'polar_vortex_disruption':\n      predictedOutcome = 'severe';\n      recommendations = [\n        'Issue severe weather warnings',\n        'Secure outdoor objects and infrastructure',\n        'Activate spotter networks',\n        'Prepare emergency shelters'\n      ];\n      break;\n      \n    case 'convective_instability':\n    case 'atmospheric_river':\n    case 'monsoonal_burst':\n      predictedOutcome = 'stormy';\n      recommendations = [\n        'Thunderstorm warnings likely',\n        'Monitor for flash flooding',\n        'Prepare for power outages',\n        'Alert agricultural operations'\n      ];\n      break;\n      \n    case 'frontal_passage':\n    case 'low_pressure_approach':\n      predictedOutcome = 'unsettled';\n      recommendations = [\n        'Changing weather conditions expected',\n        'Advise outdoor event planners',\n        'Monitor for rapid temperature changes',\n        'Prepare for mixed precipitation'\n      ];\n      break;\n      \n    case 'high_pressure_dominance':\n    case 'diurnal_variation':\n    default:\n      predictedOutcome = 'calm';\n      recommendations = [\n        'Stable weather pattern continues',\n        'Favorable conditions for outdoor activities',\n        'Normal operations can proceed',\n        'No significant weather impacts expected'\n      ];\n  }\n  \n  // Confidence based on data\n  const dataQuality = Math.min(1, signature.criticalMoments.length / 3);\n  const patternClarity = 1 - signature.volatility;\n  const confidence = (dataQuality * 0.3 + patternClarity * 0.4 + (1 - signature.stormSeverity) * 0.3);\n  \n  // Time to event\n  const timeToEvent = archetype.alertLevel === 'emergency' ? 6 :\n                      archetype.alertLevel === 'warning' ? 12 :\n                      archetype.alertLevel === 'advisory' ? 24 :\n                      archetype.alertLevel === 'watch' ? 48 : 72;\n  \n  return {\n    predictedOutcome,\n    confidence,\n    timeToEvent,\n    recommendations,\n    alertLevel: archetype.alertLevel\n  };\n}\n\n// Type exports\nexport type { ClimateData, ClimatePoint, WeatherCell, ClimateArchetype };\n";export{e as default};
