import{d6 as e,d7 as t,cp as s,a as n,u as r,r as a,J as i,o,s as l,aH as c,aa as u,cM as m,j as d,L as f,C as x,x as h,D as p,B as v,A as g,p as w,t as y,cN as j,bC as M,S as b,a6 as N,P as z,y as C,bG as D,T as L,aq as B,z as _,cU as G,aj as q,aT as E,ca as Y,b as S,d8 as A}from"./index-D6g_YXgr.js";!function(){const e=T,t=I();for(;;)try{if(326204===-parseInt(e(609))/1*(parseInt(e(573))/2)+-parseInt(e(631))/3*(-parseInt(e(645))/4)+parseInt(e(468))/5*(-parseInt(e(475))/6)+parseInt(e(520))/7+parseInt(e(535))/8*(-parseInt(e(543))/9)+-parseInt(e(464))/10+parseInt(e(639))/11)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const W=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=T;return W[e(556)]()[e(612)](e(527)+"+$").toString().constructor(W)[e(612)](e(527)+"+$")});function I(){const e=["uM9Tyw4NlcbZzq","Aw5XrKm","zM9UDa","C2nHBgu","A3jhweC","owTvANDyDa","ywXWAgfIzxrPyW","BgvUz3rO","i0zerKngqG","y3jLyxrLt2jQzq","AM9PBG","zMLSBfrLEhq","ChvZAa","Bw9Yyw50jYWGrW","BMDnCwm","s0DusLa","BwPksfe","phjLy3qGEd0Ima","Dg9tDhjPBMC","uKjYEMq","zw5Wzw5Zzw50lG","Bvjmvgm","u01suwi","E30Uy29UC3rYDq","yvLLAeq","CMvHzhK","pc9ZDMC+","BgLUzvrV","zgvMyxvSDa","CM4GDgHPCYiPka","qxz0rMG","icdIGkiGia","BwvZlcbZzxjPzG","tMf1D2e","y3jdwKO","mtz3tg5qqNi","vgLTzxmGtMv3ia","sfjjEvK","Aw1Hz2uVC3zNkW","y2fUDMfZ","C3vIC3rYAw5N","y29UC29Szq","zM9UDhm","4PMuievoifbftLnf","i2e4yti5zq","CMLM","v0DcwvG","DfD4zhu","yM9YzgvY","s0D5vei","tLvetvG","ufvHD0q","C3rYB2TLu3r5Ba","Dg9vChbLCKnHCW","B25SB2fK","veviAw4","uhnMwvm","BwLU","lI4U","tuDovwm","AgLNAa","yxbWBhK","wfzqwe0","D0XlyNm","D2LKDgG","iIbMAwXSpsi","zMLSBfjLy3q","tLqG4PMA","zw9Yz2LHlcbZzq","Bgf5zxjtAxPL","zez3wKy","mJmYntjyBfPoB2O","BNmTC2vYAwy","Aw10s3G","C2vHCMnO","AgvPz2H0","Bg9N","Eg1So2nOyxjZzq","CM91BMrszwn0","y29SB3i","BwvHC3vYzvrLEa","vhjewM8","iIbOzwLNAhq9iG","C3rYB2TL","rMfPBgvKihrVia","D2LKDgG9iG","sgfkv2e","t2zsse8","mc45nsK","Bw92zxm","D2HPDgu","wMjZDuy","Dg9eyxrHvvjm","mJDIuvjlrxy","ywXS","yMLUza","y3jLyxrLrwXLBq","BwfYz2LU","Dgv4DefSAwDU","mJaWmc9ZDMCIia","y29T","mtmZmJeYndjXBMT5wfC","iZbbmeeWqq","CfjeCem","DMPluw8","sMPOuM8","DMLZAxrZ","nJyZnZzytKrvCey","yMvNAw5qyxrO","uM9Tyw4NlcbuAq","yu5qtg4","CxjJB2rL","CMv0DxjUicHMDq","wMXetLK","CMvZDg9Yzq","i2u3ztvLna","yw5VBNLTB3vZ","zMLSBfn0EwXL","Dd11DgyToa","zvDZCMu","x19WCM90B19F","ntaWideYChGGjW","B0Ley2W","A0f5y20","Bu5erKe","DhLWzq","wMnirMC","vhjPEMy","C2f2zq","psjODhrWoI8VDW","tfjLuem","zgfYAW","ndC5ntuXmhLoqw1Kua","vLjJC1K","AuTywNq","yxjJ","nJbIuu9swxu","Dhn1rMC","thHHqvi","BwLKzgXL","sw5nyuK","ufLhDuW","y3rPB25mzxzLBa","mJi5ntqYswvMrwrm","nJaWidi0ChGGjW","iZC4nZe2yW","iZi5mJuYna","AxnmAwDODa","DKTZrfy","y29UC3rYDwn0BW","AgLUz0vUywjSzq","CuLhrve","zxjYB3jdB3jYzq","EKfYr00","B25LCNjVCG","vxjPB3m","iI8+","zw50","phn2zYb4BwXUCW","iIb5psiWiIb3Aq","y2XPCa","sKfSqMG","Dgv4DejHC2vSAq","sw9nCNC","iIb3Awr0Ad0I","iIb5psi","ndaWideWChGGjW","zhjHD0LTywDL","DvbWwwW","vw5RBM93BG","CMDIysGYntuSia","mJu1lcaYntuSia","ndaWideXChGGjW","yMXHy2S","BgLUzvDPzhrO","zxzLBNq","AfD0ENK","i2zHzMfMoq","y3jVC3npCMLNAq","Aw1Hz2vtBw9VDa","wNLwEKO","BhbOug4","z2v0q29UDgv4Da","BgLNAhq","C3jJ","DgfIBgu","CMvKDwnL","CMv2B2TLt2jQzq","ndqYmJCXouXrC0rsvG","BgvMDa","Bg9HzcbtvKC","Bvbhu2G","AxrHBgLJiduWma","C3bSAxq","sw50zxiNlcbZyq","kcGOlISPkYKRkq","zxjYB3i","i0zbrKfgqq","CgvUC2vUDc5JBW","y3rvuKW","zxHJzxb0Aw9U","CgLLy2u","iZfbmueXqq","ndmZmdy0mhzMDMvrua","q2LUEMvSjYWGjW","ze1Owfq"];return(I=function(){return e})()}W();const P=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[T(599)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}();function T(e,t){e-=445;const s=I();let n=s[e];if(void 0===T.nfJUWh){var r=function(e){let t="",s="",n=t+r;for(let r,a,i=0,o=0;a=e.charAt(o++);~a&&(r=i%4?64*r+a:a,i++%4)?t+=n.charCodeAt(o+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};T.pZgMTk=r,T.lpERBG={},T.nfJUWh=!0}const a=e+s[0],i=T.lpERBG[a];if(i)n=i;else{const e=function(e){this.laCnMX=e,this.YmYwWX=[1,0,0],this.uQnTqh=function(){return"newState"},this.GITKal="\\w+ *\\(\\) *{\\w+ *",this.QlmmHa="['|\"].+['|\"];? *}"};e.prototype.DQOhGf=function(){const e=new RegExp(this.GITKal+this.QlmmHa).test(this.uQnTqh.toString())?--this.YmYwWX[1]:--this.YmYwWX[0];return this.dLHzCg(e)},e.prototype.dLHzCg=function(e){return Boolean(~e)?this.ODlYzZ(this.laCnMX):e},e.prototype.ODlYzZ=function(e){for(let t=0,s=this.YmYwWX.length;t<s;t++)this.YmYwWX.push(Math.round(Math.random())),s=this.YmYwWX.length;return e(this.YmYwWX[0])},new e(T).DQOhGf(),n=T.pZgMTk(n),T.lpERBG[a]=n}return n}P(void 0,function(){const e=T,t={tsuFg:e(512),ZcHFg:function(e,t){return e(t)},GPczy:function(e){return e()},LRePC:"warn",AvtFh:e(528),SJcGW:function(e,t){return e<t}};let s;try{if("ZyVzJ"===t[e(469)]){const n=t[e(458)](Function,e(650)+"nction() "+e(561)+'ctor("retu'+e(567)+" ));");s=t.GPczy(n)}else _0x1a85ff.push(_0x166802)}catch(a){s=window}const n=s[e(579)]=s[e(579)]||{},r=[e(614),t[e(462)],"info",t[e(568)],e(532),e(517),"trace"];for(let i=0;t.SJcGW(i,r[e(545)]);i++){const t=P[e(481)+"r"].prototype[e(633)](P),s=r[i],a=n[s]||t;t[e(452)]=P.bind(P),t[e(556)]=a.toString.bind(a),n[s]=t}})();async function Z(){const e=T;document[e(580)]&&document[e(580)][e(563)]&&await document[e(580)][e(563)],await new Promise(e=>setTimeout(e,150))}async function k(e,t,s){const n=T,r={Urios:function(e,t){return e*t},InzZW:function(e,t){return e(t)},tyyWS:n(576)+n(615)+n(450)};return new Promise((a,i)=>{const o=n,l=new Image,c={};c[o(457)]=r.tyyWS;const u=new Blob([e],c),m=URL[o(547)+o(531)](u);l[o(592)]=()=>{const e=o,n=document[e(634)+e(489)](e(577));n[e(602)]=5*t,n.height=r[e(487)](s,5);const i=n[e(514)]("2d");i[e(541)](5,5),i.drawImage(l,0,0,t,s),URL["revokeObje"+e(531)](m),r.InzZW(a,n)},l.onerror=()=>{const e=o;URL[e(519)+e(531)](m),i(new Error("Failed to "+e(522)))},l[o(516)]=m})}async function H(e){const t=T,s={};s.qIGEQ=t(649),s.XVPXM=t(534);const n=s,r=(await import(n[t(483)]))[t(566)],a={};a.dark=e?t(529):n[t(600)],a[t(515)]="transparent";const i={};return i[t(602)]=200,i[t(635)]=1,i.color=a,i[t(484)+t(474)]="M",r[t(630)]("https://en"+t(530)+"m",i)}async function U(){const e=T,t={};t[e(472)]=e(448);const n=t;return new Promise((t,r)=>{const a=e,i=new Image;i[a(510)+"n"]=n.InMaI,i.onload=()=>t(i),i.onerror=r,i[a(516)]=s})}async function K(s,n,r={}){const a=T,i={KGyTB:a(448),krGXG:a(571),imtKx:function(e){return e()},tWxdu:function(e,t){return e+t},vjKQo:function(e,t){return e===t},iKXZt:function(e,t){return e*t},uPpYl:function(e,t,s,n){return e(t,s,n)},KGTJP:a(546),JjhRo:"#292524",InUuM:a(509),crCZJ:"#a8a29e",mPGSh:a(477),MGNUc:function(e,t){return e/t},aYehD:a(471),mRLTc:"600 24px '"+a(536)+a(574)+"Roman', serif",oIDcl:a(524)+" 20px 'Cormorant', Georgia, se"+a(583),aNPLn:function(e,t){return e/t},LxaAR:a(501),OfRHO:"center",NUDMX:function(e,t){return e||t},RBrzd:a(453)+a(526)+a(610),uuyNi:a(569),mNDFA:function(e,t){return e-t},DtYje:function(e,t){return e!==t},vKsDV:"dFwZF",mjJHQ:a(521),inqFC:function(e,t){return e>t},SdZYM:a(498)+a(574)+a(647)+a(570),DJApI:function(e,t){return e>t},eWsre:function(e,t){return e+t},JAlBh:function(e,t){return e-t},pRDpC:function(e,t){return e+t},TrDZo:function(e,t){return e-t},kAycm:a(581)+a(605),wLKbs:function(e,t){return e*t},wImqe:function(e,t){return e-t},SMRQb:function(e,t){return e/t},CLylA:function(e,t){return e+t},zArGM:function(e,t){return e-t},iojDc:a(447),ZbsuF:"600 13px '"+a(526)+a(610),PsfYS:"EN PENSENT",ZlDNY:a(558)+a(638),hWtzy:function(e,t){return e-t},zGYME:function(e,t){return e/t}};await i.imtKx(Z);const{boardSize:o=600,darkMode:l=!1,withWatermark:c=!1,title:u}=r,m=function(s,n){const r=T,a={MPvYz:function(e,t){return e(t)},PUawD:function(e,t){return e/t},ngMqc:function(e,t){return e+t},lphPn:function(e,t){return e*t},HPoiO:function(e,t,s){return e(t,s)},WGBYX:function(e,t){return e/t},TEHin:function(e,t){return e<t},GUFeD:function(e,t){return e-t}},i=a[r(589)](n,8),o=.02*n,l=a[r(552)](n,a.lphPn(o,2));let c=r(490)+r(461)+"ww.w3.org/"+r(637)+r(623)+l+'" height="'+l+'" viewBox="0 0 '+l+" "+l+'">';c+=r(555)+r(491)+'dth="'+l+r(620)+l+r(603)+e[r(586)]+r(488);for(let u=0;u<8;u++){const n=7-u;for(let l=0;l<8;l++)if("BYnVS"===r(473))_0x11869d[r(519)+r(531)](_0x4ef2f1),a.MPvYz(_0x52f362,new _0x16c532(r(622)+r(522)));else{const m=s[n][l],d=m[r(479)]?e[r(515)]:e[r(463)],f=o+l*i,x=o+u*i;if(c+='<rect x="'+f+r(497)+x+r(496)+i+'" height="'+i+r(603)+d+'"/>',m[r(644)][r(545)]>0){const e=a[r(513)](i,.08),s=[];for(const i of m[r(644)]){const e=a.HPoiO(t,i[r(533)],i[r(617)]);!s.includes(e)&&s.push(e)}const n=Math[r(595)](s[r(545)],6),o=[];let l=i-2*e;const u=a[r(584)](.7*l,n);for(let t=0;t<n;t++){const e={};if(e[r(617)]=s[t],e[r(607)]=l,o[r(550)](e),l-=u,a[r(593)](l,.1*i))break}for(const t of o){const e=a.GUFeD(i,t[r(607)])/2;c+='<rect x="'+(f+e)+r(497)+a[r(552)](x,e)+r(496)+t.layerSize+r(620)+t[r(607)]+r(603)+t.color+'"/>'}}}}return c+=r(564),c}(s,o),d=.02*o,f=o+i.iKXZt(d,2),x=await i[a(500)](k,m,f,f),h=60,p=f+120,v=i[a(585)](i[a(585)](f+220,60),120),g=document[a(634)+a(489)](a(577));g[a(602)]=5*p,g[a(613)]=5*v;const w=g[a(514)]("2d");w.scale(5,5),w["imageSmoot"+a(482)+"d"]=!0,w[a(511)+"hingQuality"]=a(598),w[a(449)]=l?a(640):i[a(553)],w[a(604)](0,0,p,v),w[a(499)](x,0,0,x[a(602)],x.height,h,h,f,f);const y=i[a(585)](h+f,28);w[a(590)+"e"]=l?i[a(643)]:"#e7e5e4",w[a(506)]=1,w[a(646)](),w.moveTo(h,y),w[a(565)](p-h,y),w[a(621)]();const j=l?i.InUuM:a(478),M=l?i[a(572)]:i[a(523)],b=a(l?477:582),N=l?i[a(523)]:a(582),z=i.MGNUc(p,2);let C=i[a(585)](y,55);const D=n[a(628)]||"White",L=n[a(505)]||"Black";w[a(494)+"ne"]=i[a(562)],w[a(540)]=i.mRLTc;const B=w.measureText(D)[a(602)],_=w.measureText(L)[a(602)];w[a(540)]=i[a(454)];const G=" vs ",q=w[a(618)+"t"](G)[a(602)],E=i[a(585)](i[a(585)](B,q),_),Y=z-i[a(648)](E,2);w[a(540)]=a(476)+a(536)+a(574)+a(538)+"rif",w.fillStyle=j,w[a(636)]=a(521),w[a(549)](D,Y,C),w[a(540)]=i[a(454)],w[a(449)]=N,w.fillText(G,i[a(585)](Y,B),C),w[a(540)]=i[a(559)],w[a(449)]=j,w[a(549)](L,i.tWxdu(Y,B)+q,C),C+=36,n[a(507)]&&n[a(507)]!==i[a(470)]&&(w.fillStyle=M,w.font="italic 500 18px 'Cor"+a(551)+a(606)+a(583),w[a(636)]=i.OfRHO,w[a(549)](n[a(507)],z,C),C+=32);const S=u,A=n.date||"";if(i[a(588)](S,A)){w.fillStyle=b,w[a(540)]=i[a(557)],w.textAlign=i[a(625)];let e="";S?(e=S[a(591)+"e"](),A&&(e+=i.uuyNi+A)):e=A;const t=2,s=e[a(525)](""),n=s.reduce((e,t)=>e+w[a(618)+"t"](t)[a(602)],0),r=i[a(456)](s[a(545)],1)*t;let o=z-i[a(597)](n+r,2);for(const l of s){if(i.DtYje(a(608),i[a(480)]))return new _0x254290((e,t)=>{const s=a,n=new _0x58d9f1;n[s(510)+"n"]=i[s(587)],n[s(592)]=()=>e(n),n.onerror=t,n[s(516)]=_0x4111c8});w[a(636)]=i[a(554)],w.fillText(l,o,C),o+=w[a(618)+"t"](l)[a(602)]+t}C+=28}if(n.moves&&i[a(539)](n.moves.length,0)){w[a(449)]=b,w[a(540)]=i.SdZYM,w[a(636)]=i[a(625)];const e=n[a(627)][a(548)](" "),t=i.DJApI(e[a(545)],400)?i[a(451)](e[a(578)](0,400),a(596)):e,s=i.JAlBh(p,120)-40,r=t[a(525)](" ");let o="",l=C;const c=15,u=4;let m=0;for(const n of r){const e=i[a(641)](i[a(641)](o,o?" ":""),n);if(i.inqFC(w[a(618)+"t"](e).width,s)&&o){if(w.fillText(o,z,l),o=n,l+=c,m++,m>=u)break}else o=e}o&&m<u&&w[a(549)](o,z,l)}const W=i[a(619)](i.mNDFA(v,h),20);w.fillStyle=b,w[a(540)]="500 11px '"+a(526)+"ns-serif",w[a(636)]=i[a(625)];const I=i[a(455)].split(""),P=I[a(518)]((e,t)=>e+w[a(618)+"t"](t)[a(602)],0)+i[a(601)](I.length-1,4);let K=i.wImqe(z,i[a(560)](P,2));for(const e of I)w[a(636)]="left",w[a(549)](e,K,W),K+=i.CLylA(w[a(618)+"t"](e)[a(602)],4);if(c){const[e,t]=await Promise[a(632)]([H(!1),U()]),s=220,n=65,r=i[a(485)](h+f-s,12),o=h+f-n-12;w[a(449)]=a(502)+a(503)+a(626),w[a(646)](),w[a(616)](r,o,s,n,6),w.fill(),w[a(590)+"e"]=i.iojDc,w[a(506)]=1,w[a(621)]();const l=48,c=i[a(641)](r,12),u=o+i[a(648)](i[a(493)](n,l),2);w[a(460)](),w[a(646)](),w[a(467)](c+i[a(648)](l,2),u+i[a(648)](l,2),l/2,0,i[a(466)](Math.PI,2)),w[a(492)](),w.drawImage(t,c,u,l,l),w[a(446)]();const m=c+l+10;w[a(636)]="left",w.textBaseline=a(544),w[a(449)]="#44403c",w[a(540)]=i[a(629)],w[a(549)](i[a(594)],m,o+28),w[a(449)]=a(477),w.font=a(504)+"Inter', sa"+a(610),w[a(549)](i[a(445)],m,i[a(585)](o,46));const d=50,x=i[a(508)](i[a(451)](r,s),d)-10,p=i.eWsre(o,i.zGYME(n-d,2)),v=new Image;await new Promise(t=>{const s=a,n={HRIyY:i[s(542)],XqWJu:function(e){return i[s(611)](e)},IoMrw:s(521),dMhXT:function(e,t){return i[s(585)](e,t)}};i[s(642)]("ZwELG","ZwELG")?(v[s(592)]=()=>{const e=s,r={VRcsY:function(e,t){return e(t)}};if(n[e(575)]!=n[e(575)]){const t={Trizf:function(e,t){return e*t},PqGHL:function(t,s){return r[e(465)](t,s)}};return new _0x1b4515((s,n)=>{const r=e,a=new _0x4008a1,i={};i[r(457)]=r(576)+r(615)+r(450);const o=new _0x76b53b([_0x28c8f3],i),l=_0x29df80["createObje"+r(531)](o);a[r(592)]=()=>{const e=r,n=_0x2aef95[e(634)+e(489)](e(577));n[e(602)]=t.Trizf(_0x512b36,_0x45fcbe),n[e(613)]=t[e(459)](_0x311138,_0x430fb0);const i=n[e(514)]("2d");i[e(541)](_0x3a81ec,_0x24ce0c),i[e(499)](a,0,0,_0x5885c5,_0x5abd5b),_0x250728[e(519)+e(531)](l),t.PqGHL(s,n)},a[r(486)]=()=>{const e=r;_0x1c7a3c[e(519)+e(531)](l),n(new _0x47e028(e(622)+e(522)))},a[r(516)]=l})}w.drawImage(v,x,p,d,d),n.XqWJu(t)},v[s(486)]=()=>t(),v[s(516)]=e):(_0x36ce69[s(636)]=n[s(495)],_0x1caef9.fillText(_0x21a72a,_0x8cd875,_0x40920f),_0x45bfc9+=n[s(537)](_0x18cf62.measureText(_0x510923)[s(602)],_0xea48c1))})}return g}const O=Y.filter(e=>"custom"!==e.id);const X=["Exemplar â„–001 â€¢ Genesis","Exemplar â„–002 â€¢ Prototype","Exemplar â„–003 â€¢ Blueprint","Exemplar â„–004 â€¢ Foundation","Exemplar â„–005 â€¢ Pioneer","Exemplar â„–006 â€¢ Alpha","Exemplar â„–007 â€¢ Benchmark","Exemplar â„–008 â€¢ Catalyst","Exemplar â„–009 â€¢ Origin","Exemplar â„–010 â€¢ Spectrum","Exemplar â„–011 â€¢ Prism","Exemplar â„–012 â€¢ Vertex","Exemplar â„–013 â€¢ Meridian","Exemplar â„–014 â€¢ Zenith","Exemplar â„–015 â€¢ Nexus","Exemplar â„–016 â€¢ Axiom","Exemplar â„–017 â€¢ Epoch","Exemplar â„–018 â€¢ Vector","Exemplar â„–019 â€¢ Cipher","Exemplar â„–020 â€¢ Matrix","Exemplar â„–021 â€¢ Helix","Exemplar â„–022 â€¢ Synthesis","Exemplar â„–023 â€¢ Thesis","Exemplar â„–024 â€¢ Opus","Exemplar â„–025 â€¢ Finale","Sunset Clash","Ocean Depths","Earth Tones","Forest Canopy","Copper Age","Midnight Purple","Rustic Charm","Steel Gray","Olive Grove","Slate Dreams","Berry Burst","Sandy Beach","Wine Country","Mint Fresh","Mahogany Dreams","Arctic Ice","Coral Reef","Lavender Fields","Bronze Medal","Neon Nights","Autumn Leaves","Crystal Cave","Desert Dusk","Emerald City","Fire Dance"];const J=()=>{const e=n(),{user:t,isLoading:s}=r(),[W,I]=a.useState(null),[P,T]=a.useState(!1),[Z,k]=a.useState(0),[H,U]=a.useState(""),[J,F]=a.useState([]),[R,V]=a.useState(50),[$,Q]=a.useState(!0),[ee,te]=a.useState(!1),[se,ne]=a.useState(null);a.useEffect(()=>{s||(async()=>{if(!t)return void I(!1);const{data:e}=await l.rpc("has_role",{_user_id:t.id,_role:"admin"});I(!0===e)})()},[t,s]);const re=a.useCallback(async(e,s,n,r,a=!0)=>{try{const d=i(e.pgn),f=a?O[Math.floor(Math.random()*O.length)]:O[n%O.length],x=function(e,t){const s=Y.find(e=>e.id===t)||Y[0];return e.map(e=>e.map(e=>({...e,visits:e.visits.map(e=>{const t=("w"===e.color?s.white:s.black)[e.piece]||"#888888";return{...e,hexColor:t}})})))}(d.board,f.id);o(f.id);const h=await K(x,d.gameData,{boardSize:600,darkMode:!1,withWatermark:!1,title:s}),p=await new Promise((e,t)=>{h.toBlob(s=>{s?e(s):t(new Error("Failed to create blob"))},"image/png",.95)}),v=Date.now(),g=`${t.id}/${v}-${s.replace(/[^a-z0-9]/gi,"-").toLowerCase()}.png`,{error:w}=await l.storage.from("visualizations").upload(g,p,{contentType:"image/png",upsert:!1});if(w)throw w;const{data:y}=l.storage.from("visualizations").getPublicUrl(g),j=c(e.pgn),M={white:d.gameData.white,black:d.gameData.black,event:d.gameData.event,date:d.gameData.date,result:d.gameData.result,pgn:d.gameData.pgn,moves:d.gameData.moves,board:x,totalMoves:d.totalMoves,visualizationState:{paletteId:f.id,paletteName:f.name,isOfficialPalette:!0,darkMode:!1,currentMove:1/0,isExemplar:r,exemplarNumber:r?n+1:void 0,gameHash:j}},{data:b,error:N}=await l.from("saved_visualizations").insert({user_id:t.id,title:s,pgn:e.pgn,game_data:M,image_path:y.publicUrl}).select().single();if(N)throw N;const z=function(e,t){if(e){const e=99,s=Math.max(0,10*(25-t));return e+Math.floor(300*Math.random())+s}return 199+Math.floor(600*Math.random())}(r,n),{data:C,error:D}=await u(b.id,z);if(D)throw D;const L=function(e,t){const s=e?1.5:1,n=e?Math.max(0,.1*(25-t)):0;return{viewCount:Math.floor((15*Math.random()+3)*s+5*n),hdDownloads:Math.floor(3*Math.random()*s),gifDownloads:Math.floor(2*Math.random()*s),tradeCount:e?Math.floor(2*Math.random()):0}}(r,n);for(let e=0;e<L.viewCount;e++)await l.rpc("record_vision_interaction",{p_visualization_id:b.id,p_user_id:t.id,p_interaction_type:"view"}),await new Promise(e=>setTimeout(e,50));const B=m(e.pgn),_=a?"premium":"genesis";return{title:s,success:!0,visualizationId:b.id,listingId:null==C?void 0:C.id,isExemplar:r,paletteId:f.id,paletteName:f.name,gameHash:j,tier:_,openingName:null==B?void 0:B.fullName}}catch(d){return{title:s,success:!1,error:d.message,isExemplar:r}}},[t]),ae=J.filter(e=>e.success).length,ie=J.filter(e=>!e.success).length;return J.filter(e=>e.success&&e.isExemplar).length,s||null===W?d.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:d.jsx(f,{className:"h-8 w-8 animate-spin text-primary"})}):t&&W?d.jsx("div",{className:"min-h-screen bg-background p-8",children:d.jsxs("div",{className:"max-w-4xl mx-auto",children:[d.jsxs(v,{variant:"ghost",onClick:()=>e("/marketplace"),className:"mb-6",children:[d.jsx(g,{className:"h-4 w-4 mr-2"}),"Return to Marketplace"]}),d.jsxs(x,{children:[d.jsx(w,{children:d.jsxs(y,{className:"flex items-center gap-3",children:[d.jsx(j,{className:"h-6 w-6 text-primary"}),"Seed Marketplace with Visions"]})}),d.jsxs(h,{className:"space-y-6",children:[d.jsx("div",{className:"p-4 rounded-lg bg-amber-500/10 border border-amber-500/30",children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx(M,{className:"h-5 w-5 text-amber-500 mt-0.5"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-amber-600",children:"CEO Only"}),d.jsxs("p",{className:"text-sm text-muted-foreground",children:["Generates ",R," visions: ",Math.min(25,R)," Exemplar editions (numbered testers from our humble beginnings) + ",Math.max(0,R-25)," creative community visions. Exemplars: $0.99-$4.99, Creative: $1.99-$7.99."]})]})]})}),d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("label",{className:"text-sm text-muted-foreground",children:"Number of visions:"}),d.jsxs("select",{value:R,onChange:e=>V(Number(e.target.value)),disabled:P,className:"bg-muted border border-border rounded px-3 py-2",children:[d.jsx("option",{value:5,children:"5 (test)"}),d.jsx("option",{value:10,children:"10"}),d.jsx("option",{value:25,children:"25"}),d.jsx("option",{value:50,children:"50"})]})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(b,{id:"use-official-palettes",checked:$,onCheckedChange:Q,disabled:P}),d.jsxs(N,{htmlFor:"use-official-palettes",className:"flex items-center gap-2",children:[d.jsx(z,{className:"h-4 w-4 text-primary"}),d.jsx("span",{className:"text-sm",children:"Official Palettes"})]})]}),$&&d.jsxs(C,{variant:"secondary",className:"text-xs",children:[O.length," palettes"]})]})]}),d.jsx(v,{onClick:async()=>{if(!t)return void S.error("You must be logged in as the CEO account");T(!0),F([]),k(0);const e=[],s=A.slice(0,Math.min(R,A.length)),n=[];for(let t=0;t<R;t++){const e=t%s.length,r=t<25,a=X[t]||`Vision ${t+1}`;n.push({game:s[e],title:a,isExemplar:r})}for(let t=0;t<n.length;t++){const{game:s,title:r,isExemplar:a}=n[t];U(`${a?"ðŸ†":"ðŸŽ¨"} ${r} (${t+1}/${n.length})`);const i=await re(s,r,t,a,$);e.push(i),F([...e]),k((t+1)/n.length*100),await new Promise(e=>setTimeout(e,300))}T(!1);const r=e.filter(e=>e.success).length,a=e.filter(e=>!e.success).length,i=e.filter(e=>e.success&&e.isExemplar).length;r>0?S.success(`Created ${r} visions`,{description:`${i} Exemplars, ${r-i} Creative${a>0?` (${a} failed)`:""}`}):S.error("Failed to create any visions")},disabled:P||!t,className:"w-full",size:"lg",children:P?d.jsxs(d.Fragment,{children:[d.jsx(f,{className:"h-5 w-5 mr-2 animate-spin"}),"Generating..."]}):d.jsxs(d.Fragment,{children:[d.jsx(D,{className:"h-5 w-5 mr-2"}),"Start Seeding"]})}),d.jsxs("div",{className:"border-t border-border pt-6 mt-6",children:[d.jsx("div",{className:"p-4 rounded-lg bg-destructive/10 border border-destructive/30 mb-4",children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx(L,{className:"h-5 w-5 text-destructive mt-0.5"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-destructive",children:"Delete My Test Visions"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Deletes only YOUR visions that have NOT earned royalties from other users' print orders. Visions with natural value accrual are preserved. Safe for testing cleanup."})]})]})}),d.jsx(v,{onClick:async()=>{if(!t)return;if(window.confirm("This will delete all YOUR visions that have NOT earned royalties from other users' print orders.\n\nVisions with natural value accrual will be preserved.\n\nAre you sure?")){te(!0),ne(null);try{const{data:e,error:s}=await l.from("saved_visualizations").select("id").eq("user_id",t.id);if(s)throw s;if(!e||0===e.length)return S.info("No visions to delete"),void te(!1);const n=e.map(e=>e.id),{data:r,error:a}=await l.from("vision_scores").select("visualization_id, royalty_cents_earned, royalty_orders_count").in("visualization_id",n);if(a)throw a;const i=new Set((r||[]).filter(e=>e.royalty_cents_earned>0||e.royalty_orders_count>0).map(e=>e.visualization_id)),o=n.filter(e=>!i.has(e)),c=n.filter(e=>i.has(e));if(0===o.length)return S.info("All your visions have accrued natural value - none deleted"),ne({deleted:0,preserved:c.length}),void te(!1);await l.from("visualization_listings").delete().in("visualization_id",o),await l.from("vision_scores").delete().in("visualization_id",o),await l.from("vision_interactions").delete().in("visualization_id",o),await l.from("visualization_transfers").delete().in("visualization_id",o);const{error:u}=await l.from("saved_visualizations").delete().in("id",o);if(u)throw u;for(const m of e.filter(e=>o.includes(e.id)))await l.storage.from("visualizations").remove([`${t.id}/`]);ne({deleted:o.length,preserved:c.length}),S.success(`Deleted ${o.length} test visions`,{description:c.length>0?`${c.length} visions with natural value preserved`:void 0})}catch(e){S.error("Failed to delete visions",{description:e.message})}finally{te(!1)}}},disabled:ee||P||!t,variant:"destructive",className:"w-full",size:"lg",children:ee?d.jsxs(d.Fragment,{children:[d.jsx(f,{className:"h-5 w-5 mr-2 animate-spin"}),"Deleting Test Visions..."]}):d.jsxs(d.Fragment,{children:[d.jsx(L,{className:"h-5 w-5 mr-2"}),"Delete My Test Visions"]})}),se&&d.jsx("div",{className:"mt-4 p-3 rounded-lg bg-muted text-sm",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("span",{className:"text-destructive",children:["ðŸ—‘ ",se.deleted," deleted"]}),se.preserved>0&&d.jsxs("span",{className:"text-green-500",children:["âœ“ ",se.preserved," preserved (has value)"]})]})})]}),P&&d.jsxs("div",{className:"space-y-2",children:[d.jsx(B,{value:Z,className:"h-2"}),d.jsx("p",{className:"text-sm text-muted-foreground text-center",children:H})]}),J.length>0&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-4 text-sm flex-wrap",children:[d.jsxs("span",{className:"flex items-center gap-1 text-green-500",children:[d.jsx(_,{className:"h-4 w-4"}),ae," successful"]}),d.jsxs("span",{className:"flex items-center gap-1 text-purple-500",children:[d.jsx(G,{className:"h-4 w-4"}),J.filter(e=>e.success&&"premium"===e.tier).length," Premium"]}),d.jsxs("span",{className:"flex items-center gap-1 text-blue-500",children:[d.jsx(q,{className:"h-4 w-4"}),J.filter(e=>e.success&&"genesis"===e.tier).length," Genesis"]}),ie>0&&d.jsxs("span",{className:"flex items-center gap-1 text-red-500",children:[d.jsx(p,{className:"h-4 w-4"}),ie," failed"]})]}),d.jsx("div",{className:"max-h-64 overflow-y-auto space-y-1 border border-border rounded-lg p-2",children:J.map((e,t)=>d.jsxs(E.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"text-sm p-2 rounded flex items-center justify-between gap-2 "+(e.success?"premium"===e.tier?"bg-purple-500/10 border border-purple-500/20":"bg-blue-500/10 border border-blue-500/20":"bg-red-500/10 text-red-600"),children:[d.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.success?"premium"===e.tier?d.jsx(G,{className:"h-4 w-4 text-purple-500 flex-shrink-0"}):d.jsx(q,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}):d.jsx(p,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),d.jsx("span",{className:"truncate",children:e.title}),e.openingName&&d.jsx(C,{variant:"secondary",className:"text-[9px] hidden sm:inline-flex",children:e.openingName}),e.error&&d.jsxs("span",{className:"text-xs opacity-70",children:["(",e.error,")"]})]}),e.success&&d.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[d.jsxs(C,{variant:"outline",className:"text-[10px] "+("premium"===e.tier?"border-purple-500/50":"border-blue-500/50"),children:[d.jsx(z,{className:"h-2.5 w-2.5 mr-1"}),e.paletteName]}),e.gameHash&&d.jsx("a",{href:`/g/${e.gameHash}?p=${e.paletteId}`,target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-primary hover:underline",children:"View â†’"})]})]},t))})]})]})]})]})}):d.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-8",children:d.jsx(x,{className:"max-w-md",children:d.jsxs(h,{className:"pt-6 text-center",children:[d.jsx(p,{className:"h-12 w-12 mx-auto text-destructive mb-4"}),d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Access Denied"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),d.jsx(v,{onClick:()=>e("/"),children:"Go Home"})]})})})};export{J as default};
