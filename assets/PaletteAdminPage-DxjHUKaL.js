import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as l,x as o,y as d,aP as u,p as m,t as x,P as h,w as f,B as p,bM as j,cj as v,a9 as g,am as w,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as k,cu as S,b as B}from"./index-xchx37pq.js";!function(){const e=G,s=D();for(;;)try{if(348335===parseInt(e(374))/1*(-parseInt(e(385))/2)+-parseInt(e(430))/3+parseInt(e(376))/4*(-parseInt(e(373))/5)+parseInt(e(419))/6*(parseInt(e(405))/7)+parseInt(e(379))/8+-parseInt(e(349))/9+parseInt(e(364))/10*(parseInt(e(399))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const A=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[G(388)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=G,s={};s[e(406)]=e(424)+"+$";const t=s;return A[e(414)]()[e(360)](t[e(406)]).toString()[e(392)+"r"](A)[e(360)]("(((.+)+)+)+$")});function D(){const e=["CM4GDgHPCYiPka","ve1jrLy","E30Uy29UC3rYDq","vLDUwuO","z2fTzv9KyxrH","mZaZoteYowfnrMzuCW","rxjYB3iGAw4Gyq","BgLUA2vKugfSzq","zgf0yq","B1rby3G","rhHgrhq","v0rWuMG","zLfgwfa","C2f2zwrFDMLZDq","Aw5Zzxj0","Bw9KAwzPzwrFyG","C2vHCMnO","ywrTAw4","zgvSzxrL","CgfSzxr0zv9VDG","mtbnDKvVy3G","zxjYAwrLCW","DMLZDwfSAxPHDa","ihjVBgu6","ELrfCuG","Aw9Uu3rHDgu","yxrH","DM1AB3y","DhjHy2u","mtqXmJCWAKXvuxzn","ouPMEuXstq","D2HPDgu","ntjWAufcufy","B3jKzxi","D2HPDgvFy29SBW","ntGXnJqWr3Lmrxrm","DgLUzYbSAw5Rzq","Du91s2S","rNPcq0i","Aw9UthG","CKXXwKS","mta0mZyYzhbzrLD5","A2LUzYbHzg1PBG","DMvYC2LVBG","yxbWBhK","yMXHy2TFy29SBW","B2TXBwS","y29UC29Szq","y29UC3rYDwn0BW","zxjYB3i","Aw5MBW","CNbJ","C2vSzwn0","zNj1C2W","CgfSzxr0zuLK","mte1odC1otHxAuvPDxy","C2zQsgy","wfLSDfC","zNjVBq","y29Kzq","v0jLyKC","mtm5ntfHB2z1qxG","wuT0BKS","Bg9N","DxbKyxrL","re5Hyuy","BxvwrgK","y0zuwMq","CgfSzxr0zv9Pza","AwqSigDHBwvFza","Dg9tDhjPBMC","teDyDLe","AgfZx3jVBgu","rxjYB3iGy2HLyW","yMXHy2S","mtqZnhr2C0vtDq","yxrPB25ZoG","yMLUza","yurTwgq","t1jiAem","kcGOlISPkYKRkq","y0flsei","rxjYB3iGy291BG","qxbgyu4","y3rVCIGICMv0Dq","zxHgwfy","mJm4nta5z3HTufbS","x19WCM90B19F","D2fYBG"];return(D=function(){return e})()}A();const q=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[G(388)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();function G(e,s){e-=342;const t=D();let n=t[e];if(void 0===G.ggTyvK){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};G.jUEWsz=a,G.EBCWsf={},G.ggTyvK=!0}const r=e+t[0],i=G.EBCWsf[r];if(i)n=i;else{const e=function(e){this.khhSXm=e,this.AaJpGF=[1,0,0],this.dsNfTl=function(){return"newState"},this.Yxchul="\\w+ *\\(\\) *{\\w+ *",this.blfefv="['|\"].+['|\"];? *}"};e.prototype.dVyQUA=function(){const e=new RegExp(this.Yxchul+this.blfefv).test(this.dsNfTl.toString())?--this.AaJpGF[1]:--this.AaJpGF[0];return this.uUmRzT(e)},e.prototype.uUmRzT=function(e){return Boolean(~e)?this.AecISb(this.khhSXm):e},e.prototype.AecISb=function(e){for(let s=0,t=this.AaJpGF.length;s<t;s++)this.AaJpGF.push(Math.round(Math.random())),t=this.AaJpGF.length;return e(this.AaJpGF[0])},new e(G).dVyQUA(),n=G.jUEWsz(n),G.EBCWsf[r]=n}return n}async function M(s){const t=G,n={};n[t(410)]=t(412),n[t(368)]=function(e,s){return e!==s};const a=n;try{const{data:n,error:r}=await e[t(402)](t(363)+t(365))[t(396)]("*").eq(a.muVDi,s).single();if(r&&a[t(368)](r[t(403)],"PGRST116"))throw r;const i={};return i.data=n,i[t(393)]=null,i}catch(r){const e={};return e[t(352)]=null,e[t(393)]=r,e}}async function P(s){const t=G,n={};n[t(397)]=function(e,s){return e===s},n[t(371)]=t(413)+t(370),n.AJMuM=t(356),n[t(404)]=t(426)+t(380)+"d visualiz"+t(420);const a=n;try{const{data:n,error:r}=await e[t(402)](t(357)+"alizations").select(a[t(371)]);if(r)throw r;let i=0;for(const e of n||[]){const n=e[t(348)][t(366)+"ionState"];if((null==n?void 0:n[t(398)])===s||(null==n?void 0:n[t(351)+"tteId"])===s)if("qYhLp"!==a.AJMuM)i++;else{const e=_0x47eef0[t(348)][t(366)+t(369)];(a[t(397)](null==e?void 0:e.paletteId,_0x3a6a93)||a[t(397)](null==e?void 0:e[t(351)+"tteId"],_0x549eb0))&&_0x316c28++}}return i}catch(r){return 0}}q(void 0,function(){const e=G,s={DNaaF:function(e,s){return e(s)},cAKHB:function(e,s){return e+s},FzBCB:e(407),aDmXd:e(393),okqmk:"table",uOuKk:e(372),cFTZd:e(415)},t=function(){const t=e;let n;try{n=s[t(409)](Function,s[t(425)](s[t(425)]("return (function() ",t(346)+t(428)+t(344)+" )"),");"))()}catch(a){n=window}return n}(),n=t[e(391)]=t[e(391)]||{},a=[s[e(382)],e(343),e(394),s[e(422)],"exception",s[e(390)],s[e(381)]];for(let r=0;r<a.length;r++)if(s[e(411)]!=s[e(411)]){if(_0x5eb160){const s=_0x5f5690[e(388)](_0x566838,arguments);return _0x17169a=null,s}}else{const s=q.constructor.prototype.bind(q),t=a[r],i=n[t]||s;s[e(342)]=q[e(421)](q),s.toString=i[e(414)][e(421)](i),n[t]=s}})();const L=["k","q","r","b","n","p"],H={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},W=()=>{var A,D,q,W;const{user:K}=s(),F=t(),[_,I]=n.useState(!1),[T,U]=n.useState(!0),[Y,X]=n.useState([]),[J,E]=n.useState(null),[R,V]=n.useState(null),[Z,$]=n.useState({}),[O,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!K)return void F("/");if(!(await async function(s){const t=G,n={};n.XYltW=t(416),n[t(354)]=t(361),n[t(384)]=t(417)+t(386)+t(367),n[t(345)]=t(350)+"dmin check:";const a=n;try{const{data:n,error:r}=await e[t(395)](a[t(401)],{_user_id:s,_role:a[t(354)]});return!r&&!0===n}catch(r){return!1}}(K.id)))return B.error("Access denied",{description:"Admin privileges required"}),void F("/");I(!0),await te(),U(!1)})()},[K,F]);const te=async()=>{const{data:s}=await async function(){const s=G,t={};t[s(353)]="palette_id";const n=t;try{const{data:t,error:a}=await e.from("palette_ov"+s(365))[s(396)]("*")[s(377)](n[s(353)]);if(a)throw a;const r={};return r[s(352)]=t||[],r[s(393)]=null,r}catch(a){const e={};return e[s(352)]=[],e.error=a,e}}();X(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await P(e.id);$(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=Y.find(s=>s.palette_id===e);E(e),V({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{R&&V({...R,[e]:{...R[e],[s]:t}})},re=async()=>{if(!J||!R||!K)return;Q(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,a){const r=G,i={exFXV:function(e,s){return e(s)},ORHhC:r(347),rXTpz:"kypbS",ionLx:r(363)+"errides",sfjHf:function(e,s){return e+s},WDpRh:r(412)};try{const{data:c}=await i[r(429)](M,s);if(c){if(i[r(423)]!==i.rXTpz){const{error:l}=await e[r(402)](i[r(383)])[r(408)]({white_colors:t,black_colors:n,modified_by:a,version:i[r(400)](c[r(387)],1)}).eq(i[r(355)],s);if(l)throw l;const o={};return o[r(393)]=null,o[r(387)]=c[r(387)]+1,o}{const e={};return e[r(393)]=_0xb4b58a,e[r(387)]=0,e}}{const c={};c[r(412)]=s,c[r(378)+"rs"]=t,c[r(389)+"rs"]=n,c[r(359)+"y"]=a,c.version=1;const{error:l}=await e[r(402)](i[r(383)])[r(358)](c);if(l)throw l;const o={};return o[r(393)]=null,o[r(387)]=1,o}}catch(c){const e={};return e[r(393)]=c,e[r(387)]=0,e}}(J,R.white,R.black,K.id);s?B.error("Failed to save",{description:s.message}):(B.success("Palette updated!",{description:`Version ${t} saved. ${Z[J]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>Y.some(s=>s.palette_id===e);return T?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):_?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(l,{className:"cursor-pointer transition-all hover:border-primary/50 "+(J===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(o,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),Z[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),Z[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[L.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),L.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:J&&R?a.jsxs(l,{children:[a.jsx(m,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(x,{className:"flex items-center gap-2",children:[a.jsx(h,{className:"h-5 w-5"}),null==(A=ie(J))?void 0:A.name]}),a.jsx(f,{children:null==(D=ie(J))?void 0:D.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(J)&&a.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!J)return;Q(!0);const{error:s}=await async function(s){const t=G,n={};n[t(427)]=t(412);const a=n;try{const{error:n}=await e[t(402)]("palette_overrides")[t(362)]().eq(a[t(427)],s);if(n)throw n;return{error:null}}catch(r){const e={};return e[t(393)]=r,e}}(J);s?B.error("Failed to revert",{description:s.message}):(B.success("Reverted to defaults"),ne(J),await te()),Q(!1)},disabled:O,children:[a.jsx(j,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(p,{size:"sm",onClick:async()=>{if(!J||!R||!K)return;(Z[J]||0)>0?se(!0):await re()},disabled:O,children:[O?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(v,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(o,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(q=ie(J))?void 0:q.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:H[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(g,{type:"color",value:R.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(g,{type:"text",value:R.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(W=ie(J))?void 0:W.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:H[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(g,{type:"color",value:R.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(g,{type:"text",value:R.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(w,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:L.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:R.white[e]},title:H[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:L.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:R.black[e]},title:H[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(l,{className:"h-full flex items-center justify-center",children:a.jsxs(o,{className:"text-center py-12",children:[a.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(b,{children:[a.jsxs(C,{className:"flex items-center gap-2",children:[a.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(k,{children:["This palette is linked to ",a.jsx("strong",{children:Z[J||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(p,{onClick:re,disabled:O,children:[O?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(S,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{W as default};
