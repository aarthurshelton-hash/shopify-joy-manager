import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b7 as o,B as l,A as d,cb as u,cR as h,a8 as x,D as m,aB as p,aC as f,aD as w,aE as j,p as v,t as g,w as y,dy as C,du as b,bo as N,dr as z,cZ as q,a1 as D,a2 as L,a3 as B,a4 as _,a5 as M,aW as W,bC as A,dz as K,b as H,y as O}from"./index-BsQTe2MU.js";import{C as S}from"./calendar-DFha0RQq.js";function U(e,t){e-=473;const s=Z();let n=s[e];if(void 0===U.djjhqO){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};U.TEPdIg=r,U.VhiOJx={},U.djjhqO=!0}const a=e+s[0],c=U.VhiOJx[a];if(c)n=c;else{const e=function(e){this.dHsrzL=e,this.hnOCQJ=[1,0,0],this.VKtbOl=function(){return"newState"},this.JpWZwc="\\w+ *\\(\\) *{\\w+ *",this.cHoUCX="['|\"].+['|\"];? *}"};e.prototype.YjZeMU=function(){const e=new RegExp(this.JpWZwc+this.cHoUCX).test(this.VKtbOl.toString())?--this.hnOCQJ[1]:--this.hnOCQJ[0];return this.ZZmARf(e)},e.prototype.ZZmARf=function(e){return Boolean(~e)?this.OndxfS(this.dHsrzL):e},e.prototype.OndxfS=function(e){for(let t=0,s=this.hnOCQJ.length;t<s;t++)this.hnOCQJ.push(Math.round(Math.random())),s=this.hnOCQJ.length;return e(this.hnOCQJ[0])},new e(U).YjZeMU(),n=U.TEPdIg(n),U.VhiOJx[a]=n}return n}!function(){const e=U,t=Z();for(;;)try{if(612699===parseInt(e(538))/1+-parseInt(e(491))/2*(parseInt(e(475))/3)+-parseInt(e(505))/4*(-parseInt(e(547))/5)+-parseInt(e(480))/6*(-parseInt(e(478))/7)+-parseInt(e(518))/8*(-parseInt(e(541))/9)+-parseInt(e(593))/10+parseInt(e(549))/11)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const I=function(){const e={};e[U(600)]="FcTMs";const t=e;let s=!0;return function(e,n){const r=s?function(){const s=U;if(t.fNzpH!==s(536)){const e={};return e[s(474)]=!1,e[s(557)]=_0x58bc70,e}if(n){const t=n[s(511)](e,arguments);return n=null,t}}:function(){};return s=!1,r}}()(void 0,function(){const e=U,t={};t[e(553)]=e(568)+"+$";const s=t;return I.toString().search(s[e(553)])[e(479)]()[e(516)+"r"](I).search(s[e(553)])});I();const P=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[U(511)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}();function Z(){const e=["BKTbuLO","t1noqwC","qM1ztwe","C3rHDhvZ","A2zuy3u","yMLUza","shDXz2W","E30Uy29UC3rYDq","yxv0Aa","zf9Jzw50CYWGDa","yM9KEq","DhjHy2u","zhjHD25Fy2vUDa","swPZzNa","CMvQzwn0zwrFyW","yxbWCM92zwrFyW","CLPSsgm","rMnutxm","B3vUDa","odqXodbqvK1hzuW","yxbWCM92zwrFyq","zNvUy3rPB25Z","mZK4nZKWounpB3vTEa","ChjVDMvKihn0yq","D2fYBG","r3Dtsg8","BMn0Aw9UkcKG","B3rHBf93AxrOza","mJv4wwPKBgy","ig5VDcbPBIbHCa","mJG2ody5z3zpwezc","y3jLyxrLzf9HDa","DxnLCL9PzcWGza","rxfmyvu","svvTrMm","Ee9dAMm","x3jLCxvLC3rZ","EuXqBLK","zxjYB3i","zgf0yq","CMf3BL9Jzw50CW","yxnJzw5KAw5N","whriB2m","Bg9N","y29UC29Szq","DgLJyxrLza","zgLZCgXHEv9Uyq","CM4GDgHPCYiPka","BwfW","kcGOlISPkYKRkq","CMvXDwvZDf9Pza","C2HKCfa","Dg9ju09tDhjPBG","y29TCgXLDgvK","CNL6yM8","y0PXvMO","sxb5zKG","z2v0vxnLCG","BgvUz3rO","wu5SC2W","zxDjuMm","C3rHDhvZlcbHBq","tM90igf1DgHLBG","uwXYy1K","CgvUzgLUz19HBq","yxbWCM92zwq","t2nZzwe","wg5YvLG","EgvUELi","C2vSzwn0","v2fSBgv0ihvWza","v3LbBNG","AxnWBgf5x25HBq","z2v0","ntiXnZG5mffQt0zUwG","yw1VDw50x2nLBG","yMLLz3G","sfPOyxK","CgvUzgLUzW","ywrTAw5FBM90zq","B3rHBf9LyxjUzq","zK56CeG","DxnLCL93ywXSzq","zxHJzxb0Aw9U","C3vJy2vZCW","mJm1mKfpwNLHEq","DxbKyxrL","CMvQzwn0zwq","n3rUy2jpvq","Dg9tDhjPBMC","nJq1otG4oeziz1jhta","ywXS","Aw52B2TL","ChjVzMLSzxm","zNjVBq","DgfIBgu","r0zbqLy","Bw91BNq","svrxtfC","DxnLCL9Pza","se5Qzve","mty4mgfhwNPYAq","Dg90ywXFzwfYBG","DgHKCMf3ywW","zM9YrwfJAa","sNb2s04","CMvHC29UigLZia","D2L0AgrYyxDHBa","vw5RBM93BIbvCW","cI0TlqO","Dw50","x19WCM90B19F","y29TCgXLDgvKxW","ywXxvKe","ChjVy2vZCY13Aq","mtmWndmYv0XxD2vu","EvrWrg0","B3jKzxi","CgvUzgLUz19JBW","sMzOB1C","qM9mCNi","yxbWBhK","DhvZ","C2LUz2XL","zwrFy2vUDhm","u25NzhG","y29UC3rYDwn0BW","yxrLigvYCM9YoG","oezbC1fYua"];return(Z=function(){return e})()}async function G(t){const s=U,n={};n[s(575)]=s(589)+s(517),n[s(535)]="withdrawal_requests",n[s(585)]=function(e,t){return e!==t},n[s(590)]="status",n[s(520)]=s(483),n[s(570)]="user_id",n[s(532)]=s(601)+"ts";const r=n;try{const n={};n[s(560)]=!1;let a=e[s(484)](r[s(535)])[s(588)]("*")[s(507)](s(550),n);t&&r.Ocsea(t,s(481))&&(a=a.eq(r[s(590)],t));const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[])[s(567)](e=>e[s(489)]))],{data:l}=await e[s(484)](r[s(520)])[s(588)](s(551)+s(591)+"e").in(r[s(570)],o),{data:d}=await e[s(484)](r[s(532)]).select("user_id, t"+s(599)+s(528)+s(546)+s(559)).in(r.shdpP,o),u=new Map((null==l?void 0:l[s(567)](e=>[e.user_id,e]))||[]),h=new Map((null==d?void 0:d[s(567)](e=>[e[s(489)],e]))||[]),x=(c||[])[s(567)](e=>{var t,n,r;return{...e,payout_details:e.payout_details,user_display_name:(null==(t=u[s(592)](e.user_id))?void 0:t[s(565)+"me"])||s(498)+"er",wallet_total_earned:(null==(n=h[s(592)](e[s(489)]))?void 0:n[s(492)+s(514)])||0,wallet_total_withdrawn:(null==(r=h[s(592)](e[s(489)]))?void 0:r["total_with"+s(531)+"s"])||0}}),m={};return m[s(558)]=x,m[s(557)]=null,m}catch(a){if(s(523)!==s(595)){const e={};return e[s(558)]=[],e.error=a,e}_0x1a6bad[s(557)](r[s(575)],_0x24469a)}}async function Y(){const t=U,s={};s.XtHoc=t(597),s[t(554)]="rejected",s.ITWLW="withdrawal"+t(555);const n=s;try{const{data:s,error:r}=await e[t(484)](n[t(488)]).select(t(580)+"ount_cents");if(r)throw r;const a={};a[t(508)+"unt"]=0,a[t(583)+t(537)]=0,a[t(534)+t(537)]=0,a[t(539)+"mount"]=0,a.completed_total=0,a["rejected_c"+t(537)]=0;const c=a;(s||[])[t(494)](e=>{const s=t;if(s(556)===s(544)){const e=_0xdf4bd0[s(516)+"r"].prototype[s(524)](_0x11849d),t=_0x5a11bb[_0x536ace],n=_0x172a34[t]||e;e[s(501)]=_0x58b621[s(524)](_0x39dc19),e[s(479)]=n[s(479)][s(524)](n),_0x8cfa[t]=e}else switch(e.status){case n[s(561)]:c["pending_co"+s(500)]++,c[s(583)+"ount"]+=e.amount_cents;break;case s(584):c[s(534)+"ount"]++,c[s(539)+s(487)]+=e[s(594)+"ts"];break;case s(572):c[s(502)+"total"]+=e.amount_cents;break;case n.xOCjc:c[s(533)+s(537)]++}});const i={};return i[t(558)]=c,i.error=null,i}catch(r){const e={};return e[t(558)]=null,e[t(557)]=r,e}}P(void 0,function(){const e=U,t={BmYMa:function(e,t){return e(t)},GsWVe:function(e,t){return e+t},Hwqgl:function(e,t){return e+t},HZhay:"return (fu"+e(545),QlrcY:e(526)+'ctor("retu'+e(566)+" )",yTpDm:"info",nKARZ:e(557),hcobh:e(530),ryzbo:"LiujH"},s=function(){const s=e;let n;try{n=t[s(521)](Function,t.GsWVe(t[s(525)](t[s(596)],t[s(582)]),");"))()}catch(r){n=window}return n}(),n=s.console=s[e(563)]||{},r=[e(562),e(543),t[e(506)],t[e(519)],e(473),e(485),t.hcobh];for(let a=0;a<r[e(577)];a++)if(t[e(573)]!==e(574)){const t=P[e(516)+"r"].prototype[e(524)](P),s=r[a],c=n[s]||t;t[e(501)]=P.bind(P),t.toString=c[e(479)][e(524)](c),n[s]=t}else _0x2f16d8=_0x2fadfc.eq(e(522),_0x87fbcb)})(),function(){const e=X,t=R();for(;;)try{if(713215===-parseInt(e(442))/1+-parseInt(e(416))/2*(-parseInt(e(440))/3)+parseInt(e(425))/4*(-parseInt(e(433))/5)+-parseInt(e(437))/6*(-parseInt(e(424))/7)+-parseInt(e(465))/8+-parseInt(e(460))/9+-parseInt(e(454))/10*(-parseInt(e(435))/11))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const k=function(){const e=X,t={};t[e(420)]="Tuetc";const s=t;let n=!0;return function(t,r){const a=e;if("Tuetc"!==s[a(420)]){const e={};return e[a(449)]=!1,e.error=_0x34bf39,e}{const e=n?function(){if(r){const e=r[a(466)](t,arguments);return r=null,e}}:function(){};return n=!1,e}}}()(void 0,function(){const e=X;return k[e(431)]().search(e(459)+"+$")[e(431)]()[e(464)+"r"](k)[e(411)](e(459)+"+$")});k();const J=function(){const e=X,t={};t[e(458)]=function(e,t){return e===t};const s=t;let n=!0;return function(t,r){const a=e;if(s[a(458)]("CjhrM",a(417))){const e={};return e[a(414)]=[],e.error=_0x2e7c34,e}{const e=n?function(){if(r){const e=r[a(466)](t,arguments);return r=null,e}}:function(){};return n=!1,e}}}();function R(){const e=["otq1uxDMseD0","ntuYmJHduhLOqwC","tM90igf1DgHLBG","sgTUDMC","BMn0Aw9UkcKG","Bg9N","Cf9IDxLLCL9Pza","Dg9tDhjPBMC","yMLUza","nZb6DgjYvvy","DhjHy2u","mtfKrK1jvM0","zxjYB3i","mZK0otjqr2n4qKu","BgLTAxq","u1PvELq","mZyWntK3A0PHsxnH","yxnJzw5KAw5N","mta0ntC5m25ry1POwq","DxnLCL9Pza","y29UC29Szq","C2vSzwn0","BMLTvgK","y3rVCIGICMv0Dq","yxrLx3DHBgXLDa","C3vJy2vZCW","C2fSzq","D2fSBgv0x3rYyq","z2v0vxnLCG","CM4GDgHPCYiPka","nJG0otC3mgffufHnua","Cf9SAxn0Aw5NxW","suDmueK","D1bns3m","sKTgs0m","kcGOlISPkYKRkq","ntqWnZu2DeLfv2jK","tKveqLO","ChjVDg90ExbL","x19WCM90B19F","y29UC3rYDwn0BW","nde4mtK5mNbrzNjrsa","yxbWBhK","Dg9gAxHLza","yxv0Aa","z2v0x29Yx2nYzq","zhbfsLK","Aw5MBW","C0LNzuW","t1rKwxm","y2vFy2vUDhm","qKvny00","zxHJzxb0Aw9U","rwfYyvm","y3jLyxrLzf9HDa","C2vHCMnO","Cf91C2vYx2LK","CMTLDhbSywnLxW","zgf0yq","CNbJ","mtzewMvtCw4","s09rzMq","DgLJyxrLza","D2fYBG","tvPhwNq","zNjVBq","BNnHy3rPB25Z","ChjVy2vZC19Tyq"];return(R=function(){return e})()}function X(e,t){e-=409;const s=R();let n=s[e];if(void 0===X.DkDfKS){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};X.fGgvnh=r,X.bFlOWo={},X.DkDfKS=!0}const a=e+s[0],c=X.bFlOWo[a];if(c)n=c;else{const e=function(e){this.Iopzxg=e,this.CsAXFu=[1,0,0],this.KRtKOL=function(){return"newState"},this.uFwOxF="\\w+ *\\(\\) *{\\w+ *",this.SkfhVa="['|\"].+['|\"];? *}"};e.prototype.fNPOVX=function(){const e=new RegExp(this.uFwOxF+this.SkfhVa).test(this.KRtKOL.toString())?--this.CsAXFu[1]:--this.CsAXFu[0];return this.xmUuXH(e)},e.prototype.xmUuXH=function(e){return Boolean(~e)?this.cSyybf(this.Iopzxg):e},e.prototype.cSyybf=function(e){for(let t=0,s=this.CsAXFu.length;t<s;t++)this.CsAXFu.push(Math.round(Math.random())),s=this.CsAXFu.length;return e(this.CsAXFu[0])},new e(X).fNPOVX(),n=X.fGgvnh(n),X.bFlOWo[a]=n}return n}function F(e){return"$"+(e/100)[X(467)](2)}function E(){var I,P;const{user:Z}=t(),k=s(),[J,R]=n.useState(!1),[X,E]=n.useState(!0),[V,T]=n.useState([]),[Q,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{oe()},[Z]);const oe=async()=>{if(!Z)return void E(!1);const{data:t}=await e.rpc("has_role",{_user_id:Z.id,_role:"admin"});!0===t&&(R(!0),await le()),E(!1)},le=async()=>{const[e,t]=await Promise.all([G(ee),Y()]);e.data&&T(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(O,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(O,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(O,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(O,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(O,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(O,{variant:"outline",children:e})}};return X?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):Z&&J?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(l,{variant:"ghost",size:"icon",onClick:()=>k(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),Q&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:F(Q.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:F(Q.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:F(Q.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),le()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(w,{value:"pending",children:"Pending"}),r.jsx(w,{value:"approved",children:"Approved"}),r.jsx(w,{value:"completed",children:"Completed"}),r.jsx(w,{value:"rejected",children:"Rejected"}),r.jsx(w,{value:"all",children:"All"})]}),r.jsx(j,{value:ee,children:r.jsxs(c,{children:[r.jsxs(v,{children:[r.jsx(g,{children:"Withdrawal Requests"}),r.jsxs(y,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===V.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(C,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(b,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:V.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(N,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(z,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(S,{className:"h-3 w-3"}),q(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",F(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:F(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(m,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(l,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(D,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(L,{children:[r.jsxs(B,{children:[r.jsxs(_,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(M,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(I=se.request.payout_details)?void 0:I.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:F(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(W,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(A,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(P=se.request.payout_details)?void 0:P.email})]})]})]}),r.jsxs(K,{children:[r.jsx(l,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=U;try{const{data:{user:r}}=await e[n(527)].getUser();if(!r)throw new Error(n(581)+n(564));const{error:a}=await e[n(484)](n(497)+n(555))[n(476)]({status:n(584),admin_notes:s||null,reviewed_by:r.id,reviewed_at:(new Date)[n(571)+"g"]()}).eq("id",t).eq("status",n(597));if(a)throw a;const c={};return c[n(474)]=!0,c[n(557)]=null,c}catch(r){const e={success:!1};return e.error=r,e}}(se.request.id,re),t.success&&H.success("Withdrawal approved");break;case"reject":if(!re.trim())return H.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=U,r={};r[n(495)]=n(581)+n(564),r[n(552)]=n(522);const a=r;try{const{data:{user:r}}=await e[n(527)][n(576)]();if(!r)throw new Error(a.JpvKN);if(!s)throw new Error("Rejection "+n(496)+"required");const{error:c}=await e[n(484)]("withdrawal"+n(555))[n(476)]({status:n(477),admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date)[n(571)+"g"]()}).eq("id",t).eq(a.EqLaU,"pending");if(c)throw c;const i={};return i[n(474)]=!0,i[n(557)]=null,i}catch(c){const e={};return e[n(474)]=!1,e[n(557)]=c,e}}(se.request.id,re),t.success&&H.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=U,r={};r[n(510)]="Not authen"+n(564),r[n(515)]="approved",r[n(579)]="withdrawal"+n(555),r.gcnHR="completed",r[n(486)]="rsoqB",r[n(503)]=function(e,t){return e===t},r[n(587)]=n(578),r[n(490)]=n(509);const a=r;try{const{data:{user:r}}=await e[n(527)][n(576)]();if(!r)throw new Error(a[n(510)]);const{data:c,error:i}=await e[n(484)](n(497)+n(555))[n(588)]("*").eq("id",t).eq("status",a[n(515)])[n(513)]();if(i||!c)throw new Error("Request not found or"+n(548)+n(542)+n(512));const{error:o}=await e[n(484)](a[n(579)])[n(476)]({status:a.gcnHR,admin_notes:s?(c[n(598)+"s"]||"")+n(499)+s:c[n(598)+"s"],completed_at:(new Date)[n(571)+"g"]()}).eq("id",t);if(o)throw o;const l={};l[n(569)]=t,l[n(489)]=c[n(489)],l[n(594)+"ts"]=c[n(594)+"ts"];const d={};d[n(529)]=l;const{error:u}=await e[n(540)][n(482)](n(504)+n(493),d);if(u&&a.GFABV===n(586)){const e={};return e[n(558)]=null,e[n(557)]=_0x343ef6,e}const h={};return h[n(474)]=!0,h[n(557)]=null,h}catch(c){if(a.alWVA(a[n(587)],a[n(490)])){const e={};return e[n(474)]=!1,e[n(557)]=_0x522483,e}{const e={};return e[n(474)]=!1,e[n(557)]=c,e}}}(se.request.id,re),t.success&&H.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?H.error(t.error.message):(ne({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(l,{onClick:()=>k("/"),children:"Go Home"})]})})})}J(void 0,function(){const e=X,t={KTCqI:function(e,t){return e(t)},NEDBZ:function(e,t){return e+t},EaraS:function(e,t){return e+t},SZUzT:"return (fu"+e(428),sIgeL:"{}.constru"+e(447)+e(453)+" )",OTdYs:"table",ZVqJb:function(e,t){return e<t}},s=function(){const s=e;let n;try{n=t.KTCqI(Function,t[s(461)](t[s(409)](t[s(439)],t[s(472)]),");"))()}catch(r){n=window}return n}(),n=s[e(444)]=s[e(444)]||{},r=[e(429),e(419),e(471),"error",e(476),t[e(473)],e(434)];for(let a=0;t.ZVqJb(a,r.length);a++){const t=J[e(464)+"r"][e(462)][e(432)](J),s=r[a],c=n[s]||t;t[e(463)]=J[e(432)](J),t[e(431)]=c[e(431)][e(432)](c),n[s]=t}})();export{E as default};
