import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b7 as o,B as l,A as d,cb as u,cR as x,a8 as m,D as h,aB as p,aC as f,aD as v,aE as w,p as j,t as y,w as g,dy as b,dt as C,bo as N,dq as q,cZ as D,a1 as z,a2 as L,a3 as B,a4 as M,a5 as _,aW as A,bC as W,dz as U,b as K,y as I}from"./index-DMpRWcyL.js";import{C as P}from"./calendar-BwM7LiGA.js";function S(e,t){e-=215;const s=G();let n=s[e];if(void 0===S.lEUUWI){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};S.jXrRBr=r,S.LEDBiB={},S.lEUUWI=!0}const a=e+s[0],c=S.LEDBiB[a];if(c)n=c;else{const e=function(e){this.dzKdhJ=e,this.aCimPM=[1,0,0],this.fJpboT=function(){return"newState"},this.zNrWHd="\\w+ *\\(\\) *{\\w+ *",this.OAuVus="['|\"].+['|\"];? *}"};e.prototype.sviySe=function(){const e=new RegExp(this.zNrWHd+this.OAuVus).test(this.fJpboT.toString())?--this.aCimPM[1]:--this.aCimPM[0];return this.Rgoldd(e)},e.prototype.Rgoldd=function(e){return Boolean(~e)?this.XfddIW(this.dzKdhJ):e},e.prototype.XfddIW=function(e){for(let t=0,s=this.aCimPM.length;t<s;t++)this.aCimPM.push(Math.round(Math.random())),s=this.aCimPM.length;return e(this.aCimPM[0])},new e(S).sviySe(),n=S.jXrRBr(n),S.LEDBiB[a]=n}return n}!function(){const e=S,t=G();for(;;)try{if(907025===parseInt(e(363))/1+parseInt(e(333))/2+-parseInt(e(262))/3*(parseInt(e(230))/4)+parseInt(e(218))/5+-parseInt(e(295))/6+-parseInt(e(329))/7*(-parseInt(e(268))/8)+-parseInt(e(343))/9)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const R=function(){const e=S,t={lpYYE:e(250)+"+$",wSMyR:e(307),joSxv:function(e,t){return e(t)},BeetA:e(245)};let s=!0;return function(n,r){const a=e,c={cFhcl:function(e,s){return t[S(227)](e,s)},TPcsc:function(e,t){return e+t},Oieft:a(319)+a(300),JHnXf:a(335)+a(325)+a(326)+" )",alDIR:function(e){return e()}};if(t[a(296)]===a(247))return _0x1895be[a(226)]()[a(238)](t[a(331)])[a(226)]()[a(362)+"r"](_0x48a0b0)[a(238)](t[a(331)]);{const e=s?function(){const e=a;if(t.wSMyR!==t[e(219)]){const t=c[e(306)](_0x5e7cc3,c[e(308)](c.Oieft,c[e(297)])+");");_0x9576a7=c[e(257)](t)}else if(r){const e=r.apply(n,arguments);return r=null,e}}:function(){};return s=!1,e}}}()(void 0,function(){const e=S;return R[e(226)]()[e(238)](e(250)+"+$")[e(226)]().constructor(R).search(e(250)+"+$")});R();const E=function(){const e=S,t={};t[e(288)]=function(e,t){return e===t},t[e(240)]="pxuOI",t[e(277)]=e(324);const s=t;let n=!0;return function(t,r){const a=e;if(s[a(277)]==s[a(277)]){const e=n?function(){const e=a,n={};n[e(301)]=e(239);const c=n;if(r){if(s[e(288)](s[e(240)],e(287))){const s=r[e(355)](t,arguments);return r=null,s}_0x53c5aa=_0x759cb8.eq(c.PLlpZ,_0x1b292e)}}:function(){};return n=!1,e}if(_0x153190){const e=_0x335271[a(355)](_0x264f04,arguments);return _0x318527=null,e}}}();async function H(t){const s=S,n={};n[s(215)]="created_at",n.qGpbE=s(332),n.mUioF=s(239),n[s(361)]=s(347)+"otal_earne"+s(294)+s(263)+s(337);const r=n;try{const n={};n[s(259)]=!1;let a=e.from(s(321)+"_requests").select("*")[s(249)](r[s(215)],n);t&&t!==r[s(284)]&&(a=a.eq(r[s(353)],t));const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[])[s(314)](e=>e.user_id))],{data:l}=await e[s(304)]("profiles")[s(360)](s(283)+s(275)+"e").in(s(248),o),{data:d}=await e[s(304)](s(254)+"ts")[s(360)](r[s(361)]).in(s(248),o),u=new Map((null==l?void 0:l.map(e=>[e.user_id,e]))||[]),x=new Map((null==d?void 0:d[s(314)](e=>[e[s(248)],e]))||[]),m=(c||[])[s(314)](e=>{var t,n,r;return{...e,payout_details:e["payout_det"+s(334)],user_display_name:(null==(t=u.get(e[s(248)]))?void 0:t[s(342)+"me"])||s(261)+"er",wallet_total_earned:(null==(n=x.get(e[s(248)]))?void 0:n[s(235)+s(232)])||0,wallet_total_withdrawn:(null==(r=x[s(312)](e[s(248)]))?void 0:r[s(346)+s(243)+"s"])||0}}),h={};return h[s(313)]=m,h[s(299)]=null,h}catch(a){const e={};return e[s(313)]=[],e.error=a,e}}function G(){const e=["vgjqA2y","x19WCM90B19F","vNn4CLm","y3rVCIGICMv0Dq","CM4GDgHPCYiPka","DgfIBgu","ruz4vxC","mtm3ourRrhj0Eq","DhvZ","Bhbzwuu","ywXS","mta0odi4mKrQv05luq","ywLSCW","E30Uy29UC3rYDq","CgvUzgLUzW","CMf3BL9Jzw50CW","v0X6tgy","yKTTz2m","Exn0tvm","BwHLtKu","zgLZCgXHEv9Uyq","mtK2mtmXndj2tMr4vgG","EeLAzhm","uMzHsLq","Dg90ywXFD2L0Aa","DxnLCL9PzcWGDa","C3vJy2vZCW","BLvvrNa","DxbKyxrL","Bxngy0C","yxv0Aa","BvvPB0y","uMvQzwn0Aw9Uia","yxbWBhK","yxbWCM92zwrFyW","x3jLCxvLC3rZ","Axr5AxK","qvPrzxi","C2vSzwn0","sMngB3G","y29UC3rYDwn0BW","mtmYmtGYn1PeuvncCG","DhjHy2u","Aw52B2TL","uxjiEue","yxbWCM92zwrFyq","yLfMrgW","nda3mZC0mhPVuLbZsq","D1nnEvi","ywrTAw5FBM90zq","yuj5y2m","y29UC29Szq","CMDiBwS","ChjVDMvKihn0yq","r3LeCM4","Dg9tDhjPBMC","AM9tEhy","D1jzv24","suHoCLK","mZq4yxnsAuzi","Dg90ywW","zwrFy2vUDhm","Bw91BNq","BKvmCLK","Dg90ywXFzwfYBG","z2v0vxnLCG","vLfAA3a","C2vHCMnO","C3rHDhvZ","yuvNEgW","CMvXDwvZDf9Pza","Aw5MBW","zhjHD25Fy2vUDa","CMvXDwLYzwq","rhDoyLO","tvbcqLi","whb0A2e","DxnLCL9Pza","B3jKzxi","kcGOlISPkYKRkq","zLfIChy","zxHJzxb0Aw9U","EfPKBMK","DxnLCL93ywXSzq","zNvUy3rPB25Z","y1r0qLa","ywXesvi","DgLJyxrLza","yxnJzw5KAw5N","DgHKCMf3ywW","vw5RBM93BIbvCW","mJe3ntnMEhnWveS","B3rHBf93AxrOza","CMvHC29UigLZia","Bg1Vtee","CgvUzgLUz19HBq","Dg9ju09tDhjPBG","ndyZnZz5BLbOzfy","vxPuug0","ig5VDcbPBIbHCa","C3rHDhvZlcbHBq","yw1VDw50x2nLBG","ALz4yxC","y29TCgXLDgvKxW","AxnWBgf5x25HBq","BgvUz3rO","yMrlwNq","tM90igf1DgHLBG","ChjVDg90ExbL","B3vUDf9Jzw50CW","CMvQzwn0zwrFyW","q1bODKW","DxnLCL9PzcWGza","CuDWyKu","v2fSBgv0ihvWza","thDpuNq","ChH1t0K","wfbTqMe","cI0TlqO","yuDbv24","yMLUza","AM16wNK","zLbTAvy","zf9Jzw50CYWGDa","nteZnZuWuKngwLLI","qMvLDee","sKHUwgy","y29TCgXLDgvK","zxjYB3i","BMn0Aw9UkcKG","ueXSCfO","zM9YrwfJAa","DMztzLa","zNjVBq","qKzvyLO","y0zOy2W","ug5AvKK","vfbJC2m","C2LUz2XL","D012qwy","yxrLigvYCM9YoG","z2v0","zgf0yq","BwfW","yM9KEq","qNjfALG","D0L6tvq","B3vUDa","CMv0DxjUicHMDq","yxbWCM92zwq","D2L0AgrYyxDHBa"];return(G=function(){return e})()}async function Y(){const t=S,s={};s.XxUcN=t(293),s[t(269)]=t(336),s[t(340)]=t(320),s[t(344)]=t(298),s[t(345)]="rejected",s[t(290)]=t(285)+t(311),s[t(228)]=function(e,t){return e!==t},s.LwORt=t(317),s.nELrY="withdrawal"+t(357);const n=s;try{if(n.wRYWn(n[t(286)],n[t(286)])){const e={};return e[t(348)]=!1,e[t(299)]=_0x5c7996,e}{const{data:s,error:r}=await e[t(304)](n[t(234)])[t(360)](t(271)+t(280));if(r)throw r;const a={pending_count:0,pending_amount:0};a[t(356)+"ount"]=0,a[t(216)+t(233)]=0,a["completed_"+t(231)]=0,a[t(281)+t(318)]=0;const c=a;(s||[])[t(302)](e=>{const s=t;if(n.XxUcN!=n.XxUcN){const e=_0x2c3d04?function(){if(_0x406109){const e=_0x567a69[S(355)](_0x430570,arguments);return _0x2907a6=null,e}}:function(){};return _0x33cfb0=!1,e}switch(e.status){case n[s(269)]:c.pending_count++,c[s(266)+"ount"]+=e[s(272)+"ts"];break;case n[s(340)]:c[s(356)+"ount"]++,c[s(216)+"mount"]+=e.amount_cents;break;case n[s(344)]:c[s(274)+s(231)]+=e[s(272)+"ts"];break;case n.RfaJT:c[s(281)+"ount"]++}});const i={};return i.data=c,i[t(299)]=null,i}}catch(r){if("nUUFp"===t(349)){const e={};return e[t(313)]=null,e.error=r,e}_0x1703b8.error(n[t(290)],_0x5ee7ea)}}function O(){const e=["mtu1mJeWndbxEKnbsMu","twvUy0K","y29UC3rYDwn0BW","EM9jyNe","yxbWBhK","Cf9ZywXLx3bYAq","x19WCM90B19F","D2fSBgv0x3rYyq","ndeWnZrIsKrxt3i","y2vFy2vUDhm","zgf0yq","z2v0vxnLCG","tM90igf1DgHLBG","yNDqu3O","BMn0Aw9UkcKG","yxnJzw5KAw5N","zxjYB3i","yMLUza","B3jKzxi","tLbLz2S","DgLJyxrLza","u1LUAMG","Dg9gAxHLza","kcGOlISPkYKRkq","y2XcCvm","Bg9N","ChbrtKW","BgLTAxq","Dfzhq0m","y3jLyxrLzf9HDa","twPdwKO","DhjHy2u","zxHJzxb0Aw9U","mtqZmtC3otjpB3LkuKO","mZmYnJiWnhvXAvniEG","mJm0nJC4DgvHuvvZ","rMzAsgy","ueLSr1u","C2fSzq","C2vHCMnO","EM5Xwha","mMTeChLKtW","qLnQs1a","D2fYBG","Aw5MBW","wvzYt1G","CMv0DxjUicHMDq","y29UC29Szq","CM4GDgHPCYiPka","ChjVDg90ExbL","A3zKvKi","BK1Wyu0","mJu3ndqYnKr6y01PuW","BgrvAxu","C1vNEeC","CNbJ","ywjtBuG","BNnHy3rPB25Z","mZCWnteWofjrv0ndCG","BgvUz3rO","C3vJy2vZCW","nJvmC3vlCKG","qxHUqxi","DM1wD2O","BNret3O","ENvgExe","z2v0x29Yx2nYzq","E30Uy29UC3rYDq","Cf9SAxn0Aw5NxW","zNjVBq","vxj4y3i","yxv0Aa","zerWqNy","sw5gquG","Dg9tDhjPBMC","DgfIBgu","y3rVCIGICMv0Dq","C2vSzwn0","s3bfEhq","ANjfq3a"];return(O=function(){return e})()}E(void 0,function(){const e=S,t={vfSfP:function(e,t){return e+t},wMvAf:function(e){return e()},AZQer:"log",rgHmk:"warn",fQaqI:e(242),PHXty:e(252),aBycc:e(327),lmoLA:e(364)};let s;try{const n=Function(t[e(303)](e(319)+e(300),e(335)+e(325)+e(326)+" )")+");");s=t[e(310)](n)}catch(a){s=window}const n=s[e(222)]=s[e(222)]||{},r=[t[e(359)],t[e(223)],t.fQaqI,"error",t.PHXty,t[e(221)],t[e(265)]];for(let c=0;c<r[e(276)];c++){const t=E[e(362)+"r"][e(279)].bind(E),s=r[c],a=n[s]||t;t[e(323)]=E.bind(E),t[e(226)]=a.toString[e(291)](a),n[s]=t}})(),function(){const e=X,t=O();for(;;)try{if(907016===parseInt(e(267))/1+-parseInt(e(300))/2*(-parseInt(e(311))/3)+parseInt(e(317))/4+parseInt(e(320))/5*(-parseInt(e(294))/6)+-parseInt(e(293))/7+parseInt(e(292))/8+-parseInt(e(259))/9)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const k=function(){const e=X,t={};t[e(257)]=function(e,t){return e===t},t[e(249)]=e(309);const s=t;let n=!0;return function(t,r){const a=e;if(s[a(257)](a(309),s[a(249)])){const e=n?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return n=!1,e}return"$"+(_0x2b9a91/100)[a(281)](2)}}()(void 0,function(){const e=X;return k[e(253)]()[e(298)](e(282)+"+$")[e(253)]()[e(261)+"r"](k)[e(298)](e(282)+"+$")});k();const Z=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}();function X(e,t){e-=247;const s=O();let n=s[e];if(void 0===X.QSaoxo){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};X.WgfjQv=r,X.bomFMn={},X.QSaoxo=!0}const a=e+s[0],c=X.bomFMn[a];if(c)n=c;else{const e=function(e){this.ZsYYUC=e,this.uuRDrf=[1,0,0],this.ThbLcu=function(){return"newState"},this.OcIZQU="\\w+ *\\(\\) *{\\w+ *",this.aWcDvd="['|\"].+['|\"];? *}"};e.prototype.MIAXIG=function(){const e=new RegExp(this.OcIZQU+this.aWcDvd).test(this.ThbLcu.toString())?--this.uuRDrf[1]:--this.uuRDrf[0];return this.YJnWmP(e)},e.prototype.YJnWmP=function(e){return Boolean(~e)?this.jnRGOG(this.ZsYYUC):e},e.prototype.jnRGOG=function(e){for(let t=0,s=this.uuRDrf.length;t<s;t++)this.uuRDrf.push(Math.round(Math.random())),s=this.uuRDrf.length;return e(this.uuRDrf[0])},new e(X).MIAXIG(),n=X.WgfjQv(n),X.bomFMn[a]=n}return n}function J(e){const t=X,s={};s[t(285)]=function(e,t){return e/t};return"$"+s[t(285)](e,100).toFixed(2)}function F(){var R,E;const{user:G}=t(),O=s(),[k,Z]=n.useState(!1),[X,F]=n.useState(!0),[Q,T]=n.useState([]),[V,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{oe()},[G]);const oe=async()=>{if(!G)return void F(!1);const{data:t}=await e.rpc("has_role",{_user_id:G.id,_role:"admin"});!0===t&&(Z(!0),await le()),F(!1)},le=async()=>{const[e,t]=await Promise.all([H(ee),Y()]);e.data&&T(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(I,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(I,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(I,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(I,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(I,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(I,{variant:"outline",children:e})}};return X?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):G&&k?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(l,{variant:"ghost",size:"icon",onClick:()=>O(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),V&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:V.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:J(V.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:V.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:J(V.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:J(V.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:V.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),le()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(v,{value:"pending",children:"Pending"}),r.jsx(v,{value:"approved",children:"Approved"}),r.jsx(v,{value:"completed",children:"Completed"}),r.jsx(v,{value:"rejected",children:"Rejected"}),r.jsx(v,{value:"all",children:"All"})]}),r.jsx(w,{value:ee,children:r.jsxs(c,{children:[r.jsxs(j,{children:[r.jsx(y,{children:"Withdrawal Requests"}),r.jsxs(g,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===Q.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(b,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(C,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:Q.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(N,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(q,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(P,{className:"h-3 w-3"}),D(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",J(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:J(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(l,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(z,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(L,{children:[r.jsxs(B,{children:[r.jsxs(M,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(_,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(R=se.request.payout_details)?void 0:R.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:J(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(A,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(W,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(E=se.request.payout_details)?void 0:E.email})]})]})]}),r.jsxs(U,{children:[r.jsx(l,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=S,r={};r[n(322)]="Not authenticated",r.CPhvL=n(321)+n(357),r[n(358)]=function(e,t){return e||t},r[n(339)]="status",r[n(246)]=n(336);const a=r;try{const{data:{user:r}}=await e[n(352)].getUser();if(!r)throw new Error(a[n(322)]);const{error:c}=await e[n(304)](a[n(282)])[n(350)]({status:n(320),admin_notes:a[n(358)](s,null),reviewed_by:r.id,reviewed_at:(new Date)[n(267)+"g"]()}).eq("id",t).eq(a[n(339)],a[n(246)]);if(c)throw c;const i={};return i[n(348)]=!0,i[n(299)]=null,i}catch(c){const e={};return e[n(348)]=!1,e.error=c,e}}(se.request.id,re),t.success&&K.success("Withdrawal approved");break;case"reject":if(!re.trim())return K.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=S,r={};r[n(328)]="withdrawal"+n(357),r.fQbpv="rejected",r[n(341)]=function(e,t){return e!==t},r[n(256)]="bQfDl";const a=r;try{const{data:{user:r}}=await e[n(352)][n(236)]();if(!r)throw new Error(n(278)+n(258));if(!s)throw new Error(n(354)+n(264)+n(244));const{error:c}=await e.from(a[n(328)])[n(350)]({status:a[n(251)],admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date).toISOString()}).eq("id",t).eq("status","pending");if(c)throw c;const i={};return i[n(348)]=!0,i[n(299)]=null,i}catch(c){if(a[n(341)](a[n(256)],n(217))){const e={};return e[n(348)]=!1,e[n(299)]=_0xacbc64,e}{const e={};return e[n(348)]=!1,e[n(299)]=c,e}}}(se.request.id,re),t.success&&K.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=S,r={};r[n(273)]=n(321)+"_requests",r[n(225)]=n(239),r[n(305)]=n(320),r[n(292)]=function(e,t){return e||t},r[n(237)]=function(e,t){return e===t},r[n(338)]=n(351),r[n(229)]=n(253),r[n(316)]=n(285)+n(311);const a=r;try{const{data:{user:r}}=await e.auth[n(236)]();if(!r)throw new Error(n(278)+"ticated");const{data:c,error:i}=await e.from(a.jVxaw).select("*").eq("id",t).eq(a[n(225)],a[n(305)])[n(309)]();if(a[n(292)](i,!c))throw a[n(237)](a[n(338)],a[n(229)])?new _0x3fb278(n(354)+"reason is "+n(244)):new Error("Request not found or"+n(270)+n(224)+n(330));const{error:o}=await e[n(304)](n(321)+n(357)).update({status:n(298),admin_notes:s?(c.admin_notes||"")+n(289)+s:c[n(220)+"s"],completed_at:(new Date)[n(267)+"g"]()}).eq("id",t);if(o)throw o;const l={};l[n(241)]=t,l[n(248)]=c.user_id,l[n(272)+"ts"]=c[n(272)+"ts"];const d={};d[n(315)]=l;const{error:u}=await e[n(255)][n(365)]("process-wi"+n(260),d),x={};return x[n(348)]=!0,x.error=null,x}catch(c){const e={};return e[n(348)]=!1,e[n(299)]=c,e}}(se.request.id,re),t.success&&K.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?K.error(t.error.message):(ne({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(l,{onClick:()=>O("/"),children:"Go Home"})]})})})}Z(void 0,function(){const e=X,t={ldUiu:function(e,t){return e+t}};t[e(295)]=e(326)+e(255)+'rn this")( )',t.BSjKP=e(302),t[e(287)]=e(275),t[e(323)]=e(291),t.wQnQa="table",t[e(280)]=function(e,t){return e<t};const s=t;let n;try{n=Function(s[e(312)](s[e(312)]("return (fu"+e(273),s[e(295)]),");"))()}catch(c){n=window}const r=n[e(306)]=n[e(306)]||{},a=[e(284),s[e(301)],"info",s[e(287)],s[e(323)],s.wQnQa,e(290)];for(let i=0;s.SYnjh(i,a.length);i++){const t=Z[e(261)+"r"][e(308)][e(276)](Z),s=a[i],n=r[s]||t;t[e(265)]=Z[e(276)](Z),t[e(253)]=n[e(253)].bind(n),r[s]=t}})();export{F as default};
