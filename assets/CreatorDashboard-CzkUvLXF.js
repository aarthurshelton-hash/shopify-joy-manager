const n='import React, { useEffect, useState } from \'react\';\nimport { motion } from \'framer-motion\';\nimport { useQuery } from \'@tanstack/react-query\';\nimport { Link, Navigate } from \'react-router-dom\';\nimport { \n  DollarSign, \n  TrendingUp, \n  Eye, \n  ShoppingBag, \n  Calendar,\n  ArrowLeft,\n  Wallet,\n  PieChart,\n  BarChart3,\n  Clock,\n  Sparkles,\n  Image,\n  Download,\n  Gift,\n  ChevronRight,\n  CheckCircle2,\n  AlertCircle\n} from \'lucide-react\';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \'@/components/ui/card\';\nimport { Badge } from \'@/components/ui/badge\';\nimport { Progress } from \'@/components/ui/progress\';\nimport { Button } from \'@/components/ui/button\';\nimport { Separator } from \'@/components/ui/separator\';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \'@/components/ui/tabs\';\nimport { supabase } from \'@/integrations/supabase/client\';\nimport { useAuth } from \'@/hooks/useAuth\';\nimport { MEMBERSHIP_ECONOMICS } from \'@/lib/visualizations/visionScoring\';\nimport { Header } from \'@/components/shop/Header\';\nimport { Footer } from \'@/components/shop/Footer\';\nimport { useRandomGameArt } from \'@/hooks/useRandomGameArt\';\nimport { RoyaltyCalculator } from \'@/components/calculator/RoyaltyCalculator\';\nimport { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, BarChart, Bar } from \'recharts\';\n\ninterface VisionStats {\n  id: string;\n  title: string;\n  royaltyCentsEarned: number;\n  royaltyOrdersCount: number;\n  printRevenueCents: number;\n  printOrderCount: number;\n  viewCount: number;\n  downloadCount: number;\n  totalScore: number;\n}\n\ninterface PortfolioStats {\n  totalRoyaltyCents: number;\n  totalRoyaltyOrders: number;\n  totalPrintRevenue: number;\n  totalPrintOrders: number;\n  totalViews: number;\n  totalDownloads: number;\n  visionCount: number;\n  visions: VisionStats[];\n}\n\n// Mock monthly data for charts (would be real in production)\nconst generateMonthlyData = (totalRoyalty: number) => {\n  const months = [\'Jul\', \'Aug\', \'Sep\', \'Oct\', \'Nov\', \'Dec\', \'Jan\'];\n  const baseAmount = totalRoyalty / 7;\n  \n  return months.map((month, i) => ({\n    month,\n    royalties: Math.floor(baseAmount * (0.5 + Math.random()) * (1 + i * 0.15)),\n    orders: Math.floor(Math.random() * 10 + 2),\n  }));\n};\n\nconst CreatorDashboard: React.FC = () => {\n  const { user, isLoading: authLoading } = useAuth();\n  const backgroundImages = useRandomGameArt(3);\n  const valueAppreciationPercent = MEMBERSHIP_ECONOMICS.valueAppreciationRate * 100;\n  \n  const { data: stats, isLoading } = useQuery({\n    queryKey: [\'creator-dashboard-stats\', user?.id],\n    queryFn: async () => {\n      if (!user) return null;\n      \n      // Get user\'s visualizations\n      const { data: visualizations } = await supabase\n        .from(\'saved_visualizations\')\n        .select(\'id, title\')\n        .eq(\'user_id\', user.id);\n\n      if (!visualizations || visualizations.length === 0) {\n        return {\n          totalRoyaltyCents: 0,\n          totalRoyaltyOrders: 0,\n          totalPrintRevenue: 0,\n          totalPrintOrders: 0,\n          totalViews: 0,\n          totalDownloads: 0,\n          visionCount: 0,\n          visions: [],\n        } as PortfolioStats;\n      }\n\n      const vizIds = visualizations.map(v => v.id);\n\n      // Get vision scores\n      const { data: scores } = await supabase\n        .from(\'vision_scores\')\n        .select(\'*\')\n        .in(\'visualization_id\', vizIds);\n\n      const visions: VisionStats[] = visualizations.map(viz => {\n        const score = scores?.find(s => s.visualization_id === viz.id);\n        return {\n          id: viz.id,\n          title: viz.title,\n          royaltyCentsEarned: score?.royalty_cents_earned || 0,\n          royaltyOrdersCount: score?.royalty_orders_count || 0,\n          printRevenueCents: score?.print_revenue_cents || 0,\n          printOrderCount: score?.print_order_count || 0,\n          viewCount: score?.view_count || 0,\n          downloadCount: (score?.download_gif_count || 0) + (score?.download_hd_count || 0),\n          totalScore: score?.total_score || 0,\n        };\n      });\n\n      const totals = visions.reduce((acc, v) => ({\n        totalRoyaltyCents: acc.totalRoyaltyCents + v.royaltyCentsEarned,\n        totalRoyaltyOrders: acc.totalRoyaltyOrders + v.royaltyOrdersCount,\n        totalPrintRevenue: acc.totalPrintRevenue + v.printRevenueCents,\n        totalPrintOrders: acc.totalPrintOrders + v.printOrderCount,\n        totalViews: acc.totalViews + v.viewCount,\n        totalDownloads: acc.totalDownloads + v.downloadCount,\n      }), {\n        totalRoyaltyCents: 0,\n        totalRoyaltyOrders: 0,\n        totalPrintRevenue: 0,\n        totalPrintOrders: 0,\n        totalViews: 0,\n        totalDownloads: 0,\n      });\n\n      return {\n        ...totals,\n        visionCount: visualizations.length,\n        visions: visions.sort((a, b) => b.royaltyCentsEarned - a.royaltyCentsEarned),\n      } as PortfolioStats;\n    },\n    enabled: !!user,\n    staleTime: 60000,\n  });\n\n  // Redirect if not logged in\n  if (!authLoading && !user) {\n    return <Navigate to="/" replace />;\n  }\n\n  const royaltyDollars = (stats?.totalRoyaltyCents || 0) / 100;\n  const totalRevenueDollars = (stats?.totalPrintRevenue || 0) / 100;\n  const platformDollars = totalRevenueDollars - royaltyDollars;\n  const monthlyData = generateMonthlyData(royaltyDollars);\n  \n  // Payout simulation (in production, this would be real)\n  const pendingPayout = royaltyDollars * 0.3; // Mock: 30% pending\n  const nextPayoutDate = new Date();\n  nextPayoutDate.setDate(1);\n  nextPayoutDate.setMonth(nextPayoutDate.getMonth() + 1);\n\n  return (\n    <div className="min-h-screen bg-background">\n      <Header />\n      \n      <main className="container mx-auto px-4 py-8">\n        {/* Back Navigation */}\n        <Link \n          to="/my-visions" \n          className="inline-flex items-center gap-2 text-muted-foreground hover:text-primary mb-6 transition-colors"\n        >\n          <ArrowLeft className="h-4 w-4" />\n          Back to My Visions\n        </Link>\n\n        {/* Hero Section */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className="relative overflow-hidden rounded-2xl p-8 mb-8 border border-primary/20 bg-gradient-to-br from-primary/10 to-green-500/10"\n        >\n          {backgroundImages[0] && (\n            <div \n              className="absolute inset-0 opacity-[0.1] bg-cover bg-center dashboard-bg-0"\n              style={{ \'--bg-image\': `url(${backgroundImages[0]})` } as React.CSSProperties}\n            />\n          )}\n          <div className="absolute inset-0 bg-gradient-to-br from-background/70 to-background/90" />\n          \n          <div className="relative z-10">\n            <div className="flex items-center gap-3 mb-4">\n              <div className="p-3 rounded-full bg-primary/20">\n                <Wallet className="h-6 w-6 text-primary" />\n              </div>\n              <div>\n                <h1 className="text-3xl font-bold">Creator Dashboard</h1>\n                <p className="text-muted-foreground">Track your earnings and portfolio performance</p>\n              </div>\n            </div>\n            \n            {/* Main Stats Grid */}\n            <div className="grid sm:grid-cols-2 lg:grid-cols-4 gap-4 mt-6">\n              <div className="p-4 rounded-xl bg-background/50 border border-border/50">\n                <div className="flex items-center gap-2 text-muted-foreground mb-2">\n                  <DollarSign className="h-4 w-4" />\n                  <span className="text-sm">Total Royalties</span>\n                </div>\n                <p className="text-3xl font-bold text-green-500">${royaltyDollars.toFixed(2)}</p>\n                <p className="text-xs text-muted-foreground mt-1">Lifetime earnings</p>\n              </div>\n              \n              <div className="p-4 rounded-xl bg-background/50 border border-border/50">\n                <div className="flex items-center gap-2 text-muted-foreground mb-2">\n                  <ShoppingBag className="h-4 w-4" />\n                  <span className="text-sm">Orders by Others</span>\n                </div>\n                <p className="text-3xl font-bold">{stats?.totalRoyaltyOrders || 0}</p>\n                <p className="text-xs text-muted-foreground mt-1">Prints sold</p>\n              </div>\n              \n              <div className="p-4 rounded-xl bg-background/50 border border-border/50">\n                <div className="flex items-center gap-2 text-muted-foreground mb-2">\n                  <Image className="h-4 w-4" />\n                  <span className="text-sm">Portfolio Size</span>\n                </div>\n                <p className="text-3xl font-bold">{stats?.visionCount || 0}</p>\n                <p className="text-xs text-muted-foreground mt-1">Visions owned</p>\n              </div>\n              \n              <div className="p-4 rounded-xl bg-background/50 border border-border/50">\n                <div className="flex items-center gap-2 text-muted-foreground mb-2">\n                  <Eye className="h-4 w-4" />\n                  <span className="text-sm">Total Views</span>\n                </div>\n                <p className="text-3xl font-bold">{stats?.totalViews || 0}</p>\n                <p className="text-xs text-muted-foreground mt-1">Across all visions</p>\n              </div>\n            </div>\n          </div>\n        </motion.div>\n\n        <Tabs defaultValue="overview" className="space-y-6">\n          <TabsList className="grid w-full grid-cols-3 lg:w-auto lg:inline-grid">\n            <TabsTrigger value="overview" className="gap-2">\n              <BarChart3 className="h-4 w-4" />\n              Overview\n            </TabsTrigger>\n            <TabsTrigger value="earnings" className="gap-2">\n              <DollarSign className="h-4 w-4" />\n              Earnings\n            </TabsTrigger>\n            <TabsTrigger value="calculator" className="gap-2">\n              <Sparkles className="h-4 w-4" />\n              Calculator\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Overview Tab */}\n          <TabsContent value="overview" className="space-y-6">\n            <div className="grid lg:grid-cols-3 gap-6">\n              {/* Earnings Chart */}\n              <Card className="lg:col-span-2">\n                <CardHeader>\n                  <CardTitle className="flex items-center gap-2">\n                    <TrendingUp className="h-5 w-5 text-primary" />\n                    Earnings Trend\n                  </CardTitle>\n                  <CardDescription>Monthly royalty earnings over time</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className="h-[250px]">\n                    <ResponsiveContainer width="100%" height="100%">\n                      <AreaChart data={monthlyData}>\n                        <defs>\n                          <linearGradient id="colorRoyalties" x1="0" y1="0" x2="0" y2="1">\n                            <stop offset="5%" stopColor="hsl(var(--primary))" stopOpacity={0.3}/>\n                            <stop offset="95%" stopColor="hsl(var(--primary))" stopOpacity={0}/>\n                          </linearGradient>\n                        </defs>\n                        <CartesianGrid strokeDasharray="3 3" className="stroke-border/30" />\n                        <XAxis dataKey="month" className="text-xs" />\n                        <YAxis className="text-xs" tickFormatter={(v) => `$${v}`} />\n                        <Tooltip \n                          contentStyle={{ \n                            backgroundColor: \'hsl(var(--card))\', \n                            border: \'1px solid hsl(var(--border))\',\n                            borderRadius: \'8px\'\n                          }}\n                          formatter={(value: number) => [`$${value.toFixed(2)}`, \'Royalties\']}\n                        />\n                        <Area \n                          type="monotone" \n                          dataKey="royalties" \n                          stroke="hsl(var(--primary))" \n                          fillOpacity={1} \n                          fill="url(#colorRoyalties)" \n                        />\n                      </AreaChart>\n                    </ResponsiveContainer>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Value Realization */}\n              <Card className="relative overflow-hidden">\n                {backgroundImages[1] && (\n                  <div \n                    className="absolute inset-0 opacity-[0.08] bg-cover bg-center dashboard-bg-1"\n                    style={{ \'--bg-image\': `url(${backgroundImages[1]})` } as React.CSSProperties}\n                  />\n                )}\n                <div className="absolute inset-0 bg-gradient-to-br from-background/90 to-background/95" />\n                <CardHeader className="relative z-10">\n                  <CardTitle className="flex items-center gap-2">\n                    <Gift className="h-5 w-5 text-green-500" />\n                    Realize Your Value\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className="relative z-10 space-y-4">\n                  <div className="p-4 rounded-lg bg-green-500/10 border border-green-500/30">\n                    <p className="text-sm text-muted-foreground">Accrued Vision Value</p>\n                    <p className="text-2xl font-bold text-green-500">${pendingPayout.toFixed(2)}</p>\n                    <p className="text-xs text-muted-foreground mt-1">\n                      Transfer to another member to realize gains\n                    </p>\n                  </div>\n                  \n                  <div className="space-y-2">\n                    <p className="text-xs font-medium text-primary">How to realize value:</p>\n                    <div className="flex items-start gap-2 text-sm">\n                      <DollarSign className="h-4 w-4 text-primary shrink-0 mt-0.5" />\n                      <div>\n                        <span className="font-medium">Sell</span>\n                        <span className="text-muted-foreground"> — 5% platform fee, you receive 95%</span>\n                      </div>\n                    </div>\n                    <div className="flex items-start gap-2 text-sm">\n                      <Sparkles className="h-4 w-4 text-blue-500 shrink-0 mt-0.5" />\n                      <div>\n                        <span className="font-medium">Trade</span>\n                        <span className="text-muted-foreground"> — 5% fee when credits involved</span>\n                      </div>\n                    </div>\n                    <div className="flex items-start gap-2 text-sm">\n                      <Gift className="h-4 w-4 text-green-500 shrink-0 mt-0.5" />\n                      <div>\n                        <span className="font-medium">Gift</span>\n                        <span className="text-muted-foreground"> — No fees, recipient gets full value</span>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <Separator />\n                  \n                  <div className="p-3 rounded-lg bg-muted/30 border border-border/50">\n                    <div className="flex items-start gap-2 text-xs">\n                      <AlertCircle className="h-3.5 w-3.5 text-muted-foreground shrink-0 mt-0.5" />\n                      <p className="text-muted-foreground">\n                        <strong className="text-foreground">No automatic payouts.</strong> Your vision\'s value grows from print orders. Transfer ownership to convert value to credits.\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Top Performing Visions */}\n            <Card>\n              <CardHeader>\n                <CardTitle className="flex items-center gap-2">\n                  <Sparkles className="h-5 w-5 text-primary" />\n                  Top Performing Visions\n                </CardTitle>\n                <CardDescription>Your visions ranked by royalty earnings</CardDescription>\n              </CardHeader>\n              <CardContent>\n                {stats?.visions && stats.visions.length > 0 ? (\n                  <div className="space-y-3">\n                    {stats.visions.slice(0, 5).map((vision, i) => (\n                      <Link\n                        key={vision.id}\n                        to={`/visualization/${vision.id}`}\n                        className="flex items-center gap-4 p-3 rounded-lg bg-background/50 border border-border/50 hover:border-primary/50 transition-colors"\n                      >\n                        <div className="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center font-bold text-primary">\n                          {i + 1}\n                        </div>\n                        <div className="flex-1 min-w-0">\n                          <p className="font-medium truncate">{vision.title}</p>\n                          <div className="flex items-center gap-4 text-xs text-muted-foreground">\n                            <span className="flex items-center gap-1">\n                              <Eye className="h-3 w-3" />\n                              {vision.viewCount} views\n                            </span>\n                            <span className="flex items-center gap-1">\n                              <ShoppingBag className="h-3 w-3" />\n                              {vision.royaltyOrdersCount} orders\n                            </span>\n                          </div>\n                        </div>\n                        <div className="text-right">\n                          <p className="font-bold text-green-500">${(vision.royaltyCentsEarned / 100).toFixed(2)}</p>\n                          <p className="text-xs text-muted-foreground">earned</p>\n                        </div>\n                        <ChevronRight className="h-4 w-4 text-muted-foreground" />\n                      </Link>\n                    ))}\n                  </div>\n                ) : (\n                  <div className="text-center py-8">\n                    <Image className="h-12 w-12 mx-auto text-muted-foreground/50 mb-4" />\n                    <p className="text-muted-foreground">No visions yet</p>\n                    <Button asChild className="mt-4">\n                      <Link to="/">Create Your First Vision</Link>\n                    </Button>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Earnings Tab */}\n          <TabsContent value="earnings" className="space-y-6">\n            <div className="grid lg:grid-cols-2 gap-6">\n              {/* Revenue Breakdown */}\n              <Card className="relative overflow-hidden">\n                {backgroundImages[2] && (\n                  <div \n                    className="absolute inset-0 opacity-[0.08] bg-cover bg-center dashboard-bg-2"\n                    style={{ \'--bg-image\': `url(${backgroundImages[2]})` } as React.CSSProperties}\n                  />\n                )}\n                <div className="absolute inset-0 bg-gradient-to-br from-background/90 to-background/95" />\n                <CardHeader className="relative z-10">\n                  <CardTitle className="flex items-center gap-2">\n                    <PieChart className="h-5 w-5 text-primary" />\n                    Revenue Breakdown\n                  </CardTitle>\n                  <CardDescription>How print revenue is distributed</CardDescription>\n                </CardHeader>\n                <CardContent className="relative z-10 space-y-4">\n                  <div className="space-y-3">\n                    <div className="flex items-center justify-between">\n                      <span className="text-sm font-medium flex items-center gap-2">\n                        <div className="w-3 h-3 rounded-full bg-green-500" />\n                        Your Value Appreciation ({valueAppreciationPercent}%)\n                      </span>\n                      <span className="font-bold text-green-500">${royaltyDollars.toFixed(2)}</span>\n                    </div>\n                    <div className="flex h-4 rounded-full overflow-hidden bg-muted/30">\n                      <div \n                        className="bg-green-500 transition-all value-bar"\n                        style={{ \'--bar-width\': `${valueAppreciationPercent}%` } as React.CSSProperties}\n                      />\n                      <div \n                        className="bg-muted-foreground/30 transition-all platform-bar"\n                        style={{ \'--bar-width\': `${100 - valueAppreciationPercent}%` } as React.CSSProperties}\n                      />\n                    </div>\n                    <div className="flex items-center justify-between">\n                      <span className="text-sm text-muted-foreground flex items-center gap-2">\n                        <div className="w-3 h-3 rounded-full bg-muted-foreground/30" />\n                        Platform & Fulfillment ({100 - valueAppreciationPercent}%)\n                      </span>\n                      <span className="text-muted-foreground">${platformDollars.toFixed(2)}</span>\n                    </div>\n                  </div>\n                  \n                  <Separator />\n                  \n                  <div className="flex items-center justify-between pt-2">\n                    <span className="font-medium">Total Revenue Generated</span>\n                    <span className="font-bold">${totalRevenueDollars.toFixed(2)}</span>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Orders Chart */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className="flex items-center gap-2">\n                    <ShoppingBag className="h-5 w-5 text-primary" />\n                    Orders Over Time\n                  </CardTitle>\n                  <CardDescription>Monthly print orders by others</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className="h-[200px]">\n                    <ResponsiveContainer width="100%" height="100%">\n                      <BarChart data={monthlyData}>\n                        <CartesianGrid strokeDasharray="3 3" className="stroke-border/30" />\n                        <XAxis dataKey="month" className="text-xs" />\n                        <YAxis className="text-xs" />\n                        <Tooltip \n                          contentStyle={{ \n                            backgroundColor: \'hsl(var(--card))\', \n                            border: \'1px solid hsl(var(--border))\',\n                            borderRadius: \'8px\'\n                          }}\n                        />\n                        <Bar dataKey="orders" fill="hsl(var(--primary))" radius={[4, 4, 0, 0]} />\n                      </BarChart>\n                    </ResponsiveContainer>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Economics Explainer */}\n            <Card className="border-green-500/30 bg-gradient-to-br from-green-500/5 to-emerald-500/5">\n              <CardHeader>\n                <CardTitle className="flex items-center gap-2">\n                  <Gift className="h-5 w-5 text-green-500" />\n                  How You Earn\n                </CardTitle>\n              </CardHeader>\n              <CardContent className="space-y-4">\n                <div className="grid sm:grid-cols-3 gap-4">\n                  <div className="p-4 rounded-lg bg-background/50 border border-border/50 text-center">\n                    <div className="w-10 h-10 mx-auto rounded-full bg-primary/10 flex items-center justify-center mb-3">\n                      <Image className="h-5 w-5 text-primary" />\n                    </div>\n                    <h4 className="font-medium mb-1">1. Create & Claim</h4>\n                    <p className="text-xs text-muted-foreground">\n                      Generate visualizations and claim ownership as a premium member\n                    </p>\n                  </div>\n                  \n                  <div className="p-4 rounded-lg bg-background/50 border border-border/50 text-center">\n                    <div className="w-10 h-10 mx-auto rounded-full bg-primary/10 flex items-center justify-center mb-3">\n                      <ShoppingBag className="h-5 w-5 text-primary" />\n                    </div>\n                    <h4 className="font-medium mb-1">2. Others Order Prints</h4>\n                    <p className="text-xs text-muted-foreground">\n                      Anyone can order prints of public visions from the marketplace\n                    </p>\n                  </div>\n                  \n                  <div className="p-4 rounded-lg bg-background/50 border border-border/50 text-center">\n                    <div className="w-10 h-10 mx-auto rounded-full bg-green-500/10 flex items-center justify-center mb-3">\n                      <DollarSign className="h-5 w-5 text-green-500" />\n                    </div>\n                    <h4 className="font-medium mb-1">3. Sell, Trade, or Gift</h4>\n                    <p className="text-xs text-muted-foreground">\n                      Value accrues from orders ({valueAppreciationPercent}% of profit). <strong>No automatic payouts</strong> — transfer ownership to realize gains.\n                    </p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Calculator Tab */}\n          <TabsContent value="calculator">\n            <RoyaltyCalculator />\n          </TabsContent>\n        </Tabs>\n      </main>\n      \n      <Footer />\n    </div>\n  );\n};\n\nexport default CreatorDashboard;';export{n as default};
