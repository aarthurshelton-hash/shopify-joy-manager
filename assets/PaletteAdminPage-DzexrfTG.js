import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as h,P as m,w as f,B as p,bM as w,cj as j,a9 as v,am as g,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as k,cu as B,b as P}from"./index-BsQTe2MU.js";!function(){const e=q,s=K();for(;;)try{if(229681===parseInt(e(384))/1*(-parseInt(e(407))/2)+parseInt(e(369))/3*(parseInt(e(350))/4)+-parseInt(e(411))/5+parseInt(e(426))/6*(parseInt(e(354))/7)+-parseInt(e(430))/8+parseInt(e(397))/9+parseInt(e(417))/10)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const D=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[q(438)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=q,s={};s[e(353)]=e(376)+"+$";const t=s;return D[e(413)]()[e(381)](e(376)+"+$")[e(413)]()[e(433)+"r"](D)[e(381)](t[e(353)])});D();const A=function(){let e=!0;return function(s,t){const n=q,r={};r[n(403)]=n(418);const a=r,i=e?function(){const e=n;if(t){if("NIDXd"===a[e(403)]){const s=_0x3e68f8?function(){if(_0x215ec9){const s=_0x5cc1e6[e(438)](_0x2cb0a1,arguments);return _0x34aa36=null,s}}:function(){};return _0x2e6d24=!1,s}{const n=t[e(438)](s,arguments);return t=null,n}}}:function(){};return e=!1,i}}();function q(e,s){e-=337;const t=K();let n=t[e];if(void 0===q.cSclPE){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};q.RnJWPC=r,q.WbzpcX={},q.cSclPE=!0}const a=e+t[0],i=q.WbzpcX[a];if(i)n=i;else{const e=function(e){this.HcrBML=e,this.xcfFnr=[1,0,0],this.xDuPIt=function(){return"newState"},this.yqyKrQ="\\w+ *\\(\\) *{\\w+ *",this.yGwYCi="['|\"].+['|\"];? *}"};e.prototype.fHOzzT=function(){const e=new RegExp(this.yqyKrQ+this.yGwYCi).test(this.xDuPIt.toString())?--this.xcfFnr[1]:--this.xcfFnr[0];return this.WGBrlk(e)},e.prototype.WGBrlk=function(e){return Boolean(~e)?this.IuDwZO(this.HcrBML):e},e.prototype.IuDwZO=function(e){for(let s=0,t=this.xcfFnr.length;s<t;s++)this.xcfFnr.push(Math.round(Math.random())),t=this.xcfFnr.length;return e(this.xcfFnr[0])},new e(q).fHOzzT(),n=q.RnJWPC(n),q.WbzpcX[a]=n}return n}function K(){const e=["zgDIzwy","A2LUzYbHzg1PBG","CuzpswO","E30Uy29UC3rYDq","CgfSzxr0zv9VDG","CeXtALO","C2f2zwrFDMLZDq","mZu5odCZmvPSvvn1Aq","DxbKyxrL","DhrLswq","ywHLEee","v21rrMK","uK9Zq0e","C1vNAKi","ihjVBgu6","zcb2Axn1ywXPEG","yxrH","nJy5nhr2Ag9LsW","EeDiCuK","u1PoALy","C3vMAwS","mZi2ndm1zKHHBhfW","zMLUza","Dg9tDhjPBMC","BMn0Aw9UkcKG","Bw9KAwzPzwrFyG","rxjYB3iGy291BG","mtm2nJe3mhPUDuPfsq","De9oCLu","rxjYB3iGy2HLyW","uKDXCKS","txjZqKW","CM4GDgHPCYiPka","rurevw0","s1f0qNK","BKXjAM8","otG5ntKYsuPLu1bN","EMHRDey","zMjdz0q","yMXHy2TFy29SBW","mJCYmZq0mfnSDer3wq","y29Kzq","CgfSzxr0zuLK","y29UC3rYDwn0BW","AufQy2i","zxjYB3i","DMvYC2LVBG","zNjVBq","yxbWBhK","yMLUza","B3jKzxi","z2fTzv9KyxrH","ywrTAw4","EvDWEuC","y3rVCIGICMv0Dq","BgLUA2vKugfSzq","x19WCM90B19F","D2HPDgvFy29SBW","ufnct2i","ChvUuNy","EufqwhK","AgfZx3jVBgu","Bg9N","DgfIBgu","mtjjqwf2Cu0","suP1sLe","CNbJ","ufPev1y","n05NsKjNrW","sevcwwS","zgvSzxrL","zgf0yq","tKLpweG","zxHJzxb0Aw9U","zxjYAwrLCW","D2HPDgu","u2vtEhy","CgfSzxr0zv9Pza","AefLA3u","yMXHy2S","ugjztfO","AwqSigDHBwvFza","yxrPB25ZoG","mJeXnZKXzNPkzM5o","tMD0y0m","ChjVDg90ExbL","uNj4ENu","DhjHy2u","sxbksNm","C2vSzwn0","kcGOlISPkYKRkq","zg1PBIbJAgvJAW","rKfvuum","zM5QB0i","yNP0Beq","C2vHCMnO","DKfAwvu","rxjYB3iGAw4Gyq","odnRCu5WDxq","y29UC29Szq","u2XTuK4","Aw9Uu3rHDgu","uuTbCNC","BgvUz3rO"];return(K=function(){return e})()}async function S(s,t,n,r){const a=q,i={};i[a(346)]="Error checking admin"+a(404),i[a(388)]=function(e,s){return e!==s},i.sufik="palette_overrides",i[a(423)]=function(e,s){return e+s},i[a(355)]="palette_id",i[a(400)]="TsxPl";const c=i;try{const{data:i}=await async function(s){const t=q,n={};n[t(409)]=t(363),n[t(402)]="PGRST116";const r=n;try{const{data:n,error:a}=await e.from(t(394)+t(360))[t(375)]("*").eq(r[t(409)],s).single();if(a&&a[t(431)]!==r[t(402)])throw a;const i={};return i[t(357)]=n,i.error=null,i}catch(a){const e={data:null};return e.error=a,e}}(s);if(i){if(c.QKArw(a(366),a(366)))return _0x11f5af[a(435)](c[a(346)],_0x1dfa63),!1;{const{error:o}=await e[a(437)](c[a(410)])[a(398)]({white_colors:t,black_colors:n,modified_by:r,version:c[a(423)](i[a(436)],1)}).eq(c[a(355)],s);if(o)throw o;return{error:null,version:c[a(423)](i.version,1)}}}if(a(362)==a(362)){const i={};i.palette_id=s,i.white_colors=t,i[a(429)+"rs"]=n,i[a(415)+"y"]=r,i[a(436)]=1;const{error:c}=await e[a(437)]("palette_ov"+a(360)).insert(i);if(c)throw c;const o={error:null};return o[a(436)]=1,o}{const e=_0xbb38f8[a(438)](_0x1be179,arguments);return _0x45f46c=null,e}}catch(o){if(a(390)===c.ahexA)return _0x4e81f5[a(413)]().search(a(376)+"+$")[a(413)]()[a(433)+"r"](_0x21b510)[a(381)](a(376)+"+$");{const e={};return e[a(435)]=o,e[a(436)]=0,e}}}async function _(s){const t=q,n={};n[t(378)]=t(396)+"alizations",n[t(434)]=function(e,s){return e===s},n[t(401)]=t(416)+"ting linke"+t(405)+t(368);const r=n;try{const{data:n,error:a}=await e[t(437)](r.FAUQC).select(t(367)+t(406));if(a)throw a;let i=0;for(const e of n||[]){const n=e[t(337)]["visualizat"+t(387)];((null==n?void 0:n[t(432)])===s||r[t(434)](null==n?void 0:n[t(341)+t(399)],s))&&i++}return i}catch(a){return 0}}A(void 0,function(){const e=q,s={mxNfv:e(370),BbMWz:e(372),yWpyG:function(e,s){return e(s)},fbCgD:"return (fu"+e(414),mEQQs:e(393)+e(340)+'rn this")( )',zhktF:function(e){return e()},dETFZ:e(435),KQtBy:e(359),IpJJs:e(349),RGqrK:e(373)},t=s[e(427)](function(){const t=e;if(s.mxNfv===s.BbMWz){const e={};return e[t(435)]=_0x3358eb,e}{let e;try{e=s[t(339)](Function,s[t(428)]+s.mEQQs+");")()}catch(n){e=window}return e}}),n=t[e(385)]=t.console||{},r=[e(348),"warn","info",s.dETFZ,s[e(424)],s[e(374)],s[e(420)]];for(let a=0;a<r[e(389)];a++){const s=A.constructor[e(371)][e(439)](A),t=r[a],i=n[t]||s;s[e(342)]=A[e(439)](A),s[e(413)]=i[e(413)].bind(i),n[t]=s}})();const H=["k","q","r","b","n","p"],M={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},I=()=>{var D,A,K,I;const{user:F}=s(),L=t(),[W,G]=n.useState(!1),[E,U]=n.useState(!0),[Y,X]=n.useState([]),[V,Z]=n.useState(null),[O,T]=n.useState(null),[J,Q]=n.useState({}),[R,$]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!F)return void L("/");if(!(await async function(s){const t=q,n={NIOXH:function(e,s){return e+s},fnjoB:"return (fu"+t(414),FYxXp:t(393)+t(340)+t(422)+" )",vAZYU:function(e,s){return e(s)},xGHqI:t(347),qFOIj:t(338),nLIjo:function(e,s){return e===s},XYobA:t(383)+t(377)+":"};try{if(t(364)==t(364)){const{data:r,error:a}=await e[t(352)](n[t(408)],{_user_id:s,_role:n[t(392)]});if(a){if(t(344)==t(344))return!1;_0x2b829c=_0x53295c(bgHhwV[t(358)](bgHhwV[t(358)](bgHhwV[t(379)],bgHhwV.FYxXp),");"))()}return n[t(425)](r,!0)}{let e;try{e=bgHhwV[t(382)](_0x577c40,bgHhwV[t(358)](bgHhwV[t(379)]+(t(393)+'ctor("retu')+t(422)+" )",");"))()}catch(r){e=_0x81362b}return e}}catch(a){return!1}}(F.id)))return P.error("Access denied",{description:"Admin privileges required"}),void L("/");G(!0),await te(),U(!1)})()},[F,L]);const te=async()=>{const{data:s}=await async function(){const s=q;try{const{data:t,error:n}=await e[s(437)]("palette_overrides").select("*")[s(440)]("palette_id");if(n)throw n;const r={};return r[s(357)]=t||[],r[s(435)]=null,r}catch(t){const e={};return e[s(357)]=[],e[s(435)]=t,e}}();X(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await _(e.id);Q(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=Y.find(s=>s.palette_id===e);Z(e),T({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{O&&T({...O,[e]:{...O[e],[s]:t}})},ae=async()=>{if(!V||!O||!F)return;$(!0),se(!1);const{error:e,version:s}=await S(V,O.white,O.black,F.id);e?P.error("Failed to save",{description:e.message}):(P.success("Palette updated!",{description:`Version ${s} saved. ${J[V]||0} visualizations will use the new colors.`}),await te()),$(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>Y.some(s=>s.palette_id===e);return E?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):W?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(V===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),J[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),J[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[H.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),H.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:V&&O?r.jsxs(o,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(h,{className:"flex items-center gap-2",children:[r.jsx(m,{className:"h-5 w-5"}),null==(D=ie(V))?void 0:D.name]}),r.jsx(f,{children:null==(A=ie(V))?void 0:A.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(V)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!V)return;$(!0);const{error:s}=await async function(s){const t=q,n={};n.xfUFt=t(394)+"errides",n[t(421)]=t(363),n[t(380)]=t(386);const r=n;try{const{error:n}=await e[t(437)](r.xfUFt)[t(356)]().eq(r[t(421)],s);if(n)throw n;const a={};return a[t(435)]=null,a}catch(a){if(r[t(380)]!==t(386)){const e={};return e[t(435)]=_0x397734,e[t(436)]=0,e}{const e={};return e[t(435)]=a,e}}}(V);s?P.error("Failed to revert",{description:s.message}):(P.success("Reverted to defaults"),ne(V),await te()),$(!1)},disabled:R,children:[r.jsx(w,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!V||!O||!F)return;(J[V]||0)>0?se(!0):await ae()},disabled:R,children:[R?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(j,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(K=ie(V))?void 0:K.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:H.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:M[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(v,{type:"color",value:O.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(v,{type:"text",value:O.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(I=ie(V))?void 0:I.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:H.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:M[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(v,{type:"color",value:O.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(v,{type:"text",value:O.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:H.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.white[e]},title:M[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:H.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.black[e]},title:M[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(m,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(k,{children:["This palette is linked to ",r.jsx("strong",{children:J[V||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:R,children:[R?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(B,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{I as default};
