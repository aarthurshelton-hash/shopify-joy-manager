const e="import { supabase } from '@/integrations/supabase/client';\n\n/**\n * Uploads a base64 print image to Supabase storage and returns the public URL.\n * This URL is used by the fulfillment system (Printify) to fetch the print image.\n */\nexport async function uploadPrintImageToStorage(\n  base64Image: string,\n  gameTitle: string\n): Promise<string | null> {\n  try {\n    // Extract the base64 data (remove data URL prefix if present)\n    const base64Data = base64Image.includes('base64,') \n      ? base64Image.split('base64,')[1] \n      : base64Image;\n    \n    // Convert base64 to blob\n    const byteCharacters = atob(base64Data);\n    const byteNumbers = new Array(byteCharacters.length);\n    for (let i = 0; i < byteCharacters.length; i++) {\n      byteNumbers[i] = byteCharacters.charCodeAt(i);\n    }\n    const byteArray = new Uint8Array(byteNumbers);\n    const blob = new Blob([byteArray], { type: 'image/png' });\n    \n    // Generate unique filename\n    const timestamp = Date.now();\n    const sanitizedTitle = gameTitle\n      .replace(/[^a-zA-Z0-9]/g, '-')\n      .toLowerCase()\n      .substring(0, 50);\n    const filename = `print-orders/${sanitizedTitle}-${timestamp}.png`;\n    \n    // Upload to Supabase storage\n    const { data, error } = await supabase.storage\n      .from('print-images')\n      .upload(filename, blob, {\n        contentType: 'image/png',\n        upsert: false,\n      });\n    \n    if (error) {\n      console.error('Failed to upload print image:', error);\n      return null;\n    }\n    \n    // Get public URL\n    const { data: publicUrlData } = supabase.storage\n      .from('print-images')\n      .getPublicUrl(filename);\n    \n    return publicUrlData.publicUrl;\n  } catch (error) {\n    console.error('Error uploading print image to storage:', error);\n    return null;\n  }\n}\n";export{e as default};
