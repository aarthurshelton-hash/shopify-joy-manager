import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as m,t as h,P as x,w as f,B as p,bM as v,cj as w,a9 as j,am as g,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as M,cu as B,b as D}from"./index-SRT_aHEt.js";function k(){const e=["C1fWEwu","CM4GDgHPCYiPka","C0PgCw0","rw5SzKC","vK9VreO","s1PuAeS","BgLUA2vKugfSzq","CgfSzxr0zv9Pza","BxHizKK","DMvYC2LVBG","ntvHuvLXEeu","CwDJCvC","C2LUz2XL","zxjYAwrLCW","C2XPyMS","y29Kzq","ChjVDg90ExbL","DhrLswq","zgvSzxrL","kcGOlISPkYKRkq","C2vSzwn0","C2f2zwrFDMLZDq","wLLUDeq","y29UC29Szq","Aev4t3q","svrJteq","u0zWDKu","D2HPDgu","A2LUzYbHzg1PBG","v3DPswK","tgX1t3y","tvbewxC","zgf0yq","ywXPEMf0Aw9UCW","rNHnBwu","thfzvxG","mtmYmZe2ogvMBLz3rG","mZe3otmWngzHtLLtuG","mte1v0ney1zS","nJy3nJGXy3PuCKjh","mtKXnZm1oeHkv25pwa","ihjVBgu6","yMXHy2TFy29SBW","DgLUzYbSAw5Rzq","zcb2Axn1ywXPEG","mtm2nte5ogvZzuD1yW","CNbJ","mJiYnZC1mhLlu2HKwq","vKnUAgS","sNP3zKq","DgfIBgu","BgDPBei","zxjYB3i","Aw5Zzxj0","yu1Or2O","yxbWBhK","rKvhuMy","yxrPB25ZoG","y3rVCIGICMv0Dq","C2vHCMnO","Eu1vyLG","BKTrt3C","qNHfDfK","uujUuha","Bg9N","CMv0DxjUicHMDq","zujytNa","Dg9tDhjPBMC","yMXHy2S","rxjYB3iGy291BG","Aw5MBW","DhjHy2u","yxrH","ENHLB3q","sunpvfK","x19WCM90B19F","ueDsu1qXmty","yKDWv1i","zNjVBq","zMLUza","mtK4mdrJt2vqrMS","tMrQEfO","BMn0Aw9UkcKG","Bw9KAwzPzwrFyG","y29UC3rYDwn0BW","C3LbsNe","DxbKyxrL","yMLUza","AwqSigDHBwvFza","DMLZDwfSAxPHDa","CgfSzxr0zv9VDG","ALDbzM4","D2HPDgvFy29SBW","zg1PBIbJAgvJAW","E30Uy29UC3rYDq","nZjsqLHey2G","ExDtqu4","m3DrzxbozG","rxjYB3iGy2HLyW","z2fTzv9KyxrH","BKLJB04","Aw9Uu3rHDgu","ywrTAw4"];return(k=function(){return e})()}function q(e,s){e-=274;const t=k();let n=t[e];if(void 0===q.rVPbwI){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};q.IfpIhI=r,q.GbMMzQ={},q.rVPbwI=!0}const a=e+t[0],i=q.GbMMzQ[a];if(i)n=i;else{const e=function(e){this.gAFrpu=e,this.vyMQBM=[1,0,0],this.LytKJe=function(){return"newState"},this.KCxIwk="\\w+ *\\(\\) *{\\w+ *",this.CCFQTu="['|\"].+['|\"];? *}"};e.prototype.EqWumF=function(){const e=new RegExp(this.KCxIwk+this.CCFQTu).test(this.LytKJe.toString())?--this.vyMQBM[1]:--this.vyMQBM[0];return this.VNSRXY(e)},e.prototype.VNSRXY=function(e){return Boolean(~e)?this.vDWqml(this.gAFrpu):e},e.prototype.vDWqml=function(e){for(let s=0,t=this.vyMQBM.length;s<t;s++)this.vyMQBM.push(Math.round(Math.random())),t=this.vyMQBM.length;return e(this.vyMQBM[0])},new e(q).EqWumF(),n=q.IfpIhI(n),q.GbMMzQ[a]=n}return n}!function(){const e=q,s=k();for(;;)try{if(697931===parseInt(e(364))/1+parseInt(e(359))/2*(parseInt(e(313))/3)+-parseInt(e(296))/4*(-parseInt(e(357))/5)+-parseInt(e(311))/6*(parseInt(e(358))/7)+parseInt(e(355))/8+parseInt(e(356))/9+-parseInt(e(366))/10*(parseInt(e(329))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const S=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[q(374)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=q,s={};s.slibk=e(338)+"+$";const t=s;return S[e(283)]()[e(275)](t[e(333)])[e(283)]().constructor(S)[e(275)](e(338)+"+$")});S();const K=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[q(374)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();async function P(s){const t=q,n={};n[t(321)]=t(306)+"errides",n.UCTvp=t(292);const r=n;try{const{data:n,error:a}=await e[t(294)](r[t(321)])[t(339)]("*").eq("palette_id",s)[t(331)]();if(a&&a[t(334)]!==r.UCTvp)throw a;const i={};return i[t(351)]=n,i.error=null,i}catch(a){const e={};return e[t(351)]=null,e.error=a,e}}async function L(s){const t=q,n={nKQOw:function(e,s){return e+s}};n[t(290)]="return (fu"+t(298),n[t(327)]=t(310)+'ctor("retu'+t(320)+" )",n[t(322)]=function(e,s){return e===s},n[t(349)]=t(368),n[t(324)]=t(304)+t(288),n[t(344)]=function(e,s){return e===s},n.WwiIi="WgHVQ";const r=n;try{if(r.EnlfG(t(368),r[t(349)])){const{data:n,error:a}=await e.from(t(340)+t(352))[t(339)](r[t(324)]);if(a)throw a;let i=0;for(const e of n||[]){const n=e[t(315)][t(305)+t(317)];(r[t(344)](null==n?void 0:n.paletteId,s)||(null==n?void 0:n[t(325)+t(336)])===s)&&i++}return i}{let e;try{e=_0x1c5911(evlidK[t(277)](evlidK[t(290)],evlidK[t(327)])+");")()}catch(a){e=_0x205c67}return e}}catch(i){if(t(370)===r[t(348)]){const e=_0x1e0543[t(374)](_0x2ba8ee,arguments);return _0x3d7c0b=null,e}return 0}}K(void 0,function(){const e=q,s={};s[e(373)]=function(e,s){return e+s},s[e(289)]=e(281)+"nction() ",s[e(307)]=e(310)+e(274)+'rn this")( )',s[e(367)]=e(280),s[e(316)]="warn",s[e(343)]=e(371),s[e(312)]="exception",s[e(279)]=e(369),s[e(354)]=e(287),s[e(301)]=function(e,s){return e<s};const t=s,n=function(){const s=e;let n;try{n=Function(t.aMhGj(t[s(289)]+t.jWAfn,");"))()}catch(r){n=window}return n}(),r=n[e(342)]=n[e(342)]||{},a=[t[e(367)],t[e(316)],e(286),t[e(343)],t[e(312)],t[e(279)],t[e(354)]];for(let i=0;t.syAJq(i,a.length);i++){const s=K[e(300)+"r"][e(335)][e(303)](K),t=a[i],n=r[t]||s;s[e(291)]=K[e(303)](K),s[e(283)]=n.toString.bind(n),r[t]=s}})();const A=["k","q","r","b","n","p"],I={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},_=()=>{var k,S,K,_;const{user:G}=s(),H=t(),[W,U]=n.useState(!1),[E,F]=n.useState(!0),[Q,Y]=n.useState([]),[J,V]=n.useState(null),[X,R]=n.useState(null),[T,Z]=n.useState({}),[O,$]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!G)return void H("/");if(!(await async function(s){const t=q,n={};n[t(330)]="has_role",n[t(282)]=t(318),n[t(341)]="BIyYb",n[t(323)]=t(297),n[t(278)]=t(314)+t(347)+t(360),n[t(350)]=function(e,s){return e===s},n.sQpye="Error in a"+t(309)+":";const r=n;try{const{data:n,error:a}=await e[t(365)](r.qgcqW,{_user_id:s,_role:r[t(282)]});if(a){if(r[t(341)]!==r[t(323)])return!1;{const e=_0x3947d6[t(300)+"r"][t(335)][t(303)](_0x2e4e2a),s=_0x3ceece[_0x24a902],n=_0x14379b[s]||e;e.__proto__=_0x3c1f79[t(303)](_0x514bd5),e[t(283)]=n.toString[t(303)](n),_0x18a1f5[s]=e}}return r[t(350)](n,!0)}catch(a){return!1}}(G.id)))return D.error("Access denied",{description:"Admin privileges required"}),void H("/");U(!0),await te(),F(!1)})()},[G,H]);const te=async()=>{const{data:s}=await async function(){const s=q,t={};t[s(276)]=s(306)+"errides";const n=t;try{const{data:t,error:r}=await e.from(n[s(276)])[s(339)]("*").order(s(326));if(r)throw r;const a={};return a.data=t||[],a.error=null,a}catch(r){const e={data:[]};return e[s(371)]=r,e}}();Y(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await L(e.id);Z(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=Q.find(s=>s.palette_id===e);V(e),R({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{X&&R({...X,[e]:{...X[e],[s]:t}})},ae=async()=>{if(!J||!X||!G)return;$(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,r){const a=q,i={DzqhR:function(e,s){return e(s)},SFpvE:function(e,s){return e+s},FxMme:a(306)+a(332)};try{const{data:c}=await i.DzqhR(P,s);if(c){const o={};o[a(308)+"rs"]=t,o[a(361)+"rs"]=n,o[a(299)+"y"]=r,o[a(328)]=c.version+1;const{error:l}=await e.from("palette_ov"+a(332))[a(302)](o).eq(a(326),s);if(l)throw l;return{error:null,version:i[a(345)](c[a(328)],1)}}{const c={};c[a(326)]=s,c.white_colors=t,c.black_colors=n,c[a(299)+"y"]=r,c.version=1;const{error:o}=await e.from(i[a(353)])[a(372)](c);if(o)throw o;const l={};return l[a(371)]=null,l[a(328)]=1,l}}catch(c){const e={};return e[a(371)]=c,e[a(328)]=0,e}}(J,X.white,X.black,G.id);s?D.error("Failed to save",{description:s.message}):(D.success("Palette updated!",{description:`Version ${t} saved. ${T[J]||0} visualizations will use the new colors.`}),await te()),$(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>Q.some(s=>s.palette_id===e);return E?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):W?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(J===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),T[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),T[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[A.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),A.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:J&&X?r.jsxs(o,{children:[r.jsx(m,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(h,{className:"flex items-center gap-2",children:[r.jsx(x,{className:"h-5 w-5"}),null==(k=ie(J))?void 0:k.name]}),r.jsx(f,{children:null==(S=ie(J))?void 0:S.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(J)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!J)return;$(!0);const{error:s}=await async function(s){const t=q,n={};n[t(293)]=t(306)+t(332);const r=n;try{const{error:n}=await e[t(294)](r[t(293)])[t(337)]().eq(t(326),s);if(n)throw n;const a={};return a[t(371)]=null,a}catch(a){const e={};return e.error=a,e}}(J);s?D.error("Failed to revert",{description:s.message}):(D.success("Reverted to defaults"),ne(J),await te()),$(!1)},disabled:O,children:[r.jsx(v,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!J||!X||!G)return;(T[J]||0)>0?se(!0):await ae()},disabled:O,children:[O?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(w,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(K=ie(J))?void 0:K.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:A.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:I[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:X.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:X.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(_=ie(J))?void 0:_.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:A.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:I[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(j,{type:"color",value:X.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(j,{type:"text",value:X.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:A.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:X.white[e]},title:I[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:A.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:X.black[e]},title:I[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(x,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(M,{children:["This palette is linked to ",r.jsx("strong",{children:T[J||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:O,children:[O?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(B,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{_ as default};
