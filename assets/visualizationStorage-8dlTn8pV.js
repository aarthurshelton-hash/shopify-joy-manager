import{s as n,ca as t,dG as r,dH as e}from"./index-DqGlL_-P.js";import{v as o,a as i,b as a}from"./visualizationSchemas-CJwNJUX7.js";import"./flagContent-CdCH2tYk.js";function s(n,t){n-=500;const r=f();let e=r[n];if(void 0===s.XmUDjn){var o=function(n){let t="",r="",e=t+o;for(let o,i,a=0,s=0;i=n.charAt(s++);~i&&(o=a%4?64*o+i:i,a++%4)?t+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=t.length;o<i;o++)r+="%"+("00"+t.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(r)};s.onMzep=o,s.cGEbAx={},s.XmUDjn=!0}const i=n+r[0],a=s.cGEbAx[i];if(a)e=a;else{const n=function(n){this.OlqlPq=n,this.Zpnmgb=[1,0,0],this.jWOsII=function(){return"newState"},this.bBxCjD="\\w+ *\\(\\) *{\\w+ *",this.dZQWqv="['|\"].+['|\"];? *}"};n.prototype.VIRzmf=function(){const n=new RegExp(this.bBxCjD+this.dZQWqv).test(this.jWOsII.toString())?--this.Zpnmgb[1]:--this.Zpnmgb[0];return this.KGxDvn(n)},n.prototype.KGxDvn=function(n){return Boolean(~n)?this.wneLaI(this.OlqlPq):n},n.prototype.wneLaI=function(n){for(let t=0,r=this.Zpnmgb.length;t<r;t++)this.Zpnmgb.push(Math.round(Math.random())),r=this.Zpnmgb.length;return n(this.Zpnmgb[0])},new n(s).VIRzmf(),e=s.onMzep(e),s.cGEbAx[i]=e}return e}!function(){const n=s,t=f();for(;;)try{if(710782===-parseInt(n(678))/1*(parseInt(n(534))/2)+parseInt(n(527))/3*(parseInt(n(528))/4)+-parseInt(n(503))/5*(-parseInt(n(575))/6)+-parseInt(n(669))/7+-parseInt(n(636))/8*(-parseInt(n(682))/9)+-parseInt(n(595))/10*(parseInt(n(690))/11)+-parseInt(n(520))/12*(-parseInt(n(619))/13))break;t.push(t.shift())}catch(r){t.push(t.shift())}}();const c=function(){const n={};n[s(577)]="KxmQV";const t=n;let r=!0;return function(n,e){const o=r?function(){const r=s;if(e){if(r(588)!==t[r(577)]){const n=_0x1cf3b5?function(){if(_0x29982d){const n=_0x24388e[r(549)](_0x3807f3,arguments);return _0xb2d7cd=null,n}}:function(){};return _0x190e44=!1,n}{const t=e.apply(n,arguments);return e=null,t}}}:function(){};return r=!1,o}}()(void 0,function(){const n=s;return c[n(531)]()[n(536)]("(((.+)+)+)+$")[n(531)]().constructor(c)[n(536)](n(559)+"+$")});c();const u=function(){let n=!0;return function(t,r){const e=n?function(){const n=s,e={};e[n(646)]=n(559)+"+$";const o=e;if(r){if("XbjMw"!==n(589)){const e=r[n(549)](t,arguments);return r=null,e}return _0x1f9e70[n(531)]()[n(536)](o[n(646)])[n(531)]()[n(591)+"r"](_0x361035)[n(536)](n(559)+"+$")}}:function(){};return n=!1,e}}();function f(){const n=["vgHPCYbPCYa","qK1mCwi","BwvFzgf0yq","BgL6yxrPB24GAq","CYbHBhjLywr5ia","y3jLyxrLzf9HDa","zxzLBNq","zunHCMq","x19WCM90B19F","ndiXnda3nMfxzg9dDa","BgLUA2vKugfSzq","C2XPy2u","rxjYB3iGAw4Gza","AxLJDMC","q2Tzr3e","CMvZDwX0","ovrACMT2AW","nZqYotK2thvpB3ni","vgL0BguGy29UDa","zgvSzxrLihzPCW","Dg9tDhjPBMC","CMvWBgfJzq","z2fTzv9KyxrH","odmZmJrXr3bPyM8","y3vYCMvUDe1VDG","C2vHCMnO","CM9WCMLHDguGyW","s0z0tMS","Aw4GEw91CIbNyq","DgL0Bgu","Cgf0Ag5HBwu","DMLZDwfSAxPHDa","C3vJy2vZCW","BIbIEsa","Aw5MBW","zgLZCgXHEv9Uyq","Dvboz2S","zgvSzxrL","yxbWBhK","C3rVCMfNzq","ChjVzMLSzxm","yMLUza","C3bSAxq","AwnHDguGzxHPCW","C2f2zwrFDMLZDq","BePAv2S","y29Kzq","C2vSzwn0","kcGOlISPkYKRkq","Dg90ywXnB3zLCW","DgXL","ywXPEMf0Aw9UoG","AwqSihvZzxjFAq","Dca4ignVBg9YCW","BM93","BMCGyxqGBgvHCW","CgLLy2vdB2XVCG","tLDcsNG","BKLK","DxbZzxj0","yM9HCMq","u01KAuG","yxjPDhK","Bg9YCW","odi4mZe1nM5my25zuW","rMLzsM0","AezTshq","shrmy1e","CMvHC29U","yMXHy2S","yxLoyw1L","DxbSAwnHDguGyW","Aw9Uu3rHDgu","u1fbz24","tenAChu","AxneDxbSAwnHDa","C29YDa","s3HTuvy","uM5WB2C","vvzMEei","y29UC3rYDwn0BW","lNbUzW","rxHHy3qGzhvWBa","BwvZC2fNzq","mtboB2zJs0y","rhHKD3y","yLjrwxm","sxfly1O","CgfSzxr0zuLK","zKDzCKu","CMv0DxjUicHMDq","CMvUDfvZzxi","vwv3v24","C2fMzq","C3vHBgL6yxrPBW","ihzLCNKGC2LTAq","yxnJzw5KAw5N","ywLUCYbPBMfWCa","y29SB3jtAw1PBa","jsbZAw1PBgfYia","zNjVBq","BMn0Aw9UkcKG","zxjYB3i","Dhj5ignOyw5NAq","CML0Eq","ywXS","Bwf0y2HLzeDHBq","yw5VDgHLCIbJBW","mJz1y3HhuMS","Dg9mB3DLCKnHCW","CMvTB3zL","z21gCeC","tIbKyxrH","B3DUzwrcEun1CG","rwH6AxO","zgfYA01Vzgu","C2LUz2XL","DxnLCL9Pza","AM9PBG","vMz0zwG","AxnjBNrYAw5ZAq","Aw9Uig5VDcbMBW","rMfPBgvKihrVia","y1bHBgv0Dgu","BgXLy3rVCG","nJK2mtmWngvuww9nqG","Bw9KzxjU","Aw5Zzxj0","DgfIBgu","sw52ywXPzcbqrW","DxbSB2fKigLTyq","D2fYBG","vgHPCYb2Axn1yq","AxnuB29tAw1PBa","DhrLswq","qwD1sM8","uKLXwM0","z2fTzurHDge","C25OtMO","y3vZDg9Tq29SBW","DhjPBq","BgvUz3rO","vMLZDwfSAxPHDa","q2r4ExC","z2u6ia","zxHJzxb0Aw9U","CwLZqK4","CgDU","DwfSAxPHDgLVBG","AgvJAZO","B3jKzxi","CM4GDgHPCYiPka","y3vZDg9T","BgXLCNK","zxr0zvnPBwLSyq","Bwf0y2HLzfbHBa","yvLtr1O","zMv0y2GGDMLZDq","nduYnZKYowD5A0n1BW","ChjVDg90ExbL","Bwn6wwW","DePqzhe","CgLLy2vuExbL","DxbSB2fK","zgf0yq","ueDsu1qXmty","zu9fB1G","mtL4CvD1yui","BKrWu0u","zxHPC3rPBMDdBW","C2f2zsb2Axn1yq","owPerhfcqG","Dg8Gysb2AxnPBW","Dw5K","zMLUzeLUzgv4","E30Uy29UC3rYDq","CYbVD25LzcbIEq","zxr0zuLK","Aw9UCW","mtq5nZe4mJv4zfLyuey","zgf0zq","ww91igHHDMuGyq","C0nhyve","qw5VDgHLCIbJBW","yxjL","y3rVCIGICMv0Dq","igzVCIb1BMLXDq","y0DHBwu","Cgzms08","BgL6yxrPB246ia","D29zDha","y29UC29Szq","whPLvhO","C3rYAw5NAwz5","CM91BMq","nwLKAhbzDW","B3DUzxjeAxnWBa","A3nvsMS","Aw1Hz2vFCgf0Aa","ChvIBgLJvxjS","y29UDgvUDfr5Ca","ywXPEMf0Aw9UCW","D2HPDgu"];return(f=function(){return n})()}function w(n,t,r){const e=s;return(n||t[e(658)]||"")[e(651)]()[e(532)](/\s+/g," ")+"::"+(r?JSON[e(501)]({palette:r[e(599)]||e(637),darkMode:r[e(626)]||!1,currentMove:r[e(535)+"e"]===1/0?e(616):r.currentMove,lockedPieces:(r.lockedPieces||[])[e(587)]((n,t)=>(n[e(567)]+"-"+n[e(673)])["localeComp"+e(695)](t[e(567)]+"-"+t.pieceType))}):"{}")}async function l(o,i,a,c){const u=s,f={HtLcQ:"another co"+u(635),LCZpu:"Error checking duplicates:",snhNj:function(n,t,r,e){return n(t,r,e)},UVfxB:function(n,t){return n===t},mczYl:u(551),CkYGq:u(546)+"me",pfLKO:u(694)+u(635),aYSGZ:u(637),SjreH:function(n,t){return n===t},iycvg:u(663),NWBJx:u(647)};try{const s=w(i,a,c),{data:l,error:g}=await n[u(611)](u(555)+u(509))[u(558)](u(563)+"d, pgn, ga"+u(513));if(g){const n={};return n[u(586)+"e"]=!1,n[u(644)+"ar"]=!1,n}for(const t of l||[]){const r=t.game_data,e=f[u(649)](w,t[u(658)]||void 0,r,r[u(542)+u(583)]);if(f.UVfxB(s,e)){const r=t[u(628)]===o;let e;if(!r){const{data:r}=await n[u(611)](f[u(671)])[u(558)](f[u(525)]).eq("user_id",t[u(628)])[u(627)]();e=(null==r?void 0:r[u(546)+"me"])||f[u(699)]}const i={};return i[u(586)+"e"]=!0,i[u(644)+"ar"]=!0,i.existingId=t.id,i["ownedByCur"+u(602)]=r,i[u(504)+"ayName"]=e,i[u(609)+u(573)]=100,i[u(579)]=u(593)+u(554)+"ts",i}}const C=(null==c?void 0:c[u(599)])||f[u(667)];let z;if(null==c?void 0:c[u(650)+"rs"])z=c[u(650)+"rs"];else if(f.SjreH(C,f[u(524)])){const n=t.find(n=>n.id===u(663));if(n){const t={};t[u(510)]=n[u(510)],t[u(580)]=n[u(580)],z=t}}const y=await r(o,i,a,C,z);if(y.isTooSimilar){if(f[u(590)](f[u(568)],u(603))){const n=_0x5d44cd[u(624)+u(602)]?u(643)+"lization i"+u(515)+u(539)+u(664):"This visua"+u(514)+u(687)+" "+(_0x18a322[u(504)+u(581)]||f[u(578)]);return{data:null,error:new _0x5576dd(n),isDuplicate:!0,ownedByCurrentUser:_0xbf9a8e[u(624)+u(602)],ownerDisplayName:_0x36b4e7[u(504)+u(581)],colorSimilarity:100}}{const n={};return n[u(586)+"e"]=!1,n[u(644)+"ar"]=!0,n.existingId=y["existingVi"+u(605)+u(569)],n[u(624)+"rentUser"]=y[u(624)+"rentUser"],n[u(504)+u(581)]=y["ownerDispl"+u(581)],n[u(609)+u(573)]=y[u(609)+u(573)],n[u(579)]=y.reason,n[u(680)+u(574)]=y[u(680)+"lors"],n["isIntrinsi"+u(634)]=y[u(631)+u(634)],n[u(631)+u(698)]=y.isIntrinsicGame,n["matchedGam"+u(518)]=y[u(617)+u(518)],n["matchedPal"+u(688)]=y[u(666)+u(688)],n[u(666)+"etteSimila"+u(615)]=y[u(666)+u(665)+u(615)],n}}let D;z&&(D=e(z)||void 0);const B={};return B[u(586)+"e"]=!1,B[u(644)+"ar"]=!1,B[u(521)+u(645)]=D,B[u(609)+"arity"]=y[u(609)+u(573)],B[u(631)+u(634)]=y[u(631)+u(634)],B[u(631)+u(698)]=y[u(631)+"cGame"],B.matchedGameCard=y["matchedGam"+u(518)],B.matchedPaletteId=y[u(666)+"etteId"],B[u(666)+u(665)+u(615)]=y["matchedPaletteSimila"+u(615)],B}catch(l){const n={};return n[u(586)+"e"]=!1,n.isTooSimilar=!1,n}}async function g(t,r,e,c,u,f){const w=s,g={eOEoX:w(653)+w(632)+w(684),Ehziz:function(n,t){return n!==t},mBtOr:w(547),lJZWk:w(640)+w(623),fGYrE:function(n,t,r,e,o){return n(t,r,e,o)},qisBN:function(n,t){return n!==t},BMLqb:"SMdiH",woYtp:"This visua"+w(514)+w(515)+w(539)+"llery",SQAgn:w(618)+w(635),iDgBy:w(692)+w(606)+"lar visualization - "+w(614)+w(566)+w(564)+w(697)+"eness",WFloK:"image/png",nDpSE:w(555)+w(509),nWjjI:w(542)+"ions"};try{if(g[w(625)](w(547),g.mBtOr))return{data:null,error:new _0x37a1f1(g[w(677)])};{const s=o(r);if(!s[w(543)])return{data:null,error:new Error(s.error||"Invalid ti"+w(561))};const C=await i(r);if(!C[w(604)])return{data:null,error:new Error(C[w(579)]||w(529)+w(608)+w(537)+"ontent")};const z=a(u);if(!z[w(543)])return{data:null,error:new Error(z.error||g[w(556)])};const y=await g[w(600)](l,t,u,e[w(648)],f);if(y[w(586)+"e"]){if(g[w(657)](g[w(512)],w(572))){const n={};return n[w(675)]=[],n[w(613)]=_0x1bb40e,n}{const n=y[w(624)+w(602)]?g[w(701)]:w(643)+"lization is owned by "+(y[w(504)+w(581)]||g[w(584)]);return{data:null,error:new Error(n),isDuplicate:!0,ownedByCurrentUser:y["ownedByCur"+w(602)],ownerDisplayName:y[w(504)+w(581)],colorSimilarity:100}}}if(y.isTooSimilar){const n=y[w(624)+w(602)]?g.iDgBy:w(511)+Math[w(502)](y[w(609)+w(573)]||30)+(w(610)+w(683)+w(544))+(y[w(504)+w(581)]||"another collector");return{data:null,error:new Error(n),isTooSimilar:!0,ownedByCurrentUser:y[w(624)+w(602)],ownerDisplayName:y[w(504)+w(581)],colorSimilarity:y[w(609)+w(573)],reason:y[w(579)]}}const D={...f};D[w(521)+w(645)]=y[w(521)+w(645)];const B=D,x=t+"/"+Date[w(565)]()+"-"+r[w(532)](/[^a-z0-9]/gi,"-")[w(620)+"e"]()+w(592),v={};v[w(508)+"e"]=g.WFloK,v[w(570)]=!1;const{error:d}=await n[w(550)][w(611)](w(542)+w(689))[w(674)](x,c,v);if(d){if("cQgcX"===w(505)){const n={};return n[w(675)]=null,n[w(613)]=_0x2bc835,n}throw new Error(w(633)+w(641)+w(655)+d[w(594)])}const{data:h}=n[w(550)][w(611)](w(542)+"ions").getPublicUrl(x),m={};m.white=e.gameData[w(510)],m.black=e[w(648)].black,m[w(517)]=e.gameData.event,m[w(691)]=e[w(648)][w(691)],m[w(526)]=e.gameData.result,m.pgn=e[w(648)].pgn,m.moves=e[w(648)].moves,m[w(571)]=e[w(571)],m[w(560)]=e[w(560)],m[w(542)+w(583)]=B;const L=m,M={};M[w(628)]=t,M[w(540)]=r,M[w(658)]=u||null,M[w(533)]=L,M[w(506)]=h[w(507)];const{data:q,error:b}=await n.from(g[w(679)])[w(638)](M).select()[w(627)]();if(b)throw await n[w(550)][w(611)](g.nWjjI)[w(621)]([x]),new Error(w(633)+w(681)+w(700)+b[w(594)]);const A={};return A[w(675)]=q,A[w(613)]=null,A}}catch(C){const n={};return n[w(675)]=null,n.error=C,n}}async function C(t){const r=s,e={};e[r(500)]=r(628),e[r(598)]=r(516);const o=e;try{const e={};e[r(607)]=!1;const{data:i,error:a}=await n[r(611)](r(555)+r(509))[r(558)]("*").eq(o[r(500)],t)[r(661)](o[r(598)],e);if(a)throw new Error("Failed to fetch visu"+r(509)+": "+a[r(594)]);const s={};return s[r(675)]=i||[],s[r(613)]=null,s}catch(i){const n={};return n[r(675)]=[],n[r(613)]=i,n}}async function z(t,r){const e=s,o={};o[e(654)]=function(n,t){return n+t},o[e(538)]=e(542)+e(689);const i=o;try{const o=new URL(r)[e(541)][e(553)]("/"),a=o[e(685)](n=>n===e(542)+e(689)),s=o[e(522)](i[e(654)](a,1))[e(629)]("/");s&&await n.storage[e(611)](i.KFtNk)[e(621)]([s]);const{error:c}=await n[e(611)](e(555)+"alizations")[e(548)]().eq("id",t);if(c)throw new Error("Failed to "+e(530)+e(659)+": "+c[e(594)]);const u={};return u[e(613)]=null,u}catch(a){const n={};return n[e(613)]=a,n}}u(void 0,function(){const n=s,t={gStgv:function(n,t){return n!==t},bRQYs:function(n,t){return n+t}};t.cZIQv=n(642),t[n(630)]="error",t[n(693)]=function(n,t){return n<t};const r=t,e=function(){const t=n;if(t(672)==t(672)){let n;try{if(r.gStgv("Dxdwv",t(596))){const n={};return n[t(675)]=null,n[t(613)]=_0x5789db,n}n=Function(r[t(597)](t(601)+t(612),t(686)+t(696)+t(662)+" )")+");")()}catch(e){n=window}return n}{const n={};n[t(510)]=_0x3d670a[t(510)],n[t(580)]=_0x40d9ea[t(580)],_0x3bc9e3=n}}(),o=e[n(702)]=e[n(702)]||{},i=["log",r.cZIQv,n(545),r[n(630)],n(656),n(639),"trace"];for(let a=0;r[n(693)](a,i[n(652)]);a++){const t=u[n(591)+"r"][n(670)].bind(u),r=i[a],e=o[r]||t;t[n(519)]=u[n(552)](u),t[n(531)]=e[n(531)].bind(e),o[r]=t}})();export{l as checkDuplicateVisualization,z as deleteVisualization,C as getUserVisualizations,g as saveVisualization};
