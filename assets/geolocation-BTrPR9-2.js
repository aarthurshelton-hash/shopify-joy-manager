const n="// IP Geolocation using free ip-api.com service\nexport interface GeoLocation {\n  ip: string;\n  country: string | null;\n  countryCode: string | null;\n  region: string | null;\n  city: string | null;\n  latitude: number | null;\n  longitude: number | null;\n  timezone: string | null;\n}\n\n// Simple hash function for IP privacy\nexport function hashIP(ip: string): string {\n  let hash = 0;\n  for (let i = 0; i < ip.length; i++) {\n    const char = ip.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // Convert to 32bit integer\n  }\n  return Math.abs(hash).toString(16).padStart(8, '0');\n}\n\nexport async function getIPGeolocation(): Promise<GeoLocation | null> {\n  try {\n    // Using ip-api.com free tier (no API key required, 45 req/min limit)\n    const response = await fetch('http://ip-api.com/json/?fields=status,message,country,countryCode,region,city,lat,lon,timezone,query', {\n      method: 'GET',\n    });\n    \n    if (!response.ok) {\n      console.warn('Geolocation API request failed');\n      return null;\n    }\n    \n    const data = await response.json();\n    \n    if (data.status === 'fail') {\n      console.warn('Geolocation lookup failed:', data.message);\n      return null;\n    }\n    \n    return {\n      ip: data.query,\n      country: data.country || null,\n      countryCode: data.countryCode || null,\n      region: data.region || null,\n      city: data.city || null,\n      latitude: data.lat || null,\n      longitude: data.lon || null,\n      timezone: data.timezone || null,\n    };\n  } catch (error) {\n    console.warn('Error fetching geolocation:', error);\n    return null;\n  }\n}\n\n// Alternative using https ipify + geojs.io (both free, https support)\nexport async function getIPGeolocationSecure(): Promise<GeoLocation | null> {\n  try {\n    // First get IP from ipify (https supported)\n    const ipResponse = await fetch('https://api.ipify.org?format=json');\n    if (!ipResponse.ok) return null;\n    const ipData = await ipResponse.json();\n    const ip = ipData.ip;\n    \n    // Then get geo data from geojs.io (free, no key required)\n    const geoResponse = await fetch(`https://get.geojs.io/v1/ip/geo/${ip}.json`);\n    if (!geoResponse.ok) {\n      return { ip, country: null, countryCode: null, region: null, city: null, latitude: null, longitude: null, timezone: null };\n    }\n    \n    const geoData = await geoResponse.json();\n    \n    return {\n      ip,\n      country: geoData.country || null,\n      countryCode: geoData.country_code || null,\n      region: geoData.region || null,\n      city: geoData.city || null,\n      latitude: geoData.latitude ? parseFloat(geoData.latitude) : null,\n      longitude: geoData.longitude ? parseFloat(geoData.longitude) : null,\n      timezone: geoData.timezone || null,\n    };\n  } catch (error) {\n    console.warn('Error fetching secure geolocation:', error);\n    return null;\n  }\n}\n";export{n as default};
