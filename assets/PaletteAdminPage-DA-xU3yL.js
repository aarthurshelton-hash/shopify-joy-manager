import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as l,x as o,y as d,aP as u,p as m,t as x,P as h,w as f,B as p,bM as g,cj as w,a9 as j,am as v,a1 as y,a2 as N,a3 as b,a4 as z,bC as C,a5 as k,cu as P,b as S}from"./index-ckGSTu6A.js";!function(){const e=B,s=U();for(;;)try{if(465872===-parseInt(e(420))/1*(parseInt(e(456))/2)+parseInt(e(448))/3*(parseInt(e(435))/4)+-parseInt(e(455))/5+parseInt(e(464))/6*(-parseInt(e(447))/7)+-parseInt(e(441))/8*(-parseInt(e(415))/9)+-parseInt(e(440))/10*(parseInt(e(482))/11)+-parseInt(e(423))/12*(-parseInt(e(468))/13))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const D=function(){let e=!0;return function(s,t){const n=B,a={};a[n(404)]=n(451);const r=a,i=e?function(){const e=n;if(r[e(404)]===e(419)){if(_0x13ed24){const e=_0xed45c3.apply(_0xd6e5,arguments);return _0x3e37a3=null,e}}else if(t){const e=t.apply(s,arguments);return t=null,e}}:function(){};return e=!1,i}}()(void 0,function(){const e=B,s={ZBMDN:"(((.+)+)+)+$"},t=s;return D.toString()[e(401)](e(462)+"+$").toString()[e(463)+"r"](D)[e(401)](t[e(421)])});function B(e,s){e-=393;const t=U();let n=t[e];if(void 0===B.yPleFH){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};B.brIRaO=a,B.KNgUFb={},B.yPleFH=!0}const r=e+t[0],i=B.KNgUFb[r];if(i)n=i;else{const e=function(e){this.kBauxu=e,this.snPZda=[1,0,0],this.sdQtwx=function(){return"newState"},this.QUzaaE="\\w+ *\\(\\) *{\\w+ *",this.JTEhOw="['|\"].+['|\"];? *}"};e.prototype.uDmgRJ=function(){const e=new RegExp(this.QUzaaE+this.JTEhOw).test(this.sdQtwx.toString())?--this.snPZda[1]:--this.snPZda[0];return this.GWKPOy(e)},e.prototype.GWKPOy=function(e){return Boolean(~e)?this.PuMAOy(this.kBauxu):e},e.prototype.PuMAOy=function(e){for(let s=0,t=this.snPZda.length;s<t;s++)this.snPZda.push(Math.round(Math.random())),t=this.snPZda.length;return e(this.snPZda[0])},new e(B).uDmgRJ(),n=B.brIRaO(n),B.KNgUFb[r]=n}return n}D();const M=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t.apply(s,arguments);return t=null,e}}:function(){};return e=!1,n}}();function U(){const e=["qLjosuy","whvfzvy","vMzUz2i","suTSzNe","BgvUz3rO","BM9vzwG","DhrLswq","tu1oz00","DMLZDwfSAxPHDa","DMvYC2LVBG","mte5mZK1mwHMs3zOua","yMLUza","D2HPDgvFy29SBW","ChjVDg90ExbL","zcb2Axn1ywXPEG","zvnNBfO","yMXHy2S","y3rVCIGICMv0Dq","CM4GDgHPCYiPka","C2vHCMnO","CgfSzxr0zuLK","CgfSzxr0zv9Pza","B0TttNy","DhDvsvG","C2f2zwrFDMLZDq","wuDHtwq","Bg9N","BMn0Aw9UkcKG","yxrPB25ZoG","C21ttwK","z2fTzv9KyxrH","ueDsu1qXmty","Aw5Zzxj0","mZGZodC3uef2zLjf","Aw9Uu3rHDgu","rxjYB3iGy2HLyW","BgLUA2vKugfSzq","vgriDvy","odnHugPnBuu","wKjnre4","zxjYB3i","mJy5ntjhAfn0wwu","zg1PBIbJAgvJAW","D2fYBG","ihjVBgu6","x3jVBgu","ywrTAw4","zMLUza","AfnmywK","x3vZzxjFAwq","tLLUyLK","yMXHy2TFy29SBW","A2LUzYbHzg1PBG","ndK5mtCYB1L2qwz0","Aw5MBW","B3jKzxi","r0Lnvfm","Dg9tDhjPBMC","nZbIuvfMEuq","mta0EhzSwuTS","rePHC0q","D2HPDgu","yxrH","C2vSzwn0","CMLVCgW","mtrIBNbZCu0","m3n0uffmyG","DgLUzYbSAw5Rzq","y29Kzq","C0Hmr1u","wLrkt0m","zNjVBq","CgfSzxr0zv9VDG","mZKXmJG3mezcCefoCG","mta2otrcAurMrge","AgfZx3jVBgu","x19WCM90B19F","E30Uy29UC3rYDq","CNbJ","zgf0yq","kcGOlISPkYKRkq","y29UC3rYDwn0BW","mJu5odG5nevcDwnHEG","tfDgsgW","ExrwDgq","yurwrMS","mtuYnZvMu2Phv20","y29UC29Szq","zxjYAwrLCW","zgvSzxrL"];return(U=function(){return e})()}async function q(s,t,n,a){const r=B,i={LWFHl:function(e,s){return e+s},aDVFk:"return (fu"+r(409),MMNgM:function(e){return e()},IKlfq:r(477),Vfngb:r(403),QUhjD:r(454)+"errides",nKUaw:function(e,s){return e!==s},smSMi:r(407)};try{if("noUeh"===i[r(475)]){const{data:c}=await async function(s){const t=B,n={};n[t(452)]=t(413);const a=n;try{const{data:n,error:r}=await e.from("palette_overrides").select("*").eq(t(403),s).single();if(r&&r[t(450)]!==a[t(452)])throw r;const i={};return i[t(461)]=n,i[t(422)]=null,i}catch(r){const e={};return e[t(461)]=null,e.error=r,e}}(s);if(c){const l={};l[r(394)+"rs"]=t,l[r(433)+"rs"]=n,l.modified_by=a,l[r(481)]=c[r(481)]+1;const{error:o}=await e[r(453)](r(454)+"errides").update(l).eq(i[r(474)],s);if(o)throw o;return{error:null,version:i[r(465)](c[r(481)],1)}}{const c={};c.palette_id=s,c[r(394)+"rs"]=t,c[r(433)+"rs"]=n,c.modified_by=a,c[r(481)]=1;const{error:l}=await e[r(453)](i.QUhjD)[r(414)](c);if(l)throw l;const o={error:null};return o[r(481)]=1,o}}{const e=_0x14e469?function(){if(_0xd60590){const e=_0x59a59d.apply(_0x4f8233,arguments);return _0x425a50=null,e}}:function(){};return _0x20f000=!1,e}}catch(c){if(!i.nKUaw(i[r(411)],r(407))){const e={};return e[r(422)]=c,e.version=0,e}{const e=_0x2ef686(QnRfYQ[r(465)](QnRfYQ[r(467)],r(459)+r(399)+'rn this")( )')+");");_0x2ae5ef=QnRfYQ[r(479)](e)}}}async function A(s){const t=B;try{const{data:n,error:a}=await e[t(453)](t(406)+"alizations")[t(445)]("id, game_d"+t(444));if(a)throw a;let r=0;for(const e of n||[]){const n=e[t(412)][t(480)+t(416)];((null==n?void 0:n[t(402)])===s||(null==n?void 0:n[t(418)+t(478)])===s)&&r++}return r}catch(n){return 0}}M(void 0,function(){const e=B,s={riopl:function(e,s){return e+s},twUIX:"return (fu"+e(409),ytVtd:e(459)+e(399)+e(400)+" )",lViEY:function(e){return e()},RSvRy:e(408),PzzVd:e(425),eSglZ:e(422),DJasD:"exception",NYnbY:"table"};let t;try{const n=Function(s[e(446)](s[e(405)],s[e(466)])+");");t=s.lViEY(n)}catch(r){t=window}const n=t[e(469)]=t.console||{},a=[s.RSvRy,s.PzzVd,e(436),s[e(397)],s[e(442)],s[e(432)],"trace"];for(let i=0;i<a[e(476)];i++){const s=M.constructor[e(395)][e(393)](M),t=a[i],r=n[t]||s;s[e(458)]=M[e(393)](M),s[e(439)]=r[e(439)][e(393)](r),n[t]=s}})();const I=["k","q","r","b","n","p"],L={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},K=()=>{var D,M,U,K;const{user:G}=s(),Z=t(),[_,H]=n.useState(!1),[Y,R]=n.useState(!0),[E,V]=n.useState([]),[F,O]=n.useState(null),[W,Q]=n.useState(null),[T,J]=n.useState({}),[$,X]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!G)return void Z("/");if(!(await async function(s){const t=B;t(424);try{const n={};n[t(431)]=s,n[t(427)]=t(428);const{data:a,error:r}=await e[t(460)](t(457),n);return!r&&!0===a}catch(n){return!1}}(G.id)))return S.error("Access denied",{description:"Admin privileges required"}),void Z("/");H(!0),await te(),R(!1)})()},[G,Z]);const te=async()=>{const{data:s}=await async function(){const s=B;try{const{data:t,error:n}=await e.from(s(454)+s(470))[s(445)]("*")[s(437)](s(403));if(n)throw n;const a={};return a[s(461)]=t||[],a[s(422)]=null,a}catch(t){const e={data:[]};return e[s(422)]=t,e}}();V(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await A(e.id);J(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=E.find(s=>s.palette_id===e);O(e),Q({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{W&&Q({...W,[e]:{...W[e],[s]:t}})},re=async()=>{if(!F||!W||!G)return;X(!0),se(!1);const{error:e,version:s}=await q(F,W.white,W.black,G.id);e?S.error("Failed to save",{description:e.message}):(S.success("Palette updated!",{description:`Version ${s} saved. ${T[F]||0} visualizations will use the new colors.`}),await te()),X(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>E.some(s=>s.palette_id===e);return Y?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):_?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(l,{className:"cursor-pointer transition-all hover:border-primary/50 "+(F===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(o,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),T[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),T[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[I.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),I.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:F&&W?a.jsxs(l,{children:[a.jsx(m,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(x,{className:"flex items-center gap-2",children:[a.jsx(h,{className:"h-5 w-5"}),null==(D=ie(F))?void 0:D.name]}),a.jsx(f,{children:null==(M=ie(F))?void 0:M.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(F)&&a.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!F)return;X(!0);const{error:s}=await async function(s){const t=B,n={GIMTS:function(e,s){return e!==s}};n[t(430)]=t(473);const a=n;try{const{error:n}=await e[t(453)](t(454)+t(470))[t(471)]().eq("palette_id",s);if(n)throw n;return{error:null}}catch(r){if(a[t(438)](a[t(430)],t(473))){const e={data:null};return e.error=_0x4ea433,e}{const e={};return e[t(422)]=r,e}}}(F);s?S.error("Failed to revert",{description:s.message}):(S.success("Reverted to defaults"),ne(F),await te()),X(!1)},disabled:$,children:[a.jsx(g,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(p,{size:"sm",onClick:async()=>{if(!F||!W||!G)return;(T[F]||0)>0?se(!0):await re()},disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(w,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(o,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(U=ie(F))?void 0:U.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:I.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(j,{type:"color",value:W.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(j,{type:"text",value:W.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(K=ie(F))?void 0:K.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:I.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(j,{type:"color",value:W.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(j,{type:"text",value:W.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(v,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:I.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:W.white[e]},title:L[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:I.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:W.black[e]},title:L[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(l,{className:"h-full flex items-center justify-center",children:a.jsxs(o,{className:"text-center py-12",children:[a.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(b,{children:[a.jsxs(z,{className:"flex items-center gap-2",children:[a.jsx(C,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(k,{children:["This palette is linked to ",a.jsx("strong",{children:T[F||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(p,{onClick:re,disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(P,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{K as default};
