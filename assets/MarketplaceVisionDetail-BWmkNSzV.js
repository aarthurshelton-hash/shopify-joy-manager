const e="import React, { useEffect, useState, useRef, useCallback } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '@/hooks/useAuth';\nimport { SquareData, GameData } from '@/lib/chess/gameSimulator';\nimport { setActivePalette, PaletteId, PieceType, getActivePalette } from '@/lib/chess/pieceColors';\nimport { Header } from '@/components/shop/Header';\nimport { Footer } from '@/components/shop/Footer';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\nimport { ArrowLeft, Loader2, Sparkles, ShoppingBag, Gift, DollarSign, Crown, Wallet } from 'lucide-react';\nimport { toast } from 'sonner';\nimport { useSessionStore, CreativeModeTransfer } from '@/stores/sessionStore';\nimport { usePrintOrderStore, PrintOrderData } from '@/stores/printOrderStore';\nimport { VisionaryMembershipCard } from '@/components/premium';\nimport AuthModal from '@/components/auth/AuthModal';\nimport { recordVisionInteraction, getVisionScore, VisionScore } from '@/lib/visualizations/visionScoring';\nimport UnifiedVisionExperience, { ExportState } from '@/components/chess/UnifiedVisionExperience';\nimport { useVisualizationExport } from '@/hooks/useVisualizationExport';\nimport { \n  getListingById, \n  purchaseListing, \n  MarketplaceListing \n} from '@/lib/marketplace/marketplaceApi';\nimport { extractPaletteId, isPremiumPalette, getPaletteDisplayName } from '@/lib/marketplace/paletteArtMap';\nimport WalletPurchaseModal from '@/components/marketplace/WalletPurchaseModal';\nimport { generateGameHash } from '@/lib/visualizations/gameCanonical';\n\ninterface ExtendedGameData {\n  white?: string;\n  black?: string;\n  event?: string;\n  date?: string;\n  result?: string;\n  pgn?: string;\n  moves?: string[];\n  totalMoves?: number;\n  board?: SquareData[][];\n  visualizationState?: {\n    paletteId?: string;\n    darkMode?: boolean;\n    currentMove?: number;\n  };\n}\n\nconst MarketplaceVisionDetail: React.FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const { user, isPremium, isLoading: authLoading, isCheckingSubscription } = useAuth();\n  const { \n    setCreativeModeTransfer,\n    returningFromOrder,\n    capturedTimelineState,\n    setReturningFromOrder,\n    setCapturedTimelineState,\n    setCurrentSimulation,\n    setSavedShareId,\n  } = useSessionStore();\n  const { setOrderData } = usePrintOrderStore();\n  \n  const [listing, setListing] = useState<MarketplaceListing | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isPurchasing, setIsPurchasing] = useState(false);\n  const [showUpgradeModal, setShowUpgradeModal] = useState(false);\n  const [showAuthModal, setShowAuthModal] = useState(false);\n  const [showWalletPurchaseModal, setShowWalletPurchaseModal] = useState(false);\n  const [visionScore, setVisionScore] = useState<VisionScore | null>(null);\n  \n  const viewRecordedRef = useRef(false);\n\n  // Export hook for HD/GIF downloads\n  const { \n    downloadTrademarkHD,\n    downloadGIF \n  } = useVisualizationExport({\n    isPremium,\n    visualizationId: listing?.visualization?.id,\n    onUnauthorized: () => setShowAuthModal(true),\n    onUpgradeRequired: () => setShowUpgradeModal(true),\n  });\n\n  // Handle restoration toast when returning from order page\n  useEffect(() => {\n    if (returningFromOrder && capturedTimelineState) {\n      const { currentMove, totalMoves, title } = capturedTimelineState;\n      const titleText = title || 'Vision';\n      const moveInfo = currentMove !== undefined && totalMoves !== undefined\n        ? `Move ${currentMove} of ${totalMoves}`\n        : currentMove !== undefined\n        ? `Move ${currentMove}`\n        : 'Your vision is ready';\n      \n      toast.success(`${titleText} restored!`, {\n        description: moveInfo,\n        icon: <Sparkles className=\"w-4 h-4\" />,\n      });\n      \n      setReturningFromOrder(false);\n      setCapturedTimelineState(null);\n    }\n  }, [returningFromOrder, capturedTimelineState, setReturningFromOrder, setCapturedTimelineState]);\n\n  useEffect(() => {\n    if (!id) {\n      setError('Invalid listing ID');\n      setIsLoading(false);\n      return;\n    }\n\n    const loadListing = async () => {\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const { data, error: fetchError } = await getListingById(id);\n\n        if (fetchError) {\n          setError(fetchError.message);\n          return;\n        }\n\n        if (!data) {\n          setError('Listing not found');\n          return;\n        }\n\n        // Restore palette from visualization\n        const gameData = data.visualization?.game_data as ExtendedGameData;\n        const paletteId = gameData?.visualizationState?.paletteId;\n        if (paletteId && paletteId !== 'custom') {\n          setActivePalette(paletteId as PaletteId);\n        }\n\n        setListing(data);\n\n        // Record view interaction (only once per session)\n        if (!viewRecordedRef.current && data.visualization?.id) {\n          viewRecordedRef.current = true;\n          recordVisionInteraction(data.visualization.id, 'view');\n          \n          // Fetch vision score\n          getVisionScore(data.visualization.id).then(score => {\n            if (score) setVisionScore(score);\n          });\n        }\n      } catch (err) {\n        console.error('Failed to load listing:', err);\n        setError('Failed to load listing');\n        toast.error('Failed to load listing');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadListing();\n  }, [id]);\n\n  // Transfer to Creative Mode\n  const handleTransferToCreative = useCallback(() => {\n    if (!isPremium) {\n      setShowUpgradeModal(true);\n      return;\n    }\n\n    if (!listing?.visualization) return;\n\n    const gameData = listing.visualization.game_data as ExtendedGameData;\n    const fen = gameData.pgn?.split(/\\s+/).find(part => part.includes('/')) || \n                'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR';\n    \n    const parseFenToBoard = (fenStr: string): (string | null)[][] => {\n      const rows = fenStr.split(' ')[0].split('/');\n      return rows.map(row => {\n        const squares: (string | null)[] = [];\n        for (const char of row) {\n          if (/\\d/.test(char)) {\n            for (let i = 0; i < parseInt(char); i++) squares.push(null);\n          } else {\n            squares.push(char);\n          }\n        }\n        return squares;\n      });\n    };\n\n    const currentPalette = getActivePalette();\n    \n    const transferData: CreativeModeTransfer = {\n      board: parseFenToBoard(fen),\n      whitePalette: currentPalette.white as Record<PieceType, string>,\n      blackPalette: currentPalette.black as Record<PieceType, string>,\n      title: `${listing.visualization.title} (Creative Edit)`,\n      sourceVisualizationId: listing.visualization.id,\n    };\n\n    setCreativeModeTransfer(transferData);\n    navigate('/creative-mode');\n    toast.success('Transferred to Creative Mode');\n  }, [listing, isPremium, setCreativeModeTransfer, navigate]);\n\n  const handlePurchase = async () => {\n    if (!listing) return;\n\n    if (!user) {\n      setShowAuthModal(true);\n      return;\n    }\n\n    if (!isPremium) {\n      setShowUpgradeModal(true);\n      return;\n    }\n\n    // For free listings, use the direct claim flow\n    if (listing.price_cents === 0) {\n      setIsPurchasing(true);\n      const { success, message, visualizationId, error } = await purchaseListing(listing.id);\n\n      if (error) {\n        toast.error('Claim failed', { description: error.message });\n        setIsPurchasing(false);\n        return;\n      }\n\n      if (success) {\n        toast.success('Congratulations!', {\n          description: message || 'Visualization added to your gallery!',\n          action: visualizationId ? {\n            label: 'View',\n            onClick: () => navigate(`/my-vision/${visualizationId}`),\n          } : undefined,\n        });\n        navigate('/my-vision');\n      }\n      setIsPurchasing(false);\n      return;\n    }\n\n    // For paid listings, show wallet purchase modal\n    setShowWalletPurchaseModal(true);\n  };\n\n  const handleWalletPurchaseSuccess = (visualizationId: string) => {\n    navigate('/my-vision');\n  };\n\n  const handleShare = async () => {\n    if (!listing?.visualization?.id) return;\n    \n    const vizData = listing.visualization as { id: string; title: string; image_path: string; game_data: Record<string, unknown>; pgn?: string; public_share_id?: string };\n    const shareUrl = `${window.location.origin}/v/${vizData.public_share_id || vizData.id}`;\n    \n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: listing.visualization.title || 'Chess Visualization',\n          text: 'Check out this unique chess visualization on En Pensent!',\n          url: shareUrl,\n        });\n      } catch (err) {\n        if ((err as Error).name !== 'AbortError') {\n          await navigator.clipboard.writeText(shareUrl);\n          toast.success('Link copied to clipboard');\n        }\n      }\n    } else {\n      await navigator.clipboard.writeText(shareUrl);\n      toast.success('Link copied to clipboard');\n    }\n  };\n\n  // Handle exports (HD, GIF, Print)\n  const handleExport = useCallback(async (type: 'hd' | 'gif' | 'print' | 'preview', exportState?: ExportState) => {\n    if (!listing?.visualization) return;\n    \n    const vizData = getVisualizationData();\n    if (!vizData) return;\n    \n    // Build filtered board based on export state\n    const filteredBoard = exportState && exportState.currentMove < vizData.totalMoves && exportState.currentMove > 0\n      ? vizData.board.map(row => \n          row.map(square => ({\n            ...square,\n            visits: square.visits.filter(visit => visit.moveNumber <= exportState.currentMove)\n          }))\n        )\n      : vizData.board;\n    \n    // Build highlight state for rendering\n    const highlightState = exportState?.lockedPieces && exportState.lockedPieces.length > 0 ? {\n      lockedPieces: exportState.lockedPieces.map(p => ({\n        pieceType: p.pieceType as PieceType,\n        pieceColor: (p.pieceColor === 'white' ? 'w' : p.pieceColor === 'black' ? 'b' : p.pieceColor) as 'w' | 'b',\n      })),\n      compareMode: exportState.compareMode,\n    } : undefined;\n    \n    if (type === 'preview') {\n      // Preview download - uses SAME rendering as HD, but with watermark for free users\n      try {\n        const { generateCleanPrintImage } = await import('@/lib/chess/printImageGenerator');\n        \n        const exportSimulation = {\n          board: filteredBoard,\n          gameData: vizData.gameData,\n          totalMoves: vizData.totalMoves,\n        };\n        \n        // Build captured state for preview with all current settings\n        const capturedState = exportState ? {\n          currentMove: exportState.currentMove,\n          selectedPhase: 'all' as const,\n          lockedPieces: exportState.lockedPieces,\n          compareMode: exportState.compareMode,\n          displayMode: 'standard' as const,\n          darkMode: exportState.darkMode,\n          showTerritory: false,\n          showHeatmaps: false,\n          showPieces: exportState.showPieces,\n          pieceOpacity: exportState.pieceOpacity,\n          capturedAt: new Date(),\n        } : undefined;\n        \n        // Always apply watermark if not premium or still checking subscription status\n        const shouldWatermark = !isPremium || isCheckingSubscription;\n        \n        const base64Image = await generateCleanPrintImage(exportSimulation, {\n          darkMode: exportState?.darkMode || false,\n          withWatermark: shouldWatermark,\n          highlightState,\n          capturedState,\n          pgn: listing.visualization.pgn || vizData.gameData.pgn || '',\n        });\n        \n        // Convert base64 to blob for download\n        const response = await fetch(base64Image);\n        const blob = await response.blob();\n        \n        const url = URL.createObjectURL(blob);\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = `${listing.visualization.title.replace(/\\s+/g, '-').toLowerCase()}-preview.png`;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        URL.revokeObjectURL(url);\n        \n        toast.success('Preview downloaded!', {\n          description: shouldWatermark ? 'Includes En Pensent branding.' : 'Full resolution image saved.',\n        });\n      } catch (error) {\n        console.error('Preview download failed:', error);\n        toast.error('Download failed', { description: 'Please try again.' });\n      }\n      return;\n    }\n    \n    if (type === 'hd') {\n      downloadTrademarkHD({\n        board: filteredBoard,\n        gameData: vizData.gameData,\n        title: listing.visualization.title,\n        darkMode: exportState?.darkMode || false,\n        highlightState,\n        piecesState: exportState ? {\n          showPieces: exportState.showPieces,\n          pieceOpacity: exportState.pieceOpacity,\n        } : undefined,\n        pgn: listing.visualization.pgn || vizData.gameData.pgn || '',\n        currentMoveNumber: exportState?.currentMove,\n      });\n      return;\n    }\n    \n    if (type === 'gif') {\n      const simulation = { board: vizData.board, gameData: vizData.gameData, totalMoves: vizData.totalMoves };\n      const captureElement = document.querySelector('[data-vision-board=\"true\"]') as HTMLElement;\n      const piecesState = exportState ? {\n        showPieces: exportState.showPieces,\n        pieceOpacity: exportState.pieceOpacity,\n      } : undefined;\n      \n      if (captureElement) {\n        downloadGIF(simulation, captureElement, listing.visualization.title, undefined, piecesState);\n      } else {\n        toast.error('Unable to capture visualization');\n      }\n      return;\n    }\n    \n    if (type === 'print') {\n      // Save timeline state for restoration on return\n      if (exportState) {\n        setCapturedTimelineState({\n          currentMove: exportState.currentMove,\n          totalMoves: vizData.totalMoves,\n          title: listing.visualization.title,\n          lockedPieces: exportState.lockedPieces.map(p => ({\n            pieceType: p.pieceType as PieceType,\n            pieceColor: p.pieceColor as 'w' | 'b',\n          })),\n          compareMode: exportState.compareMode,\n          darkMode: exportState.darkMode,\n          showPieces: exportState.showPieces,\n          pieceOpacity: exportState.pieceOpacity,\n        });\n      }\n      \n      // Save simulation to session store\n      setCurrentSimulation({\n        board: vizData.board,\n        gameData: vizData.gameData,\n        totalMoves: vizData.totalMoves,\n      }, listing.visualization.pgn || '', listing.visualization.title);\n      const vizDataCast = listing.visualization as { public_share_id?: string };\n      setSavedShareId(vizDataCast.public_share_id || '');\n      setReturningFromOrder(true);\n      \n      // Navigate to order print page\n      const storedPaletteId = (listing.visualization.game_data as ExtendedGameData)?.visualizationState?.paletteId;\n      const currentPaletteId = storedPaletteId || getActivePalette().id;\n      const vizPgn = listing.visualization.pgn || vizData.gameData.pgn;\n      const currentGameHash = vizPgn ? generateGameHash(vizPgn) : undefined;\n      \n      const orderData: PrintOrderData = {\n        visualizationId: listing.visualization.id,\n        title: listing.visualization.title,\n        imagePath: listing.visualization.image_path,\n        pgn: vizPgn, // Include PGN for piece rendering\n        gameData: {\n          white: vizData.gameData.white,\n          black: vizData.gameData.black,\n          event: vizData.gameData.event,\n          date: vizData.gameData.date,\n          result: vizData.gameData.result,\n        },\n        simulation: {\n          board: vizData.board,\n          gameData: vizData.gameData,\n          totalMoves: vizData.totalMoves,\n        },\n        shareId: vizDataCast.public_share_id,\n        returnPath: `/marketplace/${id}`,\n        // Game metadata for cart display and navigation\n        gameHash: currentGameHash,\n        paletteId: currentPaletteId,\n        capturedState: exportState ? {\n          currentMove: exportState.currentMove,\n          selectedPhase: 'all',\n          lockedPieces: exportState.lockedPieces,\n          compareMode: exportState.compareMode,\n          displayMode: 'standard',\n          darkMode: exportState.darkMode,\n          showTerritory: false,\n          showHeatmaps: false,\n          showPieces: exportState.showPieces,\n          pieceOpacity: exportState.pieceOpacity,\n          capturedAt: new Date(),\n        } : undefined,\n      };\n      setOrderData(orderData);\n      navigate('/order-print');\n    }\n  }, [listing, downloadTrademarkHD, downloadGIF, navigate, setOrderData, setCapturedTimelineState, setCurrentSimulation, setSavedShareId, setReturningFromOrder, id]);\n\n  const handleBack = () => {\n    navigate('/marketplace');\n  };\n\n  // Reconstruct board and gameData from stored data\n  const getVisualizationData = useCallback(() => {\n    if (!listing?.visualization) return null;\n\n    const storedData = listing.visualization.game_data as ExtendedGameData;\n    \n    const board: SquareData[][] = storedData.board || \n      Array(8).fill(null).map((_, rank) =>\n        Array(8).fill(null).map((_, file) => ({\n          file,\n          rank,\n          visits: [],\n          isLight: (file + rank) % 2 === 1,\n        }))\n      );\n    \n    const gameData: GameData = {\n      white: storedData.white || 'White',\n      black: storedData.black || 'Black',\n      event: storedData.event || '',\n      date: storedData.date || '',\n      result: storedData.result || '',\n      pgn: storedData.pgn || listing.visualization.pgn || '',\n      moves: storedData.moves || [],\n    };\n    \n    const totalMoves = storedData.totalMoves || 0;\n    const paletteId = storedData.visualizationState?.paletteId;\n    \n    return { board, gameData, totalMoves, paletteId };\n  }, [listing]);\n\n  const isOwnListing = user?.id === listing?.seller_id;\n  const isFree = (listing?.price_cents ?? 0) === 0;\n  const paletteId = listing ? extractPaletteId(listing.visualization?.game_data as Record<string, unknown>) : null;\n  const hasPremiumPalette = paletteId ? isPremiumPalette(paletteId) : false;\n\n  if (authLoading || isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Header />\n        <div className=\"container mx-auto px-4 py-16\">\n          <div className=\"flex items-center justify-center h-64\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Header />\n        <div className=\"container mx-auto px-4 py-16\">\n          <div className=\"max-w-md mx-auto text-center space-y-6\">\n            <h1 className=\"text-2xl font-display font-bold\">Unable to Load</h1>\n            <p className=\"text-muted-foreground\">{error}</p>\n            <Button onClick={handleBack} variant=\"outline\" className=\"gap-2\">\n              <ArrowLeft className=\"h-4 w-4\" />\n              Return to Marketplace\n            </Button>\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  const vizData = getVisualizationData();\n\n  if (!vizData) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Header />\n        <div className=\"container mx-auto px-4 py-16\">\n          <div className=\"max-w-md mx-auto text-center space-y-6\">\n            <h1 className=\"text-2xl font-display font-bold\">Invalid Visualization Data</h1>\n            <p className=\"text-muted-foreground\">The visualization data could not be loaded.</p>\n            <Button onClick={handleBack} variant=\"outline\" className=\"gap-2\">\n              <ArrowLeft className=\"h-4 w-4\" />\n              Return to Marketplace\n            </Button>\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  // Header actions for marketplace\n  const headerActions = (\n    <div className=\"flex items-center gap-3 flex-wrap\">\n      {/* Price Badge */}\n      <Badge \n        className={`text-sm px-3 py-1 ${\n          isFree \n            ? 'bg-green-500/90 hover:bg-green-500' \n            : 'bg-primary/90 hover:bg-primary'\n        }`}\n      >\n        {isFree ? (\n          <><Gift className=\"h-3 w-3 mr-1\" /> Free</>\n        ) : (\n          <>\n            <Wallet className=\"h-3 w-3 mr-1\" />\n            {((listing?.price_cents || 0) / 100).toFixed(2)} Credits\n          </>\n        )}\n      </Badge>\n      \n      {hasPremiumPalette && (\n        <Badge className=\"bg-gradient-to-r from-amber-500 to-orange-500 text-black\">\n          {getPaletteDisplayName(paletteId || '') || 'Premium'}\n        </Badge>\n      )}\n\n      {/* Claim Ownership - Premium only */}\n      {!isOwnListing && (\n        <TooltipProvider>\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button\n                onClick={handlePurchase}\n                disabled={isPurchasing}\n                className=\"btn-luxury gap-2\"\n              >\n                {isPurchasing ? (\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                ) : isFree ? (\n                  <>\n                    <Gift className=\"h-4 w-4\" />\n                    Claim Vision\n                  </>\n                ) : (\n                  <>\n                    <Wallet className=\"h-4 w-4\" />\n                    Buy with Credits\n                  </>\n                )}\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent side=\"bottom\" className=\"max-w-xs\">\n              <p className=\"font-medium mb-1\">What is Ownership?</p>\n              <ul className=\"text-xs space-y-1 text-muted-foreground\">\n                <li>• Add this vision to your personal gallery</li>\n                <li>• Exclusive digital ownership - only one owner per vision</li>\n                <li>• Earn royalties when others order prints</li>\n                <li>• Seller receives 95%, 5% supports Education Fund</li>\n              </ul>\n            </TooltipContent>\n          </Tooltip>\n        </TooltipProvider>\n      )}\n      \n      {isOwnListing && (\n        <Badge variant=\"outline\" className=\"gap-1\">\n          <Crown className=\"h-3 w-3\" />\n          Your Listing\n        </Badge>\n      )}\n    </div>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Header />\n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Premium required notice for ownership */}\n        {!isPremium && user && !isOwnListing && (\n          <div className=\"mb-6 p-3 rounded-lg bg-amber-500/10 border border-amber-500/30 flex items-center gap-2\">\n            <Crown className=\"h-5 w-5 text-amber-500 shrink-0\" />\n            <span className=\"text-sm text-amber-600\">\n              Premium membership required to claim ownership. <span className=\"text-muted-foreground\">Anyone can order prints.</span>\n            </span>\n          </div>\n        )}\n\n        {/* Unified Vision Experience - Single unified menu for ALL contexts */}\n        <UnifiedVisionExperience\n          board={vizData.board}\n          gameData={vizData.gameData}\n          totalMoves={vizData.totalMoves}\n          pgn={vizData.gameData.pgn || listing?.visualization?.pgn || ''}\n          context=\"marketplace\"\n          defaultTab=\"analytics\"\n          visualizationId={listing?.visualization?.id}\n          paletteId={vizData.paletteId}\n          createdAt={listing?.created_at}\n          title={listing?.visualization?.title}\n          imageUrl={listing?.visualization?.image_path}\n          onBack={handleBack}\n          backButtonText=\"Return to Marketplace\"\n          headerActions={headerActions}\n          onTransferToCreative={handleTransferToCreative}\n          onShare={handleShare}\n          onExport={handleExport}\n          isPremium={isPremium}\n          onUpgradePrompt={() => setShowUpgradeModal(true)}\n          purchasePrice={listing?.price_cents}\n          showPurchaseButton={!isOwnListing}\n          onPurchase={handlePurchase}\n          isPurchasing={isPurchasing}\n          isOwner={isOwnListing}\n          visionScoreData={visionScore ? {\n            viewCount: visionScore.viewCount,\n            uniqueViewers: visionScore.uniqueViewers,\n            royaltyCentsEarned: visionScore.royaltyCentsEarned,\n            royaltyOrdersCount: visionScore.royaltyOrdersCount,\n            printRevenueCents: visionScore.printRevenueCents,\n            printOrderCount: visionScore.printOrderCount,\n            totalScore: visionScore.totalScore,\n            downloadHdCount: visionScore.downloadHdCount,\n            downloadGifCount: visionScore.downloadGifCount,\n            tradeCount: visionScore.tradeCount,\n          } : null}\n        />\n      </div>\n      <Footer />\n      \n      <VisionaryMembershipCard\n        isOpen={showUpgradeModal}\n        onClose={() => setShowUpgradeModal(false)}\n        trigger=\"marketplace\"\n      />\n      \n      <AuthModal \n        isOpen={showAuthModal} \n        onClose={() => setShowAuthModal(false)} \n      />\n\n      {/* Wallet Purchase Modal for paid listings */}\n      {listing && (\n        <WalletPurchaseModal\n          open={showWalletPurchaseModal}\n          onOpenChange={setShowWalletPurchaseModal}\n          listingId={listing.id}\n          visualizationTitle={listing.visualization?.title || 'Vision'}\n          priceCents={listing.price_cents}\n          sellerName={listing.seller?.display_name || 'Collector'}\n          onSuccess={handleWalletPurchaseSuccess}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default MarketplaceVisionDetail;";export{e as default};
