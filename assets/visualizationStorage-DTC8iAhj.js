import{s as t,ca as r,dG as n,dH as e}from"./index-SRT_aHEt.js";import{v as o,a as i,b as a}from"./visualizationSchemas-BeBobukU.js";import"./flagContent-CrS5Jdfk.js";function u(t,r){t-=173;const n=c();let e=n[t];if(void 0===u.OPfKmD){var o=function(t){let r="",n="",e=r+o;for(let o,i,a=0,u=0;i=t.charAt(u++);~i&&(o=a%4?64*o+i:i,a++%4)?r+=e.charCodeAt(u+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=r.length;o<i;o++)n+="%"+("00"+r.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(n)};u.PvZALO=o,u.ivaibn={},u.OPfKmD=!0}const i=t+n[0],a=u.ivaibn[i];if(a)e=a;else{const t=function(t){this.QUGXrh=t,this.VxRpNX=[1,0,0],this.PlUTHr=function(){return"newState"},this.yHfAzw="\\w+ *\\(\\) *{\\w+ *",this.orOXuB="['|\"].+['|\"];? *}"};t.prototype.yuEiVc=function(){const t=new RegExp(this.yHfAzw+this.orOXuB).test(this.PlUTHr.toString())?--this.VxRpNX[1]:--this.VxRpNX[0];return this.qoIstH(t)},t.prototype.qoIstH=function(t){return Boolean(~t)?this.aUPmud(this.QUGXrh):t},t.prototype.aUPmud=function(t){for(let r=0,n=this.VxRpNX.length;r<n;r++)this.VxRpNX.push(Math.round(Math.random())),n=this.VxRpNX.length;return t(this.VxRpNX[0])},new t(u).yuEiVc(),e=u.PvZALO(e),u.ivaibn[i]=e}return e}function c(){const t=["D0T5zMS","A3LNrMS","q3jvs0S","D2HPDgu","Dca4ignVBg9YCW","Aw9Uu3rHDgu","DxbSAwnHDguGyW","AMDwDum","BMfbCey","igzVCIb1BMLXDq","BfnbzvO","tM1REK4","BwvZC2fNzq","BKH0uNK","zgfYA01Vzgu","ywLUCYbPBMfWCa","C2f2zwrFDMLZDq","C3rVCMfNzq","zw9cCw8","zKzJAwC","CMv0DxjUicHMDq","sw52ywXPzcb0Aq","CM4GDgHPCYiPka","zgvSzxrLihzPCW","BMn0Aw9UkcKG","ywXS","A2LUzYbKDxbSAq","z2fTzv9KyxrH","wuLTq04","qu5PrvG","mZnQCNfJq0i","zw5LC3m","vMLZDwfSAxPHDa","mJmXodq5z3zjtxf3","C3vJy2vZCW","s1r3EuK","mti1ntKYBMfuzMvl","C3rYAw5NAwz5","zxjYB3i","y3jLyxrLzf9HDa","AxnjBNrYAw5ZAq","zNjVBq","CgLLy2vdB2XVCG","Aw9UCW","ueDsu1qXmty","Bg9N","AxPHDgLVBIaTia","DgL0Bgu","rMfPBgvKihrVia","twj1y24","zxHPC3rPBMDdBW","zNLLDfK","C3bSAxq","B250zw50","y3rVCIGICMv0Dq","AM9PBG","mZbmzujryw4","qMzPCNK","wxjzy1K","rxjYB3iGAw4Gza","zunHCMq","yxbWBhK","BwTADg4","Aw4GEw91CIbNyq","AMftt20","sw52ywXPzcbqrW","Aw5Zzxj0","AxnuB29tAw1PBa","tKTeyxa","AKvVtK4","qxnrrfi","D3vtseS","CMvZDwX0","B3jKzxi","CMnXEvu","AwqSihvZzxjFAq","y3vYCMvUDe1VDG","Bg9JA2vKugLLyW","z2v0uhvIBgLJvq","zxr0zuLK","vgL0BguGy29UDa","BIbIEsa","AhjOBvm","A21Vrvy","v0T3u1O","zxr0zvnPBwLSyq","zxzLBNq","zxHPC3rPBMDjza","yM9HCMq","wg5Qu00","zhj6Bge","Dg9tDhjPBMC","A0zHsMC","y1bHBgv0Dgu","Dg90ywXnB3zLCW","uKrWug8","zxvoDhm","CMvHC29U","Cgf0Ag5HBwu","Aw1Hz2vFCgf0Aa","BgL6yxrPB24GAq","tIbKyxrH","vgHPCYb2Axn1yq","yxjL","yxjPDhK","CYbHBhjLywr5ia","AMTpuuS","zcWGCgDUlcbNyq","C2vSzwn0","DxbSB2fKigLTyq","nZvZDK1UBxK","C3jMAMm","zgf0zq","svbRBMW","zw1jB3m","y3vZDg9T","zeHwDvy","zNbeAuq","C2vHCMnO","BMCGyxqGBgvHCW","C2jgwei","C2LUz2XL","lNbUzW","uejTvLG","r1b6CNC","zgf0yq","yxLoyw1L","EuH6BLy","ihzLCNKGC2LTAq","DMLZDwfSAxPHDa","x19WCM90B19F","CMvTB3zL","DxnLCL9Pza","C2fMzq","Aw9Uig5VDcbMBW","zxHPC3rPBMDwAq","AxneDxbSAwnHDa","zMLUzeLUzgv4","y29UC29Szq","jsbZAw1PBgfYia","CgfSzxr0zuLK","CgLLy2vuExbL","y3vZDg9Tq29SBW","BgLUA2vKugfSzq","Bg9YCW","Bgz5Cw4","y29SB3jtAw1PBa","BgXLy3rVCG","zMLUza","zMv0y2GGDMLZDq","ywXPEMf0Aw9UCW","DhjPBq","BwPZDxK","CgDU","DhrLswq","wwHQsMi","ywXPEMf0Aw9UoG","EK9QruK","y0DHBwu","kcGOlISPkYKRkq","vgHPCYbPCYa","Bwf0y2HLzfbHBa","Bw9KzxjU","y29UC3rYDwn0BW","DgXL","qw5VDgHLCIbJBW","z2fTzurHDge","Dg9mB3DLCKnHCW","D2fYBG","ndqYmdy1C0fJC3bS","B3DUzwrcEun1CG","A2XcvM4","DfvxsgS","Bwf0y2HLzeDHBq","mtaWotCZmgnAC0vZEG","mta2mta5nxHcyMfPBG","sunhyNa","yMLUza","ndiYrufNA2zA","CM91BMq","wg9xB1K","BLvewwm","B2TpA0e","ww91igHHDMuGyq","y2f0zxm6","CML0Eq","E30Uy29UC3rYDq","Bg9JywXLq29TCa","mJqWmdrhEw5RrKe","Bw92zxm","C1DTu0W","B3DUzxjeAxnWBa","BgXLCNK","v0PMtNa","wgHurxm","DwfSAxPHDgLVBG","CMvUDfvZzxi","Bw5ZEKe","zxHJzxb0Aw9U","EKLQtwW","Ber4wLy","rLHzsw0","C3vHBgL6yxrPBW","Aw5MBW","yMXHy2S","CM9WCMLHDguGyW","yw5VDgHLCIbJBW","ChjVzMLSzxm","zgLZCgXHEv9Uyq","A2Dusgy","Dhj5ignOyw5NAq"];return(c=function(){return t})()}!function(){const t=u,r=c();for(;;)try{if(249755===-parseInt(t(359))/1*(parseInt(t(216))/2)+parseInt(t(279))/3*(parseInt(t(226))/4)+parseInt(t(207))/5*(parseInt(t(305))/6)+-parseInt(t(213))/7+-parseInt(t(285))/8+parseInt(t(282))/9+-parseInt(t(212))/10)break;r.push(r.shift())}catch(n){r.push(r.shift())}}();const s=function(){let t=!0;return function(r,n){const e=t?function(){const t=u;if(t(317)===t(369)){_0x266b97[t(287)](t(308)+t(255)+"heck:",_0x49c532);const r={};return r[t(174)+"e"]=!1,r.isTooSimilar=!1,r}if(n){const e=n[t(310)](r,arguments);return n=null,e}}:function(){};return t=!1,e}}()(void 0,function(){const t=u,r={};r[t(239)]=t(197)+"+$";const n=r;return s[t(340)]()[t(367)]("(((.+)+)+)+$")[t(340)]().constructor(s)[t(367)](n.FXYIm)});s();const f=function(){const t=u,r={};r[t(218)]=function(t,r){return t===r},r[t(228)]=t(365),r[t(332)]=t(284);const n=r;let e=!0;return function(t,r){const o=e?function(){const e=u;if(r){if(n.XoWoY(n[e(228)],n[e(332)])){const t=_0x2784d5?function(){if(_0x52d736){const t=_0x106fc7[e(310)](_0x285b93,arguments);return _0x3ce4d6=null,t}}:function(){};return _0x5cc56d=!1,t}{const n=r.apply(t,arguments);return r=null,n}}}:function(){};return e=!1,o}}();function w(t,r,n){const e=u,o={};o.ANiEX=e(200),o.drzla=function(t,r){return t===r},o[e(341)]=e(274);const i=o;return(t||r[e(191)]||"")[e(189)]().replace(/\s+/g," ")+"::"+(n?JSON[e(286)]({palette:n[e(178)]||i[e(278)],darkMode:n[e(263)]||!1,currentMove:i[e(339)](n[e(325)+"e"],1/0)?i[e(341)]:n.currentMove,lockedPieces:(n[e(326)+"es"]||[]).sort((t,r)=>(t.pieceColor+"-"+t[e(179)])[e(225)+e(352)](r[e(291)]+"-"+r[e(179)]))}):"{}")}async function l(o,i,a,c){const s=u,f={lreKv:function(t,r,n,e){return t(r,n,e)},YrYcY:function(t,r){return t===r},AsQDR:s(246)+"me",PBmVX:s(203)+"llector",fFcig:s(200),jkOQK:function(t,r){return t===r},jgVuC:"custom",nUDYc:function(t,r,n,e,o,i){return t(r,n,e,o,i)},srfjc:"klBVn",naApF:s(235),XhTEs:s(308)+s(255)+"heck:"};try{const u=f.lreKv(w,i,a,c),{data:l,error:y}=await t.from(s(265)+s(188))[s(357)](s(324)+s(356)+"me_data");if(y){const t={};return t[s(174)+"e"]=!1,t[s(316)+"ar"]=!1,t}for(const r of l||[]){const n=r.game_data,e=w(r[s(191)]||void 0,n,n["visualizat"+s(254)]);if(f[s(307)](u,e)){const n=f.YrYcY(r[s(381)],o);let e;if(!n){const{data:n}=await t.from(s(245))[s(357)](f[s(319)]).eq(s(381),r[s(381)])[s(370)]();e=(null==n?void 0:n[s(246)+"me"])||f[s(372)]}const i={isDuplicate:!0,isTooSimilar:!0};return i[s(336)]=r.id,i["ownedByCur"+s(234)]=n,i[s(229)+s(375)]=e,i[s(184)+s(353)]=100,i[s(346)]="Exact duplicate exists",i}}const C=(null==c?void 0:c.paletteId)||f[s(268)];let B;if(null==c?void 0:c[s(180)+"rs"])B=c.customColors;else if(f[s(355)](C,f[s(256)])){const t=r[s(186)](t=>t.id===s(364));if(t){const r={};r[s(252)]=t[s(252)],r[s(242)]=t[s(242)],B=r}}const x=await f[s(219)](n,o,i,a,C,B);if(x[s(316)+"ar"]){if(f[s(360)]===s(209)){const t={};return t[s(174)+"e"]=!1,t[s(316)+"ar"]=!0,t[s(336)]=x[s(173)+s(240)+"nId"],t["ownedByCur"+s(234)]=x[s(208)+s(234)],t[s(229)+"ayName"]=x[s(229)+s(375)],t[s(184)+s(353)]=x[s(184)+s(353)],t[s(346)]=x[s(346)],t[s(299)+s(182)]=x[s(299)+"lors"],t[s(289)+s(342)]=x[s(289)+s(342)],t["isIntrinsi"+s(196)]=x["isIntrinsi"+s(196)],t[s(211)+s(309)]=x[s(211)+s(309)],t[s(199)+s(328)]=x[s(199)+"etteId"],t[s(199)+"etteSimilarity"]=x[s(199)+s(334)+s(223)],t}{const t={};return t[s(374)]=[],t[s(287)]=_0x4b8ae9,t}}let z;if(B){if("onuvi"===f[s(257)]){const t=_0x2a0927.ownedByCurrentUser?s(351)+"lization i"+s(354)+"in your ga"+s(230):"This visua"+s(349)+"s owned by "+(_0x86d03e["ownerDispl"+s(375)]||s(244)+"llector");return{data:null,error:new _0x15e596(t),isDuplicate:!0,ownedByCurrentUser:_0x1d6070["ownedByCur"+s(234)],ownerDisplayName:_0x1d258b[s(229)+s(375)],colorSimilarity:100}}z=e(B)||void 0}const d={isDuplicate:!1,isTooSimilar:!1};return d[s(181)+"tteId"]=z,d[s(184)+"arity"]=x[s(184)+s(353)],d[s(289)+s(342)]=x[s(289)+s(342)],d[s(289)+s(196)]=x[s(289)+s(196)],d[s(211)+s(309)]=x["matchedGam"+s(309)],d["matchedPal"+s(328)]=x.matchedPaletteId,d[s(199)+s(334)+"rity"]=x[s(199)+s(334)+"rity"],d}catch(l){const t={};return t[s(174)+"e"]=!1,t[s(316)+"ar"]=!1,t}}async function y(r,n,e,c,s,f){const w=u,y={zOjEI:function(t,r){return t(r)},YhjJb:w(270)+w(202),jaSOm:"Invalid PG"+w(350),zIjMl:function(t,r,n,e,o){return t(r,n,e,o)},VdoRI:function(t,r){return t===r},eoBqo:w(183),okOkA:w(231),vCbzI:w(221)+w(377)+"lar visual"+w(295)+w(248)+w(368)+w(253)+w(258)+w(280),ldFJK:w(244)+w(185),XFVkT:w(378)+w(292),lSAeZ:"image/png",rcqyU:w(265)+w(188)};try{const u=y[w(195)](o,n);if(!u[w(283)])return{data:null,error:new Error(u[w(287)]||y[w(193)])};const C=await y[w(195)](i,n);if(!C[w(382)])return{data:null,error:new Error(C[w(346)]||w(329)+w(264)+w(243)+w(302))};const B=a(s);if(!B[w(283)])return{data:null,error:new Error(B[w(287)]||y[w(313)])};const x=await y[w(237)](l,r,s,e.gameData,f);if(x.isDuplicate){if(y.VdoRI("fBWLG",y[w(267)]))return{data:null,error:new _0x406b2b(_0x277a09.error||"Invalid ti"+w(202))};{const t=x["ownedByCur"+w(234)]?w(351)+w(349)+w(354)+w(312)+"llery":w(351)+w(349)+"s owned by "+(x[w(229)+"ayName"]||w(244)+w(185));return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:x.ownedByCurrentUser,ownerDisplayName:x[w(229)+w(375)],colorSimilarity:100}}}if(x[w(316)+"ar"]){if("WJfNp"===y[w(220)]){const t=x["ownedByCur"+w(234)]?y.vCbzI:w(198)+Math[w(217)](x[w(184)+w(353)]||30)+(w(177)+"to a visio")+w(330)+(x.ownerDisplayName||y.ldFJK);return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:x[w(208)+w(234)],ownerDisplayName:x[w(229)+w(375)],colorSimilarity:x[w(184)+w(353)],reason:x[w(346)]}}if(_0x5bf185){const t=_0x3c872c[w(310)](_0x14588a,arguments);return _0x3e6c88=null,t}}const z={...f};z[w(181)+w(192)]=x[w(181)+w(192)];const d=z,g=r+"/"+Date.now()+"-"+n.replace(/[^a-z0-9]/gi,"-")[w(205)+"e"]()+w(371),{error:D}=await t[w(266)].from(y.XFVkT).upload(g,c,{contentType:y[w(259)],upsert:!1});if(D)throw new Error(w(297)+w(358)+"ge: "+D[w(261)]);const{data:v}=t[w(266)][w(290)](w(378)+w(292))[w(327)+"rl"](g),m={};m.white=e[w(204)][w(252)],m[w(242)]=e[w(204)].black,m[w(335)]=e[w(204)].event,m[w(361)]=e[w(204)][w(361)],m[w(321)]=e[w(204)][w(321)],m[w(191)]=e.gameData.pgn,m[w(227)]=e.gameData[w(227)],m[w(337)]=e[w(337)],m[w(343)]=e[w(343)],m[w(378)+w(254)]=d;const h=m,A={};A[w(381)]=r,A[w(296)]=n,A[w(191)]=s||null,A[w(276)]=h,A[w(348)]=v.publicUrl;const{data:L,error:M}=await t[w(290)](y[w(323)])[w(315)](A)[w(357)]().single();if(M)throw await t.storage[w(290)](w(378)+w(292))[w(380)]([g]),new Error(w(297)+"save visualization: "+M[w(261)]);const p={};return p.data=L,p[w(287)]=null,p}catch(C){const t={data:null};return t[w(287)]=C,t}}async function C(r){const n=u,e={};e.CrUKK=n(249),e.ICGbp="saved_visu"+n(188),e[n(250)]=n(288),e[n(277)]=function(t,r){return t===r},e[n(190)]=n(298);const o=e;try{if(n(249)!==o[n(251)]){const t={};return t[n(374)]=null,t[n(287)]=_0xd5395,t}{const e={ascending:!1},{data:i,error:a}=await t.from(o[n(214)])[n(357)]("*").eq(n(381),r)[n(322)](o[n(250)],e);if(a)throw new Error(n(297)+n(187)+n(188)+": "+a[n(261)]);const u={};return u[n(374)]=i||[],u[n(287)]=null,u}}catch(i){if(o[n(277)](o[n(190)],n(298))){const t={data:[]};return t[n(287)]=i,t}return{data:null,error:new _0x119d43(_0x51d229[n(346)]||"Title cont"+n(264)+n(243)+n(302))}}}async function B(r,n){const e=u,o={IPknl:function(t,r){return t+r}};o[e(260)]=e(378)+"ions";const i=o;try{const o=new URL(n)[e(347)][e(301)]("/"),a=o[e(175)](t=>t===e(378)+e(292)),u=o.slice(i[e(362)](a,1))[e(304)]("/");u&&await t[e(266)].from(i[e(260)]).remove([u]);const{error:c}=await t[e(290)](e(265)+e(188)).delete().eq("id",r);if(c)throw new Error(e(297)+e(272)+e(233)+": "+c.message);const s={};return s[e(287)]=null,s}catch(a){const t={};return t.error=a,t}}f(void 0,function(){const t=u,r={XnjSM:t(366),kgTHf:function(t,r){return t+r},hrhmS:t(224)+t(303)+t(271)+" )",lDxZV:function(t){return t()},uNBfw:t(206),nHtRy:t(287),fyetY:t(236),yHznV:"table",fBMha:"trace",emIos:function(t,r){return t<r}},n=r[t(238)](function(){const n=t;let e;try{if(r[n(338)]!==n(366)){const t={};return t[n(174)+"e"]=!1,t[n(316)+"ar"]=!0,t.existingId=_0x3e1888["existingVi"+n(240)+"nId"],t[n(208)+n(234)]=_0x45499c[n(208)+n(234)],t["ownerDispl"+n(375)]=_0x55b948[n(229)+n(375)],t[n(184)+n(353)]=_0x406ef6["colorSimil"+n(353)],t[n(346)]=_0x36d16f[n(346)],t[n(299)+n(182)]=_0x252cac[n(299)+"lors"],t[n(289)+n(342)]=_0x242dd6.isIntrinsicPalette,t[n(289)+n(196)]=_0x4c8307[n(289)+n(196)],t["matchedGam"+n(309)]=_0x12db90[n(211)+"eCard"],t[n(199)+n(328)]=_0x46cc90["matchedPal"+n(328)],t["matchedPal"+n(334)+"rity"]=_0x477bd8[n(199)+n(334)+n(223)],t}e=Function(r[n(247)](r[n(247)](n(269)+n(273),r[n(331)]),");"))()}catch(o){e=window}return e}),e=n[t(176)]=n[t(176)]||{},o=[t(294),r.uNBfw,t(241),r[t(262)],r[t(300)],r[t(376)],r.fBMha];for(let i=0;r[t(363)](i,o.length);i++){const r=f[t(201)+"r"].prototype[t(215)](f),n=o[i],a=e[n]||r;r[t(379)]=f[t(215)](f),r[t(340)]=a[t(340)][t(215)](a),e[n]=r}})();export{l as checkDuplicateVisualization,B as deleteVisualization,C as getUserVisualizations,y as saveVisualization};
