import{j as e,x as s,u as a,a as t,r as i,s as r,by as n,ah as l,D as c,a8 as d,d8 as o,aL as m,aM as x,d9 as u,B as h,aP as p,T as g,b as f,p as v,em as y,cK as j,bG as b,y as N,co as w,cp as _,cq as k,J as S,K as C,X as I,Z as z,aK as B,F as Q,aE as $,aq as K,H as R,A as E,q as O,t as M,v as q,ad as D,C as P,w as A,Y as F,I as T,en as V,c9 as U,eo as L,d as J,bP as Y,aY as W,E as G,bw as H,W as X}from"./index-1k5cZzy0.js";import{M as Z}from"./medal-CbJdkmC_.js";import{C as ee}from"./cloud-C5tVnJuf.js";import{W as se}from"./wifi-off-cvigRrv-.js";import{C as ae}from"./calendar-BGH9_Q6t.js";import{S as te}from"./scan-line-BkUqeumV.js";function ie({scanning:a=!1}){const t=40;return e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx("div",{className:"absolute inset-0 bg-black/40",style:{clipPath:"polygon(\n            0 0, 100% 0, 100% 100%, 0 100%, 0 0,\n            12.5% 12.5%, 12.5% 87.5%, 87.5% 87.5%, 87.5% 12.5%, 12.5% 12.5%\n          )"}})}),e.jsxs("div",{className:"absolute left-[12.5%] top-[12.5%] right-[12.5%] bottom-[12.5%]",children:[e.jsxs(s.div,{className:"absolute top-0 left-0",animate:a?{opacity:[1,.5,1]}:{},transition:{duration:1.5,repeat:1/0},children:[e.jsx("div",{className:"absolute top-0 left-0 bg-primary",style:{width:t,height:4}}),e.jsx("div",{className:"absolute top-0 left-0 bg-primary",style:{width:4,height:t}})]}),e.jsxs(s.div,{className:"absolute top-0 right-0",animate:a?{opacity:[1,.5,1]}:{},transition:{duration:1.5,repeat:1/0,delay:.2},children:[e.jsx("div",{className:"absolute top-0 right-0 bg-primary",style:{width:t,height:4}}),e.jsx("div",{className:"absolute top-0 right-0 bg-primary",style:{width:4,height:t}})]}),e.jsxs(s.div,{className:"absolute bottom-0 left-0",animate:a?{opacity:[1,.5,1]}:{},transition:{duration:1.5,repeat:1/0,delay:.4},children:[e.jsx("div",{className:"absolute bottom-0 left-0 bg-primary",style:{width:t,height:4}}),e.jsx("div",{className:"absolute bottom-0 left-0 bg-primary",style:{width:4,height:t}})]}),e.jsxs(s.div,{className:"absolute bottom-0 right-0",animate:a?{opacity:[1,.5,1]}:{},transition:{duration:1.5,repeat:1/0,delay:.6},children:[e.jsx("div",{className:"absolute bottom-0 right-0 bg-primary",style:{width:t,height:4}}),e.jsx("div",{className:"absolute bottom-0 right-0 bg-primary",style:{width:4,height:t}})]}),e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:[e.jsx("div",{className:"w-8 h-[2px] bg-primary/40"}),e.jsx("div",{className:"w-[2px] h-8 bg-primary/40 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"})]}),a&&e.jsx(s.div,{className:"absolute left-0 right-0 h-1 bg-gradient-to-r from-transparent via-primary to-transparent",initial:{top:0},animate:{top:["0%","100%","0%"]},transition:{duration:2,repeat:1/0,ease:"linear"}})]}),e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 text-center",children:e.jsx(s.p,{initial:{opacity:0},animate:{opacity:1},className:"text-white/80 text-sm font-medium bg-black/50 px-4 py-2 rounded-full backdrop-blur-sm",children:a?"Analyzing pattern...":"Position the visualization within the frame"})})]})}function re({confidence:a,size:t=200,children:i}){const r=a>=80?{ring:"stroke-green-500",bg:"bg-green-500/10",text:"text-green-500"}:a>=50?{ring:"stroke-yellow-500",bg:"bg-yellow-500/10",text:"text-yellow-500"}:{ring:"stroke-red-500",bg:"bg-red-500/10",text:"text-red-500"},n=(t-4)/2,l=2*Math.PI*n,c=a/100*l;return e.jsxs("div",{className:"relative inline-flex flex-col items-center",children:[e.jsxs("div",{className:"relative",style:{width:t,height:t},children:[e.jsxs("svg",{className:"absolute inset-0 -rotate-90",width:t,height:t,viewBox:`0 0 ${t} ${t}`,children:[e.jsx("circle",{cx:t/2,cy:t/2,r:n,fill:"none",stroke:"currentColor",strokeWidth:4,className:"text-muted/30"}),e.jsx(s.circle,{cx:t/2,cy:t/2,r:n,fill:"none",strokeWidth:4,strokeLinecap:"round",className:r.ring,initial:{strokeDasharray:l,strokeDashoffset:l},animate:{strokeDashoffset:l-c},transition:{duration:1,ease:"easeOut"}})]}),e.jsx("div",{className:`absolute inset-2 rounded-full ${r.bg} overflow-hidden flex items-center justify-center`,children:i}),e.jsxs(s.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.5},className:`absolute -bottom-1 left-1/2 -translate-x-1/2 px-3 py-1 rounded-full text-sm font-bold ${r.bg} ${r.text} border-2 border-current`,children:[Math.round(a),"%"]})]}),e.jsx(s.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7},className:`mt-4 text-sm font-medium ${r.text}`,children:a>=80?"High Confidence":a>=50?"Medium Confidence":"Low Confidence"})]})}function ne({onSelectScan:v}){const{user:y}=a(),j=t(),[b,N]=i.useState([]),[w,_]=i.useState(!0),[k,S]=i.useState(!1);i.useEffect(()=>{y?C():_(!1)},[y]);const C=async()=>{if(y)try{const{data:e,error:s}=await r.from("scan_history").select("\n          id,\n          visualization_id,\n          image_preview,\n          matched,\n          confidence,\n          scanned_at\n        ").eq("user_id",y.id).order("scanned_at",{ascending:!1}).limit(20);if(s)throw s;const a=await Promise.all((e||[]).map(async e=>{if(e.visualization_id){const{data:s}=await r.from("saved_visualizations").select("title, image_path, public_share_id").eq("id",e.visualization_id).single();return{...e,visualization:s||void 0}}return e}));N(a)}catch(e){}finally{_(!1)}};return y?w?e.jsx("div",{className:"p-4 rounded-xl bg-card border border-border",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-1/3"}),e.jsx("div",{className:"h-16 bg-muted rounded"}),e.jsx("div",{className:"h-16 bg-muted rounded"})]})}):e.jsxs("div",{className:"rounded-xl bg-card border border-border overflow-hidden",children:[e.jsxs("button",{onClick:()=>S(!k),className:"w-full p-4 flex items-center justify-between hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"font-display font-bold",children:"Scan History"}),b.length>0&&e.jsx(l,{variant:"secondary",className:"text-xs",children:b.length})]}),e.jsx(s.span,{animate:{rotate:k?180:0},transition:{duration:.2},children:"â–¼"})]}),e.jsx(c,{children:k&&e.jsx(s.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:0===b.length?e.jsxs("div",{className:"p-6 text-center text-muted-foreground",children:[e.jsx(d,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No scans yet"}),e.jsx("p",{className:"text-xs",children:"Your scan history will appear here"})]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"max-h-80",children:e.jsx("div",{className:"p-2 space-y-2",children:b.map((a,t)=>{var i,n,l,c;return e.jsxs(s.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},className:"flex items-center gap-3 p-3 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors group",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-muted flex-shrink-0",children:(null==(i=a.visualization)?void 0:i.image_path)?e.jsx("img",{src:a.visualization.image_path,alt:a.visualization.title,className:"w-full h-full object-cover"}):a.image_preview?e.jsx("img",{src:a.image_preview,alt:"Scanned image",className:"w-full h-full object-cover opacity-50"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.matched?e.jsx(m,{className:"h-5 w-5 text-green-500"}):e.jsx(x,{className:"h-5 w-5 text-red-500"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a.matched?e.jsx(m,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):e.jsx(x,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),e.jsx("span",{className:"font-medium text-sm truncate",children:(null==(n=a.visualization)?void 0:n.title)||(a.matched?"Matched":"No Match")})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:u(new Date(a.scanned_at),{addSuffix:!0})}),a.confidence&&e.jsxs("span",{className:(c=a.confidence,c?c>=80?"text-green-500":c>=50?"text-yellow-500":"text-red-500":"text-muted-foreground"),children:[a.confidence,"% confidence"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(null==(l=a.visualization)?void 0:l.public_share_id)&&e.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>j(`/v/${a.visualization.public_share_id}`),children:e.jsx(p,{className:"h-4 w-4"})}),e.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>(async e=>{try{const{error:s}=await r.from("scan_history").delete().eq("id",e);if(s)throw s;N(s=>s.filter(s=>s.id!==e)),f.success("Scan removed from history")}catch(s){f.error("Failed to delete scan")}})(a.id),children:e.jsx(g,{className:"h-4 w-4"})})]})]},a.id)})})}),e.jsx("div",{className:"p-2 border-t border-border",children:e.jsxs(h,{variant:"ghost",size:"sm",className:"w-full text-muted-foreground hover:text-destructive",onClick:async()=>{if(y)try{const{error:e}=await r.from("scan_history").delete().eq("user_id",y.id);if(e)throw e;N([]),f.success("Scan history cleared")}catch(e){f.error("Failed to clear history")}},children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Clear All History"]})})]})})})]}):e.jsxs("div",{className:"p-4 rounded-xl bg-card border border-border text-center",children:[e.jsx(n,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sign in to save your scan history"})]})}const le=[{id:"first_scan",type:"first_scan",name:"First Scan",description:"Complete your first successful scan",icon:S,color:"text-yellow-500",threshold:1},{id:"explorer_5",type:"explorer_5",name:"Explorer",description:"Scan 5 unique visions",icon:C,color:"text-blue-500",threshold:5},{id:"collector_10",type:"collector_10",name:"Collector",description:"Scan 10 unique visions",icon:Z,color:"text-green-500",threshold:10},{id:"hunter_25",type:"hunter_25",name:"Vision Hunter",description:"Scan 25 unique visions",icon:N,color:"text-purple-500",threshold:25},{id:"master_50",type:"master_50",name:"Scan Master",description:"Scan 50 unique visions",icon:v,color:"text-orange-500",threshold:50},{id:"legend_100",type:"legend_100",name:"Legend",description:"Scan 100 unique visions",icon:I,color:"text-primary",threshold:100},{id:"scan_streak_10",type:"scan_streak_10",name:"Dedicated",description:"Complete 10 total scans",icon:z,color:"text-cyan-500",threshold:10},{id:"scan_streak_50",type:"scan_streak_50",name:"Enthusiast",description:"Complete 50 total scans",icon:z,color:"text-pink-500",threshold:50},{id:"scan_streak_100",type:"scan_streak_100",name:"Scanner Elite",description:"Complete 100 total scans",icon:z,color:"text-red-500",threshold:100}],ce=i.forwardRef(function(t,n){const{user:d}=a(),[m,x]=i.useState([]),[u,p]=i.useState([]),[g,f]=i.useState(null),[S,C]=i.useState(!0),[z,B]=i.useState(!1),[Q,$]=i.useState(!1);i.useEffect(()=>{K(),d&&R()},[d]);const K=async()=>{try{const{data:e,error:s}=await r.from("scan_leaderboard").select("*").limit(20);if(s)throw s;if(x(e||[]),d&&e){const s=e.find(e=>e.user_id===d.id);f(s||null)}}catch(e){}finally{C(!1)}},R=async()=>{if(d)try{const{data:e,error:s}=await r.from("scan_achievements").select("achievement_type").eq("user_id",d.id);if(s)throw s;p((e||[]).map(e=>e.achievement_type))}catch(e){}},E=s=>{switch(s){case 1:return e.jsx(I,{className:"h-5 w-5 text-yellow-500"});case 2:return e.jsx(Z,{className:"h-5 w-5 text-gray-400"});case 3:return e.jsx(Z,{className:"h-5 w-5 text-amber-600"});default:return e.jsx("span",{className:"w-5 text-center text-sm text-muted-foreground",children:s})}},O=()=>{if(!d)return null;const e=m.findIndex(e=>e.user_id===d.id)+1;return e>0?e:null};return S?e.jsx("div",{className:"p-4 rounded-xl bg-card border border-border",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-1/3"}),e.jsx("div",{className:"h-12 bg-muted rounded"}),e.jsx("div",{className:"h-12 bg-muted rounded"})]})}):e.jsxs("div",{ref:n,className:"rounded-xl bg-card border border-border overflow-hidden",children:[e.jsxs("button",{onClick:()=>B(!z),className:"w-full p-4 flex items-center justify-between hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"font-display font-bold",children:"Scan Leaderboard"}),O()&&e.jsxs(l,{variant:"secondary",className:"text-xs",children:["#",O()]})]}),z?e.jsx(y,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"})]}),e.jsx(c,{children:z&&e.jsxs(s.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:[e.jsxs("div",{className:"px-4 pb-2 flex gap-2",children:[e.jsxs(h,{variant:Q?"outline":"default",size:"sm",onClick:()=>$(!1),className:"flex-1",children:[e.jsx(b,{className:"h-4 w-4 mr-1"}),"Rankings"]}),e.jsxs(h,{variant:Q?"default":"outline",size:"sm",onClick:()=>$(!0),className:"flex-1",children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),"Achievements"]})]}),Q?e.jsx(o,{className:"max-h-80",children:e.jsx("div",{className:"p-2 space-y-2",children:le.map((a,t)=>{const i=u.includes(a.type),r=a.icon,n=g?a.type.includes("streak")?g.total_successful_scans:g.unique_visions_scanned:0,c=Math.min(100,n/a.threshold*100);return e.jsx(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"p-3 rounded-lg border transition-all "+(i?"bg-primary/10 border-primary/30":"bg-muted/30 border-border opacity-60"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg "+(i?"bg-primary/20":"bg-muted"),children:e.jsx(r,{className:`h-5 w-5 ${i?a.color:"text-muted-foreground"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:a.name}),i&&e.jsx(l,{variant:"secondary",className:"text-xs",children:"Earned"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.description}),!i&&d&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"h-1 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary transition-all",style:{width:`${c}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[n," / ",a.threshold]})]})]})]})},a.id)})})}):e.jsx(o,{className:"max-h-80",children:e.jsx("div",{className:"p-2 space-y-1",children:0===m.length?e.jsxs("div",{className:"p-6 text-center text-muted-foreground",children:[e.jsx(v,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No scans yet"}),e.jsx("p",{className:"text-xs",children:"Be the first to scan a vision!"})]}):m.map((a,t)=>{var i;const r=(null==d?void 0:d.id)===a.user_id;return e.jsxs(s.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},className:"flex items-center gap-3 p-3 rounded-lg transition-colors "+(r?"bg-primary/10 border border-primary/20":"hover:bg-muted/50"),children:[e.jsx("div",{className:"w-8 flex justify-center",children:E(t+1)}),e.jsxs(w,{className:"h-8 w-8",children:[e.jsx(_,{src:a.avatar_url||void 0}),e.jsx(k,{children:(null==(i=a.display_name)?void 0:i.charAt(0).toUpperCase())||"?"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm truncate",children:a.display_name||"Anonymous"}),r&&e.jsx(l,{variant:"outline",className:"text-xs",children:"You"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.total_successful_scans," scans"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-primary",children:a.unique_visions_scanned}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"unique"})]})]},a.user_id)})})}),d&&g&&e.jsx("div",{className:"p-4 border-t border-border",children:e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:g.unique_visions_scanned}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Unique"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold",children:g.total_successful_scans}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold",children:[u.length,"/",le.length]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Badges"})]})]})})]})})]})});function de({isOnline:a,pendingCount:t,syncing:i,onSync:r}){return a&&0===t?null:e.jsx(c,{children:e.jsxs(s.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center gap-3 p-3 rounded-lg border "+(a?"bg-primary/10 border-primary/20":"bg-yellow-500/10 border-yellow-500/20"),children:[e.jsx("div",{className:"p-2 rounded-full "+(a?"bg-primary/20":"bg-yellow-500/20"),children:a?i?e.jsx(B,{className:"h-4 w-4 text-primary animate-spin"}):e.jsx(ee,{className:"h-4 w-4 text-primary"}):e.jsx(se,{className:"h-4 w-4 text-yellow-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:a?i?"Syncing scans...":`${t} scan${t>1?"s":""} ready to sync`:"You're offline"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a?"Your offline scans will be uploaded":`${t} scan${t>1?"s":""} saved locally`})]}),t>0&&e.jsx(l,{variant:a?"default":"secondary",children:t}),a&&t>0&&!i&&e.jsxs(h,{size:"sm",onClick:r,className:"gap-1",children:[e.jsx(B,{className:"h-3 w-3"}),"Sync"]})]})})}ce.displayName="ScanLeaderboard";const oe=[{day:3,type:"common",icon:S,color:"text-blue-400",bg:"bg-blue-500/20",label:"3 Day",value:10},{day:7,type:"rare",icon:z,color:"text-purple-400",bg:"bg-purple-500/20",label:"Weekly",value:25},{day:14,type:"epic",icon:I,color:"text-amber-400",bg:"bg-amber-500/20",label:"2 Week",value:50},{day:30,type:"legendary",icon:v,color:"text-red-400",bg:"bg-red-500/20",label:"Monthly",value:100}];function me(){const{user:t}=a(),[n,l]=i.useState(null),[d,o]=i.useState([]),[m,x]=i.useState(!0),[u,h]=i.useState(!1);i.useEffect(()=>{t?(p(),g()):x(!1)},[t]);const p=async()=>{if(t)try{const{data:e,error:s}=await r.rpc("get_user_streak",{p_user_id:t.id});if(s)throw s;l(e)}catch(e){}finally{x(!1)}},g=async()=>{if(t)try{const{data:e,error:s}=await r.from("streak_rewards").select("*").eq("user_id",t.id).order("claimed_at",{ascending:!1}).limit(5);if(s)throw s;o(e)}catch(e){}};if(!t)return e.jsx("div",{className:"p-4 rounded-xl bg-card/50 border border-border/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-muted rounded-lg",children:e.jsx(Q,{className:"h-5 w-5 text-muted-foreground"})}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sign in to track your scan streak"})})]})});if(m)return e.jsx("div",{className:"p-4 rounded-xl bg-card/50 border border-border/50 animate-pulse",children:e.jsx("div",{className:"h-16 bg-muted rounded"})});const f=(null==n?void 0:n.current_streak)||0,y=(null==n?void 0:n.longest_streak)||0,j=(null==n?void 0:n.scanned_today)||!1,b=oe.find(e=>e.day>f)||oe[oe.length-1],N=Math.max(0,b.day-f),w=f>=30?"text-red-500":f>=14?"text-amber-500":f>=7?"text-purple-500":f>=3?"text-blue-500":"text-orange-400";return e.jsxs(s.div,{layout:!0,className:"rounded-xl bg-gradient-to-br from-card to-card/80 border border-border/50 overflow-hidden",children:[e.jsxs("button",{onClick:()=>h(!u),className:"w-full p-4 flex items-center justify-between hover:bg-muted/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.div,{animate:{scale:j?[1,1.1,1]:1},transition:{duration:.5,repeat:j?1/0:0,repeatDelay:1},className:"p-2 rounded-xl "+(j?"bg-orange-500/20":"bg-muted"),children:e.jsx(Q,{className:`h-7 w-7 ${j?w:"text-muted-foreground"}`})}),j&&f>=3&&e.jsx(s.div,{className:"absolute -inset-1 rounded-xl bg-gradient-to-t from-orange-500/30 to-red-500/0",animate:{opacity:[.5,.8,.5]},transition:{duration:1.5,repeat:1/0}})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold",children:f}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"day streak"}),j&&e.jsx(s.span,{initial:{scale:0},animate:{scale:1},className:"px-2 py-0.5 text-xs bg-green-500/20 text-green-400 rounded-full",children:"âœ“ Today"})]}),!j&&f>0&&e.jsx("p",{className:"text-xs text-amber-400",children:"Scan today to keep your streak!"}),0===f&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Start scanning to build your streak"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Best"}),e.jsxs("div",{className:"font-semibold",children:[y," days"]})]}),e.jsx(s.div,{animate:{rotate:u?180:0},className:"text-muted-foreground",children:"â–¼"})]})]}),e.jsx(c,{children:u&&e.jsx(s.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"p-4 pt-0 space-y-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Next reward"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(b.icon,{className:`h-4 w-4 ${b.color}`}),e.jsx("span",{className:"text-sm font-medium",children:b.label})]})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx(s.div,{className:"h-full bg-gradient-to-r from-primary to-primary/80",initial:{width:0},animate:{width:`${Math.min(100,f/b.day*100)}%`},transition:{duration:.5,ease:"easeOut"}})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1.5",children:N>0?`${N} more day${N>1?"s":""} to ${b.label} reward (+${b.value} points)`:`You've reached ${b.label} tier!`})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:oe.map(s=>{const a=s.icon,t=f>=s.day;return e.jsxs("div",{className:"p-2 rounded-lg text-center transition-all "+(t?`${s.bg} border border-current/20`:"bg-muted/30 opacity-50"),children:[e.jsx(a,{className:`h-5 w-5 mx-auto mb-1 ${t?s.color:"text-muted-foreground"}`}),e.jsxs("div",{className:"text-xs font-medium",children:[s.day,"d"]}),e.jsxs("div",{className:`text-xs ${t?s.color:"text-muted-foreground"}`,children:["+",s.value]})]},s.day)})}),d.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4 text-primary"}),"Recent Rewards"]}),e.jsx("div",{className:"space-y-1",children:d.slice(0,3).map(s=>e.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded bg-muted/20 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Day ",s.streak_day," - ",s.reward_type]}),e.jsxs("span",{className:"text-primary font-medium",children:["+",s.reward_value," pts"]})]},s.id))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 pt-2 border-t border-border/50",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"h-4 w-4 mx-auto text-muted-foreground mb-1"}),e.jsx("div",{className:"text-lg font-bold",children:(null==n?void 0:n.total_scan_days)||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Days"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(Q,{className:"h-4 w-4 mx-auto text-orange-400 mb-1"}),e.jsx("div",{className:"text-lg font-bold",children:f}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Current"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"h-4 w-4 mx-auto text-amber-400 mb-1"}),e.jsx("div",{className:"text-lg font-bold",children:y}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Best"})]})]})]})})})]})}const xe="enpensent_offline_scans";const ue=[{title:"The Immortal Game",pgn:"1. e4 e5 2. f4 exf4 3. Bc4 Qh4+ 4. Kf1 b5 5. Bxb5 Nf6 6. Nf3 Qh6 7. d3 Nh5 8. Nh4 Qg5 9. Nf5 c6 10. g4 Nf6 11. Rg1 cxb5 12. h4 Qg6 13. h5 Qg5 14. Qf3 Ng8 15. Bxf4 Qf6 16. Nc3 Bc5 17. Nd5 Qxb2 18. Bd6 Bxg1 19. e5 Qxa1+ 20. Ke2 Na6 21. Nxg7+ Kd8 22. Qf6+ Nxf6 23. Be7# 1-0"},{title:"Game of the Century",pgn:"1. Nf3 Nf6 2. c4 g6 3. Nc3 Bg7 4. d4 O-O 5. Bf4 d5 6. Qb3 dxc4 7. Qxc4 c6 8. e4 Nbd7 9. Rd1 Nb6 10. Qc5 Bg4 11. Bg5 Na4 12. Qa3 Nxc3 13. bxc3 Nxe4 14. Bxe7 Qb6 15. Bc4 Nxc3 16. Bc5 Rfe8+ 17. Kf1 Be6 18. Bxb6 Bxc4+ 19. Kg1 Ne2+ 20. Kf1 Nxd4+ 21. Kg1 Ne2+ 22. Kf1 Nc3+ 23. Kg1 axb6 24. Qb4 Ra4 25. Qxb6 Nxd1 26. h3 Rxa2 27. Kh2 Nxf2 28. Re1 Rxe1 29. Qd8+ Bf8 30. Nxe1 Bd5 31. Nf3 Ne4 32. Qb8 b5 33. h4 h5 34. Ne5 Kg7 35. Kg1 Bc5+ 36. Kf1 Ng3+ 37. Ke1 Bb4+ 38. Kd1 Bb3+ 39. Kc1 Ne2+ 40. Kb1 Nc3+ 41. Kc1 Rc2# 0-1"},{title:"Kasparov's Immortal",pgn:"1. e4 d6 2. d4 Nf6 3. Nc3 g6 4. Be3 Bg7 5. Qd2 c6 6. f3 b5 7. Nge2 Nbd7 8. Bh6 Bxh6 9. Qxh6 Bb7 10. a3 e5 11. O-O-O Qe7 12. Kb1 a6 13. Nc1 O-O-O 14. Nb3 exd4 15. Rxd4 c5 16. Rd1 Nb6 17. g3 Kb8 18. Na5 Ba8 19. Bh3 d5 20. Qf4+ Ka7 21. Rhe1 d4 22. Nd5 Nbxd5 23. exd5 Qd6 24. Rxd4 cxd4 25. Re7+ Kb6 26. Qxd4+ Kxa5 27. b4+ Ka4 28. Qc3 Qxd5 29. Ra7 Bb7 30. Rxb7 Qc4 31. Qxf6 Kxa3 32. Qxa6+ Kxb4 33. c3+ Kxc3 34. Qa1+ Kd2 35. Qb2+ Kd1 36. Bf1 Rd2 37. Rd7 Rxd7 38. Bxc4 bxc4 39. Qxh8 Rd3 40. Qa8 c3 41. Qa4+ Ke1 42. f4 f5 43. Kc1 Rd2 44. Qa7 1-0"}],he=[{icon:G,title:"Capture",desc:"Photograph any En Pensent vision"},{icon:te,title:"Detect",desc:"AI reads the visual encryption"},{icon:L,title:"Decrypt",desc:"Pattern decoded to identify game"},{icon:z,title:"Connect",desc:"Link to the unified experience"}];function pe(){var n,d,o,u,g,v;const y=t(),{user:j}=a(),N=i.useRef(null),w=i.useRef(null),_=i.useRef(null),k=K(6),{isOnline:S,pendingCount:C,syncing:z,cacheScan:B,syncPendingScans:Q}=function(e){const[s,a]=i.useState(navigator.onLine),[t,n]=i.useState([]),[l,c]=i.useState(!1);i.useEffect(()=>{const e=localStorage.getItem(xe);if(e)try{n(JSON.parse(e))}catch{localStorage.removeItem(xe)}},[]),i.useEffect(()=>{const e=()=>{a(!0),f.success("Back online! Syncing scans...")},s=()=>{a(!1),f.warning("You're offline. Scans will be saved locally.")};return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),i.useEffect(()=>{s&&e&&t.length>0&&!l&&o()},[s,e,t.length]);const d=i.useCallback(e=>{const s={...e,id:crypto.randomUUID(),timestamp:Date.now()};return n(e=>{const a=[...e,s];return localStorage.setItem(xe,JSON.stringify(a)),a}),s.id},[]),o=i.useCallback(async()=>{var s;if(!e||0===t.length||l)return;c(!0);let a=0;const i=[];for(const n of t)try{const{error:t}=await r.from("scan_history").insert({user_id:e,visualization_id:n.visualizationId||null,matched:n.matched,confidence:n.confidence?Math.round(n.confidence):null,image_preview:(null==(s=n.imagePreview)?void 0:s.substring(0,500))||null,scanned_at:new Date(n.timestamp).toISOString()});t?i.push(n):a++}catch(d){i.push(n)}if(n(i),localStorage.setItem(xe,JSON.stringify(i)),c(!1),a>0){f.success(`Synced ${a} offline scan${a>1?"s":""}`);try{await r.rpc("check_scan_achievements",{p_user_id:e})}catch(d){}}i.length>0&&f.error(`Failed to sync ${i.length} scan${i.length>1?"s":""}`)},[e,t,l]),m=i.useCallback(()=>{n([]),localStorage.removeItem(xe)},[]);return{isOnline:s,pendingScans:t,pendingCount:t.length,syncing:l,cacheScan:d,syncPendingScans:o,clearCache:m}}(null==j?void 0:j.id),[$,G]=i.useState(!1),[Z,ee]=i.useState("idle"),[se,ae]=i.useState(null),[te,le]=i.useState(null),[oe,pe]=i.useState(!1),[ge,fe]=i.useState(null),[ve,ye]=i.useState(null),[je,be]=i.useState(!1),[Ne,we]=i.useState("experience"),[_e,ke]=i.useState(!0),[Se,Ce]=i.useState(!1),[Ie,ze]=i.useState(0),[Be,Qe]=i.useState(0),[$e,Ke]=i.useState(0),[Re,Ee]=i.useState(0);i.useEffect(()=>{if(!$&&!se&&!oe){const e=setInterval(()=>{ze(e=>(e+1)%4)},3e3);return()=>clearInterval(e)}},[$,se,oe]);const Oe=async e=>{var s,a;if(G(!0),ee("scanning"),ae(null),le(e),!S)return j&&(B({matched:!1,imagePreview:e.substring(0,500)}),f.info("Scan saved offline",{description:"Will sync when connection is restored"})),G(!1),ee("failed"),void ae({matched:!1,reason:"You're offline. Scan saved locally and will sync when you're back online."});try{await new Promise(e=>setTimeout(e,400)),ee("analyzing"),await new Promise(e=>setTimeout(e,300)),ee("decrypting");const i=await fetch("https://aufycarwflhsdgszbnop.supabase.co/functions/v1/vision-scanner",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF1ZnljYXJ3Zmxoc2Rnc3pibm9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc5ODUwOTEsImV4cCI6MjA4MzU2MTA5MX0.uNxFLqJ3BGKkAj1pj77fxnCfDGTcdKFuCIF8HMPYiXw","Content-Type":"application/json"},body:JSON.stringify({image_base64:e})});if(!i.ok)throw new Error("Scan failed");const n=await i.json();if(ae(n),j){await async function(e,s,a,t,i){try{const{error:n}=await r.from("scan_history").insert({user_id:e,visualization_id:a||null,matched:s,confidence:t?Math.round(t):null,image_preview:(null==i?void 0:i.substring(0,500))||null});if(n)throw n}catch(n){}}(j.id,n.matched,null==(s=n.vision)?void 0:s.visualization_id,null==(a=n.vision)?void 0:a.confidence,e.substring(0,500)),Qe(e=>e+1);try{const e=await async function(e){try{const{data:s,error:a}=await r.rpc("update_scan_streak",{p_user_id:e});if(a)throw a;return s}catch(s){return null}}(j.id);(null==e?void 0:e.new_day)&&(Ee(e=>e+1),e.streak_broken?f.info("Streak reset",{description:"Your streak was reset. Keep scanning daily!"}):e.reward_value>0&&f.success(`ðŸ”¥ ${e.current_streak} Day Streak!`,{description:`+${e.reward_value} points (${e.reward_type} reward)`}))}catch(t){}try{const{data:e}=await r.rpc("check_scan_achievements",{p_user_id:j.id}),s=(e||[]).filter(e=>e.just_earned);s.length>0&&(f.success("ðŸ† Achievement Unlocked!",{description:`You earned: ${s.map(e=>e.achievement_type.replace(/_/g," ")).join(", ")}`}),Ke(e=>e+1))}catch(t){}}n.matched&&n.vision?(ee("matched"),await qe(n.vision.visualization_id),be(!0),f.success("ðŸ”“ Visual encryption decrypted!",{description:`Found: ${n.vision.title} (${n.vision.confidence}% confidence)`})):(ee("failed"),n.is_valid_vision&&f.info("Vision detected but not in database",{description:n.decryption_notes||"This appears to be an En Pensent visualization we haven't seen before."}))}catch(t){ee("failed"),ae({matched:!1,reason:"Failed to process image",error:String(t)}),f.error("Decryption failed",{description:"Please try again with a clearer image"})}finally{G(!1)}},Me=i.useCallback(()=>{var e,s,a;if((null==se?void 0:se.game_hash)||(null==(e=null==se?void 0:se.vision)?void 0:e.game_hash)){const e=se.game_hash||(null==(s=se.vision)?void 0:s.game_hash),t=se.palette_id||(null==(a=se.vision)?void 0:a.palette_id);let i=`/g/${e}`;t&&"modern"!==t&&(i+=`?p=${t}`),y(i)}else(null==se?void 0:se.share_url)&&y(se.share_url)},[se,y]),qe=async e=>{try{const{data:s,error:a}=await r.from("saved_visualizations").select("*").eq("id",e).single();if(a)throw a;const t="string"==typeof s.game_data?JSON.parse(s.game_data):s.game_data;fe({...s,game_data:t});const{data:i,error:n}=await r.from("vision_scores").select("*").eq("visualization_id",e).single();!n&&i&&ye(i)}catch(s){}},De=i.useCallback(e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];if(!a)return;const t=new FileReader;t.onload=()=>{const e=t.result;Oe(e)},t.readAsDataURL(a)},[]),Pe=()=>{var e;if(null==(e=w.current)?void 0:e.srcObject){w.current.srcObject.getTracks().forEach(e=>e.stop()),w.current.srcObject=null,pe(!1)}},Ae=()=>{ae(null),le(null),fe(null),ye(null),be(!1),we("experience"),ee("idle")},Fe=()=>{(null==ge?void 0:ge.public_share_id)&&y(`/v/${ge.public_share_id}`)};if(je&&ge){null==(n=ge.game_data)||n.board;const s=ge.game_data;return null==(d=null==s?void 0:s.moves)||d.length,e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(R,{}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs(h,{variant:"ghost",onClick:Ae,className:"mb-6 gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Scan Another Vision"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-display font-bold",children:ge.title}),(null==(o=null==se?void 0:se.vision)?void 0:o.confidence)&&e.jsxs(l,{variant:"secondary",className:"mt-2",children:[Math.round(se.vision.confidence),"% Match Confidence"]})]}),e.jsxs(h,{onClick:Fe,className:"gap-2",children:[e.jsx(p,{className:"h-4 w-4"}),"View Full Experience"]})]}),e.jsxs(O,{value:Ne,onValueChange:e=>we(e),children:[e.jsxs(M,{className:"grid w-full max-w-md grid-cols-2",children:[e.jsxs(q,{value:"experience",className:"gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Experience"]}),e.jsxs(q,{value:"analytics",className:"gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Analytics"]})]}),e.jsx(A,{value:"experience",className:"mt-6",children:e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(re,{confidence:(null==(u=null==se?void 0:se.vision)?void 0:u.confidence)||0,size:Math.min(400,window.innerWidth-100),children:e.jsx("img",{src:ge.image_path,alt:ge.title,className:"w-full h-full object-cover rounded-full"})})}),e.jsx("div",{className:"mt-6 aspect-square bg-card rounded-xl overflow-hidden border border-border",children:e.jsx("img",{src:ge.image_path,alt:ge.title,className:"w-full h-full object-contain"})})]}),e.jsx("div",{className:"space-y-4",children:(null==s?void 0:s.gameInfo)&&e.jsxs("div",{className:"p-4 rounded-xl bg-card border border-border space-y-2",children:[e.jsx("h3",{className:"font-display font-bold text-sm uppercase tracking-wide",children:"Game Info"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"White:"})," ",s.gameInfo.white||"Unknown"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Black:"})," ",s.gameInfo.black||"Unknown"]}),s.gameInfo.event&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Event:"})," ",s.gameInfo.event]}),s.gameInfo.date&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Date:"})," ",s.gameInfo.date]}),s.gameInfo.result&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Result:"})," ",s.gameInfo.result]})]})]})})]})}),e.jsx(A,{value:"analytics",className:"mt-6",children:e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-6 rounded-xl bg-card border border-border",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:(null==ve?void 0:ve.view_count)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Views"})]}),e.jsxs("div",{className:"p-6 rounded-xl bg-card border border-border",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:(null==ve?void 0:ve.unique_viewers)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Unique Viewers"})]}),e.jsxs("div",{className:"p-6 rounded-xl bg-card border border-border",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:(null==ve?void 0:ve.trade_count)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Times Traded"})]}),e.jsxs("div",{className:"p-6 rounded-xl bg-card border border-border",children:[e.jsx("div",{className:"text-3xl font-bold text-gold-gradient",children:(null==ve?void 0:ve.total_score)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Vision Score"})]})]})})]})]})]})}),e.jsx(F,{})]})}return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(R,{}),e.jsx("main",{className:"container mx-auto px-4 py-8 md:py-16",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 border border-primary/20 text-primary text-sm font-display uppercase tracking-widest mb-6",children:[e.jsx(T,{className:"h-4 w-4"}),"Revolutionary Technology",e.jsx(l,{variant:"secondary",className:"ml-2 text-xs",children:"Patent Pending"})]}),e.jsx(s.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-4xl md:text-6xl font-royal font-bold uppercase tracking-wide mb-4",children:"Natural Visionâ„¢"}),e.jsx(s.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"text-muted-foreground text-lg md:text-xl max-w-2xl mx-auto",children:"Every visualization is visually encrypted with its own data â€” a unique fingerprint that our AI can recognize instantly."})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},className:"mb-12",children:[e.jsx("div",{className:"grid grid-cols-3 gap-4 md:gap-6 max-w-3xl mx-auto",children:ue.map((a,t)=>e.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3+.1*t},className:"relative group",children:[e.jsxs("div",{className:"relative rounded-xl overflow-hidden border border-border/50 bg-card/50 backdrop-blur-sm shadow-lg hover:shadow-xl transition-shadow",children:[e.jsx(s.div,{className:"absolute inset-0 z-10 pointer-events-none",style:{background:"linear-gradient(180deg, hsl(var(--primary) / 0.3) 0%, transparent 50%, transparent 100%)",height:"50%"},animate:{top:["-50%","100%"]},transition:{duration:2.5+.5*t,repeat:1/0,ease:"linear",delay:.3*t}}),e.jsx(V,{pgn:a.pgn,size:180,animationSpeed:100+20*t,className:"w-full"}),e.jsx("div",{className:"absolute top-2 left-2 w-4 h-4 border-l-2 border-t-2 border-primary/60"}),e.jsx("div",{className:"absolute top-2 right-2 w-4 h-4 border-r-2 border-t-2 border-primary/60"}),e.jsx("div",{className:"absolute bottom-2 left-2 w-4 h-4 border-l-2 border-b-2 border-primary/60"}),e.jsx("div",{className:"absolute bottom-2 right-2 w-4 h-4 border-r-2 border-b-2 border-primary/60"}),e.jsx("div",{className:"absolute inset-0 bg-primary/0 group-hover:bg-primary/10 transition-colors duration-300"})]}),e.jsx("p",{className:"text-xs md:text-sm text-center text-muted-foreground mt-2 font-medium truncate px-1",children:a.title})]},a.title))}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground mt-6",children:[e.jsx(T,{className:"inline h-4 w-4 mr-1.5 text-primary"}),"Each vision is a unique visual encryption of its chess game"]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-start",children:[e.jsx(s.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{delay:.3},className:"space-y-6",children:e.jsxs("div",{className:"p-6 rounded-2xl bg-card border border-border/50 shadow-xl",children:[e.jsxs("h2",{className:"text-xl font-display font-bold mb-4 flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-primary"}),"Vision Scanner"]}),e.jsxs("div",{className:"aspect-square relative rounded-xl overflow-hidden bg-muted/20 border border-dashed border-border",children:[oe?e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:w,autoPlay:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"}),e.jsx(ie,{scanning:$})]}):te?e.jsx("img",{src:te,alt:"Scan preview",className:"absolute inset-0 w-full h-full object-contain"}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center p-6",children:[e.jsxs("div",{className:"w-48 h-48 mb-4 relative",children:[e.jsx(V,{pgn:ue[Ie%ue.length].pgn,size:192,animationSpeed:100,className:"w-full h-full opacity-60"}),e.jsx(s.div,{className:"absolute inset-0 pointer-events-none",style:{background:"linear-gradient(180deg, transparent 0%, hsl(var(--primary) / 0.3) 50%, transparent 100%)",height:"30%"},animate:{top:["-30%","100%"]},transition:{duration:2,repeat:1/0,ease:"linear"}}),e.jsx(s.div,{className:"absolute inset-4 border-2 border-primary/50 rounded-lg",animate:{opacity:[.3,.8,.3]},transition:{duration:2,repeat:1/0}})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Scan any En Pensent vision to decrypt it"})]}),e.jsx(c,{children:$&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-background/90 backdrop-blur-sm flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(s.div,{animate:{scale:"matched"===Z?[1,1.2,1]:1,rotate:"decrypting"===Z?[0,5,-5,0]:0},transition:{duration:.5,repeat:"decrypting"===Z?1/0:0},children:"matched"===Z?e.jsx(L,{className:"h-16 w-16 text-green-500 mx-auto"}):e.jsx(J,{className:"h-16 w-16 text-primary mx-auto"})}),e.jsx("div",{className:"flex justify-center gap-2",children:["scanning","analyzing","decrypting"].map((a,t)=>e.jsx(s.div,{className:"h-1.5 w-8 rounded-full "+(["scanning","analyzing","decrypting","matched"].indexOf(Z)>=t?"bg-primary":"bg-muted"),animate:{opacity:Z===a?[.5,1,.5]:1},transition:{duration:.8,repeat:Z===a?1/0:0}},a))}),e.jsx(s.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-sm font-medium text-primary",children:(e=>{switch(e){case"scanning":return"Scanning for visual encryption...";case"analyzing":return"Analyzing color fingerprint pattern...";case"decrypting":return"Decrypting game signature...";case"matched":return"Encryption key found!";case"failed":return"No matching encryption detected";default:return""}})(Z)},Z),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Reading visual encryption pattern..."})]})})}),e.jsx(c,{children:(null==se?void 0:se.matched)&&!$&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-background/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(s.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:15},children:e.jsx(m,{className:"h-16 w-16 text-green-500 mx-auto"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-1",children:"ðŸ”“ Decrypted!"}),e.jsx("p",{className:"text-primary font-semibold",children:null==(g=se.vision)?void 0:g.title}),e.jsxs(l,{variant:"secondary",className:"mt-2",children:[null==(v=se.vision)?void 0:v.confidence,"% Match"]})]}),se.decryption_notes&&e.jsx("p",{className:"text-xs text-muted-foreground max-w-xs mx-auto",children:se.decryption_notes}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(h,{onClick:Me,className:"gap-2",children:[e.jsx(p,{className:"h-4 w-4"}),"Open Game Menu"]}),e.jsx(h,{onClick:Ae,variant:"outline",children:"Scan Another"})]})]})})}),e.jsx(c,{children:se&&!se.matched&&!$&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-background/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(x,{className:"h-16 w-16 text-destructive mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:se.is_valid_vision?"Unknown Vision":"No Match Found"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:se.reason||se.message}),se.decryption_notes&&e.jsxs("p",{className:"text-xs text-muted-foreground/70 max-w-xs mx-auto",children:["Detected: ",se.decryption_notes]})]}),e.jsx(h,{onClick:Ae,variant:"outline",children:"Try Again"})]})})})]}),e.jsx("canvas",{ref:_,className:"hidden"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mt-6",children:oe?e.jsxs(e.Fragment,{children:[e.jsxs(h,{onClick:()=>{if(!w.current||!_.current)return;const e=_.current,s=w.current;e.width=s.videoWidth,e.height=s.videoHeight;const a=e.getContext("2d");if(a){a.drawImage(s,0,0);const t=e.toDataURL("image/jpeg",.8);Pe(),Oe(t)}},className:"gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Capture"]}),e.jsx(h,{onClick:Pe,variant:"outline",className:"gap-2",children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(h,{onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});w.current&&(w.current.srcObject=e,pe(!0))}catch(e){f.error("Camera access denied",{description:"Please allow camera access to scan"})}},className:"gap-2",disabled:$,children:[e.jsx(Y,{className:"h-4 w-4"}),"Use Camera"]}),e.jsxs(h,{variant:"outline",onClick:()=>{var e;return null==(e=N.current)?void 0:e.click()},className:"gap-2",disabled:$,children:[e.jsx(W,{className:"h-4 w-4"}),"Upload Image"]})]})}),e.jsx("input",{ref:N,type:"file",accept:"image/*",onChange:De,className:"hidden"}),(C>0||!S)&&e.jsx("div",{className:"mt-4",children:e.jsx(de,{isOnline:S,pendingCount:C,syncing:z,onSync:Q})}),e.jsx("div",{className:"mt-4",children:e.jsx(me,{},Re)}),e.jsx("div",{className:"mt-4",children:e.jsx(ne,{},Be)}),e.jsx("div",{className:"mt-4",children:e.jsx(ce,{},$e)})]})}),e.jsxs(s.div,{initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{delay:.4},className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:he.map((a,t)=>{const i=a.icon,r=Ie===t;return e.jsxs(s.div,{className:"relative p-5 rounded-xl border overflow-hidden transition-all duration-300 "+(r?"border-primary/30 shadow-lg shadow-primary/10":"border-border/50"),animate:{scale:r?1.02:1},children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-15",style:{backgroundImage:`url(${k[t]})`}}),e.jsx("div",{className:"absolute inset-0 "+(r?"bg-primary/10":"bg-card/80")}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(i,{className:"h-7 w-7 mb-3 "+(r?"text-primary":"text-muted-foreground")}),e.jsx("h4",{className:"font-semibold text-lg "+(r?"text-foreground":"text-muted-foreground"),children:a.title}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.desc})]})]},a.title)})}),e.jsxs("div",{className:"bg-gradient-to-br from-primary/10 to-primary/5 rounded-xl p-6 border border-primary/20",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-primary/20 rounded-lg",children:e.jsx(I,{className:"h-7 w-7 text-primary"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg mb-2",children:"Early Visionary Advantage"}),e.jsxs("p",{className:"text-sm text-muted-foreground leading-relaxed",children:["Every scan, view, and engagement increases your Vision's score. As our community grows, early visions become more valuable â€”",e.jsx("span",{className:"text-primary font-medium",children:" your art appreciates with our platform."})]})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-primary/20 flex items-center gap-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-muted-foreground",children:"More Members"})]}),e.jsx(H,{className:"h-4 w-4 text-primary"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-muted-foreground",children:"Higher Vision Scores"})]})]})]}),e.jsxs("div",{className:"relative overflow-hidden rounded-xl p-6 border border-border/50",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-10",style:{backgroundImage:`url(${k[0]})`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-card via-card/80 to-transparent"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Traditional QR Also Included"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Every print includes a standard QR code for compatibility with any smartphone camera. The Natural Vision scanner offers enhanced recognition for prints photographed from any angle."})]})]})]})]})]})}),e.jsx(F,{})]})}export{pe as default};
