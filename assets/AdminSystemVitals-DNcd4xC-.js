import{s as e,r as s,j as t,C as n,p as r,t as a,w as c,B as i,v as l,x as o,aB as d,aC as u,aD as m,bh as x,ad as h,aE as f,z as j,bC as g,D as v,aA as p,dt as N,cb as y,y as w,aY as b,dg as C,c_ as M,aO as D,aq as B,bG as z,fF as _,b as k,fE as S,gc as A}from"./index-ckGSTu6A.js";import{u as L}from"./useMutation-BW57iMFc.js";import{S as q}from"./server-V81UtC-K.js";import{C as H}from"./circle-alert-iJdJXpIA.js";const P=E;!function(){const e=E,s=F();for(;;)try{if(236881===parseInt(e(418))/1*(-parseInt(e(471))/2)+parseInt(e(460))/3+parseInt(e(488))/4+parseInt(e(443))/5+parseInt(e(423))/6+parseInt(e(416))/7+-parseInt(e(458))/8*(parseInt(e(469))/9))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const R=function(){const e=E,s={qXZIz:function(e,s){return e!==s}};s.GrTQk=e(437),s.phgPC="AUppa";const t=s;let n=!0;return function(s,r){const a=e,c={mLrVh:function(e,s){return t[E(452)](e,s)},qzpsh:t[a(481)]};if("AUppa"===t.phgPC){const e=n?function(){const e=a;if(r){if(c[e(449)](c[e(441)],c.qzpsh)){const s=_0x5dd7aa[e(427)](e=>_0x1ff70c(e,_0x508579));return _0x3eaff.all(s)}{const t=r[e(435)](s,arguments);return r=null,t}}}:function(){};return n=!1,e}{const e=_0x3c28c2?function(){if(_0x483cd2){const e=_0x2a7a81[a(435)](_0x5e1c40,arguments);return _0x50cbdc=null,e}}:function(){};return _0x242995=!1,e}}}()(void 0,function(){const e=E,s={};s.RStDO=e(478)+"+$";const t=s;return R[e(473)]()[e(487)](t[e(403)])[e(473)]().constructor(R)[e(487)](t[e(403)])});R();const I=function(){const e={JCHKB:function(e,s){return e!==s}},s=e;let t=!0;return function(e,n){const r=E;if(s.JCHKB(r(482),r(450))){const s=t?function(){if(n){const s=n.apply(e,arguments);return n=null,s}}:function(){};return t=!1,s}_0x7886c2=_0x5d7f13}}();I(void 0,function(){const e=E,s={rXgAN:function(e,s){return e-s},VHJHW:e(428),HeeeK:function(e,s){return e(s)},CuDYR:"{}.constru"+e(434)+e(436)+" )",AznRN:function(e,s){return e===s},wEDyC:"IIWrp",LPBQS:e(408),fHOdV:e(461),QvMyR:e(422)},t=function(){const t=e,n=function(e,t){return s[E(472)](e,t)};if(t(486)!==s.VHJHW){let e;try{e=s.HeeeK(Function,t(424)+t(444)+s.CuDYR+");")()}catch(r){if(s[t(430)](s[t(456)],t(411)))e=window;else if(_0x2f753d){const e=_0x5c3e3a[t(435)](_0x3c6fe9,arguments);return _0x43ab8b=null,e}}return e}{const e=n(_0x20400c.now(),_0x266239);_0x12641e={functionName:_0x1a2f35,status:"unhealthy",responseTime:e,lastChecked:(new _0x398167)[t(457)+"g"](),error:_0x6b3c24 instanceof _0x5de23d?_0x1c65d2[t(467)]:"Unknown er"+t(439)}}}(),n=t[e(484)]=t[e(484)]||{},r=[s[e(451)],s.fHOdV,"info","error",s[e(468)],e(417),e(405)];for(let a=0;a<r[e(419)];a++){const s=I[e(409)+"r"][e(448)][e(462)](I),t=r[a],c=n[t]||s;s[e(410)]=I[e(462)](I),s[e(473)]=c[e(473)][e(462)](c),n[t]=s}})();const T=new Map,U=new Map;function F(){const e=["B0Lszu8","kcGOlISPkYKRkq","z2v0","AgfZ","r3juuwS","tejgvLG","s0TYyNC","y29UC29Szq","CMvZDwX0","qLfmyvy","C2vHCMnO","mta2mdqWmhDpwuDhBq","zxzHBa","uLn0re8","C2v0","DhjHy2u","y2XLyxi","ywrTAw4","Bg9N","y29UC3rYDwn0BW","x19WCM90B19F","suLxCNa","ChvZAa","C3rVy2TMAxnOlq","ywXS","y2HLy2STC3vICW","mtCXntmYouHVCfDhuG","DgfIBgu","mtzhEKHNBMW","BgvUz3rO","B3j0ywW","Dg90ywW","zxHJzxb0Aw9U","mtaZnZeWAw5YrLve","CMv0DxjUicHMDq","A0zmuKO","z3jHBNqTy2vVlq","BwfW","BhvJshG","zMXVB3i","qxPUuK4","C2HPzNq","zffVrge","A0z2uMW","y3rVCIGICMv0Dq","yxbWBhK","CM4GDgHPCYiPka","AM5xzhm","tM12sgS","CM9Y","vw5RBM93BIbLCG","CxPWC2G","D2fYBMLUzW","mZC1nZKWAuTjshnh","BMn0Aw9UkcKG","DgLTzxn0yw1W","BM93","y3jLyxrLlwnOzq","ChjVDg90ExbL","BuXYvMG","wgnrCva","tfbcuvm","CvHAsxO","z3Lksvi","C0HAA2G","y2TVDxq","D0veEum","Dg9ju09tDhjPBG","mZC4mteYqxDnCwre","y3vZDg9TzxiTCa","mJq0ndCZCLvXwgHk","D2fYBG","yMLUza","EezyweG","AgvHBhrOEq","zxjYB3i","C3rHDhvZ","BwvZC2fNzq","uxznEvi","ndvAEMzhDeG","Aw52B2TL","mJyZnJb2s1rbwgC","CLHNqu4","Dg9tDhjPBMC","Dw5OzwfSDgH5","C2XNtgO","zMLSDgvY"];return(F=function(){return e})()}async function G(s,t=5e3){const n=E,r={jxxtF:function(e,s,t){return e(s,t)},VVPVM:n(465),kFLRJ:n(464),sHZkh:"unhealthy",slgLj:n(440)+"ror"},a=T[n(479)](s);if(a&&Date[n(446)]()-a[n(445)]<3e4)return a[n(485)];const c=performance[n(446)]();let i;try{const{data:t,error:a}=await e.functions[n(470)](s,{body:{healthCheck:!0,timestamp:Date[n(446)]()}}),l=performance.now()-c;if(r.jxxtF(O,s,l),a)i={functionName:s,status:r.VVPVM,responseTime:l,lastChecked:(new Date).toISOString(),error:a[n(467)]};else{let e=r[n(425)];l>3e3?e=n(474):l>1e3&&(e=n(442)),i={functionName:s,status:e,responseTime:l,lastChecked:(new Date).toISOString(),details:t}}}catch(l){const e=performance[n(446)]()-c;i={functionName:s,status:r[n(454)],responseTime:e,lastChecked:(new Date)[n(457)+"g"](),error:l instanceof Error?l.message:r[n(475)]}}return T[n(404)](s,{result:i,timestamp:Date[n(446)]()}),i}function O(e,s){const t=E,n={};n[t(463)]=function(e,s){return e>s};const r=n;!U[t(480)](e)&&U.set(e,[]);const a=U[t(479)](e);a[t(412)](s),r[t(463)](a.length,100)&&a[t(431)]()}function K(e){const s=E,t={};t[s(433)]=function(e,s){return e/s},t[s(453)]=function(e,s){return e*s},t[s(477)]=function(e,s){return e-s};const n=t,r=U.get(e);if(!r||0===r[s(419)])return null;const a=[...r].sort((e,s)=>e-s),c=a.length,i=a.reduce((e,s)=>e+s,0);return{functionName:e,totalInvocations:c,successfulInvocations:c,failedInvocations:0,averageResponseTime:n[s(433)](i,c),p95ResponseTime:a[Math[s(429)](n[s(453)](c,.95))]||a[n[s(477)](c,1)],p99ResponseTime:a[Math[s(429)](.99*c)]||a[n.oIReO(c,1)],errorRate:0,lastInvocation:(new Date)[s(457)+"g"]()}}function E(e,s){e-=403;const t=F();let n=t[e];if(void 0===E.qBmzbu){var r=function(e){let s="",t="",n=s+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?s+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};E.GlXRbF=r,E.ghntKM={},E.qBmzbu=!0}const a=e+t[0],c=E.ghntKM[a];if(c)n=c;else{const e=function(e){this.gkFkUU=e,this.FRPDGf=[1,0,0],this.NfsEDc=function(){return"newState"},this.SftAus="\\w+ *\\(\\) *{\\w+ *",this.WZBOAh="['|\"].+['|\"];? *}"};e.prototype.OlMgfU=function(){const e=new RegExp(this.SftAus+this.WZBOAh).test(this.NfsEDc.toString())?--this.FRPDGf[1]:--this.FRPDGf[0];return this.rwXuZK(e)},e.prototype.rwXuZK=function(e){return Boolean(~e)?this.LQFQTv(this.gkFkUU):e},e.prototype.LQFQTv=function(e){for(let s=0,t=this.FRPDGf.length;s<t;s++)this.FRPDGf.push(Math.round(Math.random())),t=this.FRPDGf.length;return e(this.FRPDGf[0])},new e(E).OlMgfU(),n=E.GlXRbF(n),E.ghntKM[a]=n}return n}function W(e){const s=E,t={};t[s(432)]=function(e,s){return e>s};const n=t,r=e[s(476)](e=>e.status===s(464))[s(419)],a=e[s(476)](e=>e[s(466)]===s(442)).length,c=e[s(476)](e=>"error"===e[s(466)]||"unhealthy"===e.status).length,i=e.length;let l=s(464);n.dQoDa(c,0)?l="critical":a>0&&(l=s(442));const o={};return o[s(466)]=l,o[s(464)]=r,o.warning=a,o[s(465)]=c,o[s(421)]=i,o}const Z=[P(415)+"cription",P(447)+P(455),P(459)+P(420),P(426)+P(407),P(413)+P(489)],V=X;!function(){const e=X,s=ee();for(;;)try{if(465393===-parseInt(e(359))/1*(parseInt(e(363))/2)+-parseInt(e(309))/3*(-parseInt(e(372))/4)+-parseInt(e(365))/5+parseInt(e(330))/6+parseInt(e(299))/7+parseInt(e(341))/8+-parseInt(e(355))/9)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const Y=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[X(302)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=X,s={};s[e(367)]=e(353)+"+$";const t=s;return Y[e(362)]()[e(379)](t[e(367)])[e(362)]()[e(384)+"r"](Y)[e(379)](t[e(367)])});Y();const J=function(){const e=X,s={};s.PRVOZ=e(340);const t=s;let n=!0;return function(e,s){const r=n?function(){const n=X;if(t[n(349)]===n(337))return _0x54c40b[n(348)](_0x8714c9.values());if(s){const t=s[n(302)](e,arguments);return s=null,t}}:function(){};return n=!1,r}}();function X(e,s){e-=295;const t=ee();let n=t[e];if(void 0===X.vTeiud){var r=function(e){let s="",t="",n=s+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?s+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};X.PIlztM=r,X.uCyTSs={},X.vTeiud=!0}const a=e+t[0],c=X.uCyTSs[a];if(c)n=c;else{const e=function(e){this.BddMzB=e,this.gklNcJ=[1,0,0],this.ZHoIXs=function(){return"newState"},this.TohmYu="\\w+ *\\(\\) *{\\w+ *",this.mkHXro="['|\"].+['|\"];? *}"};e.prototype.uQoxiJ=function(){const e=new RegExp(this.TohmYu+this.mkHXro).test(this.ZHoIXs.toString())?--this.gklNcJ[1]:--this.gklNcJ[0];return this.dujUtq(e)},e.prototype.dujUtq=function(e){return Boolean(~e)?this.TvezBo(this.BddMzB):e},e.prototype.TvezBo=function(e){for(let s=0,t=this.gklNcJ.length;s<t;s++)this.gklNcJ.push(Math.round(Math.random())),t=this.gklNcJ.length;return e(this.gklNcJ[0])},new e(X).uQoxiJ(),n=X.PIlztM(n),X.uCyTSs[a]=n}return n}J(void 0,function(){const e=X,s={GNeSF:function(e,s){return e+s},YjRRT:'{}.constructor("retu'+e(358)+" )",WRusd:function(e){return e()},MRuwp:e(345),aFhUJ:e(331),PDIQw:e(369),tQPmE:"exception",bFfYw:e(324)};let t;try{const n=Function(s[e(326)](e(319)+e(383),s[e(316)])+");");t=s.WRusd(n)}catch(a){t=window}const n=t[e(364)]=t[e(364)]||{},r=[s[e(317)],s[e(320)],s[e(361)],"error",s[e(312)],e(307),s[e(304)]];for(let c=0;c<r.length;c++){const s=J[e(384)+"r"].prototype[e(366)](J),t=r[c],a=n[t]||s;s[e(352)]=J[e(366)](J),s[e(362)]=a.toString[e(366)](a),n[t]=s}})();const Q={autoRefresh:!0};Q[V(380)+V(378)]=3e4,Q[V(334)]=[...Z];const $=Q;function ee(){const e=["x19WCM90B19F","kcGOlISPkYKRkq","zvrttvG","mtKXmtGYnuTnDvDHyq","D2Lhu1u","EgzZu0u","CM4GDgHPCYiPka","mtfot2LRuw8","zNvUy3rPB25oyq","uerjuxC","Dg9tDhjPBMC","mteWntq4tNvSyw1L","y29UC29Szq","mZKYote1mhfPzgLVBW","yMLUza","t09qALK","rK1bzfq","Aw5MBW","v1nVEuG","wfzSru0","mJbtyKvYyvG","BgvUz3rO","BhvIBhy","AvD0EKO","EvzABuC","uejVs3C","zxj2ywW","C2vHCMnO","CMvMCMvZAeLUDa","zMLUzeLUzgv4","z2v0","BMn0Aw9UkcKG","y29UC3rYDwn0BW","C2v0","zM9YrwfJAa","ChDREeC","B25tDgf0DxndAa","DMfSDwvZ","zhjfs2i","we93sKy","mJKYmdq4nhzMCeT1yW","CMvKDwnL","zenyzMS","yxbWBhK","yNr5C1m","yKzMwxC","zMTRALu","zxjYB3i","DgfIBgu","y3vYCMvUDa","mtuWote4Bvr3Ew5d","AxnmB2fKAw5N","yMngB3m","DffqBuu","zMLSDgvY","sezqvNy","B25fCNjVCG","wwPsuLq","tvj1D3a","C3LZDgvTu3rHDa","CMv0DxjUicHMDq","yuzOvuO","yuf5Ehy","u0LWCKu","AgvHBhrOEq","DhjHy2u","CMvZDwX0CW","r05Lu0y","yxv0B1jLzNjLCW","BwvZC2fNzq","BgfZDfvWzgf0zq","ntm5ndq2mNPdBvD6yG","D2fYBG","vMjJtwC","Dw5RBM93BG","zNvUy3rPB25Z","yw5Nzq","EuvACwe","AfHAExy","BKjoqKi","u296Aw4","v1P6sge","ndaZmdC0nhj5zu14zG","C3rHDhvZ","Dg9ju09tDhjPBG","CM9Y","Bg9N","Dw5OzwfSDgH5","AhnbyMm","zNjVBq","ufjwt1O","BMXqChC","rfvsDLi"];return(ee=function(){return e})()}function se(e){const t=V,n={VbcMg:function(e,s){return e(s)},iWtzJ:function(e,s){return e>=s},HFPVv:function(e,s){return e(s)},QUNBo:function(e,s,t){return e(s,t)},eTSMX:t(297),yVZmG:function(e,s){return e!==s},Sozin:t(356),fkkjU:t(303),hsAbc:"Unknown er"+t(344),wNlxP:function(e,s){return e>=s},XOwJF:"osatm",nlPpw:function(e,s){return e(s)},dCXfk:function(e,s){return e(s)},OkKkB:function(e,s){return e instanceof s},FMAdT:"Failed to check function health",WSoyH:function(e,s){return e(s)},yEZqa:function(e,s){return e(s)},lublv:"unknown",xfsSE:function(e,s){return e(s)},pwkxG:function(e,s,t){return e(s,t)},nBNBB:function(e,s,t){return e(s,t)}},r=s.useMemo(()=>({...$,...e}),[e]),a={};a[t(325)]=[],a[t(310)]=!1,a.lastUpdated=null,a[t(318)+"us"]=n[t(374)],a.error=null;const[c,i]=s.useState(a),[l,o]=s.useState(new Map),d=n[t(332)](s.useRef,null),u=n[t(357)](s.useRef,"unknown"),m=n.QUNBo(s.useCallback,async()=>{const e=t;n[e(314)](i,e=>({...e,isLoading:!0,error:null}));try{if(e(297)!==n[e(354)]){const s=new _0x277e0c(_0x36be58);return s[e(385)](_0x4880b1,(s.get(_0x373187)||0)+1),s}{const s=await async function(e,s=5e3){const t=E,n=e[t(427)](e=>G(e,s));return Promise[t(414)](n)}(r.functions),t=W(s),a=new Map(l);if(s[e(386)](s=>{const t=e,r=n.VbcMg(K,s[t(360)+"me"]);r&&a[t(385)](s.functionName,r)}),o(a),r[e(295)+e(335)]&&n[e(376)](t[e(342)],u[e(308)])){if(n[e(339)]!==e(356)){const s=_0x43581.results[e(381)](e=>e.functionName===_0x3ca0b0),t=[..._0x16d34a[e(325)]];n[e(375)](s,0)?t[s]=_0x1a3718:t.push(_0x5db1f8);const r=n[e(314)](_0x18c62c,t);return{..._0x3bb277,results:t,systemStatus:r[e(342)],lastUpdated:(new _0x26db0e)[e(343)+"g"]()}}r[e(295)+e(335)](t[e(342)])}u[e(308)]=t[e(342)],i({results:s,isLoading:!1,lastUpdated:(new Date)[e(343)+"g"](),systemStatus:t[e(342)],error:null})}}catch(s){if("OnKwW"===n[e(305)])_0x3b6fcc[e(308)]=n.QUNBo(_0x9798b9,_0x21602c,_0x11340c[e(380)+e(378)]);else{const t=s instanceof Error?s:new Error(n[e(347)]);r[e(315)]&&r[e(315)](t),i(s=>({...s,isLoading:!1,error:t[e(328)]}))}}},[r,l]),x=n[t(387)](s.useCallback,async e=>{const s=t;if(n.yVZmG(n[s(298)],n.XOwJF)){const e=_0x157038[s(302)](_0x1a096a,arguments);return _0x36c1b9=null,e}try{const t=await G(e);n[s(350)](i,r=>{const a=s,c=r[a(325)].findIndex(s=>s[a(360)+"me"]===e),i=[...r[a(325)]];n.wNlxP(c,0)?i[c]=t:i.push(t);const l=n.HFPVv(W,i);return{...r,results:i,systemStatus:l[a(342)],lastUpdated:(new Date)[a(343)+"g"]()}});const r=n[s(301)](K,e);return r&&o(t=>{const n=s,a=new Map(t);return a[n(385)](e,r),a}),t}catch(r){throw n.OkKkB(r,Error)?r:new Error(n[s(368)])}},[]),h=n[t(338)](s.useCallback,()=>{const e=t;T[E(406)](),n[e(370)](o,new Map),n[e(336)](i,s=>({...s,results:[],lastUpdated:null,systemStatus:e(333)}))},[]),f=s.useCallback(e=>l[t(382)](e),[l]),j=s.useCallback(()=>{const e=t;return Array[e(348)](l[e(296)]())},[l]);return s.useEffect(()=>{const e=t;return m(),r.autoRefresh&&r[e(380)+"erval"]>0&&(d.current=setInterval(m,r[e(380)+"erval"])),()=>{const s=e;d[s(308)]&&(clearInterval(d[s(308)]),d[s(308)]=null)}},[m,r[t(327)+"h"],r[t(380)+"erval"]]),{results:c[t(325)],isLoading:c[t(310)],lastUpdated:c[t(329)+"d"],systemStatus:c[t(318)+"us"],error:c[t(306)],checkHealth:m,checkSingleFunction:x,clearCache:h,getMetrics:f,getAllMetrics:j,healthyCount:c.results.filter(e=>e.status===t(323))[t(373)],warningCount:c[t(325)][t(313)](e=>"warning"===e[t(342)])[t(373)],errorCount:c[t(325)][t(313)](e=>"error"===e.status||e[t(342)]===t(346))[t(373)],totalCount:c[t(325)][t(373)]}}function te({className:e}){const[C,M]=s.useState("overview"),{results:D,isLoading:B,lastUpdated:z,systemStatus:_,error:k,checkHealth:S,checkSingleFunction:A,healthyCount:L,warningCount:P,errorCount:R,totalCount:I,getAllMetrics:T}=se({autoRefresh:!0,refreshInterval:3e4}),U=T(),F=e=>{switch(e){case"healthy":return"bg-emerald-500";case"warning":return"bg-amber-500";case"error":case"unhealthy":return"bg-red-500";default:return"bg-gray-500"}},G=e=>{switch(e){case"healthy":return t.jsx(j,{className:"h-4 w-4 text-emerald-500"});case"warning":return t.jsx(g,{className:"h-4 w-4 text-amber-500"});case"error":case"unhealthy":return t.jsx(v,{className:"h-4 w-4 text-red-500"});default:return t.jsx(x,{className:"h-4 w-4 text-gray-500"})}};return t.jsx("div",{className:e,children:t.jsxs(n,{className:"w-full",children:[t.jsxs(r,{className:"pb-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(q,{className:"h-5 w-5 text-primary"}),t.jsxs("div",{children:[t.jsx(a,{className:"text-lg",children:"Edge Function Monitor"}),t.jsx(c,{children:"Real-time health monitoring for Supabase Edge Functions"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[(()=>{switch(_){case"healthy":return t.jsxs(w,{className:"bg-emerald-500/10 text-emerald-500 border-emerald-500/20",children:[t.jsx(j,{className:"h-3 w-3 mr-1"}),"Healthy"]});case"warning":return t.jsxs(w,{className:"bg-amber-500/10 text-amber-500 border-amber-500/20",children:[t.jsx(g,{className:"h-3 w-3 mr-1"}),"Warning"]});case"critical":return t.jsxs(w,{className:"bg-red-500/10 text-red-500 border-red-500/20",children:[t.jsx(H,{className:"h-3 w-3 mr-1"}),"Critical"]});default:return t.jsxs(w,{variant:"secondary",children:[t.jsx(x,{className:"h-3 w-3 mr-1"}),"Unknown"]})}})(),t.jsx(i,{variant:"outline",size:"sm",onClick:()=>S(),disabled:B,children:t.jsx(l,{className:"h-4 w-4 "+(B?"animate-spin":"")})})]})]}),z&&t.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Last updated: ",new Date(z).toLocaleTimeString()]}),k&&t.jsxs("div",{className:"flex items-center gap-2 mt-2 text-red-500 text-sm",children:[t.jsx(H,{className:"h-4 w-4"}),t.jsx("span",{children:k})]})]}),t.jsx(o,{children:t.jsxs(d,{value:C,onValueChange:M,children:[t.jsxs(u,{className:"grid w-full grid-cols-3",children:[t.jsxs(m,{value:"overview",children:[t.jsx(x,{className:"h-4 w-4 mr-2"}),"Overview"]}),t.jsxs(m,{value:"functions",children:[t.jsx(q,{className:"h-4 w-4 mr-2"}),"Functions"]}),t.jsxs(m,{value:"metrics",children:[t.jsx(h,{className:"h-4 w-4 mr-2"}),"Metrics"]})]}),t.jsxs(f,{value:"overview",className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsx(n,{children:t.jsx(o,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total"}),t.jsx("p",{className:"text-2xl font-bold",children:I})]}),t.jsx(q,{className:"h-8 w-8 text-muted-foreground"})]})})}),t.jsx(n,{children:t.jsx(o,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Healthy"}),t.jsx("p",{className:"text-2xl font-bold text-emerald-500",children:L})]}),t.jsx(j,{className:"h-8 w-8 text-emerald-500"})]})})}),t.jsx(n,{children:t.jsx(o,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Warning"}),t.jsx("p",{className:"text-2xl font-bold text-amber-500",children:P})]}),t.jsx(g,{className:"h-8 w-8 text-amber-500"})]})})}),t.jsx(n,{children:t.jsx(o,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Error"}),t.jsx("p",{className:"text-2xl font-bold text-red-500",children:R})]}),t.jsx(v,{className:"h-8 w-8 text-red-500"})]})})})]}),B?t.jsxs("div",{className:"space-y-2",children:[t.jsx(p,{className:"h-12 w-full"}),t.jsx(p,{className:"h-12 w-full"}),t.jsx(p,{className:"h-12 w-full"})]}):D.length>0?t.jsx("div",{className:"space-y-2",children:D.map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[G(e.status),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:e.functionName}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.status," • ",Math.round(e.responseTime),"ms"]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`h-2 w-2 rounded-full ${F(e.status)}`}),t.jsx(i,{variant:"ghost",size:"sm",onClick:()=>A(e.functionName),disabled:B,children:t.jsx(l,{className:"h-3 w-3"})})]})]},e.functionName))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(x,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No functions monitored yet"}),t.jsx(i,{variant:"outline",onClick:()=>S(),className:"mt-4",disabled:B,children:"Start Monitoring"})]})]}),t.jsx(f,{value:"functions",className:"space-y-4",children:t.jsx(N,{className:"h-[400px]",children:B?t.jsx("div",{className:"space-y-2",children:[...Array(5)].map((e,s)=>t.jsx(p,{className:"h-20 w-full"},s))}):D.length>0?t.jsx("div",{className:"space-y-2",children:D.map(e=>t.jsx(n,{children:t.jsxs(o,{className:"p-4",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[G(e.status),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:e.functionName}),t.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-muted-foreground",children:[t.jsx(y,{className:"h-3 w-3"}),t.jsxs("span",{children:[Math.round(e.responseTime),"ms response"]}),t.jsx("span",{children:"•"}),t.jsxs("span",{children:["Checked: ",new Date(e.lastChecked).toLocaleTimeString()]})]}),e.error&&t.jsx("p",{className:"text-xs text-red-500 mt-1",children:e.error})]})]}),t.jsx(w,{variant:"healthy"===e.status?"default":"destructive",children:e.status})]}),e.details&&Object.keys(e.details).length>0&&t.jsxs("div",{className:"mt-3 pt-3 border-t",children:[t.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Details:"}),t.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-x-auto",children:JSON.stringify(e.details,null,2)})]})]})},e.functionName))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(q,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No function details available"})]})})}),t.jsx(f,{value:"metrics",className:"space-y-4",children:t.jsx(N,{className:"h-[400px]",children:U.length>0?t.jsx("div",{className:"space-y-2",children:U.map(e=>t.jsx(n,{children:t.jsxs(o,{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(b,{className:"h-4 w-4 text-primary"}),t.jsx("p",{className:"font-medium",children:e.functionName})]}),t.jsxs(w,{variant:"outline",children:[e.totalInvocations," calls"]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-muted-foreground text-xs",children:"Avg Response"}),t.jsxs("p",{className:"font-medium",children:[Math.round(e.averageResponseTime),"ms"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-muted-foreground text-xs",children:"P95 Response"}),t.jsxs("p",{className:"font-medium",children:[Math.round(e.p95ResponseTime),"ms"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-muted-foreground text-xs",children:"P99 Response"}),t.jsxs("p",{className:"font-medium",children:[Math.round(e.p99ResponseTime),"ms"]})]})]}),e.errorRate>0&&t.jsx("div",{className:"mt-3 pt-3 border-t",children:t.jsxs("p",{className:"text-xs text-red-500",children:["Error Rate: ",(100*e.errorRate).toFixed(1),"%"]})})]})},e.functionName))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(h,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No metrics available yet"}),t.jsx("p",{className:"text-xs mt-2",children:"Metrics are collected as functions are invoked"})]})})})]})})]})})}const ne={"market-collector":t.jsx(x,{className:"h-5 w-5"}),"prediction-engine":t.jsx(_,{className:"h-5 w-5"}),"resolution-engine":t.jsx(j,{className:"h-5 w-5"}),"evolution-engine":t.jsx(S,{className:"h-5 w-5"}),"correlation-engine":t.jsx(h,{className:"h-5 w-5"}),"autonomous-trader":t.jsx(b,{className:"h-5 w-5"}),"data-integrity":t.jsx(D,{className:"h-5 w-5"}),"prediction-accuracy":t.jsx(h,{className:"h-5 w-5"}),"system-fitness":t.jsx(x,{className:"h-5 w-5"})};function re(){var s,d;const u=C(),{data:m,isLoading:f,refetch:v}=M({queryKey:["system-vitals"],queryFn:async()=>{const{data:s,error:t}=await e.rpc("get_system_vitals");if(t)throw t;return s},refetchInterval:5e3}),{data:N}=M({queryKey:["evolution-state"],queryFn:async()=>{const{data:s,error:t}=await e.from("evolution_state").select("*").eq("state_type","global").single();if(t)throw t;return s},refetchInterval:1e4}),{data:y}=M({queryKey:["system-stats"],queryFn:async()=>{const[s,t,n]=await Promise.all([e.from("market_tick_history").select("id",{count:"exact",head:!0}),e.from("prediction_outcomes").select("id",{count:"exact",head:!0}),e.from("prediction_outcomes").select("direction_correct").not("resolved_at","is",null)]),r=n.data||[],a=r.filter(e=>e.direction_correct).length;return{totalTicks:s.count||0,totalPredictions:t.count||0,resolvedPredictions:r.length,correctPredictions:a,overallAccuracy:r.length>0?a/r.length:0}},refetchInterval:1e4}),b=L({mutationFn:async()=>{const{data:s,error:t}=await e.functions.invoke("system-heartbeat",{body:{action:"full_cycle"}});if(t)throw t;return s},onSuccess:e=>{var s,t;k.success("Heartbeat triggered successfully",{description:`Collected ${(null==(s=null==e?void 0:e.collect)?void 0:s.ticks)||0} ticks, ${(null==(t=null==e?void 0:e.predict)?void 0:t.predictions)||0} predictions`}),u.invalidateQueries({queryKey:["system-vitals"]}),u.invalidateQueries({queryKey:["system-stats"]})},onError:e=>{k.error("Heartbeat failed",{description:e.message})}}),S=e=>{switch(e){case"healthy":return"text-green-500";case"degraded":return"text-yellow-500";case"critical":return"text-destructive";default:return"text-muted-foreground"}},A=e=>{switch(e){case"healthy":return"default";case"degraded":return"secondary";case"critical":return"destructive";default:return"outline"}},q=(null==m?void 0:m.filter(e=>"heartbeat"===e.vital_type))||[],H=(null==m?void 0:m.filter(e=>"metric"===e.vital_type))||[],P=(null==m?void 0:m.filter(e=>e.is_healthy).length)||0,R=(null==m?void 0:m.length)||0,I=R>0?P/R*100:0;return f?t.jsxs("div",{className:"space-y-4",children:[t.jsx(p,{className:"h-32 w-full"}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[t.jsx(p,{className:"h-48"}),t.jsx(p,{className:"h-48"}),t.jsx(p,{className:"h-48"})]})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[t.jsxs(n,{className:"md:col-span-2",children:[t.jsxs(r,{className:"pb-2",children:[t.jsxs(a,{className:"flex items-center gap-2",children:[t.jsx(D,{className:"h-6 w-6 "+(I>=80?"text-green-500 animate-pulse":I>=50?"text-yellow-500":"text-destructive")}),"System Vitals"]}),t.jsx(c,{children:"Living system health at a glance"})]}),t.jsx(o,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Overall Health"}),t.jsxs("span",{className:"font-bold",children:[Math.round(I),"%"]})]}),t.jsx(B,{value:I,className:"h-3"}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{children:[P," of ",R," systems healthy"]}),t.jsxs(i,{size:"sm",onClick:()=>b.mutate(),disabled:b.isPending,children:[b.isPending?t.jsx(l,{className:"h-4 w-4 mr-2 animate-spin"}):t.jsx(z,{className:"h-4 w-4 mr-2"}),"Trigger Heartbeat"]})]})]})})]}),t.jsxs(n,{children:[t.jsx(r,{className:"pb-2",children:t.jsx(a,{className:"text-sm font-medium",children:"Evolution"})}),t.jsxs(o,{children:[t.jsxs("div",{className:"text-3xl font-bold",children:["Gen ",(null==N?void 0:N.generation)||0]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Fitness: ",(100*((null==N?void 0:N.fitness_score)||0)).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(null==(s=null==N?void 0:N.total_predictions)?void 0:s.toLocaleString())||0," total predictions"]})]})]}),t.jsxs(n,{children:[t.jsx(r,{className:"pb-2",children:t.jsx(a,{className:"text-sm font-medium",children:"Accuracy"})}),t.jsxs(o,{children:[t.jsxs("div",{className:"text-3xl font-bold",children:[(100*((null==y?void 0:y.overallAccuracy)||0)).toFixed(1),"%"]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[(null==y?void 0:y.correctPredictions)||0," / ",(null==y?void 0:y.resolvedPredictions)||0," correct"]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(null==(d=null==y?void 0:y.totalTicks)?void 0:d.toLocaleString())||0," ticks collected"]})]})]})]}),t.jsxs(n,{children:[t.jsxs(r,{children:[t.jsxs(a,{className:"flex items-center gap-2",children:[t.jsx(x,{className:"h-5 w-5"}),"Subsystem Heartbeats"]}),t.jsx(c,{children:"Real-time status of all system components"})]}),t.jsx(o,{children:t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:q.map(e=>{var s,n,r;return t.jsxs("div",{className:"p-4 rounded-lg border transition-colors "+(e.is_healthy?"border-green-500/30 bg-green-500/5":"degraded"===e.status?"border-yellow-500/30 bg-yellow-500/5":"critical"===e.status?"border-destructive/30 bg-destructive/5":"border-border bg-muted/30"),children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:S(e.status),children:ne[e.vital_name]||t.jsx(x,{className:"h-5 w-5"})}),t.jsx("span",{className:"font-medium capitalize",children:e.vital_name.replace(/-/g," ")})]}),t.jsx(w,{variant:A(e.status),children:e.status})]}),t.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:null==(s=e.metadata)?void 0:s.description}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"text-muted-foreground",children:["Last pulse: ",(r=e.seconds_since_pulse,r<60?`${Math.floor(r)}s ago`:r<3600?`${Math.floor(r/60)}m ago`:r<86400?`${Math.floor(r/3600)}h ago`:`${Math.floor(r/86400)}d ago`)]}),t.jsxs("span",{className:"font-mono text-xs",children:["#",e.pulse_count.toLocaleString()]})]}),e.is_healthy?t.jsx("div",{className:"mt-2 h-1 bg-green-500/30 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-green-500 animate-pulse",style:{width:`${Math.max(10,100-e.seconds_since_pulse/(((null==(n=e.metadata)?void 0:n.interval_ms)||6e4)/1e3)*100)}%`}})}):t.jsx("div",{className:"mt-2 h-1 bg-destructive/30 rounded-full"})]},e.vital_name)})})})]}),t.jsxs(n,{children:[t.jsxs(r,{children:[t.jsxs(a,{className:"flex items-center gap-2",children:[t.jsx(h,{className:"h-5 w-5"}),"Performance Metrics"]}),t.jsx(c,{children:"Key performance indicators"})]}),t.jsx(o,{children:t.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:H.map(e=>t.jsxs("div",{className:"p-4 rounded-lg border bg-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("span",{className:"font-medium capitalize",children:e.vital_name.replace(/-/g," ")}),e.is_healthy?t.jsx(j,{className:"h-5 w-5 text-green-500"}):t.jsx(g,{className:"h-5 w-5 text-yellow-500"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-end justify-between",children:[t.jsxs("span",{className:"text-3xl font-bold",children:[(100*e.last_value).toFixed(1),"%"]}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:["Target: ",(100*e.target_value).toFixed(0),"%"]})]}),t.jsx(B,{value:100*e.last_value,className:"h-2"})]})]},e.vital_name))})})]}),(null==N?void 0:N.genes)&&t.jsxs(n,{children:[t.jsxs(r,{children:[t.jsxs(a,{className:"flex items-center gap-2",children:[t.jsx(_,{className:"h-5 w-5"}),"Evolution Genes (Generation ",N.generation,")"]}),t.jsx(c,{children:"Current genetic parameters guiding predictions"})]}),t.jsx(o,{children:t.jsx("div",{className:"grid gap-3 md:grid-cols-4",children:Object.entries(N.genes).map(([e,s])=>t.jsxs("div",{className:"p-3 rounded-lg bg-muted/50",children:[t.jsx("div",{className:"text-sm text-muted-foreground capitalize",children:e.replace(/([A-Z])/g," $1").trim()}),t.jsx("div",{className:"text-xl font-mono font-bold",children:"number"==typeof s?s.toFixed(3):String(s)})]},e))})})]}),t.jsx(te,{})]})}const ae=()=>t.jsx(A,{featureName:"System Vitals",children:t.jsx(re,{})});export{ae as default};
