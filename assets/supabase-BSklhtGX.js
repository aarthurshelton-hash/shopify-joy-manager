const n="/**\n * Supabase Test Mocks\n * \n * Provides mock implementations for Supabase client and auth\n * for use in unit and integration tests.\n */\n\nimport { vi } from 'vitest';\nimport type { User, Session } from '@supabase/supabase-js';\n\n// Mock user data\nexport const mockUser: User = {\n  id: 'test-user-id',\n  email: 'test@enpensent.com',\n  user_metadata: {\n    display_name: 'Test User',\n  },\n  app_metadata: {},\n  aud: 'authenticated',\n  created_at: new Date().toISOString(),\n  role: 'authenticated',\n  updated_at: new Date().toISOString(),\n  identities: [],\n};\n\n// Mock session data\nexport const mockSession: Session = {\n  user: mockUser,\n  access_token: 'mock-access-token',\n  refresh_token: 'mock-refresh-token',\n  expires_in: 3600,\n  expires_at: Math.floor(Date.now() / 1000) + 3600,\n  token_type: 'bearer',\n};\n\n// Mock Supabase client\nexport const createMockSupabaseClient = () => ({\n  auth: {\n    signUp: vi.fn().mockResolvedValue({ data: { user: mockUser }, error: null }),\n    signInWithPassword: vi.fn().mockResolvedValue({ data: { user: mockUser, session: mockSession }, error: null }),\n    signOut: vi.fn().mockResolvedValue({ error: null }),\n    getSession: vi.fn().mockResolvedValue({ data: { session: mockSession }, error: null }),\n    onAuthStateChange: vi.fn().mockReturnValue({\n      data: { subscription: { unsubscribe: vi.fn() } },\n    }),\n    mfa: {\n      listFactors: vi.fn().mockResolvedValue({ data: { totp: [] }, error: null }),\n      getAuthenticatorAssuranceLevel: vi.fn().mockResolvedValue({\n        data: { currentLevel: 'aal1', nextLevel: 'aal1' },\n        error: null,\n      }),\n    },\n  },\n  from: vi.fn().mockReturnValue({\n    select: vi.fn().mockReturnThis(),\n    insert: vi.fn().mockReturnThis(),\n    update: vi.fn().mockReturnThis(),\n    delete: vi.fn().mockReturnThis(),\n    eq: vi.fn().mockReturnThis(),\n    neq: vi.fn().mockReturnThis(),\n    gt: vi.fn().mockReturnThis(),\n    gte: vi.fn().mockReturnThis(),\n    lt: vi.fn().mockReturnThis(),\n    lte: vi.fn().mockReturnThis(),\n    is: vi.fn().mockReturnThis(),\n    in: vi.fn().mockReturnThis(),\n    contains: vi.fn().mockReturnThis(),\n    containedBy: vi.fn().mockReturnThis(),\n    rangeGt: vi.fn().mockReturnThis(),\n    rangeGte: vi.fn().mockReturnThis(),\n    rangeLt: vi.fn().mockReturnThis(),\n    rangeLte: vi.fn().mockReturnThis(),\n    rangeAdjacent: vi.fn().mockReturnThis(),\n    overlaps: vi.fn().mockReturnThis(),\n    textSearch: vi.fn().mockReturnThis(),\n    match: vi.fn().mockReturnThis(),\n    not: vi.fn().mockReturnThis(),\n    or: vi.fn().mockReturnThis(),\n    and: vi.fn().mockReturnThis(),\n    filter: vi.fn().mockReturnThis(),\n    order: vi.fn().mockReturnThis(),\n    limit: vi.fn().mockReturnThis(),\n    single: vi.fn().mockReturnThis(),\n    maybeSingle: vi.fn().mockReturnThis(),\n    csv: vi.fn().mockReturnThis(),\n    then: vi.fn().mockImplementation((callback) => Promise.resolve(callback({ data: [], error: null }))),\n  }),\n  rpc: vi.fn().mockResolvedValue({ data: [], error: null }),\n  functions: {\n    invoke: vi.fn().mockResolvedValue({ data: {}, error: null }),\n  },\n  channel: vi.fn().mockReturnValue({\n    on: vi.fn().mockReturnThis(),\n    subscribe: vi.fn().mockReturnThis(),\n    unsubscribe: vi.fn(),\n  }),\n  removeChannel: vi.fn(),\n  removeAllChannels: vi.fn(),\n});\n\n// Mock supabase module\nexport const mockSupabaseClient = createMockSupabaseClient();\n\n// Helper to reset all mocks\nexport const resetSupabaseMocks = () => {\n  vi.clearAllMocks();\n};\n\n// Helper to mock authenticated state\nexport const mockAuthenticatedUser = (user: Partial<User> = {}) => {\n  const mergedUser = { ...mockUser, ...user };\n  mockSupabaseClient.auth.getSession.mockResolvedValue({\n    data: { session: { ...mockSession, user: mergedUser } },\n    error: null,\n  });\n  return mergedUser;\n};\n\n// Helper to mock unauthenticated state\nexport const mockUnauthenticated = () => {\n  mockSupabaseClient.auth.getSession.mockResolvedValue({\n    data: { session: null },\n    error: null,\n  });\n};\n\n// Helper to mock admin user\nexport const mockAdminUser = () => {\n  mockSupabaseClient.from = vi.fn().mockImplementation((table: string) => {\n    if (table === 'user_roles') {\n      return {\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        maybeSingle: vi.fn().mockResolvedValue({\n          data: { role: 'admin' },\n          error: null,\n        }),\n      };\n    }\n    return createMockSupabaseClient().from(table);\n  });\n  \n  return mockAuthenticatedUser({ email: 'a.arthur.shelton@gmail.com' });\n};\n";export{n as default};
