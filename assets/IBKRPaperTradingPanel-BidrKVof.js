const e='/**\n * IB Gateway Paper Trading Panel\n * \n * UI for connecting to IB Gateway via local bridge.\n * Real IB Gateway connection only - no simulation.\n */\n\nimport { useState } from \'react\';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \'@/components/ui/card\';\nimport { Button } from \'@/components/ui/button\';\nimport { Input } from \'@/components/ui/input\';\nimport { Badge } from \'@/components/ui/badge\';\nimport { Alert, AlertDescription, AlertTitle } from \'@/components/ui/alert\';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \'@/components/ui/select\';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \'@/components/ui/tabs\';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \'@/components/ui/table\';\nimport { useIBKRGateway } from \'@/hooks/useIBKRGateway\';\nimport { getBridgeConfig, setBridgeConfig } from \'@/lib/trading/ibGatewayBridge\';\nimport { \n  Loader2, \n  Wifi, \n  WifiOff, \n  RefreshCw, \n  TrendingUp, \n  TrendingDown,\n  AlertCircle,\n  CheckCircle2,\n  Terminal,\n  Settings,\n  Plug,\n} from \'lucide-react\';\n\nexport function IBKRPaperTradingPanel() {\n  const {\n    connected,\n    authenticated,\n    accounts,\n    selectedAccount,\n    positions,\n    orders,\n    loading,\n    error,\n    checkConnection,\n    connectToGateway,\n    refreshData,\n    placeOrder,\n    cancelOrder,\n    selectAccount,\n  } = useIBKRGateway();\n\n  const [orderForm, setOrderForm] = useState({\n    symbol: \'SPY\',\n    side: \'BUY\' as \'BUY\' | \'SELL\',\n    quantity: 1,\n    orderType: \'MKT\' as \'MKT\' | \'LMT\',\n    price: 0,\n  });\n  const [isPlacingOrder, setIsPlacingOrder] = useState(false);\n  const [showSettings, setShowSettings] = useState(false);\n  const [bridgeSettings, setBridgeSettings] = useState(getBridgeConfig());\n\n  const handlePlaceOrder = async () => {\n    setIsPlacingOrder(true);\n    await placeOrder({\n      symbol: orderForm.symbol,\n      side: orderForm.side,\n      quantity: orderForm.quantity,\n      orderType: orderForm.orderType,\n      price: orderForm.orderType === \'LMT\' ? orderForm.price : undefined,\n    });\n    setIsPlacingOrder(false);\n  };\n\n  const handleSaveSettings = () => {\n    setBridgeConfig(bridgeSettings);\n    setShowSettings(false);\n    checkConnection();\n  };\n\n  if (loading) {\n    return (\n      <Card className="animate-pulse">\n        <CardHeader>\n          <CardTitle className="flex items-center gap-2">\n            <Loader2 className="h-5 w-5 animate-spin" />\n            Connecting to IB Gateway Bridge...\n          </CardTitle>\n        </CardHeader>\n      </Card>\n    );\n  }\n\n  // Settings Panel\n  if (showSettings) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle className="flex items-center gap-2">\n            <Settings className="h-5 w-5" />\n            Bridge Settings\n          </CardTitle>\n        </CardHeader>\n        <CardContent className="space-y-4">\n          <div className="space-y-2">\n            <label className="text-sm font-medium">Bridge URL</label>\n            <Input \n              value={bridgeSettings.bridgeUrl}\n              onChange={e => setBridgeSettings(prev => ({ ...prev, bridgeUrl: e.target.value }))}\n              placeholder="http://localhost:4000"\n            />\n            <p className="text-xs text-muted-foreground">\n              The URL where your local bridge server is running\n            </p>\n          </div>\n\n          <div className="grid grid-cols-2 gap-4">\n            <div className="space-y-2">\n              <label className="text-sm font-medium">Gateway Host</label>\n              <Input \n                value={bridgeSettings.gatewayHost}\n                onChange={e => setBridgeSettings(prev => ({ ...prev, gatewayHost: e.target.value }))}\n                placeholder="127.0.0.1"\n              />\n            </div>\n            <div className="space-y-2">\n              <label className="text-sm font-medium">Gateway Port</label>\n              <Select \n                value={String(bridgeSettings.gatewayPort)}\n                onValueChange={v => setBridgeSettings(prev => ({ ...prev, gatewayPort: parseInt(v) }))}\n              >\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value="4002">4002 (Paper)</SelectItem>\n                  <SelectItem value="4001">4001 (Live)</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <div className="space-y-2">\n            <label className="text-sm font-medium">Client ID</label>\n            <Input \n              type="number"\n              value={bridgeSettings.clientId}\n              onChange={e => setBridgeSettings(prev => ({ ...prev, clientId: parseInt(e.target.value) || 1 }))}\n              min={1}\n            />\n          </div>\n\n          <div className="flex gap-2">\n            <Button onClick={handleSaveSettings} className="flex-1">Save Settings</Button>\n            <Button variant="outline" onClick={() => setShowSettings(false)}>Cancel</Button>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  // Not connected to bridge\n  if (!connected) {\n    return (\n      <Card className="border-destructive">\n        <CardHeader>\n          <div className="flex items-center justify-between">\n            <CardTitle className="flex items-center gap-2 text-destructive">\n              <WifiOff className="h-5 w-5" />\n              Bridge Not Running\n            </CardTitle>\n            <Button variant="ghost" size="sm" onClick={() => setShowSettings(true)}>\n              <Settings className="h-4 w-4" />\n            </Button>\n          </div>\n          <CardDescription>\n            The local bridge server must be running to connect to IB Gateway.\n          </CardDescription>\n        </CardHeader>\n        <CardContent className="space-y-4">\n          {error && (\n            <Alert variant="destructive">\n              <AlertCircle className="h-4 w-4" />\n              <AlertTitle>Connection Error</AlertTitle>\n              <AlertDescription>{error}</AlertDescription>\n            </Alert>\n          )}\n          \n          <Alert>\n            <Terminal className="h-4 w-4" />\n            <AlertTitle>Setup Instructions</AlertTitle>\n            <AlertDescription className="space-y-2 mt-2">\n              <p><strong>1.</strong> Download the bridge from the Files tab: <code className="bg-muted px-1">ib-gateway-bridge/</code></p>\n              <p><strong>2.</strong> Open Terminal and run:</p>\n              <code className="block bg-muted p-2 rounded text-xs mt-1">\n                cd ib-gateway-bridge && npm install && npm start\n              </code>\n              <p><strong>3.</strong> Start IB Gateway application and log in</p>\n              <p><strong>4.</strong> Enable API in IB Gateway: Configure → Settings → API</p>\n              <p><strong>5.</strong> Return here and click "Retry Connection"</p>\n            </AlertDescription>\n          </Alert>\n          \n          <Button onClick={checkConnection} className="w-full">\n            <RefreshCw className="h-4 w-4 mr-2" />\n            Retry Connection\n          </Button>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  // Bridge running but not connected to gateway\n  if (!authenticated) {\n    return (\n      <Card className="border-yellow-500">\n        <CardHeader>\n          <div className="flex items-center justify-between">\n            <CardTitle className="flex items-center gap-2 text-yellow-500">\n              <Wifi className="h-5 w-5" />\n              Bridge Running - Gateway Disconnected\n            </CardTitle>\n            <Button variant="ghost" size="sm" onClick={() => setShowSettings(true)}>\n              <Settings className="h-4 w-4" />\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent className="space-y-4">\n          <Alert variant="default">\n            <AlertCircle className="h-4 w-4" />\n            <AlertDescription>\n              Bridge is running. Make sure IB Gateway is open and API is enabled, then connect.\n            </AlertDescription>\n          </Alert>\n          \n          <Button onClick={connectToGateway} className="w-full">\n            <Plug className="h-4 w-4 mr-2" />\n            Connect to IB Gateway\n          </Button>\n          \n          <Button variant="outline" onClick={checkConnection} className="w-full">\n            <RefreshCw className="h-4 w-4 mr-2" />\n            Check Status\n          </Button>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  // Connected\n  return (\n    <div className="space-y-4">\n      {/* Connection Status */}\n      <Card>\n        <CardHeader className="pb-2">\n          <div className="flex items-center justify-between">\n            <CardTitle className="flex items-center gap-2 text-primary">\n              <CheckCircle2 className="h-5 w-5" />\n              IB Gateway Connected\n              <Badge variant="outline" className="ml-2 bg-primary/10 text-primary border-primary">\n                Paper Trading\n              </Badge>\n            </CardTitle>\n            <div className="flex gap-1">\n              <Button variant="ghost" size="sm" onClick={() => setShowSettings(true)}>\n                <Settings className="h-4 w-4" />\n              </Button>\n              <Button variant="ghost" size="sm" onClick={refreshData}>\n                <RefreshCw className="h-4 w-4" />\n              </Button>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className="flex items-center gap-4">\n            <div className="flex-1">\n              <Select \n                value={selectedAccount?.accountId || \'\'} \n                onValueChange={selectAccount}\n              >\n                <SelectTrigger>\n                  <SelectValue placeholder="Select Account" />\n                </SelectTrigger>\n                <SelectContent>\n                  {accounts.map(acc => (\n                    <SelectItem key={acc.accountId} value={acc.accountId}>\n                      {acc.accountId} ({acc.accountType})\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n            {selectedAccount && (\n              <div className="text-right">\n                <div className="text-sm text-muted-foreground">Balance</div>\n                <div className="text-xl font-bold">\n                  ${selectedAccount.balance.toLocaleString(\'en-US\', { minimumFractionDigits: 2 })}\n                </div>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Trading Tabs */}\n      <Tabs defaultValue="trade" className="w-full">\n        <TabsList className="grid w-full grid-cols-3">\n          <TabsTrigger value="trade">Trade</TabsTrigger>\n          <TabsTrigger value="positions">\n            Positions ({positions.length})\n          </TabsTrigger>\n          <TabsTrigger value="orders">\n            Orders ({orders.length})\n          </TabsTrigger>\n        </TabsList>\n\n        {/* Trade Tab */}\n        <TabsContent value="trade">\n          <Card>\n            <CardHeader>\n              <CardTitle>Place Order</CardTitle>\n              <CardDescription>\n                Execute paper trades through IB Gateway\n              </CardDescription>\n            </CardHeader>\n            <CardContent className="space-y-4">\n              <div className="grid grid-cols-2 gap-4">\n                <div className="space-y-2">\n                  <label className="text-sm font-medium">Symbol</label>\n                  <Input \n                    value={orderForm.symbol}\n                    onChange={e => setOrderForm(prev => ({ ...prev, symbol: e.target.value.toUpperCase() }))}\n                    placeholder="SPY"\n                  />\n                </div>\n                <div className="space-y-2">\n                  <label className="text-sm font-medium">Quantity</label>\n                  <Input \n                    type="number"\n                    value={orderForm.quantity}\n                    onChange={e => setOrderForm(prev => ({ ...prev, quantity: parseInt(e.target.value) || 1 }))}\n                    min={1}\n                  />\n                </div>\n              </div>\n\n              <div className="grid grid-cols-2 gap-4">\n                <div className="space-y-2">\n                  <label className="text-sm font-medium">Side</label>\n                  <Select \n                    value={orderForm.side}\n                    onValueChange={(v: \'BUY\' | \'SELL\') => setOrderForm(prev => ({ ...prev, side: v }))}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value="BUY">Buy</SelectItem>\n                      <SelectItem value="SELL">Sell</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className="space-y-2">\n                  <label className="text-sm font-medium">Order Type</label>\n                  <Select \n                    value={orderForm.orderType}\n                    onValueChange={(v: \'MKT\' | \'LMT\') => setOrderForm(prev => ({ ...prev, orderType: v }))}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value="MKT">Market</SelectItem>\n                      <SelectItem value="LMT">Limit</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              {orderForm.orderType === \'LMT\' && (\n                <div className="space-y-2">\n                  <label className="text-sm font-medium">Limit Price</label>\n                  <Input \n                    type="number"\n                    step="0.01"\n                    value={orderForm.price}\n                    onChange={e => setOrderForm(prev => ({ ...prev, price: parseFloat(e.target.value) || 0 }))}\n                    placeholder="0.00"\n                  />\n                </div>\n              )}\n\n              <Button \n                className="w-full"\n                onClick={handlePlaceOrder}\n                disabled={isPlacingOrder}\n              >\n                {isPlacingOrder ? (\n                  <Loader2 className="h-4 w-4 mr-2 animate-spin" />\n                ) : orderForm.side === \'BUY\' ? (\n                  <TrendingUp className="h-4 w-4 mr-2" />\n                ) : (\n                  <TrendingDown className="h-4 w-4 mr-2" />\n                )}\n                {orderForm.side} {orderForm.quantity} {orderForm.symbol}\n              </Button>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Positions Tab */}\n        <TabsContent value="positions">\n          <Card>\n            <CardContent className="pt-6">\n              {positions.length === 0 ? (\n                <div className="text-center text-muted-foreground py-8">\n                  No open positions\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Symbol</TableHead>\n                      <TableHead className="text-right">Position</TableHead>\n                      <TableHead className="text-right">Avg Cost</TableHead>\n                      <TableHead className="text-right">Market Value</TableHead>\n                      <TableHead className="text-right">P&L</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {positions.map(pos => (\n                      <TableRow key={pos.conid}>\n                        <TableCell className="font-medium">{pos.symbol}</TableCell>\n                        <TableCell className="text-right">\n                          <span className={pos.position > 0 ? \'text-primary\' : \'text-destructive\'}>\n                            {pos.position > 0 ? \'+\' : \'\'}{pos.position}\n                          </span>\n                        </TableCell>\n                        <TableCell className="text-right">\n                          ${pos.avgCost.toFixed(2)}\n                        </TableCell>\n                        <TableCell className="text-right">\n                          ${pos.marketValue.toLocaleString(\'en-US\', { minimumFractionDigits: 2 })}\n                        </TableCell>\n                        <TableCell className={`text-right font-medium ${pos.unrealizedPnl >= 0 ? \'text-primary\' : \'text-destructive\'}`}>\n                          {pos.unrealizedPnl >= 0 ? \'+\' : \'\'}${pos.unrealizedPnl.toFixed(2)}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Orders Tab */}\n        <TabsContent value="orders">\n          <Card>\n            <CardContent className="pt-6">\n              {orders.length === 0 ? (\n                <div className="text-center text-muted-foreground py-8">\n                  No open orders\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Symbol</TableHead>\n                      <TableHead>Side</TableHead>\n                      <TableHead className="text-right">Qty</TableHead>\n                      <TableHead className="text-right">Filled</TableHead>\n                      <TableHead>Status</TableHead>\n                      <TableHead></TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {orders.map(order => (\n                      <TableRow key={order.orderId}>\n                        <TableCell className="font-medium">{order.symbol}</TableCell>\n                        <TableCell>\n                          <Badge variant={order.side === \'BUY\' ? \'default\' : \'destructive\'}>\n                            {order.side}\n                          </Badge>\n                        </TableCell>\n                        <TableCell className="text-right">{order.quantity}</TableCell>\n                        <TableCell className="text-right">{order.filledQuantity}</TableCell>\n                        <TableCell>\n                          <Badge variant="outline">{order.status}</Badge>\n                        </TableCell>\n                        <TableCell>\n                          <Button \n                            variant="ghost" \n                            size="sm"\n                            onClick={() => cancelOrder(order.orderId)}\n                          >\n                            Cancel\n                          </Button>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n';export{e as default};
