import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b9 as o,B as l,A as u,ce as d,cU as x,a8 as h,D as m,aB as p,aC as f,aD as w,aE as v,p as g,t as j,w as y,e4 as C,d$ as b,bq as N,dY as D,d0 as q,a1 as z,a2 as B,a3 as L,a4 as W,a5 as I,aY as M,bF as A,e5 as _,b as S,y as H}from"./index-CiI6UKiY.js";import{C as R}from"./calendar-CIUV5rHC.js";!function(){const e=Y,t=U();for(;;)try{if(426110===parseInt(e(226))/1*(-parseInt(e(271))/2)+parseInt(e(279))/3*(parseInt(e(304))/4)+-parseInt(e(341))/5+-parseInt(e(346))/6+parseInt(e(342))/7*(-parseInt(e(316))/8)+-parseInt(e(303))/9+parseInt(e(313))/10)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const K=function(){const e=Y,t={};t[e(252)]=function(e,t){return e!==t};const s=t;let n=!0;return function(t,r){const a=e;if(s[a(252)](a(266),a(251))){const e=n?function(){if(r){const e=r[a(323)](t,arguments);return r=null,e}}:function(){};return n=!1,e}{const e=_0x4dc2fc[a(323)](_0x56561f,arguments);return _0x3c6802=null,e}}}()(void 0,function(){const e=Y;return K[e(248)]()[e(241)]("(((.+)+)+)+$")[e(248)]()[e(287)+"r"](K)[e(241)](e(228)+"+$")});K();const G=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[Y(323)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}();async function P(t){const s=Y,n={};n[s(268)]="withdrawal"+s(239),n.hQRgi=s(314),n[s(258)]=s(307),n[s(294)]=s(302),n.gXYCy="user_id, d"+s(264)+"e",n[s(230)]=s(330);const r=n;try{const n={};n[s(328)]=!1;let a=e[s(292)](r.hQIHk).select("*").order(s(336),n);if(t&&t!==s(320)){if(s(249)===r[s(272)]){const e={};return e[s(281)]=[],e[s(235)]=_0x199854,e}a=a.eq(r[s(258)],t)}const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[])[s(298)](e=>e[s(330)]))],{data:l}=await e[s(292)](r[s(294)])[s(335)](r[s(283)]).in(r[s(230)],o),{data:u}=await e.from(s(344)+"ts")[s(335)](s(244)+s(322)+s(309)+s(278)+s(327)).in("user_id",o),d=new Map((null==l?void 0:l[s(298)](e=>[e[s(330)],e]))||[]),x=new Map((null==u?void 0:u[s(298)](e=>[e[s(330)],e]))||[]),h=(c||[])[s(298)](e=>{var t,n,r;return{...e,payout_details:e[s(293)+s(288)],user_display_name:(null==(t=d[s(297)](e[s(330)]))?void 0:t.display_name)||s(253)+"er",wallet_total_earned:(null==(n=x[s(297)](e.user_id))?void 0:n[s(238)+s(255)])||0,wallet_total_withdrawn:(null==(r=x[s(297)](e[s(330)]))?void 0:r[s(247)+s(224)+"s"])||0}}),m={};return m[s(281)]=h,m[s(235)]=null,m}catch(a){const e={};return e[s(281)]=[],e[s(235)]=a,e}}function Y(e,t){e-=222;const s=U();let n=s[e];if(void 0===Y.vaaeha){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};Y.dyuzZF=r,Y.BXCtQS={},Y.vaaeha=!0}const a=e+s[0],c=Y.BXCtQS[a];if(c)n=c;else{const e=function(e){this.FHSuZk=e,this.suIYBG=[1,0,0],this.ClFHTh=function(){return"newState"},this.WZQxRG="\\w+ *\\(\\) *{\\w+ *",this.OISsrE="['|\"].+['|\"];? *}"};e.prototype.bRbbDI=function(){const e=new RegExp(this.WZQxRG+this.OISsrE).test(this.ClFHTh.toString())?--this.suIYBG[1]:--this.suIYBG[0];return this.symKwa(e)},e.prototype.symKwa=function(e){return Boolean(~e)?this.LWahWX(this.FHSuZk):e},e.prototype.LWahWX=function(e){for(let t=0,s=this.suIYBG.length;t<s;t++)this.suIYBG.push(Math.round(Math.random())),s=this.suIYBG.length;return e(this.suIYBG[0])},new e(Y).bRbbDI(),n=Y.dyuzZF(n),Y.BXCtQS[a]=n}return n}function U(){const e=["y29UC3rYDwn0BW","ywLSCW","D2L0AgrYyxDHBa","yMLUza","quDpu3u","zNjVBq","Cgf5B3v0x2rLDa","DvLJsNe","DxbKyxrL","yvHhz3K","z2v0","BwfW","DgLJyxrLza","AfLlwNi","Bw91BNq","ChjVzMLSzxm","mZa3oti4n0rlA1jPBG","neXZANfesG","DcbMB3vUzcbVCG","ChjVy2vZCY13Aq","C3rHDhvZ","wxfuvNu","zf9Jzw50CYWGDa","zxHJzxb0Aw9U","AvbZAeq","DezSufa","mJeWnJmYnJbZuxPjr0u","s0LZv0C","Aw5MBW","ofDfr3v2BG","Dg9ju09tDhjPBG","CKHqEuu","y29UC29Szq","ywXS","CMvXDwLYzwq","B3rHBf9LyxjUzq","yxbWBhK","C2LUz2XL","Cg1dCxa","y3rVCIGICMv0Dq","CMf3BL9Jzw50CW","yxnJzw5KAw5N","CMvQzwn0zwrFyW","DxnLCL9Pza","CMv0DxjUicHMDq","cI0TlqO","y29TCgXLDgvKxW","C3rHDhvZlcbHBq","C2vSzwn0","y3jLyxrLzf9HDa","v0HttMe","ChjVDg90ExbL","wgvADfu","CgvUzgLUz19HBq","mZKWnZq1mgzUuwfHza","mtq3nte4n0TLqxrIqW","B3vUDf9Jzw50CW","DxnLCL93ywXSzq","Dw50","mJu5nZiYmfbqtLDHsq","DhntChm","uMvXDwvZDcbUBW","zhjHD25Fy2vUDa","CgvUzgLUz19JBW","nZGXugLdsgf0","yM9KEq","kcGOlISPkYKRkq","DgfIBgu","yuLAtxm","yxbWCM92zwrFyW","zNvUy3rPB25Z","Aw52B2TL","yw1VDw50x2nLBG","zxjYB3i","CMvHC29UigLZia","y29TCgXLDgvK","Dg90ywXFzwfYBG","x3jLCxvLC3rZ","tM90igf1DgHLBG","C2vHCMnO","CMvQzwn0zwq","yxv0Aa","DxnLCL9PzcWGDa","x19WCM90B19F","ve5Zwva","Dg90ywXFD2L0Aa","Dg9tDhjPBMC","qMT2EMO","vhDJu0O","y3r6seK","z01Ys3i","vw5RBM93BIbvCW","ywrTAw5FBM90zq","zwrFy2vUDhm","D2fYBG","CMvXDwvZDf9Pza","DeHNtLa","DLbPwuq","z2v0vxnLCG","DgHKCMf3ywW","zxDNEKG","Dg90ywW","AxnWBgf5x25HBq","v2fSBgv0ihvWza","C2f6y1G","yxbWCM92zwq","AffjsgS","ChjVDMvKihn0yq","B3vUDa","odeYtePMsgTW","Affsz2K","BMn0Aw9UkcKG","CM4GDgHPCYiPka","AKfNuM0","DM5xwMy","CgvUzgLUzW","B3rHBf93AxrOza","mtiXmJm0mM5xBgXZDW","wunqug8","zgf0yq","BgvUz3rO","z1Hzq3K","re1Srg8","yxbWCM92zwrFyq","C3vJy2vZCW"];return(U=function(){return e})()}async function Z(){const t=Y,s={};s[t(318)]="approved",s[t(262)]=t(289)+t(239);const n=s;try{const{data:s,error:r}=await e.from(n[t(262)])[t(335)](t(334)+t(343));if(r)throw r;const a={pending_count:0};a[t(340)+t(270)]=0,a[t(231)+t(270)]=0,a[t(285)+"mount"]=0,a[t(333)+t(263)]=0,a[t(329)+t(270)]=0;const c=a;(s||[]).forEach(e=>{const s=t;switch(e[s(307)]){case s(277):c[s(225)+s(345)]++,c[s(340)+"ount"]+=e.amount_cents;break;case n[s(318)]:c[s(231)+s(270)]++,c[s(285)+s(301)]+=e[s(234)+"ts"];break;case s(237):c["completed_"+s(263)]+=e[s(234)+"ts"];break;case s(242):c[s(329)+s(270)]++}});const i={};return i[t(281)]=c,i.error=null,i}catch(r){const e={};return e[t(281)]=null,e[t(235)]=r,e}}function E(){const e=["mJDmDeHer1a","seTZDNy","ALngtxi","z2v0vxnLCG","n1fqDwHTEG","CM4GDgHPCYiPka","BMn0Aw9UkcKG","uLbhsva","D05Zq2q","DgfIBgu","vNH3Bgq","vxLwqK0","Aw9WB3a","mJK2nZK2AfvMzePy","B1rfEuy","vK15t2u","C2vHCMnO","ufbPrLe","mti3mJq0y3zAs1Dd","CMTLDhbSywnLxW","DgLzEgq","zwnHruW","mtaWteH3CLns","y29UC3rYDwn0BW","y3rVCIGICMv0Dq","Dg9gAxHLza","nJy3ndGZohrjs2Dgqq","y2vFy2vUDhm","C0f5Bg8","yxbWBhK","EKn1wwm","B0XIrxC","ChjVy2vZC19Tyq","Dfrusvu","C2fSzq","wuvoB0m","DgLJyxrLza","EfjJEfC","CMv0DxjUicHMDq","AvjiCeu","oxDtqKr2ua","EgnewKK","zxjYB3i","ugnWwhu","wxDpCgK","D2fYBG","x19WCM90B19F","Dg9tDhjPBMC","y29UC29Szq","z2v0x29Yx2nYzq","suvMDwe","Aw5MBW","uhHwzuq","yMLUza","odyZotG2oefNufDAqW","C3vJy2vZCW","s1P1rfy","zvj5sem","y3LfufC","qwvTqxm","rgHdAxi","mZG5mtG0oe9zrxbzAW","vLz5swO","uNz1ze8","kcGOlISPkYKRkq","vK9wqu0","rxjxDNC","EKzMs1i","ChjVDg90ExbL","D2fSBgv0x3rYyq","BgvUz3rO","E30Uy29UC3rYDq","tM90igf1DgHLBG","y3jLyxrLzf9HDa","ndiWmdeZs1PszhnY","zgf0yq","C2vSzwn0","C2X5uMS","Cf91C2vYx2LK","zLvnC2m","DenIrvi","BxPYt0W","mtn4tK1HELO","ruDIwfy","Bg9N","BgLTAxq","CNbJ","uwDtC2u","qK9xuvG","AhvUsvK","DhjHy2u","s2HpDfe","yxnJzw5KAw5N","Cf9SAxn0Aw5NxW","Cw1Yu0i","mJe1tK9Nvw54","yxv0Aa","uuPJy2y","mtCXmZi2C0Lor2rx"];return(E=function(){return e})()}G(void 0,function(){const e=Y,t={tFlPP:function(e,t){return e(t)},pmCqp:function(e,t){return e+t},YqTVu:"{}.constru"+e(326)+e(274)+" )",tsSps:e(256),OxDcm:e(315),TwcSJ:"error",WHSNa:e(310),YCPPo:e(229),GoZqb:function(e,t){return e<t}};let s;try{s=t[e(312)](Function,t[e(325)](e(331)+e(273)+t[e(308)],");"))()}catch(a){s=window}const n=s[e(319)]=s[e(319)]||{},r=["log",t[e(222)],t.OxDcm,t[e(250)],t[e(337)],t[e(280)],"trace"];for(let c=0;t.GoZqb(c,r[e(282)]);c++){const t=G.constructor[e(338)].bind(G),s=r[c],a=n[s]||t;t[e(245)]=G.bind(G),t[e(248)]=a[e(248)][e(290)](a),n[s]=t}})(),function(){const e=X,t=E();for(;;)try{if(760534===-parseInt(e(226))/1+-parseInt(e(141))/2*(-parseInt(e(227))/3)+parseInt(e(146))/4*(-parseInt(e(223))/5)+parseInt(e(154))/6*(parseInt(e(132))/7)+parseInt(e(189))/8*(-parseInt(e(168))/9)+parseInt(e(150))/10*(-parseInt(e(202))/11)+parseInt(e(182))/12*(parseInt(e(210))/13))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const k=function(){const e=X,t={PxVeD:function(e,t){return e+t},BmvlU:e(166)+e(134),hunIY:function(e){return e()},wNsCd:"error",UyVBM:e(218),sAylo:function(e,t){return e!==t},RHubQ:"osNpi",xRcxW:e(225)};let s=!0;return function(n,r){const a=e,c={YENoC:function(e,s){return t[X(180)](e,s)},RvudO:t.BmvlU,RPGIP:function(e){return t[X(217)](e)},pbtbB:t[a(136)],PfxIi:t[a(139)],gqezW:function(e,t){return e<t},AemAs:function(e,s){return t[a(156)](e,s)},VMyOe:t.RHubQ,oTEyF:a(209),sajNC:"zVuNJ"};if(t[a(165)]===a(225)){const e=s?function(){const e=a,t={tCbER:function(e,t){return c[X(163)](e,t)},fUMsc:c[e(191)],DhCir:e(199)+'ctor("retu'+e(133)+" )",HKsvv:function(t){return c[e(135)](t)},zCuYc:e(212),BOWQX:e(179),cyEPW:c.pbtbB,PPiFQ:e(137),PcpXu:c.PfxIi,EGbXV:function(e,t){return c.gqezW(e,t)}};if(c[e(187)](c[e(143)],c[e(142)])){if(r){if(c.sajNC!==e(172)){const e=r.apply(n,arguments);return r=null,e}{let n;try{const s=_0x3686be(t[e(208)](t[e(207)],t[e(188)])+");");n=t[e(129)](s)}catch(s){n=_0x11c3ef}const r=n[e(176)]=n[e(176)]||{},a=[t[e(158)],e(173),t[e(216)],t[e(186)],"exception",t[e(145)],t[e(171)]];for(let s=0;t[e(211)](s,a[e(198)]);s++){const t=_0x22c455[e(151)+"r"][e(196)][e(181)](_0x36fa26),n=a[s],c=r[n]||t;t[e(174)]=_0x263e4a[e(181)](_0x13cfc3),t[e(175)]=c[e(175)][e(181)](c),r[n]=t}}}}else _0x7452a7=_0x4fea9e}:function(){};return s=!1,e}{const e=_0x2b3c57[a(157)](_0x3b44d9,arguments);return _0x4f98ae=null,e}}}()(void 0,function(){const e=X;return k.toString()[e(144)](e(192)+"+$")[e(175)]()[e(151)+"r"](k)[e(144)](e(192)+"+$")});function X(e,t){e-=129;const s=E();let n=s[e];if(void 0===X.tgubAc){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};X.zOCVRf=r,X.ospeKh={},X.tgubAc=!0}const a=e+s[0],c=X.ospeKh[a];if(c)n=c;else{const e=function(e){this.tlkXnQ=e,this.bSRIDy=[1,0,0],this.FmvhRm=function(){return"newState"},this.YbgcQq="\\w+ *\\(\\) *{\\w+ *",this.Lbuvws="['|\"].+['|\"];? *}"};e.prototype.OKXKIR=function(){const e=new RegExp(this.YbgcQq+this.Lbuvws).test(this.FmvhRm.toString())?--this.bSRIDy[1]:--this.bSRIDy[0];return this.nCGHvt(e)},e.prototype.nCGHvt=function(e){return Boolean(~e)?this.DvZhTy(this.tlkXnQ):e},e.prototype.DvZhTy=function(e){for(let t=0,s=this.bSRIDy.length;t<s;t++)this.bSRIDy.push(Math.round(Math.random())),s=this.bSRIDy.length;return e(this.bSRIDy[0])},new e(X).OKXKIR(),n=X.zOCVRf(n),X.ospeKh[a]=n}return n}k();const O=function(){const e=X,t={};t[e(138)]=e(161);const s=t;let n=!0;return function(e,t){const r=n?function(){const n=X;if(s[n(138)]!=s[n(138)]){const e={};return e[n(203)]=[],e[n(170)]=_0x5480db,e}if(t){const s=t[n(157)](e,arguments);return t=null,s}}:function(){};return n=!1,r}}();function F(e){return"$"+(e/100)[X(153)](2)}function J(){var K,G;const{user:U}=t(),E=s(),[k,X]=n.useState(!1),[O,J]=n.useState(!0),[V,T]=n.useState([]),[Q,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{oe()},[U]);const oe=async()=>{if(!U)return void J(!1);const{data:t}=await e.rpc("has_role",{_user_id:U.id,_role:"admin"});!0===t&&(X(!0),await le()),J(!1)},le=async()=>{const[e,t]=await Promise.all([P(ee),Z()]);e.data&&T(e.data),t.data&&$(t.data)},ue=e=>{switch(e){case"pending":return r.jsxs(H,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(d,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(H,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(H,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(H,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(H,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(m,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(H,{variant:"outline",children:e})}};return O?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):U&&k?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E(-1),children:r.jsx(u,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),Q&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(d,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:F(Q.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:F(Q.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:F(Q.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),le()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(w,{value:"pending",children:"Pending"}),r.jsx(w,{value:"approved",children:"Approved"}),r.jsx(w,{value:"completed",children:"Completed"}),r.jsx(w,{value:"rejected",children:"Rejected"}),r.jsx(w,{value:"all",children:"All"})]}),r.jsx(v,{value:ee,children:r.jsxs(c,{children:[r.jsxs(g,{children:[r.jsx(j,{children:"Withdrawal Requests"}),r.jsxs(y,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===V.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(C,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(b,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:V.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(N,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(D,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[ue(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(R,{className:"h-3 w-3"}),q(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",F(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:F(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(m,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(l,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(z,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(B,{children:[r.jsxs(L,{children:[r.jsxs(W,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(I,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(K=se.request.payout_details)?void 0:K.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:F(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(M,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(A,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(G=se.request.payout_details)?void 0:G.email})]})]})]}),r.jsxs(_,{children:[r.jsx(l,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=Y,r={};r[n(296)]=n(267),r[n(259)]=function(e,t){return e||t};const a=r;try{const{data:{user:r}}=await e.auth[n(260)]();if(!r)throw new Error(n(240)+"ticated");const{error:c}=await e[n(292)](n(289)+n(239))[n(295)]({status:a.aXGgy,admin_notes:a[n(259)](s,null),reviewed_by:r.id,reviewed_at:(new Date)[n(317)+"g"]()}).eq("id",t).eq(n(307),n(277));if(c)throw c;const i={};return i[n(286)]=!0,i[n(235)]=null,i}catch(c){const e={};return e[n(286)]=!1,e.error=c,e}}(se.request.id,re),t.success&&S.success("Withdrawal approved");break;case"reject":if(!re.trim())return S.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=Y,r={};r[n(300)]="Rejection "+n(236)+n(321),r[n(284)]="withdrawal"+n(239);const a=r;try{const{data:{user:r}}=await e[n(243)].getUser();if(!r)throw new Error(n(240)+n(299));if(!s)throw new Error(a[n(300)]);const{error:c}=await e[n(292)](a[n(284)])[n(295)]({status:"rejected",admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date)[n(317)+"g"]()}).eq("id",t).eq(n(307),n(277));if(c)throw c;const i={};return i[n(286)]=!0,i[n(235)]=null,i}catch(c){const e={};return e[n(286)]=!1,e[n(235)]=c,e}}(se.request.id,re),t.success&&S.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=Y,r={};r.jAgRm=n(240)+n(299),r.iPshD=function(e,t){return e||t},r[n(291)]=n(223)+n(305)+" not in ap"+n(269)+"tus",r.iRPug=n(237),r[n(246)]="qVXNO",r[n(339)]=n(265)+"ate error:";const a=r;try{const{data:{user:r}}=await e[n(243)][n(260)]();if(!r)throw new Error(a[n(275)]);const{data:c,error:i}=await e[n(292)]("withdrawal"+n(239)).select("*").eq("id",t).eq("status","approved")[n(324)]();if(a[n(311)](i,!c))throw new Error(a[n(291)]);const{error:o}=await e.from(n(289)+n(239))[n(295)]({status:a.iRPug,admin_notes:s?(c[n(254)+"s"]||"")+n(332)+s:c[n(254)+"s"],completed_at:(new Date)[n(317)+"g"]()}).eq("id",t);if(o)throw o;const l={};l[n(257)]=t,l[n(330)]=c[n(330)],l[n(234)+"ts"]=c[n(234)+"ts"];const u={};u[n(227)]=l;const{error:d}=await e[n(232)][n(233)](n(306)+n(261),u);d&&n(276)===a[n(246)]&&(_0x431c59=_0x1590c7);const x={};return x[n(286)]=!0,x.error=null,x}catch(c){const e={};return e[n(286)]=!1,e[n(235)]=c,e}}(se.request.id,re),t.success&&S.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?S.error(t.error.message):(ne({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(l,{onClick:()=>E("/"),children:"Go Home"})]})})})}O(void 0,function(){const e=X,t={zFfKR:function(e,t){return e(t)},qmrSB:"return (fu"+e(134),iRHpE:e(199)+'ctor("return this")( )',eRyHC:function(e){return e()},oLbEw:function(e,t){return e!==t},iopop:e(190),jSFMr:"error",xcDZI:"exception",KZuDV:e(137),ErWvw:e(218),tiYxd:function(e,t){return e<t}};let s;try{if(t[e(159)]("mKVSu",t[e(140)])){const n=Function(t[e(222)]+(e(199)+e(152)+'rn this")( ));'));s=t.eRyHC(n)}else{const s=t[e(195)](_0x92588e,t.qmrSB+t[e(167)]+");");_0x2dbdb9=t[e(185)](s)}}catch(a){s=window}const n=s[e(176)]=s[e(176)]||{},r=[e(212),"warn","info",t[e(130)],t[e(169)],t[e(184)],t[e(194)]];for(let c=0;t[e(148)](c,r[e(198)]);c++){const t=O[e(151)+"r"].prototype.bind(O),s=r[c],a=n[s]||t;t[e(174)]=O[e(181)](O),t[e(175)]=a[e(175)][e(181)](a),n[s]=t}})();export{J as default};
