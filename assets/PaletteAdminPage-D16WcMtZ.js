import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as m,P as h,w as f,B as p,bM as j,cj as v,a9 as g,am as w,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as k,cu as D,b as K}from"./index-Byyho7FJ.js";!function(){const e=_,s=q();for(;;)try{if(505142===parseInt(e(481))/1*(parseInt(e(436))/2)+-parseInt(e(427))/3+parseInt(e(423))/4+parseInt(e(429))/5*(parseInt(e(466))/6)+-parseInt(e(450))/7*(parseInt(e(484))/8)+-parseInt(e(488))/9*(parseInt(e(419))/10)+parseInt(e(476))/11)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const B=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[_(439)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=_,s={};s[e(490)]=e(491)+"+$";const t=s;return B[e(432)]()[e(435)](t[e(490)])[e(432)]()[e(458)+"r"](B)[e(435)](e(491)+"+$")});function q(){const e=["z2fTzv9KyxrH","x3vZzxjFAwq","BgLUA2vKugfSzq","zxjYB3i","AwqSigDHBwvFza","t0D1y0u","DLj1v1a","ihjVBgu6","Bg9N","CgfSzxr0zv9Pza","D2HPDgu","AhP5tu8","AxHkt2y","y3rVCIGICMv0Dq","Denoue8","CgfSzxr0zv9VDG","AfrOsxC","zfPnEgK","t21cz2S","CM4GDgHPCYiPka","s2vMCgK","yxrPB25ZoG","yxjir3G","nJeWsvn6vhf5","DxbKyxrL","zNjVBq","DgLUzYbSAw5Rzq","mtq1mJq3mNDWq0rdyW","CMv0DxjUicHMDq","yMXHy2S","zMLUza","mtmXmtC4mfnLzKLjwG","C2vSzwn0","ntbNtxvJAeu","C3LxDxC","vvL0wKi","Dg9tDhjPBMC","ALbYEgy","wvDsrhu","C2vHCMnO","ntjjC3jvCfu","DMLZDwfSAxPHDa","zxHJzxb0Aw9U","yxbWBhK","C2vHBwq","ueDsu1qXmty","DhjHy2u","rgT1rgW","ywrTAw4","B3jKzxi","ChjVDg90ExbL","E30Uy29UC3rYDq","y29UC29Szq","CgfSzxr0zuLK","nZi3m29RzNDHDq","y3jNENa","qvv3quq","qNfsBhC","EvDqugS","A1LLseq","yxrH","Aw9Uu3rHDgu","y29UC3rYDwn0BW","zgf0yq","x3jVBgu","x19WCM90B19F","yMLUza","DKDnrLO","Aw5Zzxj0","zcb2Axn1ywXPEG","mtq0nJK2uLrNBKLK","rhriAuS","Aw5MBW","y29Kzq","DMvYC2LVBG","AgfZx3jVBgu","DNfUy2W","CNbJ","rxjYB3iGy2HLyW","DgrHt2G","mtq1otu5DgjryKXp","C29vtfy","C1zStuq","rxjYB3iGAw4Gyq","yMHYtfm","mtG0nJzlzuXRBvK","D2fYBG","BMf2BgS","ntuYvM1AyKTv","Bw9KAwzPzwrFyG","DgfIBgu","D2HPDgvFy29SBW","mtiZmZbyChbnzfG","zxjYAwrLCW","ENLpzMy","kcGOlISPkYKRkq","t01ztMK"];return(q=function(){return e})()}B();const M=function(){const e=_,s={};s[e(463)]=function(e,s){return e!==s},s[e(454)]=e(478);const t=s;let n=!0;return function(e,s){const r=n?function(){const n=_;if(s){if(!t[n(463)](t.yWPPk,t.yWPPk)){const t=s.apply(e,arguments);return s=null,t}{const e=_0xf38332[n(458)+"r"][n(446)][n(462)](_0x2931e9),s=_0x20d9be[_0x729586],t=_0xdf6e53[s]||e;e.__proto__=_0x258325.bind(_0x37e4b5),e[n(432)]=t[n(432)][n(462)](t),_0x2c2ceb[s]=e}}}:function(){};return n=!1,r}}();function _(e,s){e-=399;const t=q();let n=t[e];if(void 0===_.zYKVOp){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};_.kExCJI=r,_.MyMKCB={},_.zYKVOp=!0}const a=e+t[0],i=_.MyMKCB[a];if(i)n=i;else{const e=function(e){this.KnrqeQ=e,this.bLrMkW=[1,0,0],this.VKtaXa=function(){return"newState"},this.WpoYOG="\\w+ *\\(\\) *{\\w+ *",this.NGjWIl="['|\"].+['|\"];? *}"};e.prototype.rWeeRi=function(){const e=new RegExp(this.WpoYOG+this.NGjWIl).test(this.VKtaXa.toString())?--this.bLrMkW[1]:--this.bLrMkW[0];return this.iblgZW(e)},e.prototype.iblgZW=function(e){return Boolean(~e)?this.zePGjA(this.KnrqeQ):e},e.prototype.zePGjA=function(e){for(let s=0,t=this.bLrMkW.length;s<t;s++)this.bLrMkW.push(Math.round(Math.random())),t=this.bLrMkW.length;return e(this.bLrMkW[0])},new e(_).rWeeRi(),n=_.kExCJI(n),_.MyMKCB[a]=n}return n}async function A(s,t,n,r){const a=_,i={};i[a(434)]=function(e,s){return e!==s},i[a(467)]="iUKSs",i[a(410)]=a(411)+"errides",i.YVlwY=function(e,s){return e+s},i[a(480)]=function(e,s){return e+s};const c=i;try{if(c[a(434)](c.DtHiK,"sAoBP")){const{data:i}=await async function(s){const t=_,n={};n[t(418)]=t(405);const r=n;try{const{data:n,error:a}=await e.from(t(411)+t(489))[t(428)]("*").eq(r[t(418)],s).single();if(a&&a[t(469)]!==t(441))throw a;const i={};return i[t(459)]=n,i[t(399)]=null,i}catch(a){const e={};return e[t(459)]=null,e.error=a,e}}(s);if(i){const{error:o}=await e[a(421)](c[a(410)])[a(420)]({white_colors:t,black_colors:n,modified_by:r,version:c.YVlwY(i[a(470)],1)}).eq(a(405),s);if(o)throw o;return{error:null,version:c[a(480)](i[a(470)],1)}}{const i={};i.palette_id=s,i[a(487)+"rs"]=t,i.black_colors=n,i[a(485)+"y"]=r,i[a(470)]=1;const{error:c}=await e.from("palette_overrides")[a(464)](i);if(c)throw c;const o={};return o[a(399)]=null,o.version=1,o}}{const e=_0x182e5d.apply(_0x4f9094,arguments);return _0x4b63c2=null,e}}catch(o){const e={};return e.error=o,e[a(470)]=0,e}}async function L(s){const t=_,n={};n[t(483)]=function(e,s){return e===s},n[t(408)]=t(472),n.soULV="saved_visualizations",n[t(402)]=t(400)+t(456),n[t(452)]=function(e,s){return e===s},n[t(443)]=function(e,s){return e===s};const r=n;try{if(r[t(483)]("vqncl",r[t(408)])){const{data:n,error:a}=await e[t(421)](r[t(477)])[t(428)](r[t(402)]);if(a)throw a;let i=0;for(const e of n||[]){const n=e[t(493)][t(437)+t(457)];(r[t(452)](null==n?void 0:n[t(449)],s)||(null==n?void 0:n[t(495)+"tteId"])===s)&&i++}return i}{const e={};return e[t(459)]=null,e[t(399)]=_0x519724,e}}catch(a){if(r[t(443)](t(413),t(413)))return 0;if(_0x391272){const e=_0x1a6ff9[t(439)](_0x2e551d,arguments);return _0x45e8f3=null,e}}}M(void 0,function(){const e=_,s={kYeHD:function(e,s){return e===s},crgzp:e(433),hzyMO:function(e,s){return e(s)},UYtZB:e(424)+"nction() ",OmBgk:e(447)+e(409)+e(415)+" )",yNTYb:e(404),UAKYi:e(482),IKHLf:e(468),tdaOh:e(399),seamd:e(442),KvTtN:function(e,s){return e!==s},BqRlw:e(401)},t=function(){const t=e;let n;try{if(!s[t(455)](s[t(451)],s[t(451)])){const e=_0xeaeee1?function(){if(_0x1ed0fd){const e=_0x2c7e6d[t(439)](_0x38699f,arguments);return _0x47e1be=null,e}}:function(){};return _0x304498=!1,e}n=s[t(407)](Function,s[t(431)]+s[t(414)]+");")()}catch(r){n=window}return n}(),n=t[e(448)]=t[e(448)]||{},r=[s.yNTYb,s.UAKYi,s.IKHLf,s[e(475)],e(438),e(486),s[e(440)]];for(let a=0;a<r.length;a++){if(!s.KvTtN("TNhbs",s[e(453)])){const s={};return s[e(399)]=_0x2e93e3,s[e(470)]=0,s}{const s=M[e(458)+"r"][e(446)].bind(M),t=r[a],i=n[t]||s;s[e(461)]=M.bind(M),s[e(432)]=i.toString[e(462)](i),n[t]=s}}})();const S=["k","q","r","b","n","p"],W={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},P=()=>{var B,q,M,P;const{user:Y}=s(),G=t(),[H,I]=n.useState(!1),[U,V]=n.useState(!0),[E,O]=n.useState([]),[R,T]=n.useState(null),[Z,F]=n.useState(null),[J,$]=n.useState({}),[X,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!Y)return void G("/");if(!(await async function(s){const t=_,n={};n.syWuw=t(471),n[t(416)]=function(e,s){return e===s};const r=n;try{const n={};n[t(494)]=s,n[t(460)]=t(444);const{data:a,error:i}=await e[t(473)](r[t(430)],n);return!i&&r.Kefpi(a,!0)}catch(a){return!1}}(Y.id)))return K.error("Access denied",{description:"Admin privileges required"}),void G("/");I(!0),await te(),V(!1)})()},[Y,G]);const te=async()=>{const{data:s}=await async function(){const s=_,t={};t[s(412)]="palette_id";const n=t;try{const{data:t,error:r}=await e[s(421)](s(411)+s(489))[s(428)]("*")[s(445)](n[s(412)]);if(r)throw r;const a={};return a[s(459)]=t||[],a.error=null,a}catch(r){const e={};return e[s(459)]=[],e.error=r,e}}();O(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await L(e.id);$(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=E.find(s=>s.palette_id===e);T(e),F({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{Z&&F({...Z,[e]:{...Z[e],[s]:t}})},ae=async()=>{if(!R||!Z||!Y)return;Q(!0),se(!1);const{error:e,version:s}=await A(R,Z.white,Z.black,Y.id);e?K.error("Failed to save",{description:e.message}):(K.success("Palette updated!",{description:`Version ${s} saved. ${J[R]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>E.some(s=>s.palette_id===e);return U?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):H?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(R===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),J[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),J[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[S.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),S.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:R&&Z?r.jsxs(o,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(m,{className:"flex items-center gap-2",children:[r.jsx(h,{className:"h-5 w-5"}),null==(B=ie(R))?void 0:B.name]}),r.jsx(f,{children:null==(q=ie(R))?void 0:q.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(R)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!R)return;Q(!0);const{error:s}=await async function(s){const t=_,n={};n[t(492)]=t(405);const r=n;try{const{error:n}=await e[t(421)](t(411)+t(489)).delete().eq(r[t(492)],s);if(n)throw n;const a={};return a[t(399)]=null,a}catch(a){const e={};return e[t(399)]=a,e}}(R);s?K.error("Failed to revert",{description:s.message}):(K.success("Reverted to defaults"),ne(R),await te()),Q(!1)},disabled:X,children:[r.jsx(j,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!R||!Z||!Y)return;(J[R]||0)>0?se(!0):await ae()},disabled:X,children:[X?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(v,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(M=ie(R))?void 0:M.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:S.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:W[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(g,{type:"color",value:Z.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(g,{type:"text",value:Z.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(P=ie(R))?void 0:P.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:S.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:W[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(g,{type:"color",value:Z.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(g,{type:"text",value:Z.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(w,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:S.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:Z.white[e]},title:W[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:S.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:Z.black[e]},title:W[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(k,{children:["This palette is linked to ",r.jsx("strong",{children:J[R||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:X,children:[X?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(D,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{P as default};
