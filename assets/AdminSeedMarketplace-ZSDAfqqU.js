import{d6 as e,d7 as t,cp as s,a as n,u as r,r as a,J as i,o,s as l,aH as c,aa as u,cM as d,j as m,L as f,C as x,x as h,D as p,B as g,A as v,p as w,t as y,cN as j,bC as b,S as N,a6 as z,P as C,y as M,bG as D,T as B,aq as L,z as S,cU as E,aj as A,aT as q,ca as _,b as k,d8 as G}from"./index-Ddz_gr3U.js";!function(){const e=P,t=H();for(;;)try{if(804661===parseInt(e(434))/1+-parseInt(e(424))/2+-parseInt(e(248))/3*(-parseInt(e(448))/4)+-parseInt(e(291))/5*(parseInt(e(415))/6)+parseInt(e(360))/7*(-parseInt(e(327))/8)+-parseInt(e(251))/9*(-parseInt(e(268))/10)+-parseInt(e(273))/11*(-parseInt(e(259))/12))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const I=function(){const e=P,t={};t.EeQJj=e(375);const s=t;let n=!0;return function(e,t){const r=n?function(){const n=P;if(n(375)!==s[n(330)])_0x3f56ac[n(310)](_0x189a3d,_0x340605,_0x2d4495);else if(t){const s=t.apply(e,arguments);return t=null,s}}:function(){};return n=!1,r}}()(void 0,function(){const e=P,t={};t[e(436)]=e(374)+"+$";const s=t;return I.toString()[e(384)]("(((.+)+)+)+$")[e(404)]().constructor(I).search(s[e(436)])});I();const T=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}();T(void 0,function(){const e=P,t={zDEKy:function(e,t){return e+t},kVJtk:e(355)+e(278),jSdVc:e(312)+'ctor("retu'+e(422)+" )",TXBVF:e(458),qrsbI:function(e){return e()},IytLv:e(277),bKLcb:e(309)},s=t[e(400)](function(){const s=e;let n;try{n=Function(t[s(260)](t[s(387)]+t[s(373)],");"))()}catch(r){s(294)===t[s(337)]?_0x25b75d=_0x2a18d9:n=window}return n}),n=s[e(261)]=s.console||{},r=[t[e(334)],t[e(316)],"info","error","exception",e(269),e(336)];for(let a=0;a<r.length;a++){const t=T[e(371)+"r"][e(311)][e(313)](T),s=r[a],i=n[s]||t;t[e(407)]=T.bind(T),t[e(404)]=i[e(404)][e(313)](i),n[s]=t}})();async function K(){const e=P,t={AnZmz:function(e,t){return e(t)},ISBAB:e(405)};document[e(328)]&&document[e(328)][e(429)]&&(e(245)!==t[e(297)]?await document[e(328)][e(429)]:(_0xf7967a[e(353)+e(270)](_0x7357),t[e(430)](_0x7e2fb7,new _0xabad56("Failed to "+e(322))))),await new Promise(e=>setTimeout(e,150))}function P(e,t){e-=242;const s=H();let n=s[e];if(void 0===P.KKySix){var r=function(e){let t="",s="",n=t+r;for(let r,a,i=0,o=0;a=e.charAt(o++);~a&&(r=i%4?64*r+a:a,i++%4)?t+=n.charCodeAt(o+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};P.kxwoGq=r,P.QHLeow={},P.KKySix=!0}const a=e+s[0],i=P.QHLeow[a];if(i)n=i;else{const e=function(e){this.uwAFZL=e,this.BddmMD=[1,0,0],this.MEUyrg=function(){return"newState"},this.DulRRB="\\w+ *\\(\\) *{\\w+ *",this.vanide="['|\"].+['|\"];? *}"};e.prototype.civUjc=function(){const e=new RegExp(this.DulRRB+this.vanide).test(this.MEUyrg.toString())?--this.BddmMD[1]:--this.BddmMD[0];return this.uAuNkK(e)},e.prototype.uAuNkK=function(e){return Boolean(~e)?this.kdSzXm(this.uwAFZL):e},e.prototype.kdSzXm=function(e){for(let t=0,s=this.BddmMD.length;t<s;t++)this.BddmMD.push(Math.round(Math.random())),s=this.BddmMD.length;return e(this.BddmMD[0])},new e(P).civUjc(),n=P.kxwoGq(n),P.QHLeow[a]=n}return n}function H(){const e=["wK5zB2y","qMXHy2S","CNnpwKG","phn2zYb4BwXUCW","iIbMAwXSpsi","svncqui","Dg9eyxrHvvjm","zgX3uwO","ww1Tywq","v21oBeS","q2LUEMvSjYWGjW","vM1ttKK","EwHpA2q","Ew56veq","y3jLyxrLt2jQzq","ALj0rLm","A2vXt3m","D2fYBG","zMLSBfrLEhq","ChjVDg90ExbL","E30Uy29UC3rYDq","yMLUza","vM1YwwG","AgvPz2H0","yKTmy2i","i2zHzMfMoq","C1jUvvO","CgnPzwe","AxrHBgLJiduWma","zw5Wzw5Zzw50lG","Bg9HzcbtvKC","DfzAELi","iZbbmeeWqq","CMDIysGYntuSia","BgLUzvDPzhrO","ndy1mtu2oeLSCgXPuG","zM9UDhm","uM9Tyw4NlcbuAq","rwvrsMO","shLOEw4","y29T","AxnmAwDODa","sxL0thy","CM91BMrszwn0","DhjHy2u","vfHcvKy","BwLKzgXL","uwLlveS","zxzLBNq","Egr6sMC","iZi5mJuYna","Auz0q1e","s1LlEfC","CMLM","wxPdBvK","y2LlAu8","uw9ezNi","ywXWAgfIzxrPyW","AgLUz1f1ywXPDa","uePYq2u","Bgf5zxjtAxPL","CMv2B2TLt2jQzq","y2fUDMfZ","CMv0DxjUicHMDq","AM9PBG","zM9UDa","iIb2Awv3qM94pq","D2HPDgu","n0f5zfHttq","vfrcufi","psjODhrWoI8VDW","Aw1Hz2vtBw9VDa","B25LCNjVCG","BgvMDa","t1LysKy","yMvNAw5qyxrO","iZfbmueXqq","BwLU","iIbOzwLNAhq9iG","y29UC3rYDwn0BW","mJu1lcaYntuSia","ALnKvMm","kcGOlISPkYKRkq","C1rrDu8","vw5RBM93BG","rhHru2i","DMLZAxrZ","AgLNAa","CMvZDg9Yzq","D2LKDgG9iG","lI4U","ChvZAa","C2vHCMnO","tLqG4PMA","ve5Ituq","A1zkDgS","zw50","ndaWideWChGGjW","ufrgrvG","DfDzALe","uNviDwO","z2n5AKi","rgffteG","DhjHBNnWyxjLBG","BfH2v3O","Bw92zvrV","iIb5psiWiIb3Aq","DhLWzq","CxjZyKK","Bw92zxm","CMvKDwnL","C3bSAxq","Dg9tDhjPBMC","EMjNBwO","C2nHBgu","x19WCM90B19F","vgzVyvK","iIb5psi","twzSvMm","BNmTC2vYAwy","CxjJB2rL","ug5gEvi","zhrOpsi","mJe0ohj4s1rRsq","zgvMyxvSDa","icdIGkiGia","yLDis3q","AgLUz0vUywjSzq","rMfPBgvKihrVia","phjLy3qGEd0I","CM4GDgHPCYiPka","B25SB2fK","mJu0mtu5nLL0r3b4sG","Ahr0Chm6lY9LBG","t1z4C0i","y0TeELC","BwvZlcbZzxjPzG","CMvHzhK","qw5ABxO","s1rLvgq","ide4ChGGj0nVCG","i0zbrKfgqq","nda4odiZrfbytwjs","D2LKDgG","uxPKy04","Bw9Yyw50jYWGrW","Dg9vChbLCKnHCW","vev2yMW","CMn3B2W","shLmwLa","Dgv4DejHC2vSAq","zLvMqwe","u25hswS","BwvHC3vYzvrLEa","Bw94uxC","zMLSBfn0EwXL","nZK0ogXdwMjnqq","z21wCvm","C3jJ","BgLUzvrV","y2XPCa","zgfYAW","C3vIC3rYAw5N","Cwn1C2O","BgvUz3rO","y2vUDgvY","zMzOBgC","sw50zxiNlcbZyq","Cw1bD08","y3jLyxrLrwXLBq","uwj0wNy","z2v0q29UDgv4Da","tgLxBLa","ntaWideYChGGjW","C0PYEuq","wgvRq3O","qMTyrwW","ndaWideXChGGjW","Dd11DgyToa","odqZzvPJswD5","ChrYELq","yxjJ","mtG5yuLTwvvg","4PMuievoifbftLnf","CgLLy2u","vgLTzxmGtMv3ia","iIb3Awr0Ad0I","CgDurNe","Aw1Hz2uVC3zNkW","zMLSBfjLy3q","mtq1nZq2meHLB052DG","EKrfs3K","y29UC29Szq","iZq0ndaZyW","i2e4yti5zq","AhjIt3C","zhjHD0LTywDL","ueDnDwy","CgvUC2vUDc5JBW","nti0ntmWs3nKz21r","DgfIBgu","y3rvuKW","zw9Yz2LHlcbZzq","iZC4nZe2yW","odHzDMHREg4","idiWChGGj0nVCG","ywXS","wgvPy2K","Bg9N","BMn0Aw9UkcKG","ELbtBxi","zgf0zq","iI8+","sKThB00","Aw5JBhvKzxm","DMzhEfe","y29SB3i","C3rYB2TL","Dgv4DefSAwDU","Cg9SyK4","zMLSBa","mJaWmc9ZDMCIia","ntm1nxfdDvDZBG"];return(H=function(){return e})()}async function W(e){const t=P,s={};s[t(323)]=t(425)+t(267)+"m",s[t(341)]=t(368);const n=s;return(await import(t(412)))[t(416)][t(298)](n.tVZzR,{width:200,margin:1,color:{dark:e?t(433):n[t(341)],light:t(395)+"t"},errorCorrectionLevel:"M"})}async function Y(){const e=P,t={};t[e(455)]="anonymous";const n=t;return new Promise((t,r)=>{const a=e,i=new Image;i.crossOrigin=n[a(455)],i.onload=()=>t(i),i.onerror=r,i[a(450)]=s})}async function O(s,n,r={}){const a=P,i={RRSRk:function(e){return e()},XekCz:a(417),QoDfr:function(e){return e()},TfoaY:function(e,t){return e*t},ZNYof:function(e,t){return e+t},YzCmY:function(e,t){return e*t},TTBPR:function(e,t){return e+t},DxQSb:function(e,t){return e+t},MkcXf:a(379),gcyjB:"#FDFCFB",rcwol:function(e,t){return e-t},qmAwO:a(317),WmNlK:a(263),DaELH:"White",ptrzT:a(338),HyLZP:"600 24px '"+a(302)+"Times New Roman', serif",JKGoM:a(320)+a(274)+"morant', G"+a(271)+a(345),novnJ:" vs ",VmSNI:a(365),LiWnP:function(e,t){return e||t},ynzTD:a(242)+"Inter', sa"+a(411),keqOs:function(e,t){return e-t},TEvbl:function(e,t){return e!==t},polbN:function(e,t){return e>t},dlwQj:"mTZkL",BOaVn:"center",PJrCe:function(e,t){return e>t},PGMuf:a(382),BQwZI:function(e,t){return e===t},yhOkd:a(343),qcTeT:function(e,t){return e>=t},jRtFS:function(e,t){return e<t},Ymmad:function(e,t){return e-t},OVxsB:"500 11px '"+a(459)+"ns-serif",ihwfo:a(252)+a(385),moxQw:function(e,t){return e*t},oYUYu:function(e,t){return e-t},pgTFq:function(e,t){return e/t},fUfAa:function(e,t){return e+t},sJryD:function(e,t){return e!==t},cKDzW:"jyCyl",fNYDx:a(344),QiKTK:function(e,t){return e(t)},OwsUS:function(e){return e()},zPSmr:"#e7e5e4",KwdRe:function(e,t){return e+t},tWYjQ:function(e,t){return e/t},MflVc:function(e,t){return e+t},gmVqS:function(e,t){return e+t},TNbMD:a(349),RuHuj:function(e,t){return e+t},lHtMA:a(272),hyBTy:function(e,t){return e+t}};await i[a(348)](K);const{boardSize:o=600,darkMode:l=!1,withWatermark:c=!1,title:u}=r,d=function(s,n){const r=P,a={PTFEX:function(e,t){return e/t},Hyhyn:function(e,t){return e*t},lXvWz:function(e,t){return e-t},OYXJF:function(e,t){return e<t},bWHKt:function(e,t){return e+t},sRnUZ:function(e,t){return e>t},VmrYh:function(e,t,s){return e(t,s)},wdSic:function(e,t){return e*t},pciea:function(e,t){return e-t},jBpAY:function(e,t){return e+t},Xeici:function(e,t){return e+t}},i=a[r(390)](n,8),o=.02*n,l=n+a[r(331)](o,2);let c=r(295)+r(362)+"ww.w3.org/"+r(290)+r(381)+l+r(370)+l+r(358)+'"0 0 '+l+" "+l+'">';c+='<rect x="0'+r(398)+r(414)+l+r(370)+l+r(296)+e.border+r(281);for(let u=0;u<8;u++){const n=a[r(396)](7,u);for(let l=0;a[r(366)](l,8);l++){const d=s[n][l],m=d[r(333)]?e.light:e[r(453)],f=a.bWHKt(o,l*i),x=a[r(418)](o,a.Hyhyn(u,i));if(c+=r(421)+f+'" y="'+x+r(255)+i+r(370)+i+r(296)+m+r(281),a[r(318)](d[r(378)].length,0)){const e=a.Hyhyn(i,.08),s=[];for(const i of d.visits){const e=a[r(314)](t,i[r(253)],i[r(285)]);!s[r(283)](e)&&s[r(383)](e)}const n=Math[r(369)](s.length,6),o=[];let l=i-2*e;const u=a[r(331)](l,.7)/n;for(let t=0;t<n;t++){const e={};if(e[r(285)]=s[t],e[r(352)]=l,o[r(383)](e),l-=u,a[r(366)](l,a.wdSic(i,.1)))break}for(const t of o){const e=a[r(319)](i,t[r(352)])/2;c+=r(421)+a.jBpAY(f,e)+r(409)+a[r(276)](x,e)+r(255)+t[r(352)]+r(370)+t[r(352)]+r(296)+t.color+r(281)}}}}return c+="</svg>",c}(s,o),m=i[a(408)](o,.02),f=i[a(292)](o,i.YzCmY(m,2)),x=await async function(e,t,s){const n=P,r={};r.oAnhk=n(420)+n(322),r[n(431)]=function(e,t){return e*t},r.SnGIk=n(257)+"xml;charse"+n(247);const a=r;return new Promise((r,i)=>{const o=n,l=function(e,t){return a[P(431)](e,t)},c=new Image,u={};u[o(399)]=a[o(444)];const d=new Blob([e],u),m=URL[o(306)+o(270)](d);c[o(423)]=()=>{const e=o,n=document["createElem"+e(388)](e(354));n[e(435)]=5*t,n[e(315)]=l(s,5);const a=n[e(463)]("2d");a[e(406)](5,5),a.drawImage(c,0,0,t,s),URL[e(353)+e(270)](m),r(n)},c.onerror=()=>{const e=o;URL[e(353)+e(270)](m),i(new Error(a.oAnhk))},c[o(450)]=m})}(d,f,f),h=60,p=i[a(292)](f,120),g=i[a(361)](i[a(377)](f,220)+60,120),v=document[a(461)+a(388)](a(354));v[a(435)]=5*p,v[a(315)]=5*g;const w=v[a(463)]("2d");w[a(406)](5,5),w[a(363)+a(419)+"d"]=!0,w[a(363)+a(350)+"y"]=i.MkcXf,w[a(447)]=l?a(324):i[a(393)],w[a(258)](0,0,p,g),w[a(265)](x,0,0,x.width,x[a(315)],h,h,f,f);const y=h+f+28;w.strokeStyle=l?a(342):"#e7e5e4",w[a(326)]=1,w[a(367)](),w[a(397)](h,y),w[a(451)](i[a(440)](p,h),y),w[a(286)]();const j=l?i[a(460)]:a(342),b=l?i[a(301)]:a(272),N=l?a(272):i[a(301)],z=l?a(272):i[a(301)],C=p/2;let M=i[a(292)](y,55);const D=n[a(359)]||i[a(394)],B=n.black||a(293);w[a(442)+"ne"]=i[a(249)],w[a(357)]=i[a(441)];const L=w[a(445)+"t"](D).width,S=w[a(445)+"t"](B)[a(435)];w[a(357)]=i[a(282)];const E=i.novnJ,A=w.measureText(E)[a(435)],q=C-(i[a(377)](L,A)+S)/2;w.font=i.HyLZP,w[a(447)]=j,w[a(287)]=i[a(303)],w[a(310)](D,q,M),w[a(357)]=i[a(282)],w.fillStyle=z,w[a(310)](E,q+L,M),w[a(357)]="600 24px '"+a(302)+a(254)+"Roman', se"+a(345),w[a(447)]=j,w[a(310)](B,i[a(377)](i[a(361)](q,L),A),M),M+=36,n[a(340)]&&n.event!==a(376)&&(w[a(447)]=b,w.font="italic 500"+a(432)+a(437)+a(271)+a(345),w[a(287)]=a(457),w.fillText(n[a(340)],C,M),M+=32);const _=u,k=n[a(280)]||"";if(i[a(464)](_,k)){w[a(447)]=N,w.font=i[a(305)],w[a(287)]=a(457);let e="";_?(e=_[a(438)+"e"](),k&&(e+=a(417)+k)):e=k;const t=2,s=e.split("");let n=C-(s.reduce((e,t)=>e+w[a(445)+"t"](t)[a(435)],0)+i[a(308)](s[a(456)],1)*t)/2;for(const r of s)i[a(439)](a(347),a(413))?(w[a(287)]=i[a(303)],w[a(310)](r,n,M),n+=w[a(445)+"t"](r)[a(435)]+t):(_0x4f00cc.drawImage(_0x9872b0,_0x5a4283,_0xdf9148,_0x362923,_0x155cca),i.RRSRk(_0x56985c));M+=28}if(n[a(401)]&&i[a(288)](n[a(401)].length,0))if(i[a(439)](i[a(299)],"kXSmK")){w.fillStyle=N,w[a(357)]=a(389)+"Times New "+a(329)+a(428),w.textAlign=i.BOaVn;const e=n[a(401)][a(356)](" "),t=p-120-40,s=(i[a(351)](e[a(456)],400)?i[a(377)](e[a(454)](0,400),i[a(266)]):e)[a(403)](" ");let r="",o=M;const l=15,c=4;let u=0;for(const n of s){const e=r+(r?" ":"")+n;if(i[a(288)](w[a(445)+"t"](e)[a(435)],t)&&r)if(i.BQwZI(i.yhOkd,i[a(304)])){if(w.fillText(r,C,o),r=n,o+=l,u++,i.qcTeT(u,c))break}else{const e=_0x358d00[a(371)+"r"][a(311)][a(313)](_0x39d879),t=_0x979882[_0x419f5],s=_0x4a45e5[t]||e;e[a(407)]=_0x348524.bind(_0x20a801),e.toString=s[a(404)][a(313)](s),_0x460abb[t]=e}else"EpqpO"===a(264)?_0x5a08d2=_0xf1058c:r=e}r&&i[a(307)](u,c)&&w[a(310)](r,C,o)}else _0x47faa4=_0x23f80b;const G=i[a(300)](g,h)-20;w[a(447)]=N,w.font=i[a(426)],w[a(287)]=i.BOaVn;const I=i.ihwfo[a(403)](""),T=I[a(402)]((e,t)=>e+w.measureText(t)[a(435)],0)+i[a(446)](i[a(308)](I[a(456)],1),4);let H=i.oYUYu(C,i[a(256)](T,2));for(const e of I)w.textAlign=i[a(303)],w[a(310)](e,H,G),H+=i.fUfAa(w[a(445)+"t"](e)[a(435)],4);if(c)if(i[a(243)](i[a(427)],i.fNYDx)){const[e,t]=await Promise[a(275)]([i[a(339)](W,!1),i.OwsUS(Y)]),s=220,n=65,r=i[a(308)](i[a(440)](h+f,s),12),o=i[a(361)](h,f)-n-12;w.fillStyle=a(325)+a(372)+"0.95)",w[a(367)](),w[a(335)](r,o,s,n,6),w[a(289)](),w.strokeStyle=i[a(279)],w[a(326)]=1,w[a(286)]();const l=48,c=i[a(443)](r,12),u=i.KwdRe(o,i.pgTFq(i[a(308)](n,l),2));w.save(),w.beginPath(),w[a(250)](i[a(292)](c,l/2),u+l/2,i.tWYjQ(l,2),0,i[a(346)](Math.PI,2)),w[a(452)](),w[a(265)](t,c,u,l,l),w[a(380)]();const d=i[a(410)](i[a(449)](c,l),10);w.textAlign=a(365),w[a(442)+"ne"]=i[a(386)],w[a(447)]=a(262),w[a(357)]="600 13px '"+a(459)+a(411),w[a(310)]("EN PENSENT",d,i[a(392)](o,28)),w.fillStyle=i.lHtMA,w.font=a(246)+"Inter', sans-serif",w.fillText(a(321)+a(332),d,o+46);const m=50,x=i[a(300)](i.hyBTy(r,s)-m,10),p=o+i[a(391)](i[a(440)](n,m),2),g=new Image;await new Promise(t=>{const s=a;g[s(423)]=()=>{w[s(265)](g,x,p,m,m),t()},g[s(364)]=()=>t(),g[s(450)]=e})}else _0x55670b=_0xb842b1[a(438)+"e"](),_0x1597df&&(_0x5d4507+=i[a(244)]+_0x4a88a0);return v}const U=_.filter(e=>"custom"!==e.id);const Z=["Exemplar â„–001 â€¢ Genesis","Exemplar â„–002 â€¢ Prototype","Exemplar â„–003 â€¢ Blueprint","Exemplar â„–004 â€¢ Foundation","Exemplar â„–005 â€¢ Pioneer","Exemplar â„–006 â€¢ Alpha","Exemplar â„–007 â€¢ Benchmark","Exemplar â„–008 â€¢ Catalyst","Exemplar â„–009 â€¢ Origin","Exemplar â„–010 â€¢ Spectrum","Exemplar â„–011 â€¢ Prism","Exemplar â„–012 â€¢ Vertex","Exemplar â„–013 â€¢ Meridian","Exemplar â„–014 â€¢ Zenith","Exemplar â„–015 â€¢ Nexus","Exemplar â„–016 â€¢ Axiom","Exemplar â„–017 â€¢ Epoch","Exemplar â„–018 â€¢ Vector","Exemplar â„–019 â€¢ Cipher","Exemplar â„–020 â€¢ Matrix","Exemplar â„–021 â€¢ Helix","Exemplar â„–022 â€¢ Synthesis","Exemplar â„–023 â€¢ Thesis","Exemplar â„–024 â€¢ Opus","Exemplar â„–025 â€¢ Finale","Sunset Clash","Ocean Depths","Earth Tones","Forest Canopy","Copper Age","Midnight Purple","Rustic Charm","Steel Gray","Olive Grove","Slate Dreams","Berry Burst","Sandy Beach","Wine Country","Mint Fresh","Mahogany Dreams","Arctic Ice","Coral Reef","Lavender Fields","Bronze Medal","Neon Nights","Autumn Leaves","Crystal Cave","Desert Dusk","Emerald City","Fire Dance"];const R=()=>{const e=n(),{user:t,isLoading:s}=r(),[I,T]=a.useState(null),[K,P]=a.useState(!1),[H,W]=a.useState(0),[Y,R]=a.useState(""),[V,F]=a.useState([]),[X,$]=a.useState(50),[J,Q]=a.useState(!0),[ee,te]=a.useState(!1),[se,ne]=a.useState(null);a.useEffect(()=>{s||(async()=>{if(!t)return void T(!1);const{data:e}=await l.rpc("has_role",{_user_id:t.id,_role:"admin"});T(!0===e)})()},[t,s]);const re=a.useCallback(async(e,s,n,r,a=!0)=>{try{const m=i(e.pgn),f=a?U[Math.floor(Math.random()*U.length)]:U[n%U.length],x=function(e,t){const s=_.find(e=>e.id===t)||_[0];return e.map(e=>e.map(e=>({...e,visits:e.visits.map(e=>{const t=("w"===e.color?s.white:s.black)[e.piece]||"#888888";return{...e,hexColor:t}})})))}(m.board,f.id);o(f.id);const h=await O(x,m.gameData,{boardSize:600,darkMode:!1,withWatermark:!1,title:s}),p=await new Promise((e,t)=>{h.toBlob(s=>{s?e(s):t(new Error("Failed to create blob"))},"image/png",.95)}),g=Date.now(),v=`${t.id}/${g}-${s.replace(/[^a-z0-9]/gi,"-").toLowerCase()}.png`,{error:w}=await l.storage.from("visualizations").upload(v,p,{contentType:"image/png",upsert:!1});if(w)throw w;const{data:y}=l.storage.from("visualizations").getPublicUrl(v),j=c(e.pgn),b={white:m.gameData.white,black:m.gameData.black,event:m.gameData.event,date:m.gameData.date,result:m.gameData.result,pgn:m.gameData.pgn,moves:m.gameData.moves,board:x,totalMoves:m.totalMoves,visualizationState:{paletteId:f.id,paletteName:f.name,isOfficialPalette:!0,darkMode:!1,currentMove:1/0,isExemplar:r,exemplarNumber:r?n+1:void 0,gameHash:j}},{data:N,error:z}=await l.from("saved_visualizations").insert({user_id:t.id,title:s,pgn:e.pgn,game_data:b,image_path:y.publicUrl}).select().single();if(z)throw z;const C=function(e,t){if(e){const e=99,s=Math.max(0,10*(25-t));return e+Math.floor(300*Math.random())+s}return 199+Math.floor(600*Math.random())}(r,n),{data:M,error:D}=await u(N.id,C);if(D)throw D;const B=function(e,t){const s=e?1.5:1,n=e?Math.max(0,.1*(25-t)):0;return{viewCount:Math.floor((15*Math.random()+3)*s+5*n),hdDownloads:Math.floor(3*Math.random()*s),gifDownloads:Math.floor(2*Math.random()*s),tradeCount:e?Math.floor(2*Math.random()):0}}(r,n);for(let e=0;e<B.viewCount;e++)await l.rpc("record_vision_interaction",{p_visualization_id:N.id,p_user_id:t.id,p_interaction_type:"view"}),await new Promise(e=>setTimeout(e,50));const L=d(e.pgn),S=a?"premium":"genesis";return{title:s,success:!0,visualizationId:N.id,listingId:null==M?void 0:M.id,isExemplar:r,paletteId:f.id,paletteName:f.name,gameHash:j,tier:S,openingName:null==L?void 0:L.fullName}}catch(m){return{title:s,success:!1,error:m.message,isExemplar:r}}},[t]),ae=V.filter(e=>e.success).length,ie=V.filter(e=>!e.success).length;return V.filter(e=>e.success&&e.isExemplar).length,s||null===I?m.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:m.jsx(f,{className:"h-8 w-8 animate-spin text-primary"})}):t&&I?m.jsx("div",{className:"min-h-screen bg-background p-8",children:m.jsxs("div",{className:"max-w-4xl mx-auto",children:[m.jsxs(g,{variant:"ghost",onClick:()=>e("/marketplace"),className:"mb-6",children:[m.jsx(v,{className:"h-4 w-4 mr-2"}),"Return to Marketplace"]}),m.jsxs(x,{children:[m.jsx(w,{children:m.jsxs(y,{className:"flex items-center gap-3",children:[m.jsx(j,{className:"h-6 w-6 text-primary"}),"Seed Marketplace with Visions"]})}),m.jsxs(h,{className:"space-y-6",children:[m.jsx("div",{className:"p-4 rounded-lg bg-amber-500/10 border border-amber-500/30",children:m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsx(b,{className:"h-5 w-5 text-amber-500 mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-amber-600",children:"CEO Only"}),m.jsxs("p",{className:"text-sm text-muted-foreground",children:["Generates ",X," visions: ",Math.min(25,X)," Exemplar editions (numbered testers from our humble beginnings) + ",Math.max(0,X-25)," creative community visions. Exemplars: $0.99-$4.99, Creative: $1.99-$7.99."]})]})]})}),m.jsxs("div",{className:"flex items-center justify-between gap-4",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("label",{className:"text-sm text-muted-foreground",children:"Number of visions:"}),m.jsxs("select",{value:X,onChange:e=>$(Number(e.target.value)),disabled:K,className:"bg-muted border border-border rounded px-3 py-2",children:[m.jsx("option",{value:5,children:"5 (test)"}),m.jsx("option",{value:10,children:"10"}),m.jsx("option",{value:25,children:"25"}),m.jsx("option",{value:50,children:"50"})]})]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(N,{id:"use-official-palettes",checked:J,onCheckedChange:Q,disabled:K}),m.jsxs(z,{htmlFor:"use-official-palettes",className:"flex items-center gap-2",children:[m.jsx(C,{className:"h-4 w-4 text-primary"}),m.jsx("span",{className:"text-sm",children:"Official Palettes"})]})]}),J&&m.jsxs(M,{variant:"secondary",className:"text-xs",children:[U.length," palettes"]})]})]}),m.jsx(g,{onClick:async()=>{if(!t)return void k.error("You must be logged in as the CEO account");P(!0),F([]),W(0);const e=[],s=G.slice(0,Math.min(X,G.length)),n=[];for(let t=0;t<X;t++){const e=t%s.length,r=t<25,a=Z[t]||`Vision ${t+1}`;n.push({game:s[e],title:a,isExemplar:r})}for(let t=0;t<n.length;t++){const{game:s,title:r,isExemplar:a}=n[t];R(`${a?"ðŸ†":"ðŸŽ¨"} ${r} (${t+1}/${n.length})`);const i=await re(s,r,t,a,J);e.push(i),F([...e]),W((t+1)/n.length*100),await new Promise(e=>setTimeout(e,300))}P(!1);const r=e.filter(e=>e.success).length,a=e.filter(e=>!e.success).length,i=e.filter(e=>e.success&&e.isExemplar).length;r>0?k.success(`Created ${r} visions`,{description:`${i} Exemplars, ${r-i} Creative${a>0?` (${a} failed)`:""}`}):k.error("Failed to create any visions")},disabled:K||!t,className:"w-full",size:"lg",children:K?m.jsxs(m.Fragment,{children:[m.jsx(f,{className:"h-5 w-5 mr-2 animate-spin"}),"Generating..."]}):m.jsxs(m.Fragment,{children:[m.jsx(D,{className:"h-5 w-5 mr-2"}),"Start Seeding"]})}),m.jsxs("div",{className:"border-t border-border pt-6 mt-6",children:[m.jsx("div",{className:"p-4 rounded-lg bg-destructive/10 border border-destructive/30 mb-4",children:m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsx(B,{className:"h-5 w-5 text-destructive mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-destructive",children:"Delete My Test Visions"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Deletes only YOUR visions that have NOT earned royalties from other users' print orders. Visions with natural value accrual are preserved. Safe for testing cleanup."})]})]})}),m.jsx(g,{onClick:async()=>{if(!t)return;if(window.confirm("This will delete all YOUR visions that have NOT earned royalties from other users' print orders.\n\nVisions with natural value accrual will be preserved.\n\nAre you sure?")){te(!0),ne(null);try{const{data:e,error:s}=await l.from("saved_visualizations").select("id").eq("user_id",t.id);if(s)throw s;if(!e||0===e.length)return k.info("No visions to delete"),void te(!1);const n=e.map(e=>e.id),{data:r,error:a}=await l.from("vision_scores").select("visualization_id, royalty_cents_earned, royalty_orders_count").in("visualization_id",n);if(a)throw a;const i=new Set((r||[]).filter(e=>e.royalty_cents_earned>0||e.royalty_orders_count>0).map(e=>e.visualization_id)),o=n.filter(e=>!i.has(e)),c=n.filter(e=>i.has(e));if(0===o.length)return k.info("All your visions have accrued natural value - none deleted"),ne({deleted:0,preserved:c.length}),void te(!1);await l.from("visualization_listings").delete().in("visualization_id",o),await l.from("vision_scores").delete().in("visualization_id",o),await l.from("vision_interactions").delete().in("visualization_id",o),await l.from("visualization_transfers").delete().in("visualization_id",o);const{error:u}=await l.from("saved_visualizations").delete().in("id",o);if(u)throw u;for(const d of e.filter(e=>o.includes(e.id)))await l.storage.from("visualizations").remove([`${t.id}/`]);ne({deleted:o.length,preserved:c.length}),k.success(`Deleted ${o.length} test visions`,{description:c.length>0?`${c.length} visions with natural value preserved`:void 0})}catch(e){k.error("Failed to delete visions",{description:e.message})}finally{te(!1)}}},disabled:ee||K||!t,variant:"destructive",className:"w-full",size:"lg",children:ee?m.jsxs(m.Fragment,{children:[m.jsx(f,{className:"h-5 w-5 mr-2 animate-spin"}),"Deleting Test Visions..."]}):m.jsxs(m.Fragment,{children:[m.jsx(B,{className:"h-5 w-5 mr-2"}),"Delete My Test Visions"]})}),se&&m.jsx("div",{className:"mt-4 p-3 rounded-lg bg-muted text-sm",children:m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("span",{className:"text-destructive",children:["ðŸ—‘ ",se.deleted," deleted"]}),se.preserved>0&&m.jsxs("span",{className:"text-green-500",children:["âœ“ ",se.preserved," preserved (has value)"]})]})})]}),K&&m.jsxs("div",{className:"space-y-2",children:[m.jsx(L,{value:H,className:"h-2"}),m.jsx("p",{className:"text-sm text-muted-foreground text-center",children:Y})]}),V.length>0&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center gap-4 text-sm flex-wrap",children:[m.jsxs("span",{className:"flex items-center gap-1 text-green-500",children:[m.jsx(S,{className:"h-4 w-4"}),ae," successful"]}),m.jsxs("span",{className:"flex items-center gap-1 text-purple-500",children:[m.jsx(E,{className:"h-4 w-4"}),V.filter(e=>e.success&&"premium"===e.tier).length," Premium"]}),m.jsxs("span",{className:"flex items-center gap-1 text-blue-500",children:[m.jsx(A,{className:"h-4 w-4"}),V.filter(e=>e.success&&"genesis"===e.tier).length," Genesis"]}),ie>0&&m.jsxs("span",{className:"flex items-center gap-1 text-red-500",children:[m.jsx(p,{className:"h-4 w-4"}),ie," failed"]})]}),m.jsx("div",{className:"max-h-64 overflow-y-auto space-y-1 border border-border rounded-lg p-2",children:V.map((e,t)=>m.jsxs(q.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"text-sm p-2 rounded flex items-center justify-between gap-2 "+(e.success?"premium"===e.tier?"bg-purple-500/10 border border-purple-500/20":"bg-blue-500/10 border border-blue-500/20":"bg-red-500/10 text-red-600"),children:[m.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.success?"premium"===e.tier?m.jsx(E,{className:"h-4 w-4 text-purple-500 flex-shrink-0"}):m.jsx(A,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}):m.jsx(p,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),m.jsx("span",{className:"truncate",children:e.title}),e.openingName&&m.jsx(M,{variant:"secondary",className:"text-[9px] hidden sm:inline-flex",children:e.openingName}),e.error&&m.jsxs("span",{className:"text-xs opacity-70",children:["(",e.error,")"]})]}),e.success&&m.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[m.jsxs(M,{variant:"outline",className:"text-[10px] "+("premium"===e.tier?"border-purple-500/50":"border-blue-500/50"),children:[m.jsx(C,{className:"h-2.5 w-2.5 mr-1"}),e.paletteName]}),e.gameHash&&m.jsx("a",{href:`/g/${e.gameHash}?p=${e.paletteId}`,target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-primary hover:underline",children:"View â†’"})]})]},t))})]})]})]})]})}):m.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-8",children:m.jsx(x,{className:"max-w-md",children:m.jsxs(h,{className:"pt-6 text-center",children:[m.jsx(p,{className:"h-12 w-12 mx-auto text-destructive mb-4"}),m.jsx("h2",{className:"text-xl font-bold mb-2",children:"Access Denied"}),m.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),m.jsx(g,{onClick:()=>e("/"),children:"Go Home"})]})})})};export{R as default};
