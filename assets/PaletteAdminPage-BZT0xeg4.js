import{s as e,u as s,a as t,r as n,j as a,L as r,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as h,t as x,P as m,w as f,B as p,bM as w,cj as j,a9 as g,am as v,a1 as y,a2 as N,a3 as b,a4 as z,bC as C,a5 as D,cu as B,b as k}from"./index-Cjdju9jQ.js";!function(){const e=A,s=q();for(;;)try{if(217900===-parseInt(e(268))/1*(parseInt(e(323))/2)+parseInt(e(310))/3+-parseInt(e(272))/4*(parseInt(e(265))/5)+parseInt(e(277))/6*(-parseInt(e(258))/7)+-parseInt(e(266))/8+parseInt(e(239))/9*(parseInt(e(307))/10)+-parseInt(e(246))/11*(-parseInt(e(324))/12))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const S=function(){const e=A,s={};s[e(256)]="lqbBR";const t=s;let n=!0;return function(s,a){const r=e;if(t.THMrA!==r(238)){const e=_0xe93d75?function(){if(_0x253393){const e=_0x5d21b0[r(275)](_0x5f2a8f,arguments);return _0x33a8fa=null,e}}:function(){};return _0x2c15e7=!1,e}{const e=n?function(){if(a){const e=a[r(275)](s,arguments);return a=null,e}}:function(){};return n=!1,e}}}()(void 0,function(){const e=A,s={};s[e(237)]=e(311)+"+$";const t=s;return S[e(320)]()[e(287)](t[e(237)])[e(320)]().constructor(S)[e(287)]("(((.+)+)+)+$")});S();const M=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[A(275)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();function q(){const e=["mtjWDxnewuG","y29UC3rYDwn0BW","D2fYBG","x3jVBgu","uxLTrvO","BhfIqLi","mZz1tg9pDMO","DMvYC2LVBG","C2f2zwrFDMLZDq","yMXHy2S","Bg9N","CgfSzxr0zv9VDG","C0Husu4","mJm4nJyZn1znqu5Xsq","yMLUza","Bw9KAwzPzwrFyG","B3jKzxi","CMv0DxjUicHMDq","y29UC29Szq","CNbJ","x3vZzxjFAwq","z2Lyvfy","A2LUzYbHzg1PBG","veHnCKe","ywXPEMf0Aw9UCW","mtGYAxPRtMDz","zNjVBq","zMLUza","DhjHy2u","rxjYB3iGAw4Gyq","rxjYB3iGy291BG","DgLUzYbSAw5Rzq","mtvRuMHHAfu","mtKYnJa2ng9gswnpEG","wePrzeS","otHds2TVELC","E30Uy29UC3rYDq","s3Hpz1K","DhrLswq","mte1ndH1AwXlrwy","yxrH","swDSq3e","yxbWBhK","CM4GDgHPCYiPka","ndKXodHlB3zXBu4","EfLyz1e","tNjIq08","yxrPB25ZoG","D2HPDgu","qMzUzeS","AxL0vvy","DxbKyxrL","DgfIBgu","tuDTD0m","C2vHCMnO","CgfSzxr0zv9Pza","zg1PBIbJAgvJAW","s2v3ueW","ENzrq0e","ChjVDg90ExbL","BgLUA2vKugfSzq","zgvSzxrL","ihjVBgu6","zcb2Axn1ywXPEG","zxjYAwrLCW","Aw5MBW","DMLZDwfSAxPHDa","C2vSzwn0","CNPsrwq","D2HPDgvFy29SBW","zxjYB3i","x19WCM90B19F","vxDizLm","z2fTzv9KyxrH","mta1otu2meXPt0HbDW","zvfNAMq","yMXHy2TFy29SBW","mJuZotC0thr4t01v","kcGOlISPkYKRkq","AgfZx3jVBgu","zxHJzxb0Aw9U","zxPKu2i","C2LUz2XL","vwjhrgS","DgLprMW","CxftBgS","zgf0yq","Dg9tDhjPBMC","ueDsu1qXmty","BMn0Aw9UkcKG","ote4zefYAxft"];return(q=function(){return e})()}async function H(s){const t=A,n={};n.aWQzW=t(288),n.UoTnm=function(e,s){return e!==s};const a=n;try{const{data:n,error:r}=await e[t(259)](t(244)+t(297)).select("*").eq(a.aWQzW,s)[t(315)]();if(r&&a.UoTnm(r.code,t(321)))throw r;const i={};return i[t(319)]=n,i[t(303)]=null,i}catch(r){const e={data:null};return e[t(303)]=r,e}}function A(e,s){e-=235;const t=q();let n=t[e];if(void 0===A.CAPwDN){var a=function(e){let s="",t="",n=s+a;for(let a,r,i=0,c=0;r=e.charAt(c++);~r&&(a=i%4?64*a+r:r,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&a>>(-2*i&6)):i:0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let a=0,r=s.length;a<r;a++)t+="%"+("00"+s.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(t)};A.HhlZcM=a,A.ulfnOw={},A.CAPwDN=!0}const r=e+t[0],i=A.ulfnOw[r];if(i)n=i;else{const e=function(e){this.UhdpnU=e,this.MdJHhD=[1,0,0],this.lBXtYF=function(){return"newState"},this.eOuqhi="\\w+ *\\(\\) *{\\w+ *",this.mFOQFR="['|\"].+['|\"];? *}"};e.prototype.IoiLQb=function(){const e=new RegExp(this.eOuqhi+this.mFOQFR).test(this.lBXtYF.toString())?--this.MdJHhD[1]:--this.MdJHhD[0];return this.UDgJvT(e)},e.prototype.UDgJvT=function(e){return Boolean(~e)?this.BVhbZz(this.UhdpnU):e},e.prototype.BVhbZz=function(e){for(let s=0,t=this.MdJHhD.length;s<t;s++)this.MdJHhD.push(Math.round(Math.random())),t=this.MdJHhD.length;return e(this.MdJHhD[0])},new e(A).IoiLQb(),n=A.HhlZcM(n),A.ulfnOw[r]=n}return n}async function P(s){const t=A,n={};n[t(301)]=function(e,s){return e===s},n[t(267)]=t(263)+t(264)+t(296)+t(280);const a=n;try{const{data:n,error:r}=await e.from(t(241)+t(257))[t(300)]("id, game_d"+t(273));if(r)throw r;let i=0;for(const e of n||[]){const n=e[t(306)][t(299)+"ionState"];((null==n?void 0:n.paletteId)===s||a[t(301)](null==n?void 0:n[t(293)+t(271)],s))&&i++}return i}catch(r){return 0}}M(void 0,function(){const e=A,s={};s[e(286)]=e(269)+'ctor("retu'+e(276)+" )",s.IglCq=e(243),s[e(317)]=e(235),s[e(305)]=e(303),s[e(278)]=e(313),s[e(270)]=e(285);const t=s;let n;try{n=Function(e(250)+e(322)+t[e(286)]+");")()}catch(i){n=window}const a=n[e(251)]=n[e(251)]||{},r=[t[e(274)],t.tiOFl,e(298),t.UwHfS,t.xYXgQ,t[e(270)],e(261)];for(let c=0;c<r.length;c++){const s=M.constructor[e(292)].bind(M),t=r[c],n=a[t]||s;s[e(304)]=M[e(247)](M),s[e(320)]=n[e(320)].bind(n),a[t]=s}})();const L=["k","q","r","b","n","p"],U={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},I=()=>{var S,M,q,I;const{user:Y}=s(),_=t(),[T,W]=n.useState(!1),[F,G]=n.useState(!0),[J,X]=n.useState([]),[K,E]=n.useState(null),[O,R]=n.useState(null),[V,Z]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!Y)return void _("/");if(!(await async function(s){const t=A,n={};n[t(314)]=t(311)+"+$",n.LBXbs=t(312),n[t(282)]="Error chec"+t(255)+t(295),n[t(316)]=function(e,s){return e===s},n.qqSlk="iytUV";const a=n;try{const n={};n[t(253)]=s,n[t(236)]="admin";const{data:r,error:i}=await e[t(252)](a.LBXbs,n);return i?"giXTV"!==t(254)&&_0xf6a6ab.toString()[t(287)](t(311)+"+$")[t(320)]()[t(325)+"r"](_0x2c8399)[t(287)](IwOkSj.ezdSb):!0===r}catch(r){if(a[t(316)](t(283),a[t(318)]))return!1;_0x1ec074=_0x24c5e8}}(Y.id)))return k.error("Access denied",{description:"Admin privileges required"}),void _("/");W(!0),await te(),G(!1)})()},[Y,_]);const te=async()=>{const{data:s}=await async function(){const s=A,t={};t[s(308)]="palette_ov"+s(297),t.KewPL=s(288);const n=t;try{const{data:t,error:a}=await e[s(259)](n[s(308)]).select("*")[s(249)](n[s(290)]);if(a)throw a;const r={};return r[s(319)]=t||[],r[s(303)]=null,r}catch(a){const e={};return e[s(319)]=[],e.error=a,e}}();X(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await P(e.id);Z(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=J.find(s=>s.palette_id===e);E(e),R({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},ae=(e,s,t)=>{O&&R({...O,[e]:{...O[e],[s]:t}})},re=async()=>{if(!K||!O||!Y)return;Q(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,a){const r=A,i={fRENT:function(e,s){return e(s)},ToBYd:function(e,s){return e+s},zvQCA:r(244)+"errides"};try{const{data:c}=await i.fRENT(H,s);if(c){const{error:o}=await e[r(259)](r(244)+"errides")[r(284)]({white_colors:t,black_colors:n,modified_by:a,version:i.ToBYd(c[r(240)],1)}).eq(r(288),s);if(o)throw o;return{error:null,version:i.ToBYd(c[r(240)],1)}}{const c={};c[r(288)]=s,c.white_colors=t,c.black_colors=n,c[r(248)+"y"]=a,c[r(240)]=1;const{error:o}=await e.from(i[r(291)]).insert(c);if(o)throw o;return{error:null,version:1}}}catch(c){if(r(279)==r(279)){const e={};return e.error=c,e[r(240)]=0,e}{const e={};return e[r(319)]=[],e[r(303)]=_0x46a88c,e}}}(K,O.white,O.black,Y.id);s?k.error("Failed to save",{description:s.message}):(k.success("Palette updated!",{description:`Version ${t} saved. ${V[K]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>J.some(s=>s.palette_id===e);return F?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):T?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container max-w-6xl py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:a.jsx(i,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>a.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(K===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:a.jsxs(l,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium text-sm",children:e.name}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&a.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),V[e.id]>0&&a.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[a.jsx(u,{className:"h-2.5 w-2.5"}),V[e.id]]})]})]}),a.jsxs("div",{className:"flex gap-0.5",children:[L.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),L.map(s=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),a.jsx("div",{className:"md:col-span-2",children:K&&O?a.jsxs(o,{children:[a.jsx(h,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(x,{className:"flex items-center gap-2",children:[a.jsx(m,{className:"h-5 w-5"}),null==(S=ie(K))?void 0:S.name]}),a.jsx(f,{children:null==(M=ie(K))?void 0:M.description})]}),a.jsxs("div",{className:"flex gap-2",children:[ce(K)&&a.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!K)return;Q(!0);const{error:s}=await async function(s){const t=A,n={};n.sHTIN=t(288);const a=n;try{const{error:n}=await e.from(t(244)+t(297))[t(294)]().eq(a[t(245)],s);if(n)throw n;const r={};return r[t(303)]=null,r}catch(r){const e={};return e[t(303)]=r,e}}(K);s?k.error("Failed to revert",{description:s.message}):(k.success("Reverted to defaults"),ne(K),await te()),Q(!1)},disabled:$,children:[a.jsx(w,{className:"h-4 w-4 mr-1"}),"Revert"]}),a.jsxs(p,{size:"sm",onClick:async()=>{if(!K||!O||!Y)return;(V[K]||0)>0?se(!0):await re()},disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(j,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),a.jsxs(l,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(q=ie(K))?void 0:q.legendTheme.whiteEmoji," White Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:U[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(g,{type:"color",value:O.white[e],onChange:s=>ae("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(g,{type:"text",value:O.white[e],onChange:s=>ae("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(I=ie(K))?void 0:I.legendTheme.blackEmoji," Black Pieces"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(e=>a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:U[e]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(g,{type:"color",value:O.black[e],onChange:s=>ae("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),a.jsx(g,{type:"text",value:O.black[e],onChange:s=>ae("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[a.jsx(v,{className:"h-4 w-4"}),"Color Preview"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),a.jsx("div",{className:"flex gap-1",children:L.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.white[e]},title:U[e]},`preview-w-${e}`))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),a.jsx("div",{className:"flex gap-1",children:L.map(e=>a.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:O.black[e]},title:U[e]},`preview-b-${e}`))})]})]})]})]})]}):a.jsx(o,{className:"h-full flex items-center justify-center",children:a.jsxs(l,{className:"text-center py-12",children:[a.jsx(m,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),a.jsx(y,{open:ee,onOpenChange:se,children:a.jsxs(N,{children:[a.jsxs(b,{children:[a.jsxs(z,{className:"flex items-center gap-2",children:[a.jsx(C,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),a.jsxs(D,{children:["This palette is linked to ",a.jsx("strong",{children:V[K||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),a.jsxs(p,{onClick:re,disabled:$,children:[$?a.jsx(r,{className:"h-4 w-4 mr-1 animate-spin"}):a.jsx(B,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{I as default};
