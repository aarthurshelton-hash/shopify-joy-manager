import{s as e,u as t,a as s,r as n,j as r,L as a,C as c,x as i,b7 as o,B as l,A as d,cb as u,cR as x,a8 as m,D as h,aB as p,aC as f,aD as w,aE as v,p as j,t as g,w as y,dy as b,dt as N,bo as C,dq as z,cZ as D,a1 as q,a2 as _,a3 as B,a4 as L,a5 as M,aW as A,bC as K,dz as W,b as H,y as U}from"./index-Ddz_gr3U.js";import{C as S}from"./calendar-DvjwZzoX.js";!function(){const e=Z,t=P();for(;;)try{if(942763===parseInt(e(496))/1+parseInt(e(586))/2*(parseInt(e(589))/3)+-parseInt(e(532))/4*(parseInt(e(591))/5)+-parseInt(e(546))/6*(-parseInt(e(575))/7)+parseInt(e(547))/8*(parseInt(e(550))/9)+-parseInt(e(545))/10*(parseInt(e(492))/11)+-parseInt(e(525))/12)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const k=function(){const e=Z,t={};t[e(529)]=e(485);const s=t;let n=!0;return function(t,r){const a=e;if(s[a(529)]!==a(485)){const e={success:!1};return e[a(596)]=_0x3290b1,e}{const e=n?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return n=!1,e}}}()(void 0,function(){const e=Z,t={};t[e(563)]="(((.+)+)+)+$";const s=t;return k.toString()[e(588)](s[e(563)]).toString()[e(511)+"r"](k)[e(588)](s.liJcG)});k();const I=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}();function P(){const e=["s2TXtNi","zxjYB3i","ENzxy3m","wu9ry0G","zwrFy2vUDhm","cI0TlqO","ywrTAw5FBM90zq","DgLJyxrLza","v2fSBgv0ihvWza","CMvQzwn0zwq","t1Lwq1q","Dg9tDhjPBMC","yKTtu0C","CLvStwu","uNrStLe","Bg9N","ChvVrKW","B3jKzxi","zNjVBq","nJi4mvHcuwvXEq","zgLZCgXHEv9Uyq","D2L0AgrYyxDHBa","DxnLCL9Pza","mtuYmZu1ovnjs2r6wa","wgfxv1m","zxHJzxb0Aw9U","AxnWBgf5x25HBq","zgf0yq","y29TCgXLDgvK","x3jLCxvLC3rZ","Bw91BNq","y3rVCIGICMv0Dq","Dg9ju09tDhjPBG","y29TCgXLDgvKxW","B3rHBf9LyxjUzq","v1fms0i","z2v0vxnLCG","yxrLigvYCM9YoG","y29UC3rYDwn0BW","D0jewfy","B3vUDa","AhjTyvC","Aw52B2TL","vfzXzhm","ChjVzMLSzxm","ywLSCW","yw1VDw50x2nLBG","A2DxtKe","x19WCM90B19F","vuDHC2K","AKrqqvu","Be1PzLm","nZm0mJu2mertDwzrBW","teHVA0u","C3vJy2vZCW","BwfW","EKHlt3O","uMvXDwvZDcbUBW","ChjVDMvKihn0yq","ofnKrwvUBq","zf9Jzw50CYWGDa","DgHKCMf3ywW","ze5kz0i","y29UC29Szq","E30Uy29UC3rYDq","Dw50","CgvUzgLUzW","DxbKyxrL","se9it2S","zhjHD25Fy2vUDa","ig5VDcbPBIbHCa","Aw5MBW","oteZme9St25psa","mJrkyuzQB0e","ogPOCgnnsW","yMDpuwK","BKztruO","nZi3nda0m1D2ueDZDq","DxnLCL9PzcWGza","DhvZ","rMPPAg8","Dg90ywW","yxbWCM92zwrFyq","yMLUza","DxnLCL9PzcWGDa","zNvUy3rPB25Z","sgTKqLK","CMvQzwn0zwrFyW","vuHkvuW","yxv0Aa","BgLky0C","DNvXz2e","C3rHDhvZlcbHBq","ywXS","yxbWCM92zwq","u0Hfseu","z2v0","vxDgEe0","B25iwKu","yxnJzw5KAw5N","vgTsAMq","DxnLCL93ywXSzq","nJiWodu4zwXwD1f6","tM90igf1DgHLBG","DhjHy2u","CMvHC29UigLZia","uxLHELa","C2LUz2XL","uMvQzwn0Aw9Uia","ChjVDg90ExbL","vw5RBM93BIbvCW","CMv0DxjUicHMDq","DcbMB3vUzcbVCG","ndzTAvjSyM0","ufzSrgS","C2vHCMnO","mtKWnZrZt2jhq00","yxbWCM92zwrFyW","mtG5mJa3nxDZtNz3CW","B3vUDf9Jzw50CW","C3rHDhvZ","C2vSzwn0"];return(P=function(){return e})()}async function R(t){const s=Z,n={};n[s(522)]=s(494)+s(502),n.Hjkmo="created_at",n[s(568)]=function(e,t){return e!==t},n[s(508)]=s(495),n[s(520)]=s(557)+s(507)+s(533)+"otal_withdrawn_cents";const r=n;try{const n={};n[s(572)]=!1;let a=e.from(r.UGasi)[s(594)]("*")[s(490)](r.Hjkmo,n);t&&r[s(568)](t,s(566))&&(a=a.eq("status",t));const{data:c,error:i}=await a;if(i)throw i;const o=[...new Set((c||[])[s(528)](e=>e[s(495)]))],{data:l}=await e[s(491)](s(517))[s(594)](s(551)+s(499)+"e").in(r[s(508)],o),{data:d}=await e[s(491)](s(574)+"ts")[s(594)](r.kgWNA).in(r[s(508)],o),u=new Map((null==l?void 0:l[s(528)](e=>[e[s(495)],e]))||[]),x=new Map((null==d?void 0:d[s(528)](e=>[e.user_id,e]))||[]),m=(c||[])[s(528)](e=>{var t,n,r;return{...e,payout_details:e["payout_det"+s(518)],user_display_name:(null==(t=u[s(569)](e[s(495)]))?void 0:t[s(493)+"me"])||s(583)+"er",wallet_total_earned:(null==(n=x[s(569)](e[s(495)]))?void 0:n["total_earn"+s(599)])||0,wallet_total_withdrawn:(null==(r=x[s(569)](e[s(495)]))?void 0:r["total_with"+s(542)+"s"])||0}}),h={};return h[s(500)]=m,h[s(596)]=null,h}catch(a){if("cHQJT"!==s(524)){const e={data:[]};return e[s(596)]=a,e}{const e={};return e[s(500)]=[],e[s(596)]=_0x3b925a,e}}}function Z(e,t){e-=479;const s=P();let n=s[e];if(void 0===Z.HQJaCV){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};Z.HUHHph=r,Z.KBZjRI={},Z.HQJaCV=!0}const a=e+s[0],c=Z.KBZjRI[a];if(c)n=c;else{const e=function(e){this.hezLzj=e,this.KzfklF=[1,0,0],this.LzTGzN=function(){return"newState"},this.LNDRBV="\\w+ *\\(\\) *{\\w+ *",this.lUNciK="['|\"].+['|\"];? *}"};e.prototype.JFHvma=function(){const e=new RegExp(this.LNDRBV+this.lUNciK).test(this.LzTGzN.toString())?--this.KzfklF[1]:--this.KzfklF[0];return this.eUfDBE(e)},e.prototype.eUfDBE=function(e){return Boolean(~e)?this.EjdnNi(this.hezLzj):e},e.prototype.EjdnNi=function(e){for(let t=0,s=this.KzfklF.length;t<s;t++)this.KzfklF.push(Math.round(Math.random())),s=this.KzfklF.length;return e(this.KzfklF[0])},new e(Z).JFHvma(),n=Z.HUHHph(n),Z.KBZjRI[a]=n}return n}async function E(){const t=Z,s={};s[t(598)]=t(539),s[t(535)]="approved",s.XaWWS=t(501),s[t(487)]=t(482),s[t(595)]=function(e,t){return e===t};const n=s;try{if(!n[t(595)](t(526),t(514))){const{data:s,error:r}=await e[t(491)](t(494)+t(502))[t(594)](t(565)+t(592));if(r)throw r;const a={pending_count:0};a["pending_am"+t(513)]=0,a[t(590)+"ount"]=0,a[t(555)+t(503)]=0,a[t(506)+t(554)]=0,a.rejected_count=0;const c=a;(s||[]).forEach(e=>{const s=t;switch(e[s(593)]){case n[s(598)]:c["pending_co"+s(538)]++,c["pending_am"+s(513)]+=e[s(519)+"ts"];break;case n[s(535)]:c[s(590)+"ount"]++,c[s(555)+s(503)]+=e.amount_cents;break;case n[s(497)]:c[s(506)+s(554)]+=e.amount_cents;break;case n[s(487)]:c[s(560)+s(513)]++}});const i={};return i[t(500)]=c,i[t(596)]=null,i}{const e=_0x39ee25[t(511)+"r"].prototype[t(556)](_0x20319a),s=_0x2d9498[_0x23ca08],n=_0x36b130[s]||e;e[t(521)]=_0x29fcb8[t(556)](_0x3fe3d6),e[t(484)]=n[t(484)][t(556)](n),_0xca1b13[s]=e}}catch(r){const e={};return e[t(500)]=null,e[t(596)]=r,e}}function G(e,t){e-=155;const s=J();let n=s[e];if(void 0===G.Hxcmhv){var r=function(e){let t="",s="",n=t+r;for(let r,a,c=0,i=0;a=e.charAt(i++);~a&&(r=c%4?64*r+a:a,c++%4)?t+=n.charCodeAt(i+10)-10!=0?String.fromCharCode(255&r>>(-2*c&6)):c:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=t.length;r<a;r++)s+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(s)};G.twlKOU=r,G.GIyoQt={},G.Hxcmhv=!0}const a=e+s[0],c=G.GIyoQt[a];if(c)n=c;else{const e=function(e){this.dygvla=e,this.vRppbw=[1,0,0],this.eLDdMg=function(){return"newState"},this.ljhvJZ="\\w+ *\\(\\) *{\\w+ *",this.PfugEA="['|\"].+['|\"];? *}"};e.prototype.IUvYhQ=function(){const e=new RegExp(this.ljhvJZ+this.PfugEA).test(this.eLDdMg.toString())?--this.vRppbw[1]:--this.vRppbw[0];return this.phsnkf(e)},e.prototype.phsnkf=function(e){return Boolean(~e)?this.zWqbjg(this.dygvla):e},e.prototype.zWqbjg=function(e){for(let t=0,s=this.vRppbw.length;t<s;t++)this.vRppbw.push(Math.round(Math.random())),s=this.vRppbw.length;return e(this.vRppbw[0])},new e(G).IUvYhQ(),n=G.twlKOU(n),G.GIyoQt[a]=n}return n}function J(){const e=["nJe2mtK2mgzOyKTtDq","mty1mJfmyKjgyKO","C2fSzq","qxf4yLe","Bwfwt3y","ChjVy2vZC19Tyq","y2vFy2vUDhm","B3jKzxi","DwDwyLG","CM9ztuS","tM90igf1DgHLBG","yxv0Aa","rMPxqvK","BMn0Aw9UkcKG","C2vHCMnO","Cf9IDxLLCL9Pza","D2fYBG","x19WCM90B19F","mtm5odm2m0r5weTqBa","yxnJzw5KAw5N","Dg9gAxHLza","C2vSzwn0","DgLJyxrLza","z0jYALu","u1v3veq","CMTLDhbSywnLxW","BgLTAxq","Bg9N","CM4GDgHPCYiPka","yMLUza","CMv0DxjUicHMDq","BgvUz3rO","EMPnzfK","B2T1rgu","mJi1odKZmK9iu2HMta","E30Uy29UC3rYDq","mtm4zMHREwLK","reTPEe4","D2fSBgv0x3rYyq","sMrPqMy","nZuYy3L6DKLM","C3vJy2vZCW","ChjVDg90ExbL","zKvnBwi","Cf91C2vYx2LK","y29UC3rYDwn0BW","z2zyt0e","zxjYB3i","mZq0nZiYwvfxvhz2","CNbJ","kcGOlISPkYKRkq","sxHAAuK","Dg9tDhjPBMC","C0rhtem","Cf9ZywXLx3bYAq","Aw5MBW","Afrswvm","t2fPqKG","nJGYnZyWBxrIsMfb","DxnLCL9Pza","y29UC29Szq","z2v0vxnLCG","Aez0Dhu","Cf9SAxn0Aw5NxW","ndi1nZmWmJrQtwnlrfO","uhfAv3q","wKHUrMm","zxHJzxb0Aw9U","yxbWBhK","BNnHy3rPB25Z","zgf0yq"];return(J=function(){return e})()}I(void 0,function(){const e=Z,t={OYVCT:function(e,t){return e!==t},UwFxM:function(e,t){return e(t)},bxePi:function(e,t){return e+t},bgOQi:e(584)+"nction() ",rUlMe:e(488),Fjiho:"warn",jDPAU:e(544),FzMpY:e(577),QyazP:function(e,t){return e<t}},s=function(){const s=e;let n;try{if(!t[s(483)](s(516),s(564)))throw new _0x2b41fc(s(530)+s(585)+s(543)+s(531)+"tus");n=t[s(570)](Function,t.bxePi(t[s(548)],s(537)+s(504)+'rn this")( )')+");")()}catch(r){n=window}return n}(),n=s[e(536)]=s[e(536)]||{},r=[t[e(486)],t[e(553)],t[e(523)],e(596),e(498),"table",t.FzMpY];for(let a=0;t[e(579)](a,r.length);a++){const t=I.constructor[e(582)][e(556)](I),s=r[a],c=n[s]||t;t[e(521)]=I[e(556)](I),t[e(484)]=c[e(484)][e(556)](c),n[s]=t}})(),function(){const e=G,t=J();for(;;)try{if(982112===-parseInt(e(173))/1+-parseInt(e(189))/2+parseInt(e(156))/3*(-parseInt(e(195))/4)+-parseInt(e(155))/5+-parseInt(e(191))/6*(-parseInt(e(203))/7)+-parseInt(e(213))/8+parseInt(e(219))/9)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const Y=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[G(223)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,function(){const e=G,t={};t.OaiBH=e(205)+"+$";const s=t;return Y[e(207)]()[e(169)](s[e(212)]).toString()[e(200)+"r"](Y)[e(169)](e(205)+"+$")});Y();const F=function(){const e=G,t={};t.ugVbX=e(178);const s=t;let n=!0;return function(e,t){const r=n?function(){const n=G;if(t){if(s[n(163)]!==n(188)){const s=t[n(223)](e,arguments);return t=null,s}{const e=_0x46efd4[n(200)+"r"][n(197)][n(184)](_0x5dbee2),t=_0x1300e4[_0x103969],s=_0x52007e[t]||e;e[n(172)]=_0x1d8ce5.bind(_0x3fcce2),e.toString=s[n(207)][n(184)](s),_0x25ff07[t]=e}}}:function(){};return n=!1,r}}();function O(e){return"$"+(e/100)[G(175)](2)}function T(){var k,I;const{user:P}=t(),G=s(),[J,Y]=n.useState(!1),[F,T]=n.useState(!0),[V,X]=n.useState([]),[Q,$]=n.useState(null),[ee,te]=n.useState("pending"),[se,ne]=n.useState({type:null,request:null}),[re,ae]=n.useState(""),[ce,ie]=n.useState(!1);n.useEffect(()=>{oe()},[P]);const oe=async()=>{if(!P)return void T(!1);const{data:t}=await e.rpc("has_role",{_user_id:P.id,_role:"admin"});!0===t&&(Y(!0),await le()),T(!1)},le=async()=>{const[e,t]=await Promise.all([R(ee),E()]);e.data&&X(e.data),t.data&&$(t.data)},de=e=>{switch(e){case"pending":return r.jsxs(U,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[r.jsx(u,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return r.jsxs(U,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Approved"]});case"completed":return r.jsxs(U,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[r.jsx(x,{className:"h-3 w-3 mr-1"}),"Completed"]});case"rejected":return r.jsxs(U,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"cancelled":return r.jsxs(U,{variant:"outline",className:"bg-muted text-muted-foreground",children:[r.jsx(h,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return r.jsx(U,{variant:"outline",children:e})}};return F?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-primary"})}):P&&J?r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r.jsx(l,{variant:"ghost",size:"icon",onClick:()=>G(-1),children:r.jsx(d,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Withdrawal Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Review and process payout requests"})]})]}),Q&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[r.jsx(c,{className:"bg-yellow-500/10 border-yellow-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 mb-1",children:[r.jsx(u,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Pending"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.pending_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:O(Q.pending_amount)})]})}),r.jsx(c,{className:"bg-blue-500/10 border-blue-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[r.jsx(x,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Approved"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.approved_count}),r.jsx("p",{className:"text-sm text-muted-foreground",children:O(Q.approved_amount)})]})}),r.jsx(c,{className:"bg-green-500/10 border-green-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Total Paid"})]}),r.jsx("p",{className:"text-2xl font-bold",children:O(Q.completed_total)})]})}),r.jsx(c,{className:"bg-red-500/10 border-red-500/20",children:r.jsxs(i,{className:"pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-1",children:[r.jsx(h,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Rejected"})]}),r.jsx("p",{className:"text-2xl font-bold",children:Q.rejected_count})]})})]}),r.jsxs(p,{value:ee,onValueChange:e=>{te(e),le()},children:[r.jsxs(f,{className:"mb-6",children:[r.jsx(w,{value:"pending",children:"Pending"}),r.jsx(w,{value:"approved",children:"Approved"}),r.jsx(w,{value:"completed",children:"Completed"}),r.jsx(w,{value:"rejected",children:"Rejected"}),r.jsx(w,{value:"all",children:"All"})]}),r.jsx(v,{value:ee,children:r.jsxs(c,{children:[r.jsxs(j,{children:[r.jsx(g,{children:"Withdrawal Requests"}),r.jsxs(y,{children:["pending"===ee&&"Review and approve or reject pending requests","approved"===ee&&"Process approved withdrawals","completed"===ee&&"View completed payouts","rejected"===ee&&"View rejected requests","all"===ee&&"All withdrawal requests"]})]}),r.jsx(i,{children:0===V.length?r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(b,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsxs("p",{children:["No ","all"!==ee?ee:""," withdrawal requests"]})]}):r.jsx(N,{className:"h-[500px]",children:r.jsx("div",{className:"space-y-4",children:V.map(e=>{var t;return r.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/30 transition-colors",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx(C,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.user_display_name}),r.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(z,{className:"h-3 w-3"}),(null==(t=e.payout_details)?void 0:t.email)||"No email provided"]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[de(e.status),r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(S,{className:"h-3 w-3"}),D(new Date(e.created_at),{addSuffix:!0})]}),r.jsxs("span",{className:"text-muted-foreground",children:["Earned: ",O(e.wallet_total_earned||0)]})]}),e.admin_notes&&r.jsxs("p",{className:"text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[r.jsx("strong",{children:"Notes:"})," ",e.admin_notes]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-2",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:O(e.amount_cents)}),r.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(l,{size:"sm",variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-600 hover:text-white",onClick:()=>ne({type:"approve",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(l,{size:"sm",variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-600 hover:text-white",onClick:()=>ne({type:"reject",request:e}),children:[r.jsx(h,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),"approved"===e.status&&r.jsxs(l,{size:"sm",onClick:()=>ne({type:"complete",request:e}),children:[r.jsx(x,{className:"h-4 w-4 mr-1"}),"Mark Completed"]})]})]})]})},e.id)})})})})]})})]}),r.jsx(q,{open:!!se.type,onOpenChange:()=>ne({type:null,request:null}),children:r.jsxs(_,{children:[r.jsxs(B,{children:[r.jsxs(L,{children:["approve"===se.type&&"Approve Withdrawal","reject"===se.type&&"Reject Withdrawal","complete"===se.type&&"Complete Withdrawal"]}),r.jsxs(M,{children:["approve"===se.type&&"This will approve the withdrawal request for processing.","reject"===se.type&&"Please provide a reason for rejection.","complete"===se.type&&"Confirm you have sent the payment to the user."]})]}),se.request&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:se.request.user_display_name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:null==(k=se.request.payout_details)?void 0:k.email})]}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:O(se.request.amount_cents)})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"reject"===se.type?"Rejection Reason (Required)":"Admin Notes (Optional)"}),r.jsx(A,{placeholder:"reject"===se.type?"Explain why this request is being rejected...":"Add any notes about this action...",value:re,onChange:e=>ae(e.target.value),rows:3})]}),"complete"===se.type&&r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[r.jsx(K,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-amber-700",children:["Only mark as complete after you have sent the payment via PayPal to"," ",r.jsx("strong",{children:null==(I=se.request.payout_details)?void 0:I.email})]})]})]}),r.jsxs(W,{children:[r.jsx(l,{variant:"outline",onClick:()=>ne({type:null,request:null}),disabled:ce,children:"Cancel"}),r.jsxs(l,{onClick:async()=>{if(se.type&&se.request){ie(!0);try{let t;switch(se.type){case"approve":t=await async function(t,s){const n=Z,r={};r[n(561)]=n(576)+n(480),r[n(571)]=function(e,t){return e||t},r.uVNNi=n(593),r[n(541)]=n(539);const a=r;try{const{data:{user:r}}=await e[n(562)][n(509)]();if(!r)throw new Error(a[n(561)]);const{error:c}=await e.from("withdrawal"+n(502))[n(540)]({status:n(567),admin_notes:a.onHZE(s,null),reviewed_by:r.id,reviewed_at:(new Date)[n(505)+"g"]()}).eq("id",t).eq(a.uVNNi,a.HOHOk);if(c)throw c;const i={};return i[n(527)]=!0,i[n(596)]=null,i}catch(c){const e={};return e[n(527)]=!1,e[n(596)]=c,e}}(se.request.id,re),t.success&&H.success("Withdrawal approved");break;case"reject":if(!re.trim())return H.error("Rejection reason is required"),void ie(!1);t=await async function(t,s){const n=Z,r={};r.TkRjd="Not authen"+n(480),r[n(587)]=n(593),r[n(512)]="pending";const a=r;try{const{data:{user:r}}=await e[n(562)][n(509)]();if(!r)throw new Error(a[n(573)]);if(!s)throw new Error(n(581)+n(578)+"required");const{error:c}=await e.from(n(494)+n(502))[n(540)]({status:"rejected",admin_notes:s,reviewed_by:r.id,reviewed_at:(new Date)[n(505)+"g"]()}).eq("id",t).eq(a[n(587)],a[n(512)]);if(c)throw c;const i={};return i[n(527)]=!0,i[n(596)]=null,i}catch(c){const e={};return e[n(527)]=!1,e[n(596)]=c,e}}(se.request.id,re),t.success&&H.success("Withdrawal rejected");break;case"complete":t=await async function(t,s){const n=Z,r={};r[n(549)]=n(576)+n(480),r[n(597)]=function(e,t){return e||t},r[n(489)]="withdrawal"+n(502),r[n(559)]=n(501);const a=r;try{const{data:{user:r}}=await e[n(562)][n(509)]();if(!r)throw new Error(a[n(549)]);const{data:c,error:i}=await e[n(491)](n(494)+n(502))[n(594)]("*").eq("id",t).eq(n(593),"approved")[n(580)]();if(a[n(597)](i,!c))throw new Error(n(530)+"t found or not in ap"+n(531)+n(552));const{error:o}=await e[n(491)](a[n(489)])[n(540)]({status:a[n(559)],admin_notes:s?(c[n(479)+"s"]||"")+n(600)+s:c.admin_notes,completed_at:(new Date)[n(505)+"g"]()}).eq("id",t);if(o)throw o;const l={};l.request_id=t,l.user_id=c[n(495)],l[n(519)+"ts"]=c.amount_cents;const d={};d.body=l;const{error:u}=await e[n(558)][n(515)]("process-wi"+n(534),d),x={success:!0};return x[n(596)]=null,x}catch(c){const e={};return e[n(527)]=!1,e[n(596)]=c,e}}(se.request.id,re),t.success&&H.success("Withdrawal marked as completed")}(null==t?void 0:t.error)?H.error(t.error.message):(ne({type:null,request:null}),ae(""),await le())}finally{ie(!1)}}},disabled:ce||"reject"===se.type&&!re.trim(),className:"reject"===se.type?"bg-red-600 hover:bg-red-700":"approve"===se.type?"bg-green-600 hover:bg-green-700":"",children:[ce&&r.jsx(a,{className:"h-4 w-4 mr-2 animate-spin"}),"approve"===se.type&&"Approve","reject"===se.type&&"Reject","complete"===se.type&&"Mark Complete"]})]})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(c,{className:"max-w-md w-full",children:r.jsxs(i,{className:"pt-6 text-center",children:[r.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("h2",{className:"text-xl font-bold mb-2",children:"Admin Access Required"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"You need admin privileges to access this page."}),r.jsx(l,{onClick:()=>G("/"),children:"Go Home"})]})})})}F(void 0,function(){const e=G,t={};t[e(208)]=function(e,t){return e!==t},t[e(167)]="IKVhb",t[e(211)]=e(206),t[e(217)]=function(e,t){return e+t},t.maVOv=e(185)+e(168),t[e(194)]=e(190)+'ctor("retu'+e(183)+" )",t[e(198)]=e(179),t[e(158)]=e(171),t.gfXOA=function(e,t){return e<t};const s=t,n=function(){const t=e;if(s[t(208)](s.FjWAY,s[t(211)])){let e;try{e=Function(s[t(217)](s[t(217)](s[t(159)],s[t(194)]),");"))()}catch(n){if(s.fEMmb!==t(179)){const e=_0x11dd36?function(){if(_0x56768b){const e=_0x204470[t(223)](_0x5d069d,arguments);return _0x1e779a=null,e}}:function(){};return _0x4fc768=!1,e}e=window}return e}_0xcbef17=_0x3791fb}(),r=n[e(215)]=n[e(215)]||{},a=[e(182),s[e(158)],e(210),e(202),e(222),"table","trace"];for(let c=0;s[e(201)](c,a[e(186)]);c++){const t=F[e(200)+"r"][e(197)][e(184)](F),s=a[c],n=r[s]||t;t.__proto__=F[e(184)](F),t[e(207)]=n.toString[e(184)](n),r[s]=t}})();export{T as default};
