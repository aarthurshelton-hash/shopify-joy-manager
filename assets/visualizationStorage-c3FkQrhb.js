import{s as t,ca as n,dG as r,dH as e}from"./index-DEc03Eh1.js";import{v as o,a as i,b as a}from"./visualizationSchemas-D3yk01n_.js";import"./flagContent-B7QRy3TA.js";!function(){const t=l,n=c();for(;;)try{if(704351===parseInt(t(167))/1+parseInt(t(344))/2*(parseInt(t(351))/3)+-parseInt(t(282))/4*(-parseInt(t(199))/5)+-parseInt(t(287))/6*(-parseInt(t(277))/7)+-parseInt(t(291))/8*(parseInt(t(255))/9)+parseInt(t(295))/10*(parseInt(t(273))/11)+-parseInt(t(247))/12)break;n.push(n.shift())}catch(r){n.push(n.shift())}}();const s=function(){const t=l,n={};n[t(195)]=t(300)+" very simi"+t(339)+t(309)+t(211)+"ng at leas"+t(265)+t(239)+t(204),n.szXkh=t(299)+"llector";const r=n;let e=!0;return function(n,o){const i=t,a={};a.jcMzg=r[i(195)],a[i(327)]=r[i(217)],a.pvEVT="KXFZa";const s=a,c=e?function(){const t=i;if(o){if("KXFZa"===s[t(260)]){const t=o.apply(n,arguments);return o=null,t}{const n=_0x579c33[t(230)+"rentUser"]?s.jcMzg:t(365)+_0x318a87.round(_0x38e96a[t(258)+t(183)]||30)+(t(280)+"to a vision by ")+(_0x126bb7.ownerDisplayName||s[t(327)]);return{data:null,error:new _0x23e5e5(n),isTooSimilar:!0,ownedByCurrentUser:_0x4679a6[t(230)+t(320)],ownerDisplayName:_0x539877[t(345)+t(316)],colorSimilarity:_0x31a189[t(258)+t(183)],reason:_0x19bf6a.reason}}}}:function(){};return e=!1,c}}()(void 0,function(){const t=l,n={};n[t(307)]="(((.+)+)+)+$";const r=n;return s[t(311)]()[t(259)](r.WSMBR).toString()[t(233)+"r"](s).search(r[t(307)])});function c(){const t=["AMDNr3G","nhDbzw5wwa","EvnLA1u","BgXLy3rVCG","ihzLCNKGC2LTAq","C2rZy1y","nteXohjdCevZBq","u3rLv2u","EKrTAu0","Ahb4CgW","mte2ofD2q0XOvW","zvb0tvy","CM9WCMLHDguGyW","zxjYB3i","mJbXD3vdt2y","y3vZDg9T","qu9xEgG","tIbKyxrH","yw5VDgHLCIbJBW","ww91igHHDMuGyq","BgL6yxrPB246ia","y2f0zxm6","BIbIEsa","DwfSAxPHDgLVBG","D2fYBG","DwDpsKS","v1nnqLi","zMv0y2GGDMLZDq","AxPHDgLVBIaTia","rMfPBgvKihrVia","Dg9tDhjPBMC","EgXICeq","z2fTzurHDge","sK5srgu","CMv0DxjUicHMDq","yxLoyw1L","C3vJy2vZCW","z2u6ia","wujADum","CMvUDfvZzxi","y29UC29Szq","C2LUz2XL","zgf0yq","B2zyCem","DhrLswq","ywXS","u0zxy0G","Bwf0y2HLzeDHBq","ywLUCYbPBMfWCa","vgL0BguGy29UDa","Bwf0y2HLzfbHBa","DxbZzxj0","CMvTB3zL","s3beshm","y29Kzq","rxjYB3iGy2HLyW","BgLUA2vKugfSzq","yxbWBhK","BgfYihzPC3vHBa","C2vSzwn0","BfnQs2m","zcWGCgDUlcbNyq","C3rVCMfNzq","odjpzLrrqKC","B3DUzxjeAxnWBa","Dg9mB3DLCKnHCW","DxbSB2fK","CML0Eq","C3bSAxq","q2rXvNG","mZmYmZfXCfjmvNu","z1rsz2m","yxnJzw5KAw5N","uMPkuvC","CM4GDgHPCYiPka","AxneDxbSAwnHDa","Dg90ywXnB3zLCW","s0PZyLe","DuveqNy","AxnuB29tAw1PBa","sw52ywXPzcb0Aq","CYbVD25LzcbIEq","B3jKzxi","Aw5Zzxj0","vgHPCYbPCYa","BgL6yxrPB24GAq","DxbSAwnHDguGyW","vMLZDwfSAxPHDa","tw5eC3C","CMvHC29U","mtmWoda3mwjit2nozW","y2vnDwi","Aw9Uu3rHDgu","CgLLy2vuExbL","Aw9UCW","y3vYCMvUDe1VDG","D2HPDgu","Een3vuG","Aw4GEw91CIbNyq","zgf0zq","ChjVzMLSzxm","su1uzNq","zMLUzeLUzgv4","y0DHBwu","zxHJzxb0Aw9U","zgvSzxrLihzPCW","yxjPDhK","EvPLu1m","wezpuvC","x19WCM90B19F","yM9HCMq","zvvtzgu","AwH1EgK","ChvIBgLJvxjS","DxnLCL9Pza","u1bHAu4","ChjVDg90ExbL","C2f2zwrFDMLZDq","u092CfC","v0LvBwm","CMvZDwX0","zunHCMq","mtKZmta0nwvrDfrvDa","qw5VDgHLCIbJBW","BM93","Cgf0Ag5HBwu","CgDU","zw5LC3m","zxHPC3rPBMDjza","sNvKDuS","DgfIBgu","Bw92zxm","DMLZDwfSAxPHDa","zNjVBq","Dhj5ignOyw5NAq","vgHPCYb2Axn1yq","wwL3EKO","BwvFzgf0yq","rxjYB3iGAw4Gza","zxr0zvnPBwLSyq","C3PyA2G","tNHdDgm","CM91BMq","Bw9KzxjU","y1bHBgv0Dgu","z2fTzv9KyxrH","lNbUzW","yMLUza","D2Peug4","y3vZDg9Tq29SBW","AxnjBNrYAw5ZAq","Dw5K","BMCGyxqGBgvHCW","B3DUzwrcEun1CG","sefnAMe","Bg9JywXLq29TCa","y29UC3rYDwn0BW","Aw9Uig5VDcbMBW","DgXL","zgfYA01Vzgu","BKLK","E30Uy29UC3rYDq","igzVCIb1BMLXDq","ywXPEMf0Aw9UCW","zMLUza","D254vha","BgXLCNK","C3rYAw5NAwz5","rLHeuMm","y3rZr24","mZu2mJmYnJbfBfnJz2K","CMvWBgfJzq","Aw5MBW","CgfSzxr0zuLK","z3bqtvq","BMn0Aw9UkcKG","v0XyBve","ywXPEMf0Aw9UoG","odm2mvf5tvP3CG","v2TlEMu","zxzLBNq","y29SB3jtAw1PBa","C2vHCMnO","ChzfvLq","AwnHDguGzxHPCW","y3fHAhC","BwvZC2fNzq","DhjPBq","Dca4ignVBg9YCW","yMXHy2S","wNLhs3q","BgvUz3rO","we5IqNG","sxvJCve","zgLZCgXHEv9Uyq","CYbHBhjLywr5ia","mZG0mZuYmuDqBgHytW","CgnTqLK","zxr0zuLK","zxHPC3rPBMDwAq","nZG4ow1SDgXdrW","C29YDa","B250zw50","jsbZAw1PBgfYia"];return(c=function(){return t})()}s();const u=function(){let t=!0;return function(n,r){const e=t?function(){const t=l;if(r){if(t(242)==t(242)){const e=r[t(338)](n,arguments);return r=null,e}{const n=_0x23be42?function(){if(_0x3fb057){const n=_0xc2b797[t(338)](_0x3e5763,arguments);return _0xbf34ad=null,n}}:function(){};return _0x871694=!1,n}}}:function(){};return t=!1,e}}();function f(t,n,r){const e=l,o={};o[e(267)]=e(326);const i=o;return(t||n[e(203)]||"")[e(264)]()[e(248)](/\s+/g," ")+"::"+(r?JSON[e(244)]({palette:r[e(250)]||e(220),darkMode:r[e(236)]||!1,currentMove:r.currentMove===1/0?i[e(267)]:r[e(172)+"e"],lockedPieces:(r.lockedPieces||[])[e(278)]((t,n)=>(t.pieceColor+"-"+t.pieceType)[e(232)+"are"](n.pieceColor+"-"+n[e(170)]))}):"{}")}function l(t,n){t-=163;const r=c();let e=r[t];if(void 0===l.bmAizL){var o=function(t){let n="",r="",e=n+o;for(let o,i,a=0,s=0;i=t.charAt(s++);~i&&(o=a%4?64*o+i:i,a++%4)?n+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=n.length;o<i;o++)r+="%"+("00"+n.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(r)};l.hXbMQa=o,l.dsmMMI={},l.bmAizL=!0}const i=t+r[0],a=l.dsmMMI[i];if(a)e=a;else{const t=function(t){this.POgNFn=t,this.zldUdE=[1,0,0],this.dalBdf=function(){return"newState"},this.LuuWLb="\\w+ *\\(\\) *{\\w+ *",this.bleaVz="['|\"].+['|\"];? *}"};t.prototype.RtvmDX=function(){const t=new RegExp(this.LuuWLb+this.bleaVz).test(this.dalBdf.toString())?--this.zldUdE[1]:--this.zldUdE[0];return this.ptszbN(t)},t.prototype.ptszbN=function(t){return Boolean(~t)?this.zTSfhB(this.POgNFn):t},t.prototype.zTSfhB=function(t){for(let n=0,r=this.zldUdE.length;n<r;n++)this.zldUdE.push(Math.round(Math.random())),r=this.zldUdE.length;return t(this.zldUdE[0])},new t(l).RtvmDX(),e=l.hXbMQa(e),l.dsmMMI[i]=e}return e}async function w(o,i,a,s){const c=l,u={xlbpD:function(t,n,r,e){return t(n,r,e)},XFOQW:"id, user_i"+c(342)+c(214),yZeSS:function(t,n){return t===n},ihuxi:c(256),sdscV:"display_name",gTRgc:c(191),ugOJK:"Exact dupl"+c(261)+"ts",HAMja:c(220),pcmBY:function(t,n){return t===n},jggGx:c(296),WIUmc:c(192),YBZuC:"DIVZp",WLXmQ:function(t,n,r,e,o,i){return t(n,r,e,o,i)},FWZHI:c(215)+c(163)+"heck:"};try{const l=u[c(312)](f,i,a,s),{data:w,error:z}=await t[c(210)]("saved_visu"+c(240))[c(340)](u[c(185)]);if(z){const t={isDuplicate:!1,isTooSimilar:!1};return t}for(const n of w||[]){const r=n[c(222)],e=f(n[c(203)]||void 0,r,r["visualizat"+c(169)]);if(u[c(184)](l,e)){if(c(256)===u[c(189)]){const r=n[c(191)]===o;let e;if(!r){const{data:r}=await t[c(210)](c(177))[c(340)](u[c(286)]).eq(u[c(352)],n.user_id).single();e=(null==r?void 0:r[c(271)+"me"])||c(200)+c(284)}const i={isDuplicate:!0,isTooSimilar:!0};return i[c(205)]=n.id,i["ownedByCur"+c(320)]=r,i["ownerDispl"+c(316)]=e,i[c(258)+"arity"]=100,i[c(166)]=u[c(306)],i}_0x22f5cb=_0x4538d8.customColors}}const C=(null==s?void 0:s[c(250)])||u[c(231)];let D;if(null==s?void 0:s.customColors)D=s[c(226)+"rs"];else if(u[c(274)](C,u[c(281)])){const t=n[c(241)](t=>t.id===c(296));if(t)if(u[c(196)]===u[c(319)]){const t=_0xf9fe6[c(241)](t=>t.id===c(296));if(t){const n={};n[c(173)]=t.white,n[c(266)]=t.black,_0x2714f5=n}}else{const n={};n[c(173)]=t[c(173)],n.black=t.black,D=n}}const g=await u[c(253)](r,o,i,a,C,D);if(g[c(360)+"ar"]){const t={};return t[c(356)+"e"]=!1,t[c(360)+"ar"]=!0,t[c(205)]=g[c(276)+"sualizatio"+c(237)],t[c(230)+c(320)]=g["ownedByCur"+c(320)],t["ownerDispl"+c(316)]=g[c(345)+c(316)],t[c(258)+c(183)]=g.colorSimilarity,t.reason=g.reason,t.existingColors=g.existingColors,t[c(227)+"cPalette"]=g["isIntrinsi"+c(221)],t["isIntrinsi"+c(180)]=g[c(227)+c(180)],t[c(328)+"eCard"]=g[c(328)+c(198)],t.matchedPaletteId=g[c(331)+c(275)],t[c(331)+c(216)+"rity"]=g[c(331)+c(216)+c(348)],t}let y;D&&(y=e(D)||void 0);const x={};return x[c(356)+"e"]=!1,x[c(360)+"ar"]=!1,x["linkedPale"+c(325)]=y,x["colorSimil"+c(183)]=g[c(258)+c(183)],x[c(227)+c(221)]=g[c(227)+c(221)],x[c(227)+c(180)]=g[c(227)+c(180)],x[c(328)+"eCard"]=g["matchedGam"+c(198)],x[c(331)+c(275)]=g[c(331)+c(275)],x[c(331)+c(216)+c(348)]=g[c(331)+c(216)+"rity"],x}catch(w){const t={isDuplicate:!1,isTooSimilar:!1};return t}}async function z(n,r,e,s,c,u){const f=l,z={NxCtc:f(361)+f(235),DRhxT:function(t,n){return t(n)},xutUw:f(269),lSjKc:function(t,n){return t(n)},FXDRc:"Invalid PG"+f(298),zDmiM:f(212)+f(366)+f(272)+f(175)+f(243),ySekU:f(300)+f(285)+f(339)+f(309)+f(211)+f(229)+f(265)+" for uniqu"+f(204),wjDPn:"image/png",cqahw:function(t,n){return t===n},uEDBv:f(270),eUSde:"visualizat"+f(171),gpPMT:f(194)+"alizations",KJsbQ:function(t,n){return t||n}};try{const l=o(r);if(!l[f(317)])return{data:null,error:new Error(l[f(294)]||z[f(218)])};const C=await z.DRhxT(i,r);if(!C.safe){if(z.xutUw===f(269))return{data:null,error:new Error(C[f(166)]||f(330)+f(329)+f(293)+f(279))};{const t={};t[f(173)]=_0x92961e[f(173)],t[f(266)]=_0x4ca1a6.black,_0x6ce7c5=t}}const D=z[f(341)](a,c);if(!D.success)return{data:null,error:new Error(D[f(294)]||z[f(245)])};const g=await w(n,c,e.gameData,u);if(g.isDuplicate){const t=g["ownedByCur"+f(320)]?z[f(289)]:"This visua"+f(366)+f(362)+" "+(g[f(345)+f(316)]||f(299)+f(284));return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:g[f(230)+f(320)],ownerDisplayName:g[f(345)+f(316)],colorSimilarity:100}}if(g[f(360)+"ar"]){const t=g[f(230)+"rentUser"]?z[f(283)]:f(365)+Math[f(219)](g[f(258)+"arity"]||30)+"% similar to a visio"+f(303)+(g[f(345)+"ayName"]||"another collector");return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:g.ownedByCurrentUser,ownerDisplayName:g[f(345)+f(316)],colorSimilarity:g["colorSimil"+f(183)],reason:g[f(166)]}}const y={...u};y["linkedPale"+f(325)]=g[f(337)+f(325)];const x=y,d=n+"/"+Date[f(201)]()+"-"+r[f(248)](/[^a-z0-9]/gi,"-")[f(346)+"e"]()+f(223),v={};v.contentType=z[f(225)],v[f(332)]=!1;const{error:B}=await t[f(343)][f(210)]("visualizations")[f(347)](d,s,v);if(B){if(z[f(262)](z[f(359)],z[f(359)]))throw new Error("Failed to upload ima"+f(318)+B[f(263)]);{const t=_0x33218a[f(233)+"r"][f(193)][f(224)](_0x415171),n=_0x5d7349[_0x2d82d5],r=_0x46f1ac[n]||t;t[f(186)]=_0x39d703[f(224)](_0x70625b),t.toString=r[f(311)].bind(r),_0x3a3f51[n]=t}}const{data:m}=t.storage[f(210)](z[f(188)]).getPublicUrl(d),h={};h[f(173)]=e[f(313)].white,h[f(266)]=e[f(313)][f(266)],h[f(257)]=e[f(313)][f(257)],h[f(176)]=e[f(313)].date,h[f(197)]=e[f(313)][f(197)],h.pgn=e[f(313)].pgn,h[f(208)]=e[f(313)][f(208)],h[f(187)]=e[f(187)],h[f(357)]=e[f(357)],h[f(209)+"ionState"]=x;const L=h,{data:M,error:b}=await t.from(z[f(251)])[f(364)]({user_id:n,title:r,pgn:z[f(358)](c,null),game_data:L,image_path:m[f(190)]}).select()[f(322)]();if(b)throw await t[f(343)][f(210)]("visualizat"+f(171))[f(333)]([d]),new Error(f(310)+"save visua"+f(301)+b.message);const p={};return p[f(323)]=M,p[f(294)]=null,p}catch(C){const t={};return t[f(323)]=null,t[f(294)]=C,t}}async function C(n){const r=l,e={};e[r(334)]=r(191),e[r(206)]="created_at",e[r(168)]=function(t,n){return t!==n},e[r(165)]=r(290);const o=e;try{const e={};e[r(353)]=!1;const{data:i,error:a}=await t.from(r(194)+r(240))[r(340)]("*").eq(o.KpDHs,n)[r(363)](o[r(206)],e);if(a)throw new Error("Failed to "+r(308)+"alizations: "+a[r(263)]);const s={};return s[r(323)]=i||[],s[r(294)]=null,s}catch(i){if(o[r(168)](o[r(165)],o[r(165)])){const t=_0x42386e?function(){if(_0xa419a3){const t=_0x3049f6[r(338)](_0xebcb8c,arguments);return _0x17da6f=null,t}}:function(){};return _0x33f18e=!1,t}{const t={};return t[r(323)]=[],t[r(294)]=i,t}}}async function D(n,r){const e=l,o={etiOC:function(t,n){return t+n}};o[e(324)]="visualizations",o[e(178)]=e(194)+e(240);const i=o;try{const o=new URL(r)[e(202)][e(349)]("/"),a=o[e(179)](t=>t===e(209)+e(171)),s=o.slice(i.etiOC(a,1)).join("/");s&&await t[e(343)].from(i[e(324)])[e(333)]([s]);const{error:c}=await t.from(i[e(178)]).delete().eq("id",n);if(c)throw new Error(e(310)+e(182)+e(304)+": "+c[e(263)]);const u={};return u[e(294)]=null,u}catch(a){const t={};return t.error=a,t}}u(void 0,function(){const t=l,n={YiwzJ:function(t,n){return t(n)},xCwUH:function(t,n){return t+n},MLHPD:t(315)+t(252),AOWxh:t(238)+'ctor("retu'+t(355)+" )",JNRDe:t(305),CdqVx:t(207)},r=function(){const r=t;let e;try{e=n[r(213)](Function,n[r(174)](n.MLHPD,n[r(297)])+");")()}catch(o){e=window}return e}(),e=r[t(321)]=r.console||{},o=["log",n[t(314)],t(249),t(294),t(181),n[t(350)],"trace"];for(let i=0;i<o[t(268)];i++){const n=u.constructor[t(193)][t(224)](u),r=o[i],a=e[r]||n;n[t(186)]=u[t(224)](u),n.toString=a[t(311)][t(224)](a),e[r]=n}})();export{w as checkDuplicateVisualization,D as deleteVisualization,C as getUserVisualizations,z as saveVisualization};
