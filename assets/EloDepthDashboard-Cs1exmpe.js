const e='import React, { useState, useEffect } from \'react\';\nimport { Card, CardContent, CardHeader, CardTitle } from \'@/components/ui/card\';\nimport { Badge } from \'@/components/ui/badge\';\nimport { Progress } from \'@/components/ui/progress\';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \'@/components/ui/tabs\';\nimport { Brain, Zap, Target, TrendingUp, Crown, Swords, BarChart3 } from \'lucide-react\';\nimport { supabase } from \'@/integrations/supabase/client\';\nimport { \n  calculateEnPensentElo, \n  calculateDetailedEloMetrics,\n  calculateMarketElo,\n  canWeBeatStockfish,\n  EloEstimate,\n  DepthEloMetrics \n} from \'@/lib/chess/eloEstimator\';\nimport { calculateDepthMetricsFromBenchmark, DepthMetrics } from \'@/lib/chess/depthAnalysis\';\n\ninterface BenchmarkData {\n  hybridAccuracy: number;\n  stockfishAccuracy: number;\n  totalGames: number;\n  attempts: Array<{\n    stockfish_depth: number | null;\n    stockfish_correct: boolean;\n    hybrid_correct: boolean;\n    hybrid_confidence: number | null;\n    hybrid_archetype: string | null;\n    move_number: number;\n  }>;\n}\n\nexport function EloDepthDashboard() {\n  const [loading, setLoading] = useState(true);\n  const [eloEstimate, setEloEstimate] = useState<EloEstimate | null>(null);\n  const [detailedElo, setDetailedElo] = useState<DepthEloMetrics | null>(null);\n  const [depthMetrics, setDepthMetrics] = useState<DepthMetrics | null>(null);\n  const [marketElo, setMarketElo] = useState<number>(0);\n  const [beatStockfishPath, setBeatStockfishPath] = useState<string[]>([]);\n\n  useEffect(() => {\n    fetchBenchmarkData();\n  }, []);\n\n  const fetchBenchmarkData = async () => {\n    setLoading(true);\n    try {\n      // Get cumulative stats\n      const { data: benchmarks } = await supabase\n        .from(\'chess_benchmark_results\')\n        .select(\'*\')\n        .order(\'created_at\', { ascending: false })\n        .limit(10);\n\n      // Get prediction attempts for detailed analysis\n      const { data: attempts } = await supabase\n        .from(\'chess_prediction_attempts\')\n        .select(\'*\')\n        .order(\'created_at\', { ascending: false })\n        .limit(500);\n\n      if (benchmarks && benchmarks.length > 0 && attempts) {\n        // Aggregate benchmark data\n        const totalGames = benchmarks.reduce((sum, b) => sum + b.total_games, 0);\n        const hybridCorrect = attempts.filter(a => a.hybrid_correct).length;\n        const stockfishCorrect = attempts.filter(a => a.stockfish_correct).length;\n        \n        const hybridAccuracy = hybridCorrect / Math.max(attempts.length, 1);\n        const stockfishAccuracy = stockfishCorrect / Math.max(attempts.length, 1);\n\n        // Calculate depth metrics\n        const depthData = attempts.map(a => ({\n          stockfishDepth: a.stockfish_depth || 40,\n          stockfishCorrect: a.stockfish_correct,\n          hybridCorrect: a.hybrid_correct,\n          hybridConfidence: a.hybrid_confidence || 50,\n          hybridArchetype: a.hybrid_archetype || \'unknown\',\n          moveNumber: a.move_number,\n        }));\n\n        const depth = calculateDepthMetricsFromBenchmark(depthData);\n        setDepthMetrics(depth);\n\n        // Calculate ELO estimate\n        const elo = calculateEnPensentElo(\n          hybridAccuracy,\n          stockfishAccuracy,\n          depth.enPensentEffectiveDepth,\n          attempts.length\n        );\n        setEloEstimate(elo);\n\n        // Calculate detailed ELO breakdown\n        const avgConfidence = attempts.reduce((sum, a) => sum + (a.hybrid_confidence || 50), 0) / attempts.length;\n        const horizonAccuracy = depth.horizonAccuracy.find(h => h.movesAhead >= 15)?.accuracy || 50;\n        \n        const detailed = calculateDetailedEloMetrics(\n          hybridAccuracy,\n          stockfishAccuracy,\n          depth.enPensentEffectiveDepth,\n          depth.stockfishDepth,\n          avgConfidence,\n          horizonAccuracy\n        );\n        setDetailedElo(detailed);\n\n        // Calculate market ELO\n        const mktElo = calculateMarketElo(hybridAccuracy);\n        setMarketElo(mktElo);\n\n        // Get path to beat Stockfish\n        const { path } = canWeBeatStockfish();\n        setBeatStockfishPath(path);\n      }\n    } catch (error) {\n      console.error(\'Error fetching benchmark data:\', error);\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <Card className="bg-card/50 backdrop-blur border-primary/20">\n        <CardContent className="flex items-center justify-center h-64">\n          <Brain className="w-8 h-8 animate-pulse text-primary" />\n          <span className="ml-2">Calculating ELO & Depth...</span>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className="space-y-6">\n      {/* Main ELO Display */}\n      <Card className="bg-gradient-to-br from-card via-card to-primary/5 border-primary/30">\n        <CardHeader>\n          <CardTitle className="flex items-center gap-2">\n            <Crown className="w-6 h-6 text-yellow-500" />\n            En Pensent™ ELO Rating\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">\n            {/* FIDE Reference - Stockfish Official */}\n            <div className="text-center p-6 bg-muted/50 rounded-xl border border-muted">\n              <div className="text-sm text-muted-foreground mb-2">FIDE Reference: Stockfish 17</div>\n              <div className="text-5xl font-bold text-muted-foreground">\n                3600\n              </div>\n              <Badge variant="outline" className="mt-2">\n                CCRL/TCEC Official Rating\n              </Badge>\n              <div className="text-xs text-muted-foreground mt-2">\n                World\'s Strongest Engine\n              </div>\n            </div>\n\n            {/* Our ELO */}\n            <div className="text-center p-6 bg-gradient-to-br from-primary/20 to-primary/5 rounded-xl border border-primary/30">\n              <div className="text-sm text-muted-foreground mb-2">En Pensent (Prediction)</div>\n              <div className="text-5xl font-bold bg-gradient-to-r from-primary to-purple-400 bg-clip-text text-transparent">\n                {eloEstimate?.enPensentElo || \'—\'}\n              </div>\n              <Badge className="mt-2" variant="secondary">\n                {eloEstimate?.humanEquivalent || \'Calculating...\'}\n              </Badge>\n              <div className="text-xs text-muted-foreground mt-2">\n                SF Prediction ELO: {Math.round(eloEstimate?.stockfishPredictionElo || 0)}\n              </div>\n            </div>\n\n            {/* Advantage */}\n            <div className="text-center p-6 bg-gradient-to-br from-green-500/20 to-green-500/5 rounded-xl border border-green-500/30">\n              <div className="text-sm text-muted-foreground mb-2">Prediction Advantage</div>\n              <div className={`text-5xl font-bold ${(eloEstimate?.eloAdvantage || 0) >= 0 ? \'text-green-500\' : \'text-red-500\'}`}>\n                {(eloEstimate?.eloAdvantage || 0) >= 0 ? \'+\' : \'\'}{Math.round(eloEstimate?.eloAdvantage || 0)}\n              </div>\n              <Badge variant="outline" className="mt-2 border-green-500/50 text-green-500">\n                {(eloEstimate?.eloAdvantage || 0) > 0 ? \'Superior\' : \'Growing\'}\n              </Badge>\n              <div className="text-xs text-muted-foreground mt-2">\n                vs SF Prediction (not Playing)\n              </div>\n            </div>\n          </div>\n\n          {/* Confidence Interval */}\n          {eloEstimate && (\n            <div className="mt-6 p-4 bg-muted/30 rounded-lg">\n              <div className="text-sm text-muted-foreground mb-2">95% Confidence Interval</div>\n              <div className="flex items-center gap-4">\n                <span className="text-lg font-mono">{eloEstimate.confidenceRange.low}</span>\n                <Progress \n                  value={((eloEstimate.enPensentElo - eloEstimate.confidenceRange.low) / \n                         (eloEstimate.confidenceRange.high - eloEstimate.confidenceRange.low)) * 100} \n                  className="flex-1"\n                />\n                <span className="text-lg font-mono">{eloEstimate.confidenceRange.high}</span>\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      <Tabs defaultValue="depth" className="w-full">\n        <TabsList className="grid w-full grid-cols-4">\n          <TabsTrigger value="depth" className="gap-2">\n            <Target className="w-4 h-4" />\n            Depth Analysis\n          </TabsTrigger>\n          <TabsTrigger value="breakdown" className="gap-2">\n            <BarChart3 className="w-4 h-4" />\n            ELO Breakdown\n          </TabsTrigger>\n          <TabsTrigger value="market" className="gap-2">\n            <TrendingUp className="w-4 h-4" />\n            Market ELO\n          </TabsTrigger>\n          <TabsTrigger value="path" className="gap-2">\n            <Swords className="w-4 h-4" />\n            Beat Stockfish\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value="depth">\n          <Card className="bg-card/50 backdrop-blur border-border/50">\n            <CardHeader>\n              <CardTitle className="flex items-center gap-2">\n                <Target className="w-5 h-5" />\n                Depth Comparison: En Pensent vs Stockfish\n              </CardTitle>\n            </CardHeader>\n            <CardContent className="space-y-6">\n              <div className="grid grid-cols-2 gap-6">\n                {/* Stockfish Depth */}\n                <div className="p-4 bg-muted/30 rounded-lg">\n                  <div className="text-sm text-muted-foreground mb-1">Stockfish Search Depth</div>\n                  <div className="text-3xl font-bold">{depthMetrics?.stockfishDepth || 40} plies</div>\n                  <div className="text-sm text-muted-foreground">\n                    ≈ {Math.floor((depthMetrics?.stockfishDepth || 40) / 2)} moves ahead\n                  </div>\n                </div>\n\n                {/* En Pensent Depth */}\n                <div className="p-4 bg-primary/10 rounded-lg border border-primary/30">\n                  <div className="text-sm text-muted-foreground mb-1">En Pensent Effective Depth</div>\n                  <div className="text-3xl font-bold text-primary">\n                    {depthMetrics?.enPensentEffectiveDepth || 0} plies\n                  </div>\n                  <div className="text-sm text-muted-foreground">\n                    ≈ {Math.floor((depthMetrics?.enPensentEffectiveDepth || 0) / 2)} moves ahead\n                  </div>\n                </div>\n              </div>\n\n              {/* Depth Advantage */}\n              <div className="p-4 bg-gradient-to-r from-green-500/10 to-transparent rounded-lg border border-green-500/20">\n                <div className="flex items-center justify-between">\n                  <div>\n                    <div className="text-sm text-muted-foreground">Depth Advantage</div>\n                    <div className={`text-2xl font-bold ${(depthMetrics?.depthAdvantage || 0) >= 0 ? \'text-green-500\' : \'text-red-500\'}`}>\n                      {(depthMetrics?.depthAdvantage || 0) >= 0 ? \'+\' : \'\'}{depthMetrics?.depthAdvantage || 0} plies\n                    </div>\n                  </div>\n                  <div className="text-right">\n                    <div className="text-sm text-muted-foreground">Depth Ratio</div>\n                    <div className="text-2xl font-bold">{depthMetrics?.depthRatio || 1}x</div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Horizon Accuracy */}\n              {depthMetrics?.horizonAccuracy && depthMetrics.horizonAccuracy.length > 0 && (\n                <div>\n                  <div className="text-sm font-medium mb-3">Accuracy by Prediction Horizon</div>\n                  <div className="space-y-2">\n                    {depthMetrics.horizonAccuracy.slice(0, 5).map((h, i) => (\n                      <div key={i} className="flex items-center gap-4">\n                        <div className="w-20 text-sm text-muted-foreground">\n                          {h.movesAhead}+ moves\n                        </div>\n                        <div className="flex-1 flex gap-2 items-center">\n                          <Progress value={h.accuracy} className="flex-1 h-2" />\n                          <span className="text-sm font-mono w-12">{h.accuracy.toFixed(0)}%</span>\n                        </div>\n                        <div className="w-20 text-xs text-muted-foreground">\n                          SF: {h.stockfishAccuracyAtHorizon.toFixed(0)}%\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value="breakdown">\n          <Card className="bg-card/50 backdrop-blur border-border/50">\n            <CardHeader>\n              <CardTitle className="flex items-center gap-2">\n                <BarChart3 className="w-5 h-5" />\n                ELO Rating Breakdown\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className="space-y-4">\n                {detailedElo?.breakdown.map((item, i) => (\n                  <div key={i} className="p-4 bg-muted/30 rounded-lg">\n                    <div className="flex items-center justify-between mb-2">\n                      <span className="font-medium">{item.category}</span>\n                      <Badge variant={item.contribution >= 0 ? \'default\' : \'destructive\'}>\n                        {item.contribution >= 0 ? \'+\' : \'\'}{item.contribution} ELO\n                      </Badge>\n                    </div>\n                    <div className="text-sm text-muted-foreground">{item.description}</div>\n                  </div>\n                ))}\n\n                <div className="p-4 bg-primary/10 rounded-lg border border-primary/30 mt-6">\n                  <div className="flex items-center justify-between">\n                    <span className="text-lg font-bold">Combined ELO</span>\n                    <span className="text-2xl font-bold text-primary">\n                      {detailedElo?.combinedElo || eloEstimate?.enPensentElo || \'—\'}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value="market">\n          <Card className="bg-card/50 backdrop-blur border-border/50">\n            <CardHeader>\n              <CardTitle className="flex items-center gap-2">\n                <TrendingUp className="w-5 h-5" />\n                Market Battle ELO\n              </CardTitle>\n            </CardHeader>\n            <CardContent className="space-y-6">\n              <div className="text-center p-8 bg-gradient-to-br from-amber-500/20 to-amber-500/5 rounded-xl border border-amber-500/30">\n                <div className="text-sm text-muted-foreground mb-2">\n                  The Market IS Our Stockfish\n                </div>\n                <div className="text-6xl font-bold bg-gradient-to-r from-amber-400 to-orange-500 bg-clip-text text-transparent">\n                  {marketElo}\n                </div>\n                <div className="text-lg mt-2 text-muted-foreground">Market Battle ELO</div>\n              </div>\n\n              <div className="p-4 bg-muted/30 rounded-lg">\n                <div className="text-sm font-medium mb-3">Understanding Market ELO</div>\n                <div className="space-y-2 text-sm text-muted-foreground">\n                  <p>• <strong>2000 ELO</strong> = Random guessing (50% accuracy)</p>\n                  <p>• <strong>2400 ELO</strong> = Efficient Market Hypothesis baseline</p>\n                  <p>• <strong>2700 ELO</strong> = Consistent edge over market (60% accuracy)</p>\n                  <p>• <strong>3000+ ELO</strong> = Legendary trader level (70%+ accuracy)</p>\n                </div>\n              </div>\n\n              <div className="p-4 bg-primary/5 rounded-lg border border-primary/20">\n                <Zap className="w-5 h-5 text-primary mb-2" />\n                <div className="text-sm">\n                  <strong>CEO Insight:</strong> The market is a 3600+ ELO opponent - \n                  a complex adaptive system we\'re learning to beat through pattern recognition,\n                  just like we\'re beating Stockfish\'s predictions in chess.\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value="path">\n          <Card className="bg-card/50 backdrop-blur border-border/50">\n            <CardHeader>\n              <CardTitle className="flex items-center gap-2">\n                <Swords className="w-5 h-5" />\n                Path to Beat Stockfish at Chess\n              </CardTitle>\n            </CardHeader>\n            <CardContent className="space-y-6">\n              <div className="p-4 bg-amber-500/10 rounded-lg border border-amber-500/30">\n                <div className="text-sm font-medium text-amber-500 mb-2">Current Status</div>\n                <p className="text-sm text-muted-foreground">\n                  We currently USE Stockfish for tactical calculation, so we can\'t beat it at \n                  move-by-move play. However, our <strong>prediction superiority</strong> shows \n                  we understand game trajectories better than pure calculation.\n                </p>\n              </div>\n\n              <div className="space-y-3">\n                <div className="text-sm font-medium">The Path Forward:</div>\n                {beatStockfishPath.map((step, i) => (\n                  <div key={i} className="flex items-start gap-3 p-3 bg-muted/30 rounded-lg">\n                    <div className="w-6 h-6 rounded-full bg-primary/20 flex items-center justify-center text-xs font-bold text-primary">\n                      {i + 1}\n                    </div>\n                    <div className="text-sm">{step.substring(3)}</div>\n                  </div>\n                ))}\n              </div>\n\n              <div className="p-4 bg-gradient-to-r from-primary/10 to-purple-500/10 rounded-lg border border-primary/20">\n                <Brain className="w-5 h-5 text-primary mb-2" />\n                <div className="text-sm">\n                  <strong>The Ultimate Goal:</strong> Create a hybrid engine that uses \n                  En Pensent\'s pattern recognition to GUIDE Stockfish\'s tactical calculations,\n                  choosing lines that lead to favorable outcomes we\'ve already predicted.\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n';export{e as default};
