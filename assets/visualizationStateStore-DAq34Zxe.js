const e="import { create } from 'zustand';\nimport { persist, createJSONStorage } from 'zustand/middleware';\nimport { PieceType, PieceColor } from '@/lib/chess/pieceColors';\nimport { GamePhase } from '@/contexts/TimelineContext';\nimport { MoveHistoryEntry } from '@/components/chess/EnPensentOverlay';\n\nexport interface LockedPiece {\n  pieceType: PieceType;\n  pieceColor: PieceColor;\n}\n\nexport interface LockedSquare {\n  square: string;\n  pieces: LockedPiece[];\n}\n\nexport interface CapturedVisualizationState {\n  // Timeline state\n  currentMove: number;\n  selectedPhase: GamePhase;\n  isPlaying: boolean;\n  \n  // Legend state\n  lockedPieces: LockedPiece[];\n  lockedSquares: LockedSquare[];\n  compareMode: boolean;\n  highlightedPiece: LockedPiece | null;\n  \n  // Display mode\n  displayMode: 'art' | 'analysis' | 'minimal';\n  darkMode: boolean;\n  \n  // Territory mode\n  showTerritory: boolean;\n  showHeatmaps: boolean;\n  \n  // Show pieces overlay\n  showPieces: boolean;\n  pieceOpacity: number;\n  \n  // Move history for live games\n  moveHistory?: MoveHistoryEntry[];\n  \n  // Captured timestamp\n  capturedAt: Date;\n}\n\ninterface VisualizationStateStore {\n  // Current state for capturing\n  currentMove: number;\n  selectedPhase: GamePhase;\n  lockedPieces: LockedPiece[];\n  lockedSquares: LockedSquare[];\n  compareMode: boolean;\n  displayMode: 'art' | 'analysis' | 'minimal';\n  darkMode: boolean;\n  showTerritory: boolean;\n  showHeatmaps: boolean;\n  \n  // Show pieces state (synced with visualization)\n  showPieces: boolean;\n  pieceOpacity: number;\n  \n  // Actions\n  setCurrentMove: (move: number) => void;\n  setSelectedPhase: (phase: GamePhase) => void;\n  setLockedPieces: (pieces: LockedPiece[]) => void;\n  setLockedSquares: (squares: LockedSquare[]) => void;\n  setCompareMode: (mode: boolean) => void;\n  setDisplayMode: (mode: 'art' | 'analysis' | 'minimal') => void;\n  setDarkMode: (dark: boolean) => void;\n  setShowTerritory: (show: boolean) => void;\n  setShowHeatmaps: (show: boolean) => void;\n  setShowPieces: (show: boolean) => void;\n  setPieceOpacity: (opacity: number) => void;\n  \n  // Capture current state for export\n  captureState: (moveHistory?: MoveHistoryEntry[]) => CapturedVisualizationState;\n  \n  // Restore from captured state\n  restoreFromState: (state: Partial<CapturedVisualizationState>) => void;\n  \n  // Reset state\n  resetState: () => void;\n}\n\nconst initialState = {\n  currentMove: Infinity,\n  selectedPhase: 'all' as GamePhase,\n  lockedPieces: [] as LockedPiece[],\n  lockedSquares: [] as LockedSquare[],\n  compareMode: false,\n  displayMode: 'art' as const,\n  darkMode: false,\n  showTerritory: false,\n  showHeatmaps: false,\n  showPieces: true,\n  pieceOpacity: 0.7,\n};\n\nexport const useVisualizationStateStore = create<VisualizationStateStore>()(\n  persist(\n    (set, get) => ({\n      ...initialState,\n      \n      setCurrentMove: (move) => set({ currentMove: move }),\n      setSelectedPhase: (phase) => set({ selectedPhase: phase }),\n      setLockedPieces: (pieces) => set({ lockedPieces: pieces }),\n      setLockedSquares: (squares) => set({ lockedSquares: squares }),\n      setCompareMode: (mode) => set({ compareMode: mode }),\n      setDisplayMode: (mode) => set({ displayMode: mode }),\n      setDarkMode: (dark) => set({ darkMode: dark }),\n      setShowTerritory: (show) => set({ showTerritory: show }),\n      setShowHeatmaps: (show) => set({ showHeatmaps: show }),\n      setShowPieces: (show) => set({ showPieces: show }),\n      setPieceOpacity: (opacity) => set({ pieceOpacity: opacity }),\n      \n      captureState: (moveHistory) => {\n        const state = get();\n        return {\n          currentMove: state.currentMove,\n          selectedPhase: state.selectedPhase,\n          isPlaying: false, // Always pause for capture\n          lockedPieces: [...state.lockedPieces],\n          lockedSquares: [...state.lockedSquares],\n          compareMode: state.compareMode,\n          highlightedPiece: null,\n          displayMode: state.displayMode,\n          darkMode: state.darkMode,\n          showTerritory: state.showTerritory,\n          showHeatmaps: state.showHeatmaps,\n          showPieces: state.showPieces,\n          pieceOpacity: state.pieceOpacity,\n          moveHistory,\n          capturedAt: new Date(),\n        };\n      },\n      \n      restoreFromState: (state) => {\n        set({\n          currentMove: state.currentMove ?? initialState.currentMove,\n          selectedPhase: state.selectedPhase ?? initialState.selectedPhase,\n          lockedPieces: state.lockedPieces ?? initialState.lockedPieces,\n          lockedSquares: state.lockedSquares ?? initialState.lockedSquares,\n          compareMode: state.compareMode ?? initialState.compareMode,\n          displayMode: state.displayMode ?? initialState.displayMode,\n          darkMode: state.darkMode ?? initialState.darkMode,\n          showTerritory: state.showTerritory ?? initialState.showTerritory,\n          showHeatmaps: state.showHeatmaps ?? initialState.showHeatmaps,\n          showPieces: state.showPieces ?? initialState.showPieces,\n          pieceOpacity: state.pieceOpacity ?? initialState.pieceOpacity,\n        });\n      },\n      \n      resetState: () => set(initialState),\n    }),\n    {\n      name: 'en-pensent-visualization-state',\n      storage: createJSONStorage(() => sessionStorage),\n      partialize: (state) => ({\n        // Persist display preferences and current state\n        currentMove: state.currentMove,\n        selectedPhase: state.selectedPhase,\n        lockedPieces: state.lockedPieces,\n        lockedSquares: state.lockedSquares,\n        compareMode: state.compareMode,\n        displayMode: state.displayMode,\n        darkMode: state.darkMode,\n        showTerritory: state.showTerritory,\n        showHeatmaps: state.showHeatmaps,\n        showPieces: state.showPieces,\n        pieceOpacity: state.pieceOpacity,\n      }),\n    }\n  )\n);";export{e as default};
