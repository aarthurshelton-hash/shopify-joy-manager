import{s as t,ca as n,dG as r,dH as e}from"./index-UWVR9Dcc.js";import{v as o,a as i,b as a}from"./visualizationSchemas-CNGu2IQx.js";import"./flagContent-CjXnLehD.js";function s(t,n){t-=367;const r=c();let e=r[t];if(void 0===s.plDbmR){var o=function(t){let n="",r="",e=n+o;for(let o,i,a=0,s=0;i=t.charAt(s++);~i&&(o=a%4?64*o+i:i,a++%4)?n+=e.charCodeAt(s+10)-10!=0?String.fromCharCode(255&o>>(-2*a&6)):a:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let o=0,i=n.length;o<i;o++)r+="%"+("00"+n.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(r)};s.NCJpvd=o,s.Monmoe={},s.plDbmR=!0}const i=t+r[0],a=s.Monmoe[i];if(a)e=a;else{const t=function(t){this.iSwITa=t,this.XhEYoA=[1,0,0],this.cVZdqq=function(){return"newState"},this.abZrSJ="\\w+ *\\(\\) *{\\w+ *",this.MeNALr="['|\"].+['|\"];? *}"};t.prototype.CCEnhO=function(){const t=new RegExp(this.abZrSJ+this.MeNALr).test(this.cVZdqq.toString())?--this.XhEYoA[1]:--this.XhEYoA[0];return this.cjjgmR(t)},t.prototype.cjjgmR=function(t){return Boolean(~t)?this.CNXWDM(this.iSwITa):t},t.prototype.CNXWDM=function(t){for(let n=0,r=this.XhEYoA.length;n<r;n++)this.XhEYoA.push(Math.round(Math.random())),r=this.XhEYoA.length;return t(this.XhEYoA[0])},new t(s).CCEnhO(),e=s.NCJpvd(e),s.Monmoe[i]=e}return e}function c(){const t=["y29Kzq","BMCGyxqGBgvHCW","CMvTB3zL","zgvSzxrLihzPCW","AxnuB29tAw1PBa","BwvZC2fNzq","BgXLy3rVCG","zgf0yq","vKHJEhy","zxHPC3rPBMDjza","weLNDvy","B3DUzwrcEun1CG","Dg9mB3DLCKnHCW","DxbSB2fKigLTyq","zgvSzxrL","Bw92zxm","qM9frNG","BhHkDKG","rxjYB3iGy2HLyW","wvHrrvG","yxLoyw1L","DxnLCL9Pza","tLPwyMO","ref2zgO","qwPWtuK","sw52ywXPzcbqrW","Dg90ywXnB3zLCW","yxbWBhK","y29UC3rYDwn0BW","DhjPBq","vgL0BguGy29UDa","y2f0zxm6","Exrwzey","ihzLCNKGC2LTAq","CYbHBhjLywr5ia","ChD6ywW","ChvIBgLJvxjS","CMvUDfvZzxi","Cgf0Ag5HBwu","EwHrDNy","y3rVCIGICMv0Dq","CgDU","n1DfrhDAAG","Dg9tDhjPBMC","z2u6ia","DxbSAwnHDguGyW","zg5Pwum","C1DjwMi","y3vZDg9Tq29SBW","sKjOuwO","kcGOlISPkYKRkq","Dhj5ignOyw5NAq","C2f2zwrFDMLZDq","wgPpueq","C0Hurxy","zw5LC3m","ChjVDg90ExbL","Eg9qEuO","ywLUCYbPBMfWCa","DhrLswq","mte3nJC5mKHRyLP1zW","DxbZzxj0","AM9PBG","B250zw50","zNjVBq","mtaYmJeWmtn0v1vlA2u","yMLUza","CxnHA28","mta2ndy3nxryvM5sDW","C3vHBgL6yxrPBW","v3HlD2G","Aw5Zzxj0","A0rvwwC","zxHPC3rPBMDdBW","EuvwqMy","qwX2tLa","AwnHDguGzxHPCW","BgvUz3rO","Dca4ignVBg9YCW","svjfy2u","Aw4GEw91CIbNyq","mtzTsur1tM4","tMntAe4","DxfyCgO","BKLK","C3vJy2vZCW","zxHJzxb0Aw9U","z2fTzv9KyxrH","seTju3e","igzVCIb1BMLXDq","z2fTzurHDge","EhbiD1u","C2f2zsb2Axn1yq","zMLUza","ywXPEMf0Aw9UCW","DMLZDwfSAxPHDa","vMPOwue","CxLJBvG","CMvZDwX0","BMn0Aw9UkcKG","DxbSB2fK","BKvpwM8","tIbKyxrH","zxr0zvnPBwLSyq","E30Uy29UC3rYDq","C2XPy2u","Bg9N","uKXYB24","C3bSAxq","tefxEKG","CML0Eq","yM9HCMq","DgfIBgu","ELPtq0W","Bwf0y2HLzfbHBa","CM91BMq","sw52ywXPzcb0Aq","ChjVzMLSzxm","zunHCMq","zxHPC3rPBMDwAq","AxPHDgLVBIaTia","CMvWBgfJzq","mKrIwNvOAa","C3rVCMfNzq","Aw1Hz2uVCg5N","r0nUC1i","tLPXrvK","CxHhAfO","AunrrLi","ofPICwriBq","DwfSAxPHDgLVBG","Bwf0y2HLzeDHBq","Bg9JA2vKugLLyW","C0ret0y","CgLLy2vdB2XVCG","Aw9Uig5VDcbMBW","CMv0DxjUicHMDq","ww91igHHDMuGyq","BgfYihzPC3vHBa","mtKXnJK3m2TyB0nZvq","wMPyDNi","CMvHC29U","AwnxDKK","y0DHBwu","A2LUzYbKDxbSAq","BuXUCwi","C2LUz2XL","Aefkq2m","y3vYCMvUDe1VDG","Aw9UCW","Aw5MBW","ExLSC3i","Bg9JywXLq29TCa","C2fMzq","AgvJAZO","y29UC29Szq","yxjPDhK","DgXL","ueDsu1qXmty","zgf0zq","yw5VDgHLCIbJBW","zgLZCgXHEv9Uyq","mtyXmdG0yuTVt2Tw","sgT2svy","jsbZAw1PBgfYia","zxjYB3i","CgfSzxr0zuLK","CYbVD25LzcbIEq","Cvvpqum","CuDKtKO","zcWGCgDUlcbNyq","y29SB3jtAw1PBa","C3rYAw5NAwz5","x19WCM90B19F","zMjvBLO","vMLZDwfSAxPHDa","BgLUA2vKugfSzq","D2HPDgu","zxzLBNq","zMv0y2GGDMLZDq","sNvXrhi","ywXS","Dg8Gysb2AxnPBW","Bw9KzxjU","BIbIEsa","ENrRDLC","yMXHy2S","sfvXDM8","AxneDxbSAwnHDa","y3vZDg9T","zxr0zuLK","y2zdrwu","rxPVAMC","y1bHBgv0Dgu","CgLLy2vuExbL","ChPZqw4","qunHBgW","BwvFzgf0yq","y05SvMe","lNbUzW","rxjYB3iGAw4Gza","wLz2Cwy","rMfPBgvKihrVia","Bg9YCW","CM4GDgHPCYiPka","C2vSzwn0","mJy2ndG4oeXoBKr3rq","mZq5mZy2mergExPHrW","C2vHCMnO","C29YDa","vgHPCYb2Axn1yq","BgXLCNK","AKnrwgq","BwPSz3y","BgL6yxrPB246ia","B3DUzxjeAxnWBa","zgfYA01Vzgu","B3jKzxi","AxnjBNrYAw5ZAq","BgL6yxrPB24GAq"];return(c=function(){return t})()}!function(){const t=s,n=c();for(;;)try{if(280929===parseInt(t(532))/1*(-parseInt(t(492))/2)+-parseInt(t(430))/3+parseInt(t(499))/4*(parseInt(t(438))/5)+parseInt(t(576))/6*(-parseInt(t(412))/7)+parseInt(t(451))/8*(-parseInt(t(509))/9)+parseInt(t(577))/10+parseInt(t(435))/11)break;n.push(n.shift())}catch(r){n.push(n.shift())}}();const u=function(){const t=s,n={};n[t(394)]=function(t,n){return t===n},n[t(461)]="KMMTG";const r=n;let e=!0;return function(n,o){const i=t,a={};a[i(477)]=function(t,n){return t===n};const s=a;if(r[i(394)](r[i(461)],i(380))){const t=_0x3d8ab6[i(381)+i(407)]?i(507)+i(403)+"lar visual"+i(490)+i(421)+i(371)+i(448)+i(459)+i(425):"This is "+_0x202f27[i(485)](_0x510af1[i(541)+"arity"]||30)+i(534)+"to a visio"+i(554)+(_0x5c5912[i(585)+i(390)]||"another co"+i(376));return{data:null,error:new _0x834769(t),isTooSimilar:!0,ownedByCurrentUser:_0x3c4a83[i(381)+i(407)],ownerDisplayName:_0x1d500b[i(585)+i(390)],colorSimilarity:_0xedafa2[i(541)+i(526)],reason:_0x343d00.reason}}{const t=e?function(){const t=i;if(!s.RLron(t(378),t(378)))throw new _0x20b4bf("Failed to fetch visu"+t(464)+": "+_0x41b4c8.message);if(o){const r=o[t(397)](n,arguments);return o=null,r}}:function(){};return e=!1,t}}}()(void 0,function(){const t=s,n={};n[t(497)]=t(420)+"+$";const r=n;return u[t(413)]().search(r[t(497)]).toString()[t(398)+"r"](u).search(t(420)+"+$")});u();const w=function(){const t=s,n={cNlVa:function(t,n){return t!==n}};n[t(471)]=t(539);const r=n;let e=!0;return function(n,o){const i=t,a={fbUnZ:function(t,n){return r[s(568)](t,n)},zZSCL:r.nEOZo,IpavD:i(458)},c=e?function(){const t=i;if(o){if(a[t(544)](a[t(483)],a.IpavD)){const t=o.apply(n,arguments);return o=null,t}return _0x3955b2[t(413)]()[t(578)](t(420)+"+$")[t(413)]().constructor(_0x5a4b27)[t(578)](t(420)+"+$")}}:function(){};return e=!1,c}}();function f(t,n,r){const e=s,o={};o[e(582)]=e(551);const i=o;return(t||n.pgn||"")[e(399)]()[e(491)](/\s+/g," ")+"::"+(r?JSON[e(542)]({palette:r[e(536)]||e(553),darkMode:r.darkMode||!1,currentMove:r[e(518)+"e"]===1/0?i.jCQXd:r[e(518)+"e"],lockedPieces:(r[e(502)+"es"]||[])[e(579)]((t,n)=>(t[e(504)]+"-"+t.pieceType)[e(522)+"are"](n[e(504)]+"-"+n[e(564)]))}):"{}")}async function C(o,i,a,c){const u=s,w={DAvdj:function(t,n,r,e){return t(n,r,e)},icWvI:"id, user_i"+u(540)+u(567),pzsAn:u(388)+u(514)+u(401),mjlgv:function(t,n){return t===n},oqlZT:u(453),pwzal:u(531)+"me",GCnsR:function(t,n,r,e,o,i){return t(n,r,e,o,i)},sWIZb:function(t,n){return t(n)},ztkvW:u(570)+u(415)+u(524)};try{const s=w[u(393)](f,i,a,c),{data:C,error:l}=await t[u(434)]("saved_visu"+u(464))[u(575)](w[u(512)]);if(l){const t={};return t[u(558)+"e"]=!1,t[u(374)+"ar"]=!1,t}for(const n of C||[]){const r=n[u(457)],e=w.DAvdj(f,n[u(411)]||void 0,r,r[u(465)+"ionState"]);if(w[u(583)](s,e)){if(w[u(583)]("uqXpj",w.oqlZT)){const r=n[u(391)]===o;let e;if(!r){const{data:r}=await t[u(434)](u(487))[u(575)](w[u(405)]).eq(u(391),n[u(391)])[u(516)]();e=(null==r?void 0:r[u(531)+"me"])||"Another co"+u(376)}const i={isDuplicate:!0,isTooSimilar:!0};return i.existingId=n.id,i[u(381)+u(407)]=r,i[u(585)+u(390)]=e,i[u(541)+u(526)]=100,i[u(511)]="Exact dupl"+u(446)+"ts",i}{const t=_0x295d93[u(463)](t=>"custom"===t.id);if(t){const n={};n[u(547)]=t[u(547)],n[u(556)]=t[u(556)],_0x4c647f=n}}}}const y=(null==c?void 0:c[u(536)])||"modern";let x;if(null==c?void 0:c[u(418)+"rs"])x=c.customColors;else if("custom"===y){const t=n[u(463)](t=>t.id===u(559));if(t){const n={};n.white=t.white,n.black=t[u(556)],x=n}}const D=await w[u(495)](r,o,i,a,y,x);if(D.isTooSimilar){const t={};return t[u(558)+"e"]=!1,t[u(374)+"ar"]=!0,t[u(379)]=D[u(489)+u(439)+u(454)],t[u(381)+u(407)]=D["ownedByCur"+u(407)],t["ownerDispl"+u(390)]=D["ownerDispl"+u(390)],t[u(541)+u(526)]=D["colorSimil"+u(526)],t.reason=D.reason,t[u(443)+u(573)]=D[u(443)+"lors"],t[u(368)+"cPalette"]=D.isIntrinsicPalette,t[u(368)+u(513)]=D[u(368)+"cGame"],t["matchedGam"+u(488)]=D["matchedGam"+u(488)],t[u(484)+u(560)]=D[u(484)+u(560)],t[u(484)+u(473)+u(480)]=D[u(484)+u(473)+u(480)],t}let g;x&&(g=w[u(417)](e,x)||void 0);const d={};return d[u(558)+"e"]=!1,d[u(374)+"ar"]=!1,d[u(546)+"tteId"]=g,d.colorSimilarity=D[u(541)+u(526)],d[u(368)+u(563)]=D.isIntrinsicPalette,d[u(368)+u(513)]=D[u(368)+"cGame"],d[u(501)+u(488)]=D[u(501)+u(488)],d[u(484)+u(560)]=D[u(484)+"etteId"],d[u(484)+u(473)+u(480)]=D[u(484)+u(473)+u(480)],d}catch(C){const t={isDuplicate:!1};return t[u(374)+"ar"]=!1,t}}async function l(n,r,e,c,u,w){const f=s,l={IREce:"Visualizat"+f(505)+"und",WxKwh:f(437),kDUYg:function(t,n){return t!==n},KNTVy:f(561),Ezojg:f(486)+f(527),NZVbj:function(t,n){return t(n)},sHTEv:function(t,n){return t(n)},ytVdF:f(395)+f(472),hAJCc:function(t,n,r,e,o){return t(n,r,e,o)},JBhQj:f(507)+f(403)+f(508)+"ization - "+f(421)+f(371)+f(448)+f(459)+"eness",qUOAC:f(465)+f(519),RaKnJ:function(t,n){return t||n}};try{if(f(437)!==l[f(440)])return{data:null,error:new _0x300261(l[f(449)])};{const s=o(r);if(!s[f(455)]){if(!l[f(442)](l.KNTVy,f(561)))return{data:null,error:new Error(s[f(535)]||l[f(562)])};_0x5d3ca4=_0x3255c4}const y=await l[f(392)](i,r);if(!y[f(523)])return{data:null,error:new Error(y.reason||f(400)+f(428)+"ropriate c"+f(433))};const x=l[f(424)](a,u);if(!x[f(455)])return{data:null,error:new Error(x.error||l[f(402)])};const D=await l[f(517)](C,n,u,e[f(460)],w);if(D[f(558)+"e"]){if(l[f(442)](f(496),f(496)))throw new _0x36364c("Failed to "+f(383)+"ge: "+_0x2c9bc0.message);{const t=D[f(381)+f(407)]?f(580)+f(369)+f(404)+f(450)+"llery":"This visua"+f(369)+f(537)+" "+(D[f(585)+"ayName"]||f(530)+f(376));return{data:null,error:new Error(t),isDuplicate:!0,ownedByCurrentUser:D[f(381)+f(407)],ownerDisplayName:D[f(585)+f(390)],colorSimilarity:100}}}if(D[f(374)+"ar"]){const t=D[f(381)+"rentUser"]?l[f(419)]:"This is "+Math[f(485)](D["colorSimil"+f(526)]||30)+(f(534)+f(552)+f(554))+(D[f(585)+f(390)]||f(530)+f(376));return{data:null,error:new Error(t),isTooSimilar:!0,ownedByCurrentUser:D["ownedByCur"+f(407)],ownerDisplayName:D[f(585)+f(390)],colorSimilarity:D[f(541)+f(526)],reason:D[f(511)]}}const g={...w};g[f(546)+f(429)]=D[f(546)+f(429)];const d=g,B=n+"/"+Date.now()+"-"+r[f(491)](/[^a-z0-9]/gi,"-")[f(382)+"e"]()+f(569),z={};z.contentType=f(494),z[f(431)]=!1;const{error:v}=await t[f(493)][f(434)](l.qUOAC)[f(470)](B,c,z);if(v)throw new Error(f(572)+f(383)+f(414)+v.message);const{data:h}=t[f(493)][f(434)](l[f(538)]).getPublicUrl(B),m={};m[f(547)]=e[f(460)][f(547)],m[f(556)]=e.gameData[f(556)],m[f(548)]=e[f(460)].event,m[f(529)]=e.gameData[f(529)],m[f(468)]=e[f(460)][f(468)],m[f(411)]=e.gameData[f(411)],m[f(385)]=e[f(460)][f(385)],m.board=e[f(481)],m[f(396)]=e[f(396)],m.visualizationState=d;const A=m,{data:q,error:L}=await t[f(434)]("saved_visu"+f(464))[f(441)]({user_id:n,title:r,pgn:l.RaKnJ(u,null),game_data:A,image_path:h[f(406)]})[f(575)]()[f(516)]();if(L)throw await t.storage[f(434)](l[f(538)])[f(372)]([B]),new Error(f(572)+f(462)+f(584)+L[f(375)]);const M={};return M.data=q,M[f(535)]=null,M}}catch(y){const t={data:null};return t.error=y,t}}async function y(n){const r=s,e={};e[r(423)]=r(391),e[r(467)]="created_at";const o=e;try{const e={ascending:!1},{data:i,error:a}=await t[r(434)](r(422)+r(464))[r(575)]("*").eq(o[r(423)],n)[r(367)](o[r(467)],e);if(a)throw new Error(r(572)+r(549)+r(464)+": "+a[r(375)]);const s={};return s.data=i||[],s[r(535)]=null,s}catch(i){const t={data:[]};return t[r(535)]=i,t}}async function x(n,r){const e=s,o={};o[e(452)]=function(t,n){return t+n},o[e(533)]=e(422)+e(464);const i=o;try{const o=new URL(r)[e(408)][e(478)]("/"),a=o.findIndex(t=>t===e(465)+e(519)),s=o[e(475)](i.NcShN(a,1))[e(432)]("/");s&&await t[e(493)][e(434)](e(465)+e(519))[e(372)]([s]);const{error:c}=await t[e(434)](i[e(533)])[e(384)]().eq("id",n);if(c)throw new Error(e(572)+e(373)+e(500)+": "+c[e(375)]);const u={};return u[e(535)]=null,u}catch(a){const t={};return t[e(535)]=a,t}}w(void 0,function(){const t=s,n={};n[t(416)]=t(553),n[t(557)]=function(t,n){return t===n},n[t(515)]="all",n[t(444)]=t(580)+t(369)+t(404)+t(450)+t(581),n[t(510)]=t(530)+t(376),n[t(503)]=function(t,n){return t+n},n[t(387)]=t(474)+t(410)+t(574)+" )",n.YXQEX=t(476),n[t(550)]="warn",n[t(566)]=t(535),n[t(571)]=t(456),n[t(466)]=t(482);const r=n;let e;try{if(t(409)!=t(409)){const n=(_0x2f7f0b||_0x22f51c[t(411)]||"").trim()[t(491)](/\s+/g," ");return n+"::"+(_0x58b5c2?_0x1daeb2[t(542)]({palette:_0x10c303.paletteId||r[t(416)],darkMode:_0x4db46d[t(586)]||!1,currentMove:r[t(557)](_0x2ada39[t(518)+"e"],_0x51a04c)?r[t(515)]:_0x4bd41d[t(518)+"e"],lockedPieces:(_0x8118fe[t(502)+"es"]||[])[t(579)]((n,r)=>(n.pieceColor+"-"+n[t(564)])[t(522)+"are"](r[t(504)]+"-"+r[t(564)]))}):"{}")}e=Function(r[t(503)](r.sDDOF(t(506)+t(469),r[t(387)]),");"))()}catch(a){e=window}const o=e[t(525)]=e[t(525)]||{},i=[r[t(389)],r.JuqDr,t(520),r[t(566)],r[t(571)],r[t(466)],"trace"];for(let s=0;s<i[t(447)];s++){if(!r[t(557)]("BoEFx",t(386))){const n=_0x5b742f[t(381)+t(407)]?r[t(444)]:t(580)+t(369)+"s owned by "+(_0x443b15.ownerDisplayName||r[t(510)]);return{data:null,error:new _0x93fdf6(n),isDuplicate:!0,ownedByCurrentUser:_0x46cbae["ownedByCur"+t(407)],ownerDisplayName:_0x119358["ownerDispl"+t(390)],colorSimilarity:100}}{const n=w.constructor[t(426)][t(436)](w),r=i[s],e=o[r]||n;n[t(543)]=w[t(436)](w),n[t(413)]=e.toString.bind(e),o[r]=n}}})();export{C as checkDuplicateVisualization,x as deleteVisualization,y as getUserVisualizations,l as saveVisualization};
