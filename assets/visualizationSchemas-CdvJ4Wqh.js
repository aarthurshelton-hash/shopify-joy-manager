import{s as e,b3 as a,cv as n,b2 as s,cw as t}from"./index-BRnl98aa.js";import{f as r}from"./flagContent-DwVP0cba.js";async function o(a,n){if(!a||0===a.trim().length)return{safe:!0};try{const{data:s,error:t}=await e.functions.invoke("moderate-content",{body:{type:"text",content:a}});return t?{safe:!0}:(!s.safe&&(null==n?void 0:n.userId)&&(null==n||n.contentType),{safe:s.safe,reason:s.reason,flagged:!s.safe})}catch(s){return{safe:!0}}}async function i(a,n){if(!a)return{safe:!1,reason:"No image provided"};try{const{data:s,error:t}=await e.functions.invoke("moderate-content",{body:{type:"image",content:a}});return t?{safe:!0}:(!s.safe&&(null==n?void 0:n.userId)&&(null==n||n.contentType),{safe:s.safe,reason:s.reason,flagged:!s.safe})}catch(s){return{safe:!0}}}function c(e){return new Promise((a,n)=>{const s=new FileReader;s.onload=()=>{const e=s.result;a(e)},s.onerror=n,s.readAsDataURL(e)})}const u=e=>(a,s)=>{const t=function(e){if(!e||0===e.trim().length)return{safe:!0};const a=[/\b(fuck|shit|cunt|nigger|faggot)\b/gi],n=e.toLowerCase();for(const s of a)if(s.test(n))return{safe:!1,reason:"Content contains inappropriate language"};return{safe:!0}}(a);return t.safe||s.addIssue({code:n.custom,message:t.reason||`${e} contains inappropriate content`}),a},f=a().trim().min(1,"Title is required").max(200,"Title must be 200 characters or less").regex(/^[^<>]*$/,"Title cannot contain < or > characters").superRefine(u("Title")),l=a().max(1e5,"PGN data is too large (max 100KB)").optional().nullable();s({title:f,pgn:l}),s({priceCents:t().int("Price must be a whole number of cents").min(0,"Price cannot be negative").max(1e6,"Maximum price is $10,000")});const m=a().trim().min(1,"Display name is required").max(50,"Display name must be 50 characters or less").regex(/^[^\x00-\x1F\x7F]*$/,"Display name cannot contain control characters").superRefine(u("Display name"));function d(e){var a;const n=f.safeParse(e);return n.success?{success:!0,data:n.data}:{success:!1,error:(null==(a=n.error.errors[0])?void 0:a.message)||"Invalid title"}}function g(e){var a;const n=l.safeParse(e);return n.success?{success:!0,data:n.data}:{success:!1,error:(null==(a=n.error.errors[0])?void 0:a.message)||"Invalid PGN data"}}export{g as a,i as b,m as d,c as f,o as m,d as v};
