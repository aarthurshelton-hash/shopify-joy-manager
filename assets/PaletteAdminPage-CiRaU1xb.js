import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as l,x as o,y as d,aP as u,p as x,t as m,P as h,w as f,B as j,bM as p,cj as w,a9 as g,am as v,a1 as y,a2 as N,a3 as b,a4 as C,bC as B,a5 as z,cu as k,b as D}from"./index-BKigiLhM.js";!function(){const e=A,s=q();for(;;)try{if(619014===-parseInt(e(489))/1+-parseInt(e(503))/2*(parseInt(e(531))/3)+-parseInt(e(551))/4+-parseInt(e(526))/5+parseInt(e(535))/6+parseInt(e(557))/7*(parseInt(e(487))/8)+parseInt(e(494))/9)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const M=function(){let e=!0;return function(s,t){const n=e?function(){const e=A;if(e(547)!==e(521)){if(t){const n=t[e(479)](s,arguments);return t=null,n}}else{const s=_0x5757d5[e(550)+"r"].prototype[e(474)](_0x4016a9),t=_0x473747[_0x360fd7],n=_0x2e4be0[t]||s;s[e(545)]=_0x2f6409[e(474)](_0x527698),s[e(522)]=n[e(522)][e(474)](n),_0x2bb247[t]=s}}:function(){};return e=!1,n}}()(void 0,function(){const e=A;return M[e(522)]().search("(((.+)+)+)+$")[e(522)]()[e(550)+"r"](M).search(e(475)+"+$")});function q(){const e=["rwTyA04","D2HPDgu","mJGXnti2nKL4BunPvW","CgfSzxr0zv9VDG","A2LUzYbHzg1PBG","BvDxrxK","C2vSzwn0","B3jKzxi","CgfSzxr0zuLK","CgfSzxr0zv9Pza","zgvSzxrL","yxrPB25ZoG","x19WCM90B19F","wLfJEMq","uxzkBu0","tw1jvhm","ywrTAw4","y29UC3rYDwn0BW","mJi2nJy1mMHbBKnYBa","zxjYB3i","vxv6Dxi","Bw9KAwzPzwrFyG","zevMEu0","ywXPEMf0Aw9UCW","mZm4ndi5n2jyz0zouG","BMn0Aw9UkcKG","quHZANq","AejLyuS","DxbKyxrL","DgfIBgu","yMLUza","kcGOlISPkYKRkq","CM4GDgHPCYiPka","zg1PBIbJAgvJAW","rxjYB3iGy291BG","yxbWBhK","BgvUz3rO","A2DUtxG","vMH4qvi","CNDLBK4","EMXrtNq","D2HPDgvFy29SBW","y3rVCIGICMv0Dq","og9wwvfXCa","y29UC29Szq","mta2mti5neDeCMrZCq","yMXHy2TFy29SBW","v21prwq","E30Uy29UC3rYDq","ChjVDg90ExbL","mJK0mZy3ntLjCw1mwK0","ihjVBgu6","ywLMBgu","zMLUza","uevfsK8","zxjYAwrLCW","Cw90see","rxjYB3iGAw4Gyq","ANf5Dg4","mJqWzfDVyuTv","zcb2Axn1ywXPEG","AxjwAfe","qKPgBNe","zeTIrfu","y29Kzq","CNbJ","DgLUzYbSAw5Rzq","rxjYB3iGy2HLyW","D1LwrhG","ueDsu1qXmty","x3vZzxjFAwq","shDeqve","Aw9Uu3rHDgu","C2f2zwrFDMLZDq","zxHJzxb0Aw9U","DhrLswq","u1rTs0i","wxPZr1u","Dg9tDhjPBMC","C2LUz2XL","v05zuNC","DMLZDwfSAxPHDa","ntuXnZmXmgzMtwLfyG","DMvYC2LVBG","zgf0yq","zNjVBq","yMXHy2S","mJe4mJvMDNrdBeS","uvHgtKS"];return(q=function(){return e})()}M();const P=function(){const e=A,s={};s[e(520)]=function(e,s){return e!==s},s[e(538)]=e(546);const t=s;let n=!0;return function(s,r){const a=e;if(!t[a(520)](t.mWWEy,a(546))){const e=n?function(){if(r){const e=r.apply(s,arguments);return r=null,e}}:function(){};return n=!1,e}if(_0x54b1c9){const e=_0x5be477[a(479)](_0x5021f2,arguments);return _0x27b8cc=null,e}}}();function A(e,s){e-=469;const t=q();let n=t[e];if(void 0===A.YIHBJP){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};A.rKjCBg=r,A.FuarEu={},A.YIHBJP=!0}const a=e+t[0],i=A.FuarEu[a];if(i)n=i;else{const e=function(e){this.qMwgxD=e,this.lBCFTj=[1,0,0],this.RDxlEG=function(){return"newState"},this.BblMmK="\\w+ *\\(\\) *{\\w+ *",this.xkFbRJ="['|\"].+['|\"];? *}"};e.prototype.QQGWsC=function(){const e=new RegExp(this.BblMmK+this.xkFbRJ).test(this.RDxlEG.toString())?--this.lBCFTj[1]:--this.lBCFTj[0];return this.nJtZXD(e)},e.prototype.nJtZXD=function(e){return Boolean(~e)?this.WXPNXp(this.qMwgxD):e},e.prototype.WXPNXp=function(e){for(let s=0,t=this.lBCFTj.length;s<t;s++)this.lBCFTj.push(Math.round(Math.random())),t=this.lBCFTj.length;return e(this.lBCFTj[0])},new e(A).QQGWsC(),n=A.rKjCBg(n),A.FuarEu[a]=n}return n}async function _(s){const t=A,n={QXFNK:function(e,s){return e(s)},eEOhB:function(e,s){return e+s},hBeaK:"{}.constru"+t(486)+t(476)+" )",MmITs:t(536)+"errides",xKsjr:function(e,s){return e!==s},WNYRw:function(e,s){return e===s},rwenN:t(505)};try{const{data:r,error:a}=await e.from(n[t(548)])[t(539)]("*").eq(t(542),s)[t(523)]();if(a&&n.xKsjr(a[t(508)],t(513)))throw a;const i={};return i[t(528)]=r,i[t(552)]=null,i}catch(r){if(n[t(524)](n[t(483)],n[t(483)])){const e={};return e[t(528)]=null,e.error=r,e}_0x2bf4e1=BVkVsO[t(532)](_0x465d56,BVkVsO.eEOhB("return (fu"+t(469)+BVkVsO[t(471)],");"))()}}async function K(s){const t=A,n={};n[t(500)]=t(517)+t(556),n[t(484)]="id, game_data",n.PEEJO=t(478)+t(510)+t(504)+t(544);const r=n;try{const{data:n,error:a}=await e[t(529)](r[t(500)])[t(539)](r[t(484)]);if(a)throw a;let i=0;for(const e of n||[]){const n=e.game_data[t(525)+t(516)];((null==n?void 0:n[t(541)])===s||(null==n?void 0:n["linkedPale"+t(519)])===s)&&i++}return i}catch(a){return 0}}P(void 0,function(){const e=A,s={VhxAR:function(e,s){return e===s},BJFnq:e(512),LcIrI:function(e,s){return e(s)},jqytn:"return (fu"+e(469),dKbDU:e(492)+'ctor("return this")( )',KOTVi:e(552),kgnMx:e(518),AHsjt:"trace"},t=function(){const t=e;if(s[t(482)](s[t(506)],t(491))){const e=_0x48b10b?function(){if(_0x1ceb3c){const e=_0x4cfd23[t(479)](_0x14ff3,arguments);return _0xe4c2df=null,e}}:function(){};return _0x44c24b=!1,e}{let e;try{e=s.LcIrI(Function,s[t(502)]+s[t(507)]+");")()}catch(n){e=window}return e}}(),n=t[e(488)]=t[e(488)]||{},r=["log","warn","info",s.KOTVi,s[e(481)],e(473),s[e(470)]];for(let a=0;a<r[e(480)];a++){const s=P[e(550)+"r"][e(493)][e(474)](P),t=r[a],i=n[t]||s;s[e(545)]=P[e(474)](P),s[e(522)]=i[e(522)][e(474)](i),n[t]=s}})();const S=["k","q","r","b","n","p"],L={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},F=()=>{var M,q,P,F;const{user:G}=s(),I=t(),[E,J]=n.useState(!1),[W,T]=n.useState(!0),[U,H]=n.useState([]),[X,V]=n.useState(null),[Y,R]=n.useState(null),[O,Z]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!G)return void I("/");if(!(await async function(s){const t=A,n={};n.dEfyM=t(549),n[t(533)]=t(501)+t(477)+":";const r=n;try{const n={};n[t(514)]=s,n._role=r[t(555)];const{data:a,error:i}=await e[t(509)]("has_role",n);return!i&&!0===a}catch(a){return!1}}(G.id)))return D.error("Access denied",{description:"Admin privileges required"}),void I("/");J(!0),await te(),T(!1)})()},[G,I]);const te=async()=>{const{data:s}=await async function(){const s=A;try{const{data:t,error:n}=await e.from(s(536)+s(499)).select("*")[s(540)]("palette_id");if(n)throw n;const r={};return r[s(528)]=t||[],r[s(552)]=null,r}catch(t){const e={};return e[s(528)]=[],e.error=t,e}}();H(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await K(e.id);Z(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=U.find(s=>s.palette_id===e);V(e),R({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{Y&&R({...Y,[e]:{...Y[e],[s]:t}})},ae=async()=>{if(!X||!Y||!G)return;Q(!0),se(!1);const{error:s,version:t}=await async function(s,t,n,r){const a=A,i={aifle:function(e,s){return e(s)},HwDAQ:function(e,s){return e+s}};try{const{data:c}=await i[a(496)](_,s);if(c){const{error:l}=await e[a(529)](a(536)+"errides")[a(472)]({white_colors:t,black_colors:n,modified_by:r,version:i[a(515)](c.version,1)}).eq(a(542),s);if(l)throw l;const o={error:null};return o[a(527)]=c.version+1,o}{const i={};i[a(542)]=s,i[a(485)+"rs"]=t,i[a(490)+"rs"]=n,i[a(554)+"y"]=r,i[a(527)]=1;const{error:c}=await e[a(529)](a(536)+a(499)).insert(i);if(c)throw c;const l={};return l[a(552)]=null,l[a(527)]=1,l}}catch(c){const e={};return e[a(552)]=c,e[a(527)]=0,e}}(X,Y.white,Y.black,G.id);s?D.error("Failed to save",{description:s.message}):(D.success("Palette updated!",{description:`Version ${t} saved. ${O[X]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>U.some(s=>s.palette_id===e);return W?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):E?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(l,{className:"cursor-pointer transition-all hover:border-primary/50 "+(X===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(o,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),O[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),O[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[S.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),S.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:X&&Y?r.jsxs(l,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(m,{className:"flex items-center gap-2",children:[r.jsx(h,{className:"h-5 w-5"}),null==(M=ie(X))?void 0:M.name]}),r.jsx(f,{children:null==(q=ie(X))?void 0:q.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(X)&&r.jsxs(j,{variant:"outline",size:"sm",onClick:async()=>{if(!X)return;Q(!0);const{error:s}=await async function(s){const t=A,n={};n[t(553)]=t(536)+t(499);const r=n;try{const{error:n}=await e[t(529)](r[t(553)])[t(543)]().eq(t(542),s);if(n)throw n;return{error:null}}catch(a){const e={};return e.error=a,e}}(X);s?D.error("Failed to revert",{description:s.message}):(D.success("Reverted to defaults"),ne(X),await te()),Q(!1)},disabled:$,children:[r.jsx(p,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(j,{size:"sm",onClick:async()=>{if(!X||!Y||!G)return;(O[X]||0)>0?se(!0):await ae()},disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(w,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(o,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(P=ie(X))?void 0:P.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:S.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(g,{type:"color",value:Y.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(g,{type:"text",value:Y.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(F=ie(X))?void 0:F.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:S.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:L[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(g,{type:"color",value:Y.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(g,{type:"text",value:Y.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(v,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:S.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:Y.white[e]},title:L[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:S.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:Y.black[e]},title:L[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(l,{className:"h-full flex items-center justify-center",children:r.jsxs(o,{className:"text-center py-12",children:[r.jsx(h,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(B,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(z,{children:["This palette is linked to ",r.jsx("strong",{children:O[X||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(j,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(j,{onClick:ae,disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(k,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{F as default};
