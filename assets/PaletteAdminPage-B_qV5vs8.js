import{s as e,u as s,a as t,r as n,j as r,L as a,b7 as i,ca as c,C as o,x as l,y as d,aP as u,p as x,t as h,P as m,w as f,B as p,bM as j,cj as v,a9 as w,am as g,a1 as y,a2 as N,a3 as b,a4 as C,bC as z,a5 as D,cu as k,b as B}from"./index-DEc03Eh1.js";function L(e,s){e-=282;const t=G();let n=t[e];if(void 0===L.gtmTVr){var r=function(e){let s="",t="",n=s+r;for(let r,a,i=0,c=0;a=e.charAt(c++);~a&&(r=i%4?64*r+a:a,i++%4)?s+=n.charCodeAt(c+10)-10!=0?String.fromCharCode(255&r>>(-2*i&6)):i:0)a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(let r=0,a=s.length;r<a;r++)t+="%"+("00"+s.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(t)};L.FYztwx=r,L.BKKsqX={},L.gtmTVr=!0}const a=e+t[0],i=L.BKKsqX[a];if(i)n=i;else{const e=function(e){this.LHbfUW=e,this.nxDljf=[1,0,0],this.eAfRZX=function(){return"newState"},this.vfTpcK="\\w+ *\\(\\) *{\\w+ *",this.kCYtOa="['|\"].+['|\"];? *}"};e.prototype.zpdfRT=function(){const e=new RegExp(this.vfTpcK+this.kCYtOa).test(this.eAfRZX.toString())?--this.nxDljf[1]:--this.nxDljf[0];return this.RFGMdf(e)},e.prototype.RFGMdf=function(e){return Boolean(~e)?this.Ftatvh(this.LHbfUW):e},e.prototype.Ftatvh=function(e){for(let s=0,t=this.nxDljf.length;s<t;s++)this.nxDljf.push(Math.round(Math.random())),t=this.nxDljf.length;return e(this.nxDljf[0])},new e(L).zpdfRT(),n=L.FYztwx(n),L.BKKsqX[a]=n}return n}!function(){const e=L,s=G();for(;;)try{if(467379===parseInt(e(357))/1*(parseInt(e(289))/2)+parseInt(e(343))/3+parseInt(e(314))/4+-parseInt(e(348))/5+-parseInt(e(313))/6+-parseInt(e(306))/7+-parseInt(e(287))/8*(-parseInt(e(290))/9))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const M=function(){const e=L,s={kYxWh:function(e,s){return e+s},xUptC:e(358)+e(318),nsrXP:function(e){return e()}};let t=!0;return function(n,r){const a=e;if(a(286)!==a(297)){const e=t?function(){if(r){const e=r[a(328)](n,arguments);return r=null,e}}:function(){};return t=!1,e}{const e=_0x2051d1(s[a(369)](s[a(336)],a(283)+'ctor("retu'+a(295)+" )")+");");_0x2cbd84=s[a(375)](e)}}}()(void 0,function(){const e=L,s={OGGFr:"(((.+)+)+)+$"},t=s;return M.toString()[e(311)](t[e(334)])[e(301)]()[e(366)+"r"](M)[e(311)](t[e(334)])});M();const q=function(){let e=!0;return function(s,t){const n=e?function(){if(t){const e=t[L(328)](s,arguments);return t=null,e}}:function(){};return e=!1,n}}();function G(){const e=["C2vSzwn0","BNnYwfa","CgfSzxr0zv9Pza","x19WCM90B19F","yMXHy2TFy29SBW","zNjVBq","qwftrhu","wgXzD2y","C2zOCha","E30Uy29UC3rYDq","Bw9KAwzPzwrFyG","CgfSzxr0zv9VDG","BxjPEhe","mJe0mZe5mM9jue9qCq","z2fTzv9KyxrH","nJyWotj5ywPhs2i","mZzUru5NvK0","zgvSzxrL","ywXPEMf0Aw9UCW","tMTfqMG","D2HPDgvFy29SBW","CM4GDgHPCYiPka","z1PuDhO","CKfhrfa","DhrLswq","u1bcBxy","rNHprfu","Dg9tDhjPBMC","DxbKyxrL","zxjYAwrLCW","r3jUtg4","rxjYB3iGy2HLyW","nZa3nty3B1LOv0Dc","twvmsMO","CMHkAxm","AwqSigDHBwvFza","rxjYB3iGy291BG","C2vHCMnO","zxjYB3i","mJm0mZq1nLnLv1LHwG","mZe4mdb1zK5lChe","DLnNs24","zM9OtNC","DMvYC2LVBG","BMn0Aw9UkcKG","B3fjsgO","D2HPDgu","BKTLCu8","ru94tum","D2XeqLi","zgf0yq","D2fYBG","C2f2zwrFDMLZDq","yMXHy2S","yxbWBhK","zLvbrfK","rxjYB3iGAw4Gyq","AgfZx3jVBgu","CgfSzxr0zuLK","yxrPB25ZoG","t0DhrNi","wvHnuLG","EfvWDem","ueDsu1qXmty","DMLZDwfSAxPHDa","Aw9Uu3rHDgu","zgTdve0","uKX5ufq","ChjVDg90ExbL","odu0mJjWC2XyuLi","y29Kzq","zxHJzxb0Aw9U","DgfIBgu","ChjAufC","mJCYnZy4mhz6C3LoAq","vfv3Exu","wgTqzKy","Aw5Zzxj0","yMLUza","CNbJ","zg1PBIbJAgvJAW","suDHCNG","z0P3B2i","mtjsvwLisK0","CMv0DxjUicHMDq","kcGOlISPkYKRkq","zurND24","yxrH","yMvivuG","Bg9N","y3rVCIGICMv0Dq","tw15yxG","y29UC3rYDwn0BW","Dvj5suu","y29UC29Szq","A1L4v2G","vMn6z08","ruHMDLG","yLnXrLu","A2LUzYbHzg1PBG"];return(G=function(){return e})()}async function S(s,t,n,r){const a=L,i={};i[a(371)]=a(285)+"errides",i[a(350)]=function(e,s){return e+s};const c=i;try{const{data:i}=await async function(s){const t=L,n={};n[t(315)]=function(e,s){return e===s},n[t(362)]=t(321),n[t(372)]="palette_overrides",n[t(367)]=t(376);const r=n;try{if(r[t(315)](t(380),r.beHUH)){const e={};return e[t(312)]=_0x37ad6e,e}{const{data:n,error:a}=await e[t(379)](r.bSqFU)[t(374)]("*").eq(r[t(367)],s).single();if(a&&a[t(344)]!==t(337))throw a;const i={};return i[t(324)]=n,i[t(312)]=null,i}}catch(a){const e={};return e[t(324)]=null,e[t(312)]=a,e}}(s);if(i){const{error:o}=await e.from(c[a(371)])[a(302)]({white_colors:t,black_colors:n,modified_by:r,version:c[a(350)](i[a(317)],1)}).eq(a(376),s);if(o)throw o;return{error:null,version:c[a(350)](i[a(317)],1)}}{const i={};i[a(376)]=s,i[a(294)+"rs"]=t,i.black_colors=n,i[a(284)+"y"]=r,i[a(317)]=1;const{error:o}=await e[a(379)](c.EHfvX)[a(351)](i);if(o)throw o;const l={};return l[a(312)]=null,l.version=1,l}}catch(o){const e={};return e[a(312)]=o,e.version=0,e}}async function P(s){const t=L,n={};n.IGarx=t(359)+"+$",n[t(323)]=t(326)+t(292),n.fohNw=t(309)+t(361),n[t(282)]=function(e,s){return e===s},n[t(341)]="fgSNF",n[t(307)]=function(e,s){return e===s};const r=n;try{const{data:n,error:a}=await e[t(379)](r[t(323)])[t(374)](r[t(316)]);if(a)throw a;let i=0;for(const e of n||[]){if(r.sfhpp(r[t(341)],t(296)))return _0x2e042e.toString()[t(311)](hNhLyq[t(355)])[t(301)]().constructor(_0x537b69).search(hNhLyq[t(355)]);{const n=e[t(288)][t(338)+t(339)];if((null==n?void 0:n[t(332)])===s||r[t(307)](null==n?void 0:n["linkedPale"+t(298)],s)){if(!r[t(282)]("NkEBh",t(293))){const e={};return e[t(312)]=_0x2ee56e,e[t(317)]=0,e}i++}}}return i}catch(a){return 0}}q(void 0,function(){const e=L,s={ILGYQ:function(e,s){return e(s)},prZPW:function(e,s){return e+s},GrnLn:function(e,s){return e+s},eDgwn:"return (fu"+e(318),fUADY:e(283)+e(364)+e(295)+" )",EOxMC:e(363),UmGkM:e(346),YXMRX:"trace"};let t;try{t=s.ILGYQ(Function,s[e(347)](s[e(304)](s[e(360)],s[e(329)]),");"))()}catch(a){t=window}const n=t[e(368)]=t.console||{},r=[s[e(322)],e(325),"info","error",e(345),s.UmGkM,s[e(335)]];for(let i=0;i<r.length;i++){const s=q[e(366)+"r"][e(342)][e(352)](q),t=r[i],a=n[t]||s;s[e(377)]=q[e(352)](q),s[e(301)]=a[e(301)][e(352)](a),n[t]=s}})();const K=["k","q","r","b","n","p"],A={k:"King",q:"Queen",r:"Rook",b:"Bishop",n:"Knight",p:"Pawn"},H=()=>{var M,q,G,H;const{user:U}=s(),Y=t(),[_,F]=n.useState(!1),[X,I]=n.useState(!0),[W,O]=n.useState([]),[T,Z]=n.useState(null),[E,R]=n.useState(null),[J,V]=n.useState({}),[$,Q]=n.useState(!1),[ee,se]=n.useState(!1);n.useEffect(()=>{(async()=>{if(!U)return void Y("/");if(!(await async function(s){const t=L,n={XlYwf:function(e,s){return e===s}};n[t(299)]=t(300),n[t(365)]=t(331),n[t(308)]="admin",n[t(349)]=function(e,s){return e===s},n[t(370)]=t(330)+t(354)+":";const r=n;try{if(r[t(381)]("FxODU",r[t(299)])){const{data:n,error:a}=await e[t(353)](r[t(365)],{_user_id:s,_role:r.rhJis});return!a&&r[t(349)](n,!0)}{const e=_0xd85a24.apply(_0x212a13,arguments);return _0x39263e=null,e}}catch(a){return!1}}(U.id)))return B.error("Access denied",{description:"Admin privileges required"}),void Y("/");F(!0),await te(),I(!1)})()},[U,Y]);const te=async()=>{const{data:s}=await async function(){const s=L,t={};t[s(340)]="palette_id";const n=t;try{const{data:t,error:r}=await e[s(379)](s(285)+s(303)).select("*").order(n[s(340)]);if(r)throw r;const a={};return a[s(324)]=t||[],a.error=null,a}catch(r){const e={};return e[s(324)]=[],e.error=r,e}}();O(s);const t={};for(const e of c.filter(e=>"custom"!==e.id))t[e.id]=await P(e.id);V(t)},ne=e=>{const s=c.find(s=>s.id===e);if(!s)return;const t=W.find(s=>s.palette_id===e);Z(e),R({white:(null==t?void 0:t.white_colors)||{...s.white},black:(null==t?void 0:t.black_colors)||{...s.black}})},re=(e,s,t)=>{E&&R({...E,[e]:{...E[e],[s]:t}})},ae=async()=>{if(!T||!E||!U)return;Q(!0),se(!1);const{error:e,version:s}=await S(T,E.white,E.black,U.id);e?B.error("Failed to save",{description:e.message}):(B.success("Palette updated!",{description:`Version ${s} saved. ${J[T]||0} visualizations will use the new colors.`}),await te()),Q(!1)},ie=e=>c.find(s=>s.id===e),ce=e=>W.some(s=>s.palette_id===e);return X?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(a,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):_?r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"container max-w-6xl py-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:r.jsx(i,{className:"h-6 w-6 text-primary"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Palette Administration"}),r.jsx("p",{className:"text-muted-foreground text-sm",children:"Modify featured palette colors. Changes propagate to all linked visualizations."})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Featured Palettes"}),c.filter(e=>"custom"!==e.id).map(e=>r.jsx(o,{className:"cursor-pointer transition-all hover:border-primary/50 "+(T===e.id?"border-primary ring-1 ring-primary/20":""),onClick:()=>ne(e.id),children:r.jsxs(l,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-sm",children:e.name}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[ce(e.id)&&r.jsx(d,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Modified"}),J[e.id]>0&&r.jsxs(d,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1",children:[r.jsx(u,{className:"h-2.5 w-2.5"}),J[e.id]]})]})]}),r.jsxs("div",{className:"flex gap-0.5",children:[K.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.white[s]}},`w-${s}`)),K.map(s=>r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.black[s]}},`b-${s}`))]})]})},e.id))]}),r.jsx("div",{className:"md:col-span-2",children:T&&E?r.jsxs(o,{children:[r.jsx(x,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(h,{className:"flex items-center gap-2",children:[r.jsx(m,{className:"h-5 w-5"}),null==(M=ie(T))?void 0:M.name]}),r.jsx(f,{children:null==(q=ie(T))?void 0:q.description})]}),r.jsxs("div",{className:"flex gap-2",children:[ce(T)&&r.jsxs(p,{variant:"outline",size:"sm",onClick:async()=>{if(!T)return;Q(!0);const{error:s}=await async function(s){const t=L,n={};n.drKec=t(285)+t(303),n[t(319)]=t(376);const r=n;try{const{error:n}=await e[t(379)](r.drKec)[t(291)]().eq(r[t(319)],s);if(n)throw n;return{error:null}}catch(a){const e={};return e.error=a,e}}(T);s?B.error("Failed to revert",{description:s.message}):(B.success("Reverted to defaults"),ne(T),await te()),Q(!1)},disabled:$,children:[r.jsx(j,{className:"h-4 w-4 mr-1"}),"Revert"]}),r.jsxs(p,{size:"sm",onClick:async()=>{if(!T||!E||!U)return;(J[T]||0)>0?se(!0):await ae()},disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(v,{className:"h-4 w-4 mr-1"}),"Save Changes"]})]})]})}),r.jsxs(l,{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(G=ie(T))?void 0:G.legendTheme.whiteEmoji," White Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:K.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:A[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(w,{type:"color",value:E.white[e],onChange:s=>re("white",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(w,{type:"text",value:E.white[e],onChange:s=>re("white",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`w-${e}`))})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm",children:[null==(H=ie(T))?void 0:H.legendTheme.blackEmoji," Black Pieces"]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:K.map(e=>r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs text-muted-foreground",children:A[e]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(w,{type:"color",value:E.black[e],onChange:s=>re("black",e,s.target.value),className:"w-10 h-8 p-0.5 cursor-pointer"}),r.jsx(w,{type:"text",value:E.black[e],onChange:s=>re("black",e,s.target.value),className:"h-8 text-xs font-mono"})]})]},`b-${e}`))})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3 text-sm flex items-center gap-2",children:[r.jsx(g,{className:"h-4 w-4"}),"Color Preview"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"White"}),r.jsx("div",{className:"flex gap-1",children:K.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:E.white[e]},title:A[e]},`preview-w-${e}`))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Black"}),r.jsx("div",{className:"flex gap-1",children:K.map(e=>r.jsx("div",{className:"w-8 h-8 rounded-md shadow-sm",style:{backgroundColor:E.black[e]},title:A[e]},`preview-b-${e}`))})]})]})]})]})]}):r.jsx(o,{className:"h-full flex items-center justify-center",children:r.jsxs(l,{className:"text-center py-12",children:[r.jsx(m,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Select a palette to edit its colors"})]})})})]})]}),r.jsx(y,{open:ee,onOpenChange:se,children:r.jsxs(N,{children:[r.jsxs(b,{children:[r.jsxs(C,{className:"flex items-center gap-2",children:[r.jsx(z,{className:"h-5 w-5 text-amber-500"}),"Confirm Palette Update"]}),r.jsxs(D,{children:["This palette is linked to ",r.jsx("strong",{children:J[T||""]||0})," visualizations. Saving these changes will affect how all linked visualizations render."]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(p,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),r.jsxs(p,{onClick:ae,disabled:$,children:[$?r.jsx(a,{className:"h-4 w-4 mr-1 animate-spin"}):r.jsx(k,{className:"h-4 w-4 mr-1"}),"Confirm Update"]})]})]})})]}):null};export{H as default};
